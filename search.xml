<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>é€šä¿—è®¾è®¡æ¨¡å¼ï¼ˆè¯‘ï¼‰</title>
    <url>/2020/04/23/%E9%80%9A%E4%BF%97%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%EF%BC%88%E8%AF%91%EF%BC%89/</url>
    <content><![CDATA[<p><a href="https://roadmap.sh/guides/design-patterns-for-humans" target="_blank" rel="noopener">åŸæ–‡ï¼šDesign Patterns for Humans</a></p>
<p>è®¾è®¡æ¨¡å¼æ˜¯å¯¹åå¤å‡ºç°çš„é—®é¢˜çš„è§£å†³æ–¹æ¡ˆï¼›<em>è§£å†³æŸäº›é—®é¢˜çš„æŒ‡å—</em>ã€‚å®ƒä»¬ä¸æ˜¯åƒé­”æ³•ä¸€æ ·çš„ç±»ã€åŒ…æˆ–è€…åº“ã€‚è¿™ä¸ªæŒ‡å—è¯´çš„æ˜¯åœ¨æŸäº›æƒ…å†µä¸‹å¦‚ä½•è§£å†³æŸäº›é—®é¢˜ã€‚</p>
<a id="more"></a>
<blockquote>
<p>è®¾è®¡æ¨¡å¼æ˜¯å¯¹åå¤å‡ºç°çš„é—®é¢˜çš„è§£å†³æ–¹æ¡ˆã€‚å¦‚ä½•è§£å†³æŸäº›é—®é¢˜çš„æŒ‡å—ã€‚</p>
</blockquote>
<p>ç»´åŸºç™¾ç§‘çš„æè¿°å¦‚ä¸‹ï¼š</p>
<blockquote>
<p>åœ¨è½¯ä»¶å·¥ç¨‹é¢†åŸŸï¼Œè½¯ä»¶è®¾è®¡æ¨¡å¼æ˜¯å¯¹è½¯ä»¶è®¾è®¡ä¸­ç»™å®šä¸Šä¸‹æ–‡ä¸­å¸¸è§é—®é¢˜çš„é€šç”¨å¯é‡ç”¨è§£å†³æ–¹æ¡ˆã€‚å®ƒä¸æ˜¯å¯ä»¥ç›´æ¥è½¬æ¢ä¸ºæºä»£ç æˆ–æœºå™¨ç çš„æœ€ç»ˆè®¾è®¡ã€‚å®ƒæ˜¯ä¸€ç§æè¿°æˆ–æ¨¡æ¿ï¼Œç”¨äºåœ¨è®¸å¤šä¸åŒæƒ…å†µä¸‹è§£å†³é—®é¢˜ã€‚</p>
</blockquote>
<h2 id="å°å¿ƒ"><a href="#å°å¿ƒ" class="headerlink" title="å°å¿ƒ"></a>å°å¿ƒ</h2><p>å¼€å‘äººå‘˜ï¼ˆå¤§å¤šæ˜¯åˆå­¦è€…ï¼‰çŠ¯äº†è¿‡åˆ†æ€è€ƒå’Œå¼ºåŠ è®¾è®¡æ¨¡å¼çš„é”™è¯¯ï¼Œè¿™å¯èƒ½ä¼šå¯¼è‡´ç¾éš¾ã€‚ç»éªŒæ³•åˆ™æ˜¯ä½¿ä»£ç åº“å°½å¯èƒ½ç®€å•ï¼Œå½“ä½ å¼€å‘ä¸­èƒ½åœ¨ä»£ç åº“ä¸­çœ‹åˆ°é‡å¤æ¨¡å¼æ—¶ï¼Œå†æ‰§è¡Œç›¸å…³è®¾è®¡æ¨¡å¼ã€‚</p>
<ul>
<li>è®¾è®¡æ¨¡å¼ä¸æ˜¯é“¶å¼¹ï¼ˆè¯‘æ³¨ï¼šé“¶å¼¹æŒ‡çš„æ˜¯ä¸‡èƒ½å·¥å…·ï¼‰ã€‚</li>
<li>ä¸è¦å¼ºè¡Œä½¿ç”¨ï¼Œä¸ç„¶æœ‰å¥½æœå­åƒã€‚</li>
<li>è¯·è®°ä½ï¼Œè®¾è®¡æ¨¡å¼æ˜¯<em>è§£å†³</em>é—®é¢˜çš„æ–¹æ³•ï¼Œè€Œä¸æ˜¯<em>å‘ç°</em>é—®é¢˜çš„æ–¹æ¡ˆï¼Œä¸è¦æƒ³å¤ªå¤šã€‚</li>
<li>ç”¨å¾—å¯¹æ—¶è¢«ç§°ä¸ºæ•‘æ˜Ÿï¼Œä¸ç„¶å°±æ˜¯ä»£ç æ··ä¹±ã€‚</li>
</ul>
<blockquote>
<p>è™½ç„¶ä»£ç ç¤ºä¾‹ç”¨ PHP-7 ç¼–å†™ï¼Œä½†ä¸æ¯«ä¸å½±å“ä½ ç†è§£æ¦‚å¿µã€‚</p>
</blockquote>
<h2 id="è®¾è®¡æ¨¡å¼çš„ç±»å‹"><a href="#è®¾è®¡æ¨¡å¼çš„ç±»å‹" class="headerlink" title="è®¾è®¡æ¨¡å¼çš„ç±»å‹"></a>è®¾è®¡æ¨¡å¼çš„ç±»å‹</h2><p>æœ¬æŒ‡å—å‚è€ƒ Gang of Four (Gof) çš„<a href="https://en.wikipedia.org/wiki/Design_Patterns" target="_blank" rel="noopener">ã€Šè®¾è®¡æ¨¡å¼ã€‹</a>ä¸€ä¹¦ã€‚ä¹¦ä¸­å°†è®¾è®¡æ¨¡å¼åˆ†æˆ 3 ç±»ï¼š</p>
<ul>
<li><a href="#åˆ›å»ºå‹æ¨¡å¼">Creational åˆ›å»ºå‹æ¨¡å¼</a></li>
<li><a href="#ç»“æ„å‹æ¨¡å¼">Structural ç»“æ„å‹æ¨¡å¼</a></li>
<li><a href="#è¡Œä¸ºå‹æ¨¡å¼">Behavioral è¡Œä¸ºå‹æ¨¡å¼</a></li>
</ul>
<h2 id="åˆ›å»ºå‹æ¨¡å¼"><a href="#åˆ›å»ºå‹æ¨¡å¼" class="headerlink" title="åˆ›å»ºå‹æ¨¡å¼"></a>åˆ›å»ºå‹æ¨¡å¼</h2><p>ç®€è€Œè¨€ä¹‹</p>
<blockquote>
<p>åˆ›å»ºå‹æ¨¡å¼å…³æ³¨å¦‚ä½•å®ä¾‹åŒ–ä¸€ä¸ªå¯¹è±¡æˆ–ä¸€ç»„å¯¹è±¡ã€‚</p>
</blockquote>
<p>ç»´åŸºè¯´</p>
<blockquote>
<p>è½¯ä»¶å·¥ç¨‹é¢†åŸŸï¼Œåˆ›å»ºå‹æ¨¡å¼æ˜¯å¤„ç†å¯¹è±¡åˆ›å»ºæœºåˆ¶çš„è®¾è®¡æ¨¡å¼ï¼Œå°è¯•ä»¥é€‚åˆçš„æ–¹å¼åˆ›å»ºå¯¹è±¡ã€‚å¯¹è±¡åˆ›å»ºçš„åŸºæœ¬å½¢å¼å¯èƒ½ä¼šå¯¼è‡´è®¾è®¡é—®é¢˜æˆ–è€…å¢åŠ è®¾è®¡çš„å¤æ‚æ€§ã€‚åˆ›å»ºå‹æ¨¡å¼é€šè¿‡æŸç§æ–¹æ³•æ§åˆ¶å¯¹è±¡çš„åˆ›å»ºæ¥è§£å†³æ­¤é—®é¢˜ã€‚</p>
</blockquote>
<p>è¿™é‡Œåˆ—å‡º 6 ç§åˆ›å»ºå‹æ¨¡å¼ï¼š</p>
<ul>
<li><a href="#ğŸ -ç®€å•å·¥å‚">Simple Factory ç®€å•å·¥å‚</a> </li>
<li><a href="#ğŸ­-å·¥å‚æ–¹æ³•">Factory Method å·¥å‚æ–¹æ³•</a> </li>
<li><a href="#ğŸ”¨-æŠ½è±¡å·¥å‚">Abstract Factory æŠ½è±¡å·¥å‚</a> </li>
<li><a href="#ğŸ‘·-ç”Ÿæˆå™¨">Builder ç”Ÿæˆå™¨</a> </li>
<li><a href="#ğŸ‘-åŸå‹">Prototype åŸå‹</a> </li>
<li><a href="#ğŸ’-å•ä¾‹">Singleton å•ä¾‹</a> </li>
</ul>
<h3 id="ğŸ -ç®€å•å·¥å‚"><a href="#ğŸ -ç®€å•å·¥å‚" class="headerlink" title="ğŸ  ç®€å•å·¥å‚"></a>ğŸ  ç®€å•å·¥å‚</h3><p>ç°å®ä¾‹å­</p>
<blockquote>
<p>è€ƒè™‘ä¸€ä¸‹ï¼Œä½ åœ¨ç›–æˆ¿å­ï¼Œéœ€è¦é—¨ã€‚ä½ å¯ä»¥ç©¿ä¸Šæœ¨åŒ è¡£æœï¼Œå¸¦ä¸Šæœ¨å¤´ã€èƒ¶æ°´ã€é’‰å­å’Œæ‰€æœ‰å¿…è¦çš„å·¥å…·ï¼Œç„¶åå¼€å§‹åœ¨æˆ¿å­é‡Œé€ é—¨ã€‚æˆ–è€…ä½ åªè¦æ‰“ä¸ªç”µè¯ç»™å·¥å‚ï¼Œè®©ä»–ä»¬æŠŠé€ å¥½çš„é—¨ç»™ä½ ï¼Œè¿™æ ·ä½ å°±ä¸éœ€è¦äº†è§£ä»»ä½•é€ é—¨çš„é¢å¤–çŸ¥è¯†äº†ã€‚</p>
</blockquote>
<p>ç®€è€Œè¨€ä¹‹</p>
<blockquote>
<p>ç®€å•å·¥å‚åªéœ€è¦ä¸ºä½¿ç”¨è€…ç”Ÿæˆä¸€ä¸ªå®ä¾‹ï¼Œè€Œä¸éœ€è¦ä¸ºä½¿ç”¨è€…å…¬å¼€ä»»ä½•å®ä¾‹åŒ–çš„é€»è¾‘ã€‚</p>
</blockquote>
<p>ç»´åŸºè¯´</p>
<blockquote>
<p>é¢å‘å¯¹è±¡ç¼–ç¨‹ï¼ˆOOPï¼‰ä¸­ï¼Œå·¥å‚æ˜¯ç”¨äºåˆ›å»ºå…¶ä»–å¯¹è±¡çš„å¯¹è±¡ â€”â€” æ­£å¼è¯´æ³•æ˜¯ï¼Œå·¥å‚æ˜¯ä¸€ç§å‡½æ•°æˆ–æ–¹æ³•ï¼Œå®ƒä»æŸä¸ªæ–¹æ³•ï¼ˆå‡å®šä¸º â€œnewâ€ï¼‰è°ƒç”¨å¹¶è¿”å›ä¸åŒåŸå‹æˆ–ç±»çš„å¯¹è±¡ã€‚</p>
</blockquote>
<p><strong>ç¨‹åºç¤ºä¾‹</strong></p>
<p>é¦–å…ˆæ˜¯é—¨çš„æ¥å£å’Œå…¶å®ç°ï¼š</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">interface</span> <span class="title">Door</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getWidth</span><span class="params">()</span>: <span class="title">float</span></span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getHeight</span><span class="params">()</span>: <span class="title">float</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">WoodenDoor</span> <span class="keyword">implements</span> <span class="title">Door</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">protected</span> $width;</span><br><span class="line">    <span class="keyword">protected</span> $height;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">(float $width, float $height)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;width = $width;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;height = $height;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getWidth</span><span class="params">()</span>: <span class="title">float</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;width;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getHeight</span><span class="params">()</span>: <span class="title">float</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;height;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç„¶åæˆ‘ä»¬æœ‰ä¸ªé—¨å·¥å‚æ¥åˆ¶é€ é—¨å¹¶è¿”å›å®ƒï¼š</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">DoorFactory</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="function"><span class="keyword">function</span> <span class="title">makeDoor</span><span class="params">($width, $height)</span>: <span class="title">Door</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> WoodenDoor($width, $height);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç„¶åå°±å¯ä»¥è¿™æ ·ç”¨ï¼š</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">// ç»™æˆ‘é€ ä¸€æ‰‡ 100*200 å°ºå¯¸çš„é—¨</span></span><br><span class="line">$door = DoorFactory::makeDoor(<span class="number">100</span>, <span class="number">200</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="string">'Width: '</span> . $door-&gt;getWidth();</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'Height: '</span> . $door-&gt;getHeight();</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç»™æˆ‘é€ ä¸€æ‰‡ 50*100 å°ºå¯¸çš„é—¨</span></span><br><span class="line">$door2 = DoorFactory::makeDoor(<span class="number">50</span>, <span class="number">100</span>);</span><br></pre></td></tr></table></figure>
<p><strong>å•¥æ—¶å€™ç”¨å‘¢ï¼Ÿ</strong></p>
<p>åˆ›å»ºå¯¹è±¡æ—¶ï¼Œä¸ä»…è¦å¤åˆ¶ï¼Œè¿˜è¦æ‰§è¡Œä¸€äº›é€»è¾‘æ“ä½œï¼Œè¿™äº›ä»£ç æ”¾åˆ°ä¸“é—¨çš„â€œå·¥å‚â€é‡Œç›¸æ¯”å››å¤„å¤åˆ¶ç²˜è´´ç›¸åŒä»£ç æ˜¯æ›´æœ‰æ„ä¹‰çš„ã€‚</p>
<h3 id="ğŸ­-å·¥å‚æ–¹æ³•"><a href="#ğŸ­-å·¥å‚æ–¹æ³•" class="headerlink" title="ğŸ­ å·¥å‚æ–¹æ³•"></a>ğŸ­ å·¥å‚æ–¹æ³•</h3><p>ç°å®ä¾‹å­</p>
<blockquote>
<p>æ€è€ƒä¸€ä¸ªæ‹›è˜ç»ç†çš„ä¾‹å­ï¼Œä¸€ä¸ªäººä¸å¯èƒ½å¯¹æ¯ä¸ªèŒä½è¿›è¡Œé¢è¯•ã€‚æ ¹æ®èŒä½ç©ºç¼ºï¼Œå¥¹å¿…é¡»å†³å®šé¢è¯•æ­¥éª¤ç„¶åå°†å…¶å§”æ‰˜ç»™å…¶ä»–äººã€‚</p>
</blockquote>
<p>ç®€è€Œè¨€ä¹‹</p>
<blockquote>
<p>å®ƒæä¾›äº†ä¸€ç§å°†å®ä¾‹åŒ–é€»è¾‘å§”æ‰˜ç»™å­ç±»çš„æ–¹æ³•ã€‚</p>
</blockquote>
<p>ç»´åŸºè¯´</p>
<blockquote>
<p>åŸºäºç±»çš„ç¼–ç¨‹ä¸­ï¼Œå·¥å‚æ–¹æ³•æ¨¡å¼æ˜¯ä¸€ç§åˆ›å»ºå‹æ¨¡å¼ï¼Œè¯¥æ¨¡å¼ä½¿ç”¨å·¥å‚æ–¹æ³•æ¥å¤„ç†åˆ›å»ºå¯¹è±¡çš„é—®é¢˜ï¼Œè€Œä¸å¿…æŒ‡å®šå°†è¦åˆ›å»ºå¯¹è±¡çš„ç¡®åˆ‡ç±»ã€‚è¿™æ˜¯é€šè¿‡è°ƒç”¨å·¥å‚æ–¹æ³•åˆ›å»ºå¯¹è±¡æ¥å®Œæˆçš„ã€‚è¯¥æ–¹æ³•åœ¨æ¥å£ä¸­æŒ‡å®šå¹¶ç”±å­ç±»å®ç°ï¼Œæˆ–è€…åœ¨åŸºç±»ä¸­å®ç°ï¼Œå¹¶ä¸”å¯ä»¥é€‰æ‹©ç”±æ´¾ç”Ÿç±»è¦†ç›–ï¼Œè€Œä¸æ˜¯é€šè¿‡è°ƒç”¨æ„é€ å‡½æ•°æ¥è¦†ç›–ã€‚</p>
</blockquote>
<p><strong>ç¨‹åºç¤ºä¾‹</strong></p>
<p>ä»¥æˆ‘ä»¬ä¸Šæ–‡çš„æ‹›è˜ç»ç†ä¸ºä¾‹ã€‚é¦–å…ˆï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ªé¢è¯•å®˜æ¥å£åŠå…¶å®ç°ï¼š</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">interface</span> <span class="title">Interviewer</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">askQuestions</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Developer</span> <span class="keyword">implements</span> <span class="title">Interviewer</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">askQuestions</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">'Asking about design patterns!'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CommunityExecutive</span> <span class="keyword">implements</span> <span class="title">Interviewer</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">askQuestions</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">'Asking about community building'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç°åœ¨å®šä¹‰æ‹›è˜ç»ç†ï¼ˆHiringManagerï¼‰ï¼š</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">HiringManager</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å·¥å‚æ–¹æ³•</span></span><br><span class="line">    <span class="keyword">abstract</span> <span class="keyword">protected</span> <span class="function"><span class="keyword">function</span> <span class="title">makeInterviewer</span><span class="params">()</span>: <span class="title">Interviewer</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">takeInterview</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $interviewer = <span class="keyword">$this</span>-&gt;makeInterviewer();</span><br><span class="line">        $interviewer-&gt;askQuestions();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç°åœ¨ï¼Œä»»ä½•å­ç±»éƒ½å¯æ‰©å±•å®ƒå¹¶æä¾›æ‰€éœ€è¦çš„é¢è¯•å®˜ï¼š</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">DevelopmentManager</span> <span class="keyword">extends</span> <span class="title">HiringManager</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">protected</span> <span class="function"><span class="keyword">function</span> <span class="title">makeInterviewer</span><span class="params">()</span>: <span class="title">Interviewer</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> Developer();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MarketingManager</span> <span class="keyword">extends</span> <span class="title">HiringManager</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">protected</span> <span class="function"><span class="keyword">function</span> <span class="title">makeInterviewer</span><span class="params">()</span>: <span class="title">Interviewer</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> CommunityExecutive();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿™æ ·ç”¨ï¼š</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">$devManager = <span class="keyword">new</span> DevelopmentManager();</span><br><span class="line">$devManager-&gt;takeInterview(); <span class="comment">// Output: Asking about design patterns</span></span><br><span class="line"></span><br><span class="line">$marketingManager = <span class="keyword">new</span> MarketingManager();</span><br><span class="line">$marketingManager-&gt;takeInterview(); <span class="comment">// Output: Asking about community building.</span></span><br></pre></td></tr></table></figure>
<p><strong>å•¥æ—¶å€™ç”¨å‘¢ï¼Ÿ</strong></p>
<p>å½“ç±»ä¸­æœ‰ä¸€äº›é€šç”¨å¤„ç†ä½†æ‰€éœ€çš„å­ç±»åœ¨è¿è¡Œæ—¶åŠ¨æ€ç¡®å®šæ—¶å¾ˆæœ‰ç”¨ã€‚æˆ–è€…æ¢å¥è¯è¯´ï¼Œç”¨æˆ·ä¸çŸ¥é“å®ƒå¯èƒ½éœ€è¦ä»€ä¹ˆç¡®åˆ‡çš„å­ç±»ã€‚</p>
<h3 id="ğŸ”¨-æŠ½è±¡å·¥å‚"><a href="#ğŸ”¨-æŠ½è±¡å·¥å‚" class="headerlink" title="ğŸ”¨ æŠ½è±¡å·¥å‚"></a>ğŸ”¨ æŠ½è±¡å·¥å‚</h3><p>ç°å®ä¾‹å­</p>
<blockquote>
<p>å¯¹ç®€å•å·¥å‚çš„ä¾‹å­æ‰©å±•ä¸€ä¸‹ã€‚æ ¹æ®ä½ çš„éœ€æ±‚ï¼Œ ä½ å¯èƒ½ä»ä¸€å®¶æœ¨é—¨åº—ä¹°åˆ°ä¸€æ‰‡é—¨ï¼Œæˆ–è€…åœ¨é“é—¨åº—ä¹°åˆ°ä¸€æ‰‡é“é—¨ï¼Œæˆ–è€…ç›¸å…³çš„åº—ä¹°åˆ° PVC é—¨ã€‚å¦å¤–ï¼Œä½ å¯èƒ½éœ€è¦å…·æœ‰ä¸åŒä¸“ä¸šæŠ€èƒ½çš„äººæ¥å®‰è£…ä¸åŒçš„é—¨ï¼Œä¾‹å¦‚ï¼Œæœ¨é—¨çš„æœ¨åŒ ï¼Œé“é—¨çš„ç„Šæ¥å·¥ç­‰ã€‚å¦‚ä½ æ‰€è§ï¼Œä»–ä»¬ä¸é—¨ä¹‹é—´å­˜åœ¨ä¾èµ–æ€§ï¼Œæœ¨é—¨éœ€è¦æœ¨åŒ ï¼Œé“é—¨éœ€è¦ç„Šæ¥å·¥ç­‰ã€‚</p>
</blockquote>
<p>ç®€è€Œè¨€ä¹‹</p>
<blockquote>
<p>å·¥å‚çš„å·¥å‚ï¼›ä¸€ä¸ªå°†ç›¸å…³æˆ–ä»å±çš„å·¥å‚åˆ†ç»„åœ¨ä¸€èµ·ï¼Œä½†ä¸æŒ‡å®šå…¶å…·ä½“ç±»åˆ«çš„å·¥å‚ã€‚</p>
</blockquote>
<p>ç»´åŸºè¯´</p>
<blockquote>
<p>æŠ½è±¡å·¥å‚æ¨¡å¼æä¾›äº†ä¸€ç§æ–¹æ³•æ¥å°è£…ä¸€ç»„å…·æœ‰å…±åŒä¸»é¢˜çš„å•ä¸ªå·¥å‚ï¼Œè€Œæ— éœ€æŒ‡å®šå…¶å…·ä½“ç±»ã€‚</p>
</blockquote>
<p><strong>ç¨‹åºç¤ºä¾‹</strong></p>
<p>è½¬æ¢ä¸Šé¢é—¨çš„ä¾‹å­ã€‚é¦–å…ˆæ˜¯é—¨çš„æ¥å£åŠå…¶å®ç°ï¼š</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">interface</span> <span class="title">Door</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getDescription</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">WoodenDoor</span> <span class="keyword">implements</span> <span class="title">Door</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getDescription</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">'I am a wooden door'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">IronDoor</span> <span class="keyword">implements</span> <span class="title">Door</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getDescription</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">'I am an iron door'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç„¶åæˆ‘ä»¬ä¸ºæ¯ç§é—¨é…å¤‡è£…é…ä¸“å®¶ï¼š</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">interface</span> <span class="title">DoorFittingExpert</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getDescription</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Welder</span> <span class="keyword">implements</span> <span class="title">DoorFittingExpert</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getDescription</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">'I can only fit iron doors'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Carpenter</span> <span class="keyword">implements</span> <span class="title">DoorFittingExpert</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getDescription</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">'I can only fit wooden doors'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç°åœ¨æˆ‘ä»¬æœ‰äº†æŠ½è±¡å·¥å‚ï¼Œå®ƒå°†ä½¿æˆ‘ä»¬èƒ½å¤Ÿåˆ¶é€ ä¸€ç³»åˆ—å¯¹è±¡ï¼Œå³æœ¨é—¨å·¥å‚å°†åˆ›å»ºæœ¨é—¨å’Œæœ¨é—¨è£…é…ä¸“å®¶ï¼Œé“é—¨å·¥å‚å°†åˆ›å»ºé“é—¨å’Œé“é—¨è£…é…ä¸“å®¶ã€‚</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">interface</span> <span class="title">DoorFactory</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">makeDoor</span><span class="params">()</span>: <span class="title">Door</span></span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">makeFittingExpert</span><span class="params">()</span>: <span class="title">DoorFittingExpert</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æœ¨é—¨å·¥å‚è¿”å›æœ¨åŒ å’Œæœ¨é—¨</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">WoodenDoorFactory</span> <span class="keyword">implements</span> <span class="title">DoorFactory</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">makeDoor</span><span class="params">()</span>: <span class="title">Door</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> WoodenDoor();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">makeFittingExpert</span><span class="params">()</span>: <span class="title">DoorFittingExpert</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> Carpenter();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// é“é—¨å·¥å‚è¿”å›é“é—¨å’Œç›¸å…³çš„è£…é…ä¸“å®¶</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">IronDoorFactory</span> <span class="keyword">implements</span> <span class="title">DoorFactory</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">makeDoor</span><span class="params">()</span>: <span class="title">Door</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> IronDoor();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">makeFittingExpert</span><span class="params">()</span>: <span class="title">DoorFittingExpert</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> Welder();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æ¥ç€è¿™ä¹ˆç”¨ï¼š</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">$woodenFactory = <span class="keyword">new</span> WoodenDoorFactory();</span><br><span class="line"></span><br><span class="line">$door = $woodenFactory-&gt;makeDoor();</span><br><span class="line">$expert = $woodenFactory-&gt;makeFittingExpert();</span><br><span class="line"></span><br><span class="line">$door-&gt;getDescription();  <span class="comment">// Output: I am a wooden door</span></span><br><span class="line">$expert-&gt;getDescription(); <span class="comment">// Output: I can only fit wooden doors</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Same for Iron Factory</span></span><br><span class="line">$ironFactory = <span class="keyword">new</span> IronDoorFactory();</span><br><span class="line"></span><br><span class="line">$door = $ironFactory-&gt;makeDoor();</span><br><span class="line">$expert = $ironFactory-&gt;makeFittingExpert();</span><br><span class="line"></span><br><span class="line">$door-&gt;getDescription();  <span class="comment">// Output: I am an iron door</span></span><br><span class="line">$expert-&gt;getDescription(); <span class="comment">// Output: I can only fit iron doors</span></span><br></pre></td></tr></table></figure>
<p>å¦‚ä½ æ‰€è§ï¼Œæœ¨é—¨å·¥å‚å·²ç»å°è£…äº†æœ¨åŒ ï¼ˆcarpenterï¼‰å’Œæœ¨é—¨ï¼ˆwooden doorï¼‰ï¼Œé“é—¨å·¥å‚å·²ç»å°è£…äº†é“é—¨ï¼ˆiron doorï¼‰å’Œç„Šæ¥å·¥ï¼ˆwelderï¼‰ã€‚å› æ­¤ï¼Œå®ƒç¡®ä¿æˆ‘ä»¬å¯¹äºæ¯ä¸ªå·²åˆ›å»ºçš„é—¨ä¸ä¼šåŒ¹é…åˆ°é”™è¯¯çš„è£…é…ä¸“å®¶ã€‚</p>
<p><strong>å•¥æ—¶å€™ç”¨å‘¢?</strong></p>
<p>å½“å­˜åœ¨ç›¸äº’å…³è”çš„ä¾èµ–å…³ç³»å¹¶ä¸”æ¶‰åŠåˆ°éç®€å•çš„åˆ›å»ºé€»è¾‘æ—¶ã€‚</p>
<h3 id="ğŸ‘·-ç”Ÿæˆå™¨"><a href="#ğŸ‘·-ç”Ÿæˆå™¨" class="headerlink" title="ğŸ‘· ç”Ÿæˆå™¨"></a>ğŸ‘· ç”Ÿæˆå™¨</h3><p>ç°å®ä¾‹å­</p>
<blockquote>
<p>åŠ å…¥ä½ åœ¨ Hardee åº—é‡Œä¸‹äº†ä¸€ç¬”è®¢å•ï¼Œä»–ä»¬ä¼šæ¯«æ— ç–‘é—®çš„å°†è´§å“äº¤ç»™ä½ ï¼›è¿™æ˜¯ç®€å•å·¥å‚çš„ä¾‹å­ã€‚ä½†æ˜¯æŸäº›æƒ…å†µä¸‹ï¼Œåˆ›å»ºé€»è¾‘å¯èƒ½è®¾è®¡æ›´å¤šçš„æ­¥éª¤ã€‚ä¾‹å¦‚ï¼Œä½ æƒ³è¦å®šåˆ¶èµ›ç™¾å‘³çš„è®¢å•ï¼Œåœ¨æ±‰å ¡çš„åˆ¶ä½œæ–¹å¼ä¸Šæœ‰å¤šç§é€‰æ‹©ï¼Œä¾‹å¦‚ï¼šä½ æƒ³è¦å“ªç§é¢åŒ…ï¼Ÿæƒ³è¦é‚£ç§è°ƒå‘³æ–™ï¼Ÿé‚£ç§å¥¶é…ªï¼Ÿç­‰ç­‰ã€‚è¿™ç§æƒ…å†µä¸‹ï¼Œç”Ÿæˆå™¨æ¨¡å¼åº”è¿è€Œç”Ÿã€‚</p>
</blockquote>
<p>ç®€è€Œè¨€ä¹‹</p>
<blockquote>
<p>å…è®¸ä½ åˆ›å»ºå¯¹è±¡çš„ä¸åŒæ ·å¼ï¼ŒåŒæ—¶é¿å…æ„é€ å‡½æ•°æ±¡æŸ“ã€‚å½“ä¸€ä¸ªå¯¹è±¡æœ‰å¤šç§é£æ ¼æ—¶å¾ˆæœ‰ç”¨ï¼Œäº¦æˆ–è€…åˆ›å»ºå¯¹è±¡æ¶‰åŠå¾ˆå¤šæ­¥éª¤æ—¶ã€‚</p>
</blockquote>
<p>ç»´åŸºè¯´</p>
<blockquote>
<p>ç”Ÿæˆå™¨æ¨¡å¼æ˜¯ä¸€ç§å¯¹è±¡åˆ›å»ºè½¯ä»¶è®¾è®¡æ¨¡å¼ï¼Œæ—¨åœ¨ä¸ºä¼¸ç¼©æ„é€ å™¨åæ¨¡å¼æ‰¾åˆ°è§£å†³æ–¹æ¡ˆã€‚</p>
</blockquote>
<p>è§£é‡Šä¸€ä¸‹ä»€ä¹ˆæ˜¯ä¼¸ç¼©æ„é€ å™¨åæ¨¡å¼ã€‚æœ‰æ—¶æˆ‘ä»¬è§è¿‡ä»¥ä¸‹æ„é€ å‡½æ•°ï¼š</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">($size, $cheese = true, $pepperoni = true, $tomato = false, $lettuce = true)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å¦‚ä½ æ‰€è§ï¼Œæ„é€ å‡½æ•°å‚æ•°çš„æ•°é‡å¾ˆå¿«ä¼šå¤±æ§ï¼Œè¿‡å¤šçš„å‚æ•°çœ‹ç€ä¼šå¾ˆå¤´å¤§ã€‚å¦å¤–ï¼Œå¦‚æœä½ æƒ³æ·»åŠ æ›´å¤šé€‰é¡¹ï¼Œåˆ™æ­¤å‚æ•°åˆ—è¡¨è¿˜ç»§ç»­å¢é•¿ã€‚è¿™å°±æ˜¯ä¼¸ç¼©æ„é€ å‡½æ•°åæ¨¡å¼ã€‚</p>
<p><strong>ç¨‹åºç¤ºä¾‹</strong></p>
<p>æ˜æ™ºçš„åšæ³•æ˜¯ä½¿ç”¨æ„é€ å™¨æ¨¡å¼ã€‚é¦–å…ˆï¼Œæˆ‘ä»¬è¦åšæ±‰å ¡ï¼š</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Burger</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">protected</span> $size;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">protected</span> $cheese = <span class="keyword">false</span>;</span><br><span class="line">    <span class="keyword">protected</span> $pepperoni = <span class="keyword">false</span>;</span><br><span class="line">    <span class="keyword">protected</span> $lettuce = <span class="keyword">false</span>;</span><br><span class="line">    <span class="keyword">protected</span> $tomato = <span class="keyword">false</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">(BurgerBuilder $builder)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;size = $builder-&gt;size;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;cheese = $builder-&gt;cheese;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;pepperoni = $builder-&gt;pepperoni;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;lettuce = $builder-&gt;lettuce;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;tomato = $builder-&gt;tomato;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æ¥ç€æ˜¯æˆ‘ä»¬çš„ç”Ÿæˆå™¨ï¼š</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BurgerBuilder</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $size;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> $cheese = <span class="keyword">false</span>;</span><br><span class="line">    <span class="keyword">public</span> $pepperoni = <span class="keyword">false</span>;</span><br><span class="line">    <span class="keyword">public</span> $lettuce = <span class="keyword">false</span>;</span><br><span class="line">    <span class="keyword">public</span> $tomato = <span class="keyword">false</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">(int $size)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;size = $size;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">addPepperoni</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;pepperoni = <span class="keyword">true</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">addLettuce</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;lettuce = <span class="keyword">true</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">addCheese</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;cheese = <span class="keyword">true</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">addTomato</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;tomato = <span class="keyword">true</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">build</span><span class="params">()</span>: <span class="title">Burger</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> Burger(<span class="keyword">$this</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿™ä¹ˆç”¨ï¼š</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">$burger = (<span class="keyword">new</span> BurgerBuilder(<span class="number">14</span>))</span><br><span class="line">                    -&gt;addPepperoni()</span><br><span class="line">                    -&gt;addLettuce()</span><br><span class="line">                    -&gt;addTomato()</span><br><span class="line">                    -&gt;build();</span><br></pre></td></tr></table></figure>
<p><strong>å•¥æ—¶å€™ç”¨å‘¢ï¼Ÿ</strong></p>
<p>å½“å¯¹è±¡çš„é…ç½®é¡¹è¿‡å¤šï¼Œä¸ºäº†é¿å…ä¼¸ç¼©æ„é€ å‡½æ•°æ—¶ï¼Œè¿™ä¸å·¥å‚æ¨¡å¼çš„ä¸»è¦åŒºåˆ«åœ¨äºï¼šå½“åˆ›å»ºæ˜¯ä¸€æ­¥è¿‡ç¨‹æ—¶ï¼Œä½¿ç”¨å·¥å‚æ¨¡å¼ï¼Œè€Œåˆ›å»ºæ˜¯å¤šæ­¥è¿‡ç¨‹æ˜¯ï¼Œå°†ä½¿ç”¨ç”Ÿæˆå™¨æ¨¡å¼ã€‚</p>
<h3 id="ğŸ‘-åŸå‹"><a href="#ğŸ‘-åŸå‹" class="headerlink" title="ğŸ‘ åŸå‹"></a>ğŸ‘ åŸå‹</h3><p>ç°å®ä¾‹å­</p>
<blockquote>
<p>è®°å¾—å¤šåˆ©å—ï¼Ÿé‚£åªå…‹éš†ç¾Šï¼ä¸è°ˆç»†èŠ‚ï¼Œå…³é”®æ˜¯å…‹éš†ã€‚</p>
</blockquote>
<p>ç®€è€Œè¨€ä¹‹</p>
<blockquote>
<p>é€šè¿‡å…‹éš†åŸºäºç°æœ‰å¯¹è±¡åˆ›å»ºå¯¹è±¡ã€‚</p>
</blockquote>
<p>ç»´åŸºè¯´</p>
<blockquote>
<p>åŸå‹æ¨¡å¼æ˜¯è½¯ä»¶å¼€å‘ä¸­çš„ä¸€ç§åˆ›å»ºå‹æ¨¡å¼ã€‚å½“è¦åˆ›å»ºçš„å¯¹è±¡ç”±åŸå‹ç¤ºä¾‹ç¡®å®šæ—¶ä½¿ç”¨ï¼Œè¯¥å®ä¾‹è¢«å…‹éš†ä»¥ç”Ÿæˆæ–°å¯¹è±¡ã€‚</p>
</blockquote>
<p>ç®€è€Œè¨€ä¹‹ï¼Œå®ƒä½¿ä½ å¯ä»¥åˆ›å»ºç°æœ‰å¯¹è±¡çš„å‰¯æœ¬å¹¶æ ¹æ®éœ€è¦å¯¹å…¶è¿›è¡Œä¿®æ”¹ï¼Œè€Œä¸å¿…éº»çƒ¦ä»å¤´å¼€å§‹åˆ›å»ºå¯¹è±¡å¹¶è®¾ç½®ã€‚</p>
<p><strong>ç¨‹åºå®ä¾‹</strong></p>
<p>åœ¨ PHP ä¸­ï¼Œç”¨ <code>clone</code> å¾ˆå®¹æ˜“åšåˆ°ï¼š</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Sheep</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">protected</span> $name;</span><br><span class="line">    <span class="keyword">protected</span> $category;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">(string $name, string $category = <span class="string">'Mountain Sheep'</span>)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;name = $name;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;category = $category;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">setName</span><span class="params">(string $name)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;name = $name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getName</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">setCategory</span><span class="params">(string $category)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;category = $category;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getCategory</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;category;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å…‹éš†æ–¹å¼å¦‚ä¸‹ï¼š</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">$original = <span class="keyword">new</span> Sheep(<span class="string">'Jolly'</span>);</span><br><span class="line"><span class="keyword">echo</span> $original-&gt;getName(); <span class="comment">// Jolly</span></span><br><span class="line"><span class="keyword">echo</span> $original-&gt;getCategory(); <span class="comment">// Mountain Sheep</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Clone and modify what is required</span></span><br><span class="line">$cloned = <span class="keyword">clone</span> $original;</span><br><span class="line">$cloned-&gt;setName(<span class="string">'Dolly'</span>);</span><br><span class="line"><span class="keyword">echo</span> $cloned-&gt;getName(); <span class="comment">// Dolly</span></span><br><span class="line"><span class="keyword">echo</span> $cloned-&gt;getCategory(); <span class="comment">// Mountain sheep</span></span><br></pre></td></tr></table></figure>
<p>ä½ è¿˜å¯ä»¥ä½¿ç”¨é­”æ³•æ–¹æ³• <code>__clone</code> æ–¹æ³•ä¿®æ”¹å…‹éš†è¡Œä¸ºã€‚</p>
<p><strong>å•¥æ—¶å€™ç”¨å‘¢ï¼Ÿ</strong></p>
<p>å½“éœ€è¦ä¸€ä¸ªä¸ç°æœ‰å¯¹è±¡ç›¸ä¼¼çš„å¯¹è±¡æ—¶ï¼Œæˆ–è€…ä¸å…‹éš†ç›¸æ¯”åˆ›å»ºæˆæœ¬å¾ˆé«˜ã€‚</p>
<h3 id="ğŸ’-å•ä¾‹"><a href="#ğŸ’-å•ä¾‹" class="headerlink" title="ğŸ’ å•ä¾‹"></a>ğŸ’ å•ä¾‹</h3><p>ç°å®ä¾‹å­</p>
<blockquote>
<p>ä¸€ä¸ªå›½å®¶ä¸€æ¬¡åªèƒ½æœ‰ä¸€ä½æ€»ç»Ÿã€‚æ¯æ¬¡æ¥å¬å€¼ç­ç”µè¯çš„éƒ½æ˜¯åŒä¸€ä½æ€»ç»Ÿã€‚æ€»ç»Ÿåœ¨è¿™é‡Œå°±æ˜¯å•ä¾‹ã€‚</p>
</blockquote>
<p>ç®€è€Œè¨€ä¹‹</p>
<blockquote>
<p>ç¡®ä¿ä»…åˆ›å»ºç‰¹å®šç±»çš„ä¸€ä¸ªå¯¹è±¡ã€‚</p>
</blockquote>
<p>ç»´åŸºè¯´</p>
<blockquote>
<p>åœ¨è½¯ä»¶å·¥ç¨‹ä¸­ï¼Œå•ä¾‹æ¨¡å¼æ—¶ä¸€ç§å°†ç±»çš„å®ä¾‹åŒ–é™åˆ¶ä¸ºä¸€ä¸ªå¯¹è±¡çš„è½¯ä»¶è®¾è®¡æ¨¡å¼ã€‚å½“ä»…éœ€è¦ä¸€ä¸ªå¯¹è±¡æ¥åè°ƒæ•´ä¸ªç³»ç»Ÿä¸­çš„åŠ¨ä½œæ—¶ï¼Œè¿™å¾ˆæœ‰ç”¨ã€‚</p>
</blockquote>
<p>å•ä¾‹æ¨¡å¼å®é™…ä¸Šè¢«è®¤ä¸ºæ˜¯åæ¨¡å¼ï¼Œåº”é¿å…è¿‡åº¦ä½¿ç”¨å®ƒã€‚å®ƒä¸ä¸€å®šæ˜¯åçš„ï¼Œå¹¶ä¸”å¯èƒ½æœ‰ä¸€äº›æœ‰æ•ˆçš„ä½¿ç”¨åœºæ™¯ä½†æ˜¯åº”è°¨æ…ä½¿ç”¨ï¼Œå› ä¸ºå®ƒä¼šåœ¨ä½ çš„åº”ç”¨ç¨‹åºä¸­å¼•å…¥å…¨å±€çŠ¶æ€ï¼Œå¹¶ä¸”åœ¨åŒä¸€ä¸ªä½ç½®è¿›è¡Œæ›´æ”¹å¯èƒ½ä¼šå½±å“å…¶ä»–åŒºåŸŸï¼Œè¿™è®©è°ƒè¯•å˜å¾—éå¸¸å›°éš¾ã€‚å…³äºå®ƒä»¬çš„å¦ä¸€ä¸ªä¸å¥½çš„åœ°æ–¹æ˜¯ï¼Œå®ƒä¼šä½¿ä½ çš„ä»£ç é«˜è€¦åˆï¼Œéš¾ä»¥æ¨¡æ‹Ÿå•ä¾‹ã€‚</p>
<p><strong>ç¨‹åºç¤ºä¾‹</strong></p>
<p>è¦åˆ›å»ºå•ä¾‹ï¼Œè¯·å°†æ„é€ å‡½æ•°è®¾ä¸ºç§æœ‰ï¼Œç¦ç”¨å…‹éš†ï¼Œç¦ç”¨æ‰©å±•ï¼Œå¹¶åˆ›å»ºä¸€ä¸ªé™æ€å˜é‡æ¥å®¹çº³å®ä¾‹ã€‚</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">President</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> $instance;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="comment">// Hide the constructor</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="function"><span class="keyword">function</span> <span class="title">getInstance</span><span class="params">()</span>: <span class="title">President</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (!<span class="keyword">self</span>::$instance) &#123;</span><br><span class="line">            <span class="keyword">self</span>::$instance = <span class="keyword">new</span> <span class="keyword">self</span>();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">self</span>::$instance;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">__clone</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="comment">// Disable cloning</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="comment">// Disable unserialize</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æ¥ç€æ˜¯ä½¿ç”¨ï¼š</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">$president1 = President::getInstance();</span><br><span class="line">$president2 = President::getInstance();</span><br><span class="line"></span><br><span class="line">var_dump($president1 === $president2); <span class="comment">// true</span></span><br></pre></td></tr></table></figure>
<h2 id="ç»“æ„å‹æ¨¡å¼"><a href="#ç»“æ„å‹æ¨¡å¼" class="headerlink" title="ç»“æ„å‹æ¨¡å¼"></a>ç»“æ„å‹æ¨¡å¼</h2><p>ç®€è€Œè¨€ä¹‹</p>
<blockquote>
<p>ç»“æ„æ¨¡å¼ä¸»è¦ä¸å¯¹è±¡ç»„æˆæœ‰å…³ï¼Œæ¢å¥è¯è¯´ï¼Œå®ä½“å¦‚ä½•äº’ç›¸åˆ©ç”¨ã€‚æˆ–è€…è¿˜æœ‰å¦ä¸€ç§è§£é‡Šï¼Œå®ƒä»¬æœ‰åŠ©äºå›ç­”â€œå¦‚ä½•æ„å»ºè½¯ä»¶ç»„ä»¶ï¼Ÿâ€ã€‚</p>
</blockquote>
<p>ç»´åŸºè¯´</p>
<blockquote>
<p>åœ¨è½¯ä»¶å·¥ç¨‹ä¸­ï¼Œç»“æ„å‹æ¨¡å¼æ˜¯é€šè¿‡è¯†åˆ«å®ä½“é—´çš„ç®€å•æ–¹æ³•æ¥ç®€åŒ–è®¾è®¡çš„è®¾è®¡æ¨¡å¼ã€‚</p>
</blockquote>
<p>è¿™æœ‰ 7 ç§ç»“æ„æ¨¡å¼ï¼š</p>
<ul>
<li><a href="#ğŸ”Œ-é€‚é…å™¨">Adapter é€‚é…å™¨</a></li>
<li><a href="#ğŸš¡-æ¡¥æ¥">Bridge æ¡¥æ¥</a></li>
<li><a href="#ğŸŒ¿-ç»„åˆ">Composite ç»„åˆ</a></li>
<li><a href="#â˜•-è£…é¥°å™¨">Decorator è£…é¥°å™¨</a></li>
<li><a href="#ğŸ“¦-å¤–è§‚æ¨¡å¼">Facade å¤–è§‚</a></li>
<li><a href="#ğŸƒ-äº«å…ƒ">Flyweight äº«å…ƒ</a></li>
<li><a href="#ğŸ±-ä»£ç†">Proxy ä»£ç†</a></li>
</ul>
<h3 id="ğŸ”Œ-é€‚é…å™¨"><a href="#ğŸ”Œ-é€‚é…å™¨" class="headerlink" title="ğŸ”Œ é€‚é…å™¨"></a>ğŸ”Œ é€‚é…å™¨</h3><p>ç°å®ä¾‹å­</p>
<blockquote>
<p>åœ¨ä½ çš„å­˜å‚¨å¡ä¸­æœ‰ä¸€äº›ç…§ç‰‡ï¼Œéœ€è¦å°†å®ƒä»¬ä¼ è¾“åˆ°è®¡ç®—æœºä¸Šã€‚ä¸ºäº†ä¼ è¾“å®ƒä»¬ï¼Œä½ éœ€è¦æŸç§å’Œè®¡ç®—æœºç«¯å£å…¼å®¹çš„é€‚é…å™¨ï¼Œä»¥ä¾¿å°†å­˜å‚¨å¡è¿æ¥åˆ°è®¡ç®—æœºã€‚è¿™ç§æƒ…å†µä¸‹ï¼Œè¯»å¡å™¨å°±æ˜¯é€‚é…å™¨ã€‚å¦ä¸€ä¸ªä¾‹å­æ˜¯è‘—åçš„ç”µæºé€‚é…å™¨ï¼Œä¸‰è„šæ’å¤´ä¸èƒ½è¿æ¥åˆ°ä¸¤è„šæ’åº§ï¼Œéœ€è¦ä½¿ç”¨ç”µæºé€‚é…å™¨ï¼Œä½¿å…¶ä¸ä¸¤è„šæ’åº§å…¼å®¹ã€‚è¿˜æœ‰ä¸ªä¾‹å­æ˜¯ç¿»è¯‘å‘˜å°†ä¸€ä¸ªäººè¯´çš„è¯ç¿»è¯‘ç»™å¦ä¸€ä¸ªäººã€‚</p>
</blockquote>
<p>ç®€è€Œè¨€ä¹‹</p>
<blockquote>
<p>é€‚é…å™¨æ¨¡å¼æ˜¯ä½ å¯ä»¥å°†å…¶ä»–ä¸å…¼å®¹çš„å¯¹è±¡åŒ…è£…åˆ°é€‚é…å™¨ä¸­ï¼Œä»¥ä½¿å…¶ä¸å¦ä¸€ä¸ªç±»å…¼å®¹ã€‚</p>
</blockquote>
<p>ç»´åŸºè¯´</p>
<blockquote>
<p>è½¯ä»¶å·¥ç¨‹é¢†åŸŸï¼Œé€‚é…å™¨æ¨¡å¼æ˜¯ä¸€ç§è½¯ä»¶è®¾è®¡æ¨¡å¼ï¼Œå®ƒå…è®¸å°†ç°æœ‰ç±»çš„æ¥å£ç”¨ä½œå¦ä¸€ä¸ªæ¥å£ã€‚å®ƒé€šå¸¸ç”¨äºå°†ç°æœ‰ç±»å’Œå…¶ä»–ç±»ä¸€èµ·ä½¿ç”¨è€Œæ— éœ€ä¿®æ”¹å…¶æºä»£ç ã€‚</p>
</blockquote>
<p><strong>ç¨‹åºç¤ºä¾‹</strong></p>
<p>æ€è€ƒä¸€ä¸ªçŒäººç‹©çŒç‹®å­çš„æ¸¸æˆã€‚é¦–å…ˆæˆ‘ä»¬æœ‰ä¸€ä¸ª <code>Lion</code> æ¥å£ï¼Œæ‰€æœ‰ç±»å‹çš„ç‹®å­éƒ½å¿…é¡»å®ç°ã€‚</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">interface</span> <span class="title">Lion</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">roar</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">AfricanLion</span> <span class="keyword">implements</span> <span class="title">Lion</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">roar</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">AsianLion</span> <span class="keyword">implements</span> <span class="title">Lion</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">roar</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>çŒäººä½¿ç”¨ <code>Lion</code> æ¥å£çš„ä»»ä½•å®ç°éƒ½å¯ä»¥è¿›è¡Œç‹©çŒã€‚</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Hunter</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">hunt</span><span class="params">(Lion $lion)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $lion-&gt;roar();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç°åœ¨å‡è®¾æˆ‘ä»¬å¿…é¡»åœ¨æ¸¸æˆä¸­æ·»åŠ  WildDog ï¼ˆé‡ç‹—ï¼‰ï¼Œä»¥ä¾¿çŒäººå¯¹å…¶ç‹©çŒã€‚ä½†æ˜¯æˆ‘ä»¬ä¸èƒ½ç›´æ¥è¿™æ ·åšï¼Œå› ä¸ºç‹—å…·æœ‰ä¸åŒçš„æ¥å£ã€‚ä¸ºäº†ä½¿å…¶ä¸æˆ‘ä»¬çš„çŒäººå…¼å®¹ï¼Œæˆ‘ä»¬å¿…é¡»åˆ›å»ºä¸€ä¸ªå…¼å®¹çš„é€‚é…å™¨ã€‚</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">// æŠŠå®ƒæ·»åŠ åˆ°æ¸¸æˆã€‚</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">WildDog</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">bark</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å…³äºé‡ç‹—çš„é€‚é…å™¨ï¼Œä½¿å…¶ä¸æˆ‘ä»¬çš„æ¸¸æˆå…¼å®¹ã€‚</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">WildDogAdapter</span> <span class="keyword">implements</span> <span class="title">Lion</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">protected</span> $dog;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">(WildDog $dog)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;dog = $dog;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">roar</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;dog-&gt;bark();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç°åœ¨å¯ä»¥ä½¿ç”¨ WildDogAdapter åœ¨æˆ‘ä»¬çš„æ¸¸æˆä¸­ä½¿ç”¨ WildDog äº†ã€‚</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">$wildDog = <span class="keyword">new</span> WildDog();</span><br><span class="line">$wildDogAdapter = <span class="keyword">new</span> WildDogAdapter($wildDog);</span><br><span class="line"></span><br><span class="line">$hunter = <span class="keyword">new</span> Hunter();</span><br><span class="line">$hunter-&gt;hunt($wildDogAdapter);</span><br></pre></td></tr></table></figure>
<h3 id="ğŸš¡-æ¡¥æ¥"><a href="#ğŸš¡-æ¡¥æ¥" class="headerlink" title="ğŸš¡ æ¡¥æ¥"></a>ğŸš¡ æ¡¥æ¥</h3><p>ç°å®ä¾‹å­</p>
<blockquote>
<p>è€ƒè™‘ä½ æœ‰ä¸€ä¸ªåŒ…å«ä¸åŒé¡µé¢çš„ç½‘ç«™ï¼Œå¹¶ä¸”å…è®¸ç”¨æˆ·æ›´æ”¹ä¸»é¢˜ã€‚ä½ ä¼šæ€ä¹ˆåšï¼Ÿä¸ºæ¯ä¸ªä¸»é¢˜åˆ›å»ºæ¯ä¸ªé¡µé¢çš„å¤šä¸ªå‰¯æœ¬ï¼Œè¿˜æ˜¯åªåˆ›å»ºå•ç‹¬çš„ä¸»é¢˜ï¼Œæ ¹æ®ç”¨æˆ·çš„å–œå¥½åŠ è½½å®ƒä»¬ï¼Ÿæ¡¥æ¥æ¨¡å¼å…è®¸ä½ æ‰§è¡Œç¬¬äºŒç§æ–¹æ¡ˆã€‚</p>
</blockquote>
<p><img src="33b7aea0-f515-11e6-983f-98823c9845ee.png" alt="Without Bridge"></p>
<p>ç®€è€Œè¨€ä¹‹</p>
<blockquote>
<p>æ¡¥æ¥æ¨¡å¼æ˜¯ä¼˜å…ˆäºç»§æ‰¿è€Œä¸æ˜¯ç»§æ‰¿ã€‚å°†å®ç°ç»†èŠ‚ä»å±‚æ¬¡ç»“æ„æ¨é€åˆ°å…·æœ‰å•ç‹¬å±‚æ¬¡ç»“æ„çš„å¦ä¸€ä¸ªå¯¹è±¡ã€‚</p>
</blockquote>
<p>ç»´åŸºè¯´</p>
<blockquote>
<p>æ¡¥æ¥æ¨¡å¼æ˜¯è½¯ä»¶å·¥ç¨‹ä¸­ä½¿ç”¨çš„ä¸€ç§è®¾è®¡æ¨¡å¼ï¼Œæ—¨åœ¨â€œå°†æŠ½è±¡ä¸å…¶å®ç°åˆ†ç¦»ï¼Œä»è€Œä½¿ä¸¤è€…å¯ä»¥ç‹¬ç«‹å˜åŒ–â€ã€‚</p>
</blockquote>
<p><strong>ç¨‹åºç¤ºä¾‹</strong></p>
<p>è½¬æ¢ä¸Šé¢ WebPage çš„ä¾‹å­ã€‚è¿™æ˜¯ WebPage çš„å±‚æ¬¡ç»“æ„ã€‚</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">interface</span> <span class="title">WebPage</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">(Theme $theme)</span></span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getContent</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">About</span> <span class="keyword">implements</span> <span class="title">WebPage</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">protected</span> $theme;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">(Theme $theme)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;theme = $theme;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getContent</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"About page in "</span> . <span class="keyword">$this</span>-&gt;theme-&gt;getColor();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Careers</span> <span class="keyword">implements</span> <span class="title">WebPage</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">protected</span> $theme;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">(Theme $theme)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;theme = $theme;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getContent</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"Careers page in "</span> . <span class="keyword">$this</span>-&gt;theme-&gt;getColor();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä»¥åŠå•ç‹¬ä¸»é¢˜çš„å±‚æ¬¡ç»“æ„</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">interface</span> <span class="title">Theme</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getColor</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">DarkTheme</span> <span class="keyword">implements</span> <span class="title">Theme</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getColor</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">'Dark Black'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">LightTheme</span> <span class="keyword">implements</span> <span class="title">Theme</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getColor</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">'Off white'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">AquaTheme</span> <span class="keyword">implements</span> <span class="title">Theme</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getColor</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">'Light blue'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä¸¤ä¸ªå±‚æ¬¡çš„ç”¨æ³•</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">$darkTheme = <span class="keyword">new</span> DarkTheme();</span><br><span class="line"></span><br><span class="line">$about = <span class="keyword">new</span> About($darkTheme);</span><br><span class="line">$careers = <span class="keyword">new</span> Careers($darkTheme);</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> $about-&gt;getContent(); <span class="comment">// "About page in Dark Black";</span></span><br><span class="line"><span class="keyword">echo</span> $careers-&gt;getContent(); <span class="comment">// "Careers page in Dark Black";</span></span><br></pre></td></tr></table></figure>
<h3 id="ğŸŒ¿-ç»„åˆ"><a href="#ğŸŒ¿-ç»„åˆ" class="headerlink" title="ğŸŒ¿ ç»„åˆ"></a>ğŸŒ¿ ç»„åˆ</h3><p>ç°å®ä¾‹å­</p>
<blockquote>
<p>æ¯ä¸€ä¸ªç»„ç»‡ç”±é›‡å‘˜ç»„æˆã€‚æ¯ä¸ªå—é›‡è€…æœ‰ç›¸åŒåŠŸèƒ½ï¼Œæ¯”å¦‚ï¼Œæœ‰ä¸€ä»½è–ªæ°´ã€ä¸€äº›èŒè´£ã€æ˜¯å¦å‘æŸäººæŠ¥å‘Šã€æ˜¯å¦æœ‰ä¸‹å±ç­‰ç­‰ã€‚</p>
</blockquote>
<p>ç®€è€Œè¨€ä¹‹</p>
<blockquote>
<p>ç»„åˆæ¨¡å¼ä½¿å®¢æˆ·èƒ½å¤Ÿä»¥ç»Ÿä¸€çš„æ–¹å¼å¯¹å¾…å„ä¸ªå¯¹è±¡ã€‚</p>
</blockquote>
<p>ç»´åŸºè¯´</p>
<blockquote>
<p>åœ¨è½¯ä»¶å·¥ç¨‹ä¸­ï¼Œç»„åˆæ¨¡å¼æ˜¯ä¸€ç§åˆ†åŒºè®¾è®¡æ¨¡å¼ã€‚ç»„åˆæ¨¡å¼å°†ä¸€ç»„å¯¹è±¡å½“æˆä¸€ä¸ªå¯¹è±¡çš„å•ä¸ªå®ä¾‹å¯¹å¾…ã€‚ç»„åˆçš„ç›®çš„æ˜¯å°†å¯¹è±¡â€œç»„æˆâ€æ ‘çŠ¶ç»“æ„ï¼Œä»¥è¡¨ç¤ºæ•´ä¸ªéƒ¨åˆ†çš„å±‚æ¬¡ç»“æ„ã€‚å®ç°ç»„åˆæ¨¡å¼å¯ä»¥ä½¿å®¢æˆ·ç»Ÿä¸€å¯¹å¾…å•ä¸ªå¯¹è±¡å’Œå¤åˆå¯¹è±¡ã€‚</p>
</blockquote>
<p><strong>ç¨‹åºç¤ºä¾‹</strong></p>
<p>ä»¥æˆ‘ä»¬çš„é›‡å‘˜ä¸ºä¾‹ã€‚è¿™é‡Œæœ‰ä¸åŒçš„å‘˜å·¥ç±»å‹ã€‚</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">interface</span> <span class="title">Employee</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">(string $name, float $salary)</span></span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getName</span><span class="params">()</span>: <span class="title">string</span></span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">setSalary</span><span class="params">(float $salary)</span></span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getSalary</span><span class="params">()</span>: <span class="title">float</span></span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getRoles</span><span class="params">()</span>: <span class="title">array</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Developer</span> <span class="keyword">implements</span> <span class="title">Employee</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">protected</span> $salary;</span><br><span class="line">    <span class="keyword">protected</span> $name;</span><br><span class="line">    <span class="keyword">protected</span> $roles;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">(string $name, float $salary)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;name = $name;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;salary = $salary;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getName</span><span class="params">()</span>: <span class="title">string</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">setSalary</span><span class="params">(float $salary)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;salary = $salary;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getSalary</span><span class="params">()</span>: <span class="title">float</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;salary;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getRoles</span><span class="params">()</span>: <span class="title">array</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;roles;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Designer</span> <span class="keyword">implements</span> <span class="title">Employee</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">protected</span> $salary;</span><br><span class="line">    <span class="keyword">protected</span> $name;</span><br><span class="line">    <span class="keyword">protected</span> $roles;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">(string $name, float $salary)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;name = $name;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;salary = $salary;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getName</span><span class="params">()</span>: <span class="title">string</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">setSalary</span><span class="params">(float $salary)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;salary = $salary;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getSalary</span><span class="params">()</span>: <span class="title">float</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;salary;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getRoles</span><span class="params">()</span>: <span class="title">array</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;roles;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç„¶åæˆ‘ä»¬æœ‰ä¸€ä¸ªç”±å‡ ç§ä¸åŒç±»å‹é›‡å‘˜ç»„æˆçš„ç»„ç»‡ã€‚</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Organization</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">protected</span> $employees;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">addEmployee</span><span class="params">(Employee $employee)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;employees[] = $employee;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getNetSalaries</span><span class="params">()</span>: <span class="title">float</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $netSalary = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">foreach</span> (<span class="keyword">$this</span>-&gt;employees <span class="keyword">as</span> $employee) &#123;</span><br><span class="line">            $netSalary += $employee-&gt;getSalary();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> $netSalary;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æ¥ç€è¿™ä¹ˆç”¨</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">// å‡†å¤‡å‘˜å·¥</span></span><br><span class="line">$john = <span class="keyword">new</span> Developer(<span class="string">'John Doe'</span>, <span class="number">12000</span>);</span><br><span class="line">$jane = <span class="keyword">new</span> Designer(<span class="string">'Jane Doe'</span>, <span class="number">15000</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// æŠŠä»–ä»¬æ·»åŠ åˆ°ç»„ç»‡</span></span><br><span class="line">$organization = <span class="keyword">new</span> Organization();</span><br><span class="line">$organization-&gt;addEmployee($john);</span><br><span class="line">$organization-&gt;addEmployee($jane);</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="string">"Net salaries: "</span> . $organization-&gt;getNetSalaries(); <span class="comment">// Net Salaries: 27000</span></span><br></pre></td></tr></table></figure>
<h3 id="â˜•-è£…é¥°å™¨"><a href="#â˜•-è£…é¥°å™¨" class="headerlink" title="â˜• è£…é¥°å™¨"></a>â˜• è£…é¥°å™¨</h3><p>ç°å®ä¾‹å­</p>
<blockquote>
<p>å‡è®¾ä½ ç»è¥ä¸€å®¶æä¾›å¤šç§æœåŠ¡çš„æ±½è½¦ç»´ä¿®åº—ã€‚ç°åœ¨ï¼Œä½ è¦å¦‚ä½•è®¡ç®—è¦æ”¶å–çš„è´¦å•ï¼Ÿé€‰æ‹©ä¸€é¡¹æœåŠ¡ï¼Œå¹¶åŠ¨æ€åœ°å‘å…¶æ·»åŠ æœåŠ¡å’Œçš„ä»·æ ¼ï¼ŒçŸ¥é“è·å¾—æœ€ç»ˆèŠ±é”€ã€‚è¿™é‡Œçš„æ¯ç§æœåŠ¡éƒ½æ˜¯è£…é¥°å™¨ã€‚</p>
</blockquote>
<p>ç®€è€Œè¨€ä¹‹</p>
<blockquote>
<p>è£…é¥°å™¨æ¨¡å¼ä½¿ä½ å¯ä»¥å°†å¯¹è±¡åŒ…è£…åœ¨è£…é¥°å™¨ç±»çš„å¯¹è±¡ä¸­ï¼Œä»è€Œåœ¨è¿è¡Œæ—¶åŠ¨æ€æ›´æ”¹å¯¹è±¡çš„è¡Œä¸ºã€‚</p>
</blockquote>
<p>ç»´åŸºè¯´</p>
<blockquote>
<p>é¢å‘å¯¹è±¡ç¼–ç¨‹ä¸­ï¼Œè£…é¥°å™¨æ¨¡å¼æ˜¯ä¸€ç§è®¾è®¡æ¨¡å¼ï¼Œå®ƒå…è®¸å°†è¡Œä¸ºåŠ¨æ€æˆ–é™æ€åœ°æ·»åŠ åˆ°å•ä¸ªå¯¹è±¡ä¸­ï¼Œè€Œä¸å½±å“åŒä¸€ç±»ä¸­å…¶ä»–å¯¹è±¡åœ°è¡Œä¸ºã€‚è£…é¥°å™¨æ¨¡å¼é€šå¸¸å¯ç”¨äºéµå®ˆâ€œå•ä¸€èŒè´£åŸåˆ™â€ï¼Œå› ä¸ºå®ƒå…è®¸åœ¨å…·æœ‰å”¯ä¸€å…³æ³¨åŒºåŸŸçš„ç±»ä¹‹é—´åˆ’åˆ†åŠŸèƒ½ã€‚</p>
</blockquote>
<p><strong>ç¨‹åºç¤ºä¾‹</strong></p>
<p>ä»¥å’–å•¡ä¸ºä¾‹ï¼Œé¦–å…ˆï¼Œæˆ‘ä»¬æœ‰ä¸ªç®€å•çš„ offee çš„æ¥å£åŠå®ç°ã€‚</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">interface</span> <span class="title">Coffee</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getCost</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getDescription</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SimpleCoffee</span> <span class="keyword">implements</span> <span class="title">Coffee</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getCost</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">10</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getDescription</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">'Simple coffee'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æˆ‘ä»¬å¸Œæœ›ä½¿ä»£ç å¯æ‰©å±•ï¼Œä»¥ä¾¿åœ¨éœ€è¦æ—¶é€šè¿‡é€‰é¡¹é…ç½®ï¼Œæˆ‘ä»¬ä¸ºå…¶æ·»åŠ è£…é¥°å™¨ã€‚</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MilkCoffee</span> <span class="keyword">implements</span> <span class="title">Coffee</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">protected</span> $coffee;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">(Coffee $coffee)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;coffee = $coffee;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getCost</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;coffee-&gt;getCost() + <span class="number">2</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getDescription</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;coffee-&gt;getDescription() . <span class="string">', milk'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">WhipCoffee</span> <span class="keyword">implements</span> <span class="title">Coffee</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">protected</span> $coffee;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">(Coffee $coffee)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;coffee = $coffee;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getCost</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;coffee-&gt;getCost() + <span class="number">5</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getDescription</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;coffee-&gt;getDescription() . <span class="string">', whip'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">VanillaCoffee</span> <span class="keyword">implements</span> <span class="title">Coffee</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">protected</span> $coffee;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">(Coffee $coffee)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;coffee = $coffee;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getCost</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;coffee-&gt;getCost() + <span class="number">3</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getDescription</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;coffee-&gt;getDescription() . <span class="string">', vanilla'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç°åœ¨æ¥åˆ¶ä½œå’–å•¡ã€‚</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">$someCoffee = <span class="keyword">new</span> SimpleCoffee();</span><br><span class="line"><span class="keyword">echo</span> $someCoffee-&gt;getCost(); <span class="comment">// 10</span></span><br><span class="line"><span class="keyword">echo</span> $someCoffee-&gt;getDescription(); <span class="comment">// Simple Coffee</span></span><br><span class="line"></span><br><span class="line">$someCoffee = <span class="keyword">new</span> MilkCoffee($someCoffee);</span><br><span class="line"><span class="keyword">echo</span> $someCoffee-&gt;getCost(); <span class="comment">// 12</span></span><br><span class="line"><span class="keyword">echo</span> $someCoffee-&gt;getDescription(); <span class="comment">// Simple Coffee, milk</span></span><br><span class="line"></span><br><span class="line">$someCoffee = <span class="keyword">new</span> WhipCoffee($someCoffee);</span><br><span class="line"><span class="keyword">echo</span> $someCoffee-&gt;getCost(); <span class="comment">// 17</span></span><br><span class="line"><span class="keyword">echo</span> $someCoffee-&gt;getDescription(); <span class="comment">// Simple Coffee, milk, whip</span></span><br><span class="line"></span><br><span class="line">$someCoffee = <span class="keyword">new</span> VanillaCoffee($someCoffee);</span><br><span class="line"><span class="keyword">echo</span> $someCoffee-&gt;getCost(); <span class="comment">// 20</span></span><br><span class="line"><span class="keyword">echo</span> $someCoffee-&gt;getDescription(); <span class="comment">// Simple Coffee, milk, whip, vanilla</span></span><br></pre></td></tr></table></figure>
<h3 id="ğŸ“¦-å¤–è§‚æ¨¡å¼"><a href="#ğŸ“¦-å¤–è§‚æ¨¡å¼" class="headerlink" title="ğŸ“¦ å¤–è§‚æ¨¡å¼"></a>ğŸ“¦ å¤–è§‚æ¨¡å¼</h3><p>ç°å®ä¾‹å­</p>
<blockquote>
<p>ä½ æ˜¯æ€ä¹ˆæ‰“å¼€è®¡ç®—æœºçš„ï¼Ÿâ€œæŒ‰ä¸‹ç”µæºæŒ‰é’®â€ä½ ä¼šè¿™ä¹ˆè¯´ï¼Œé‚£ä»…ä»…æ˜¯ä½ æ‰€çŸ¥é“çš„ï¼Œé‚£æ˜¯ä½ ä½¿ç”¨çš„è®¡ç®—æœºåœ¨å¤–éƒ¨æä¾›çš„ç®€å•æ¥å£ï¼Œåœ¨å†…éƒ¨ï¼Œå®ƒè¿˜å¿…é¡»è¦åšå¾ˆå¤šäº‹æƒ…æ‰èƒ½å®ç°ã€‚ä¸å¤æ‚å­ç³»ç»Ÿçš„è¿™ç§ç®€å•æ¥å£å°±æ˜¯ä¸€ä¸ªå¤–è§‚ã€‚</p>
</blockquote>
<p>ç®€è€Œè¨€ä¹‹</p>
<blockquote>
<p>å¤–è§‚æ¨¡å¼æä¾›äº†åˆ°å¤æ‚å­ç³»ç»Ÿçš„ç®€åŒ–æ¥å£ã€‚</p>
</blockquote>
<p>ç»´åŸºè¯´</p>
<blockquote>
<p>å¤–è§‚æ˜¯ä¸ºå¤§å‹ä»£ç ï¼ˆä¾‹å¦‚ç±»åº“ï¼‰æä¾›ç®€åŒ–æ¥å£çš„å¯¹è±¡ã€‚</p>
</blockquote>
<p><strong>ç¨‹åºç¤ºä¾‹</strong></p>
<p>ç”¨ä¸Šé¢è®¡ç®—æœºçš„ä¾‹å­ï¼Œè¿™é‡Œæœ‰ä¸ªè®¡ç®—æœºç±»ã€‚</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Computer</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getElectricShock</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"Ouch!"</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">makeSound</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"Beep beep!"</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">showLoadingScreen</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"Loading.."</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">bam</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"Ready to be used!"</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">closeEverything</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"Bup bup bup buzzzz!"</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">sooth</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"Zzzzz"</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">pullCurrent</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"Haaah!"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿™æ˜¯å¤–è§‚ã€‚</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ComputerFacade</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">protected</span> $computer;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">(Computer $computer)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;computer = $computer;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">turnOn</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;computer-&gt;getElectricShock();</span><br><span class="line">        <span class="keyword">$this</span>-&gt;computer-&gt;makeSound();</span><br><span class="line">        <span class="keyword">$this</span>-&gt;computer-&gt;showLoadingScreen();</span><br><span class="line">        <span class="keyword">$this</span>-&gt;computer-&gt;bam();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">turnOff</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;computer-&gt;closeEverything();</span><br><span class="line">        <span class="keyword">$this</span>-&gt;computer-&gt;pullCurrent();</span><br><span class="line">        <span class="keyword">$this</span>-&gt;computer-&gt;sooth();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä½¿ç”¨å¤–è§‚ã€‚</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">$computer = <span class="keyword">new</span> ComputerFacade(<span class="keyword">new</span> Computer());</span><br><span class="line">$computer-&gt;turnOn(); <span class="comment">// Ouch! Beep beep! Loading.. Ready to be used!</span></span><br><span class="line">$computer-&gt;turnOff(); <span class="comment">// Bup bup buzzz! Haah! Zzzzz</span></span><br></pre></td></tr></table></figure>
<h3 id="ğŸƒ-äº«å…ƒ"><a href="#ğŸƒ-äº«å…ƒ" class="headerlink" title="ğŸƒ äº«å…ƒ"></a>ğŸƒ äº«å…ƒ</h3><p>ç°å®ä¾‹å­</p>
<blockquote>
<p>ä½ æœ‰æ²¡æœ‰åœ¨æ‘Šå­ä¸Šä¹°è¿‡èŒ¶ï¼Ÿä»–ä»¬é€šå¸¸ä¼šå¤šåšå‡ æ¯ï¼ŒæŠŠå¤šå‡ºæ¥çš„ç•™ç»™å…¶ä»–é¡¾å®¢ï¼Œè¿™æ ·å¯ä»¥èŠ‚çº¦èµ„æºï¼Œæ¯”å¦‚ç‡ƒæ°”ã€‚ äº«å…ƒè®¾è®¡æ¨¡å¼ä¸»è¦å°±æ˜¯è¿™é‡Œï¼Œå³å…±äº«ã€‚</p>
</blockquote>
<p>ç®€è€Œè¨€ä¹‹</p>
<blockquote>
<p>å®ƒç”¨äºé€šè¿‡ä¸ç›¸ä¼¼å¯¹è±¡å°½å¯èƒ½å¤šåœ°å…±äº«æ¥æœ€å¤§ç¨‹åº¦å‡å°‘å†…å­˜ä½¿ç”¨æˆ–è€…è®¡ç®—å¼€é”€ã€‚</p>
</blockquote>
<p>ç»´åŸºè¯´</p>
<blockquote>
<p>åœ¨è®¡ç®—æœºç¼–ç¨‹ä¸­ï¼Œäº«å…ƒ æ˜¯ä¸€ç§è½¯ä»¶è®¾è®¡æ¨¡å¼ã€‚äº«å…ƒæ˜¯é€šè¿‡ä¸å…¶ä»–ç±»ä¼¼å¯¹è±¡å…±äº«å°½å¯èƒ½å¤šçš„æ•°æ®æ¥æœ€å¤§ç¨‹åº¦å‡å°‘å†…å­˜ä½¿ç”¨çš„å¯¹è±¡ï¼›å½“ç®€å•çš„é‡å¤ä»£ç å ç”¨äº†è¿‡å¤šå†…å­˜æ—¶ï¼Œè¿™æ˜¯ä¸€ç§å¤§é‡ä½¿ç”¨å¯¹è±¡çš„æ–¹æ³•ã€‚</p>
</blockquote>
<p><strong>ç¨‹åºç¤ºä¾‹</strong></p>
<p>åˆ©ç”¨ä¸Šé¢èŒ¶çš„ä¾‹å­ã€‚é¦–å…ˆè¦æœ‰åšèŒ¶å¸ˆå‚…ã€‚</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">// Anything that will be cached is flyweight.</span></span><br><span class="line"><span class="comment">// Types of tea here will be flyweights.</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">KarakTea</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Acts as a factory and saves the tea</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TeaMaker</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">protected</span> $availableTea = [];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">make</span><span class="params">($preference)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">empty</span>(<span class="keyword">$this</span>-&gt;availableTea[$preference])) &#123;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;availableTea[$preference] = <span class="keyword">new</span> KarakTea();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;availableTea[$preference];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æ¥ç€æ˜¯æä¾›æœåŠ¡çš„èŒ¶åº—ï¼ˆTeaShopï¼‰</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TeaShop</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">protected</span> $orders;</span><br><span class="line">    <span class="keyword">protected</span> $teaMaker;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">(TeaMaker $teaMaker)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;teaMaker = $teaMaker;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">takeOrder</span><span class="params">(string $teaType, int $table)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;orders[$table] = <span class="keyword">$this</span>-&gt;teaMaker-&gt;make($teaType);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">serve</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">foreach</span> (<span class="keyword">$this</span>-&gt;orders <span class="keyword">as</span> $table =&gt; $tea) &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">"Serving tea to table# "</span> . $table;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç”¨æ³•</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">$teaMaker = <span class="keyword">new</span> TeaMaker();</span><br><span class="line">$shop = <span class="keyword">new</span> TeaShop($teaMaker);</span><br><span class="line"></span><br><span class="line">$shop-&gt;takeOrder(<span class="string">'less sugar'</span>, <span class="number">1</span>);</span><br><span class="line">$shop-&gt;takeOrder(<span class="string">'more milk'</span>, <span class="number">2</span>);</span><br><span class="line">$shop-&gt;takeOrder(<span class="string">'without sugar'</span>, <span class="number">5</span>);</span><br><span class="line"></span><br><span class="line">$shop-&gt;serve();</span><br><span class="line"><span class="comment">// Serving tea to table# 1</span></span><br><span class="line"><span class="comment">// Serving tea to table# 2</span></span><br><span class="line"><span class="comment">// Serving tea to table# 5</span></span><br></pre></td></tr></table></figure>
<h3 id="ğŸ±-ä»£ç†"><a href="#ğŸ±-ä»£ç†" class="headerlink" title="ğŸ± ä»£ç†"></a>ğŸ± ä»£ç†</h3><p>å®é™…ä¾‹å­</p>
<blockquote>
<p>ç”¨è¿‡é—¨ç¦å¡é€šè¿‡å®‰å…¨é—¨å—ï¼Ÿå¼€é—¨çš„æ–¹æ³•å¾ˆå¤šï¼Œæ¯”å¦‚ç”¨é—¨ç¦å¡æˆ–è€…æŒ‰ä¸‹ç»•è¿‡å®‰å…¨æ€§çš„æŒ‰é’®ã€‚é—¨çš„ä¸»è¦åŠŸèƒ½æ˜¯æ‰“å¼€ï¼Œä½†æ˜¯å…¶é¡¶éƒ¨æ·»åŠ äº†ä»£ç†ä»¥æ·»åŠ ä¸€äº›åŠŸèƒ½ã€‚è®©æˆ‘ä½¿ç”¨ä¸‹é¢çš„ä»£ç ç¤ºä¾‹è§£é‡Šå®ƒã€‚</p>
</blockquote>
<p>ç®€è€Œè¨€ä¹‹</p>
<blockquote>
<p>ä½¿ç”¨ä»£ç†æ¨¡å¼ï¼Œä¸€ä¸ªç±»è¡¨ç¤ºå¦ä¸€ä¸ªç±»çš„åŠŸèƒ½ã€‚</p>
</blockquote>
<p>ç»´åŸºè¯´</p>
<blockquote>
<p>ä¸€èˆ¬æ¥è¯´ï¼Œä»£ç†æ˜¯ä¸€ä¸ªç±»ï¼Œå……å½“å…¶ä»–ç±»çš„æ¥å£ã€‚ä»£ç†æ—¶å®¢æˆ·ç«¯è°ƒç”¨çš„åŒ…è£…å™¨æˆ–è€…åŒ…è£…å¯¹è±¡ï¼Œç”¨æ¥è®¿é—®åå°çš„çœŸå®å¯¹è±¡ã€‚ä½¿ç”¨ä»£ç†å¯ä»¥ç®€å•åœ°è½¬å‘åˆ°çœŸå®å¯¹è±¡ï¼Œè¿˜å¯ä»¥æä¾›å…¶ä»–é€»è¾‘ã€‚åœ¨ä»£ç†ä¸­ï¼Œè¿˜å¯ä»¥æä¾›é¢å¤–çš„åŠŸèƒ½ï¼Œä¾‹å¦‚åœ¨å¯¹å®é™…å¯¹è±¡åœ°æ“ä½œå ç”¨å¤§é‡èµ„æºæ—¶è¿›è¡Œç¼“å­˜ï¼Œæˆ–è€…åœ¨è°ƒç”¨å¯¹çœŸæ˜¯å¯¹è±¡åœ°æ“ä½œä¹‹å‰æ£€æŸ¥å…ˆå†³æ¡ä»¶ã€‚</p>
</blockquote>
<p><strong>ç¨‹åºç¤ºä¾‹</strong></p>
<p>ç”¨ä¸Šé¢å®‰å…¨é—¨çš„ä¾‹å­ã€‚é¦–å…ˆï¼Œå®ç°é—¨çš„æ¥å£ã€‚</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">interface</span> <span class="title">Door</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">open</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">close</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">LabDoor</span> <span class="keyword">implements</span> <span class="title">Door</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">open</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"Opening lab door"</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">close</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"Closing the lab door"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æ¥ç€æˆ‘ä»¬ç”¨ä¸€ä¸ªä»£ç†ä½¿é—¨æ›´å®‰å…¨</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SecuredDoor</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">protected</span> $door;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">(Door $door)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;door = $door;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">open</span><span class="params">($password)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">$this</span>-&gt;authenticate($password)) &#123;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;door-&gt;open();</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">"Big no! It ain't possible."</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">authenticate</span><span class="params">($password)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> $password === <span class="string">'$ecr@t'</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">close</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;door-&gt;close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç”¨ä¾‹</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">$door = <span class="keyword">new</span> SecuredDoor(<span class="keyword">new</span> LabDoor());</span><br><span class="line">$door-&gt;open(<span class="string">'invalid'</span>); <span class="comment">// Big no! It ain't possible.</span></span><br><span class="line"></span><br><span class="line">$door-&gt;open(<span class="string">'$ecr@t'</span>); <span class="comment">// Opening lab door</span></span><br><span class="line">$door-&gt;close(); <span class="comment">// Closing lab door</span></span><br></pre></td></tr></table></figure>
<p>å¦ä¸€ä¸ªä¾‹å­æ˜¯æŸç§æ•°æ®æ˜ å°„å™¨çš„å®ç°ã€‚ä¾‹å¦‚ï¼Œæˆ‘æœ€è¿‘ä½¿ç”¨è¿™ç§æ¨¡å¼ä¸º MongoDB åˆ¶ä½œäº† ODM (å¯¹è±¡æ•°æ®æ˜ å°„å™¨)ï¼Œåœ¨å…¶ä¸­ç”¨åˆ°äº†é­”æ³•æ–¹æ³• <code>__call()</code> å›´ç»• mongo ç±»ç¼–å†™äº†ä¸€ä¸ªä»£ç†ã€‚æ‰€æœ‰çš„æ–¹æ³•è°ƒç”¨éƒ½è¢«ä»£ç†åˆ°åŸå§‹ mongo ç±»ï¼Œå¹¶ä¸”åŸæ ·è¿”å›æ£€ç´¢ç»“æœï¼Œä½†æ˜¯ <code>find</code> æˆ– <code>findOne</code> çš„æƒ…å†µä¸‹ï¼Œæ•°æ®æ˜ å°„åˆ°æ‰€éœ€çš„ç±»å¯¹è±¡ï¼Œè¿”å›çš„æ˜¯è¯¥å¯¹è±¡è€Œä¸æ˜¯ <code>Cursor</code>ã€‚</p>
<h2 id="è¡Œä¸ºå‹æ¨¡å¼"><a href="#è¡Œä¸ºå‹æ¨¡å¼" class="headerlink" title="è¡Œä¸ºå‹æ¨¡å¼"></a>è¡Œä¸ºå‹æ¨¡å¼</h2><p>ç®€è€Œè¨€ä¹‹</p>
<blockquote>
<p>å®ƒä¸å¯¹è±¡ä¹‹é—´çš„èŒè´£åˆ†é…æœ‰å…³ã€‚å®ƒä»¬ä¸ç»“æ„æ¨¡å¼çš„ä¸åŒä¹‹å¤„åœ¨äºå®ƒä»¬ä¸ä»…æŒ‡å®šç»“æ„ï¼Œè€Œä¸”è¿˜æ¦‚è¿°äº†å®ƒä»¬ä¹‹é—´æ¶ˆæ¯ä¼ é€’/é€šä¿¡çš„æ¨¡å¼ã€‚æ¢å¥è¯è¯´ï¼Œå®ƒä»¬æ˜¯ä¸ºäº†è§£å†³å¦‚ä½•åœ¨è½¯ä»¶ç»„ä»¶ä¸­è¿è¡Œä¸€ç§è¡Œä¸ºçš„é—®é¢˜ã€‚</p>
</blockquote>
<p>ç»´åŸºè¯´</p>
<blockquote>
<p>è½¯ä»¶å·¥ç¨‹ä¸­ï¼Œè¡Œä¸ºå‹æ¨¡å¼æ˜¯è¯†åˆ«å¯¹è±¡ä¹‹é—´å¸¸è§çš„é€šä¿¡æ¨¡å¼å¹¶å®ç°è¿™äº›æ¨¡å¼çš„è®¾è®¡æ¨¡å¼ã€‚è¿™æ ·åšæé«˜äº†æ‰§è¡Œæ­¤é€šä¿¡çš„çµæ´»æ€§ã€‚</p>
</blockquote>
<p>ä¸‹é¢åˆ—å‡º 10 ç§è¡Œä¸ºå‹æ¨¡å¼ï¼š</p>
<ul>
<li><a href="#ğŸ”—-è´£ä»»é“¾">Chain of Responsibility è´£ä»»é“¾</a></li>
<li><a href="#ğŸ‘®-å‘½ä»¤">Command å‘½ä»¤</a></li>
<li><a href="#â¿-è¿­ä»£å™¨">Iterator è¿­ä»£å™¨</a></li>
<li><a href="#ğŸ‘½-è°ƒè§£å‘˜">Mediator è°ƒè§£å‘˜</a></li>
<li><a href="#ğŸ’¾-å¤‡å¿˜å½•">Memento å¤‡å¿˜å½•</a></li>
<li><a href="#ğŸ˜-è§‚å¯Ÿè€…">Observer è§‚å¯Ÿè€…</a></li>
<li><a href="#ğŸƒ-è®¿é—®è€…">Visitor è®¿é—®è€…</a></li>
<li><a href="#ğŸ’¡-ç­–ç•¥">Strategy ç­–ç•¥</a></li>
<li><a href="#ğŸ’¢-çŠ¶æ€">State çŠ¶æ€</a></li>
<li><a href="#ğŸ“’-æ¨¡æ¿æ–¹æ³•">Template Method æ¨¡æ¿æ–¹æ³•</a></li>
</ul>
<h3 id="ğŸ”—-è´£ä»»é“¾"><a href="#ğŸ”—-è´£ä»»é“¾" class="headerlink" title="ğŸ”— è´£ä»»é“¾"></a>ğŸ”— è´£ä»»é“¾</h3><p>ç°å®ä¾‹å­</p>
<blockquote>
<p>å¦‚æœï¼Œä½ çš„è´¦å·æœ‰ä¸‰ç§æ”¯ä»˜æ–¹å¼ï¼ˆAï¼ŒB å’Œ C)ï¼›æ¯ä¸ªè´¦å·éƒ½æœ‰ä¸åŒçš„å­˜æ¬¾ã€‚ A æœ‰ 100 å…ƒï¼Œ B æœ‰ 300 å…ƒ å’Œ C æœ‰ 1000 å…ƒï¼Œæ”¯ä»˜åå¥½çš„é¡ºåºä¾æ¬¡ä¸º Aã€Bã€C ã€‚ä½ å°†æ”¯ä»˜ä»¥æ¡ 210 å…ƒçš„å•†å“ã€‚ç”¨ä¸Šè´£ä»»é“¾ï¼Œé¦–å…ˆä¼šæ£€æŸ¥è´¦æˆ· A å¤Ÿä¸å¤Ÿæ”¯ä»˜ï¼Œå¦‚æœå¯ä»¥ï¼Œå°†è¿›è¡Œè´­ä¹°ï¼Œç„¶åé“¾æ¡æ–­è£‚ã€‚å¦‚æœä¸å¤Ÿï¼Œåˆ™è¯·æ±‚ä¼šè¿›ä¸€æ­¥åˆ°è´¦æˆ· B ï¼Œæ£€æŸ¥æ˜¯å¦å¤Ÿæ”¯ä»˜ï¼Œå¦‚æœå¯ä»¥ï¼Œå°†è¿›è¡Œè´­ä¹°ï¼Œç„¶åé“¾æ¡æ–­è£‚ã€‚å¦åˆ™è¯·æ±‚ç»§ç»­ç›´åˆ°æ‰¾åˆ°ä½•æ—¶çš„å¤„ç†ç¨‹åºä¸ºæ­¢ã€‚åœ¨è¿™é‡Œï¼ŒAã€B å’Œ C æ˜¯é“¾ä¸Šçš„é“¾æ¥ï¼Œæ•´ä¸ªç°è±¡å°±æ˜¯è´£ä»»é“¾ã€‚</p>
</blockquote>
<p>ç®€è€Œè¨€ä¹‹</p>
<blockquote>
<p>å®ƒæœ‰åŠ©äºæ„å»ºå¯¹è±¡é“¾ã€‚è¯·æ±‚ä»ä¸€ç«¯è¿›å…¥ï¼Œå¹¶ä¸æ–­åœ°ä»ä¸€ä¸ªå¯¹è±¡ç§»åˆ°å¦ä¸€ä¸ªå¯¹è±¡ï¼Œç›´åˆ°æ‰¾åˆ°åˆé€‚åœ°å¤„ç†ç¨‹åºä¸ºæ­¢ã€‚</p>
</blockquote>
<p>ç»´åŸºè¯´</p>
<blockquote>
<p>é¢å‘å¯¹è±¡è®¾è®¡ä¸­ï¼Œè´£ä»»é“¾æ¨¡å¼æ˜¯ä¸€ç§è®¾è®¡æ¨¡å¼ï¼Œç”±å‘½ä»¤å¯¹è±¡çš„æºå’Œä¸€ç³»åˆ—å¤„ç†å¯¹è±¡ç»„æˆã€‚æ¯ä¸ªå¤„ç†å¯¹è±¡éƒ½åŒ…å«å®šä¹‰å…¶å¯ä»¥å¤„ç†çš„å‘½ä»¤å¯¹è±¡ç±»å‹çš„é€»è¾‘ï¼›å…¶ä½™çš„å°†ä¼ é€’åˆ°é“¾ä¸­çš„ä¸‹ä¸€ä¸ªå¤„ç†å¯¹è±¡ã€‚</p>
</blockquote>
<p><strong>ç¨‹åºç¤ºä¾‹</strong></p>
<p>ç”¨ä¸Šè´¦æˆ·çš„ä¾‹å­ã€‚é¦–å…ˆï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ªåŸºæœ¬è´¦æˆ·ï¼Œè¯¥è´¦æˆ·å…·æœ‰è´¦æˆ·å’ŒæŸäº›è´¦æˆ·é“¾æ¥åœ¨ä¸€èµ·çš„é€»è¾‘ã€‚</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Account</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">protected</span> $successor;</span><br><span class="line">    <span class="keyword">protected</span> $balance;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">setNext</span><span class="params">(Account $account)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;successor = $account;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">pay</span><span class="params">(float $amountToPay)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">$this</span>-&gt;canPay($amountToPay)) &#123;</span><br><span class="line">            <span class="keyword">echo</span> sprintf(<span class="string">'Paid %s using %s'</span> . PHP_EOL, $amountToPay, get_called_class());</span><br><span class="line">        &#125; <span class="keyword">elseif</span> (<span class="keyword">$this</span>-&gt;successor) &#123;</span><br><span class="line">            <span class="keyword">echo</span> sprintf(<span class="string">'Cannot pay using %s. Proceeding ..'</span> . PHP_EOL, get_called_class());</span><br><span class="line">            <span class="keyword">$this</span>-&gt;successor-&gt;pay($amountToPay);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="keyword">Exception</span>(<span class="string">'None of the accounts have enough balance'</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">canPay</span><span class="params">($amount)</span>: <span class="title">bool</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;balance &gt;= $amount;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Bank</span> <span class="keyword">extends</span> <span class="title">Account</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">protected</span> $balance;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">(float $balance)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;balance = $balance;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Paypal</span> <span class="keyword">extends</span> <span class="title">Account</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">protected</span> $balance;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">(float $balance)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;balance = $balance;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Bitcoin</span> <span class="keyword">extends</span> <span class="title">Account</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">protected</span> $balance;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">(float $balance)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;balance = $balance;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç°åœ¨ï¼Œä½¿ç”¨ä¸Šé¢å®šä¹‰çš„é“¾æ¥ï¼ˆå³é“¶è¡Œã€PayPalã€æ¯”ç‰¹å¸ï¼‰å‡†å¤‡é“¾ã€‚</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">// å‡†å¤‡è¿™æ ·ä¸€æ¡é“¾</span></span><br><span class="line"><span class="comment">//      $bank-&gt;$paypal-&gt;$bitcoin</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">// æœ€å¼€å§‹æ˜¯é“¶è¡Œ</span></span><br><span class="line"><span class="comment">//      å¦‚æœé“¶è¡Œä¸å¤Ÿå°±å°è¯• PayPal</span></span><br><span class="line"><span class="comment">//     å¦‚æœ PayPal ä¸å¤Ÿå†å°è¯• bit coin</span></span><br><span class="line"></span><br><span class="line">$bank = <span class="keyword">new</span> Bank(<span class="number">100</span>);          <span class="comment">// é“¶è¡Œä½™é¢ 100</span></span><br><span class="line">$paypal = <span class="keyword">new</span> Paypal(<span class="number">200</span>);      <span class="comment">// Paypal ä½™é¢ä¸º 200</span></span><br><span class="line">$bitcoin = <span class="keyword">new</span> Bitcoin(<span class="number">300</span>);    <span class="comment">// Bitcoin ä½™é¢ä¸º 300</span></span><br><span class="line"></span><br><span class="line">$bank-&gt;setNext($paypal);</span><br><span class="line">$paypal-&gt;setNext($bitcoin);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Let's try to pay using the first priority i.e. bank</span></span><br><span class="line">$bank-&gt;pay(<span class="number">259</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Output will be</span></span><br><span class="line"><span class="comment">// ==============</span></span><br><span class="line"><span class="comment">// Cannot pay using bank. Proceeding ..</span></span><br><span class="line"><span class="comment">// Cannot pay using paypal. Proceeding ..:</span></span><br><span class="line"><span class="comment">// Paid 259 using Bitcoin!</span></span><br></pre></td></tr></table></figure>
<h3 id="ğŸ‘®-å‘½ä»¤"><a href="#ğŸ‘®-å‘½ä»¤" class="headerlink" title="ğŸ‘® å‘½ä»¤"></a>ğŸ‘® å‘½ä»¤</h3><p>ç°å®ä¾‹å­</p>
<blockquote>
<p>ä¸€ä¸ªé€šç”¨çš„ä¾‹å­æ˜¯ä½ åœ¨é¤å…ç‚¹é¤ã€‚ä½ ï¼ˆå³å®¢æˆ·ï¼‰è¦æ±‚æœåŠ¡å‘˜ï¼ˆå³è°ƒç”¨è€…ï¼‰å¸¦æ¥ä¸€äº›é£Ÿç‰©ï¼ˆå³å‘½ä»¤ï¼‰ï¼ŒæœåŠ¡å‘˜åªéœ€å°†è¯·æ±‚è½¬å‘ç»™è´Ÿè´£çƒ¹é¥ªçš„å¨å¸ˆï¼ˆå³æ¥æ”¶è€…ï¼‰ã€‚å¦ä¸€ä¸ªä¾‹å­æ˜¯ï¼Œä½ ï¼ˆå³å®¢æˆ·ï¼‰ä½¿ç”¨é¥æ§å™¨ï¼ˆå³è°ƒç”¨è€…ï¼‰æ‰“å¼€ï¼ˆå³å‘½ä»¤ï¼‰ç”µè§†ï¼ˆå³æ¥æ”¶è€…ï¼‰ã€‚</p>
</blockquote>
<p>ç®€è€Œè¨€ä¹‹</p>
<blockquote>
<p>å…è®¸ä½ å°†åŠ¨ä½œå°è£…åœ¨å¯¹è±¡ä¸­ã€‚è¯¥æ¨¡å¼çš„å…³é”®æ€æƒ³æ˜¯æä¾›ä½¿å®¢æˆ·ç«¯å’Œæ¥æ”¶è€…è§£è€¦çš„æ–¹æ³•ã€‚</p>
</blockquote>
<p>ç»´åŸºè¯´</p>
<blockquote>
<p>é¢å‘å¯¹è±¡ç¼–ç¨‹ä¸­ï¼Œå‘½ä»¤æ¨¡å¼æ˜¯ä¸€ç§è¡Œä¸ºå‹æ¨¡å¼ï¼Œå…¶ä¸­çš„å¯¹è±¡ç”¨äºå°è£…ä»¥åæ‰§è¡ŒåŠ¨ä½œæˆ–è§¦å‘äº‹ä»¶æ‰€éœ€çš„æ‰€æœ‰ä¿¡æ¯ã€‚è¯¥ä¿¡æ¯åŒ…æ‹¬æ–¹æ³•åç§°ï¼Œæ‹¥æœ‰æ–¹æ³•çš„å¯¹è±¡å’Œæ–¹æ³•å‚æ•°çš„å€¼ã€‚</p>
</blockquote>
<p><strong>ç¨‹åºç¤ºä¾‹</strong></p>
<p>é¦–å…ˆå®ç°æ¥æ”¶è€…çš„æ‰€æœ‰åŠ¨ä½œ</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">// Receiver</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Bulb</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">turnOn</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"Bulb has been lit"</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">turnOff</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"Darkness!"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç„¶åæˆ‘ä»¬å°†æ¥å£çš„æ¯ä¸€ä¸ªå‘½ä»¤éƒ½å®ç°</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">interface</span> <span class="title">Command</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">execute</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">undo</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">redo</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Command</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TurnOn</span> <span class="keyword">implements</span> <span class="title">Command</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">protected</span> $bulb;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">(Bulb $bulb)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;bulb = $bulb;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">execute</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;bulb-&gt;turnOn();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">undo</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;bulb-&gt;turnOff();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">redo</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;execute();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TurnOff</span> <span class="keyword">implements</span> <span class="title">Command</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">protected</span> $bulb;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">(Bulb $bulb)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;bulb = $bulb;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">execute</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;bulb-&gt;turnOff();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">undo</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;bulb-&gt;turnOn();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">redo</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;execute();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æ¥ç€æˆ‘ä»¬çš„è°ƒç”¨è€…ï¼Œå®¢æˆ·ç«¯å°†ä¸ä¹‹äº¤äº’ä»¥å¤„ç†ä»»ä½•å‘½ä»¤ã€‚</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">// Invoker</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">RemoteControl</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">submit</span><span class="params">(Command $command)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $command-&gt;execute();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æœ€åçœ‹çœ‹å®¢æˆ·ç«¯ä¸­å¦‚ä½•ä½¿ç”¨</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">$bulb = <span class="keyword">new</span> Bulb();</span><br><span class="line"></span><br><span class="line">$turnOn = <span class="keyword">new</span> TurnOn($bulb);</span><br><span class="line">$turnOff = <span class="keyword">new</span> TurnOff($bulb);</span><br><span class="line"></span><br><span class="line">$remote = <span class="keyword">new</span> RemoteControl();</span><br><span class="line">$remote-&gt;submit($turnOn); <span class="comment">// Bulb has been lit!</span></span><br><span class="line">$remote-&gt;submit($turnOff); <span class="comment">// Darkness!</span></span><br></pre></td></tr></table></figure>
<p>å‘½ä»¤æ¨¡å¼å¯ä»¥ç”¨æ¥å®ç°åŸºäºäº‹åŠ¡çš„ç³»ç»Ÿã€‚ä¸€æ—¦æ‰§è¡Œå‘½ä»¤ï¼Œä¾¿ä¼šç»§ç»­ä¿æŒå‘½ä»¤çš„å†å²è®°å½•ã€‚å¦‚æœæœ€ç»ˆçš„å‘½ä»¤è¢«æˆåŠŸæ‰§è¡Œï¼Œè¦ä¹ˆä¸€åˆ‡æ­£å¸¸å¦åˆ™åªéœ€è¦ä¾¿åˆ©å†å²è®°å½•å¹¶ç»§ç»­å¯¹æ‰€æœ‰å·²æ‰§è¡Œçš„å‘½ä»¤æ‰§è¡Œæ’¤é”€å³å¯ã€‚</p>
<h3 id="â¿-è¿­ä»£å™¨"><a href="#â¿-è¿­ä»£å™¨" class="headerlink" title="â¿ è¿­ä»£å™¨"></a>â¿ è¿­ä»£å™¨</h3><p>ç°å®ä¾‹å­</p>
<blockquote>
<p>æ—§æ”¶éŸ³æœºçš„ä¾‹å­æŒºä¸é”™ï¼Œç”¨æˆ·å¯ä»¥ä»æŸä¸ªé¢‘é“å¼€å§‹ï¼Œç„¶åä½¿ç”¨ä¸‹ä¸€ä¸ªæˆ–è€…ä¸Šä¸€ä¸ªæŒ‰é’®æµè§ˆå„ä¸ªé¢‘é“ã€‚åˆæˆ–è€…æ˜¯ MP3 æ’­æ”¾å™¨æˆ–è€…ç”µè§†æœºä¹Ÿå¯ä»¥é€šè¿‡å‰åæŒ‰é’®æµè§ˆå†…å®¹ï¼Œæ¢å¥è¯è¯´å®ƒä»¬éƒ½æä¾›äº†ä¸€ä¸ªæ¥å£ï¼Œä»¥å¾ªç¯çš„æ–¹å¼è®¿é—®ç›¸åº”çš„é¢‘é“ï¼Œæ­Œæ›²æˆ–å¹¿æ’­ç”µå°ã€‚</p>
</blockquote>
<p>ç®€è€Œè¨€ä¹‹</p>
<blockquote>
<p>å®ƒæä¾›äº†ä¸€ç§åœ¨ä¸æš´éœ²åº•å±‚å®ç°çš„æƒ…å†µä¸‹è®¿é—®å¯¹è±¡å…ƒç´ çš„æ–¹æ³•ã€‚</p>
</blockquote>
<p>ç»´åŸºè¯´</p>
<blockquote>
<p>é¢å‘å¯¹è±¡ç¼–ç¨‹ä¸­ï¼Œè¿­ä»£å™¨æ¨¡å¼æ˜¯ä¸€ç§è®¾è®¡æ¨¡å¼ï¼Œå…¶ä¸­è¿­ä»£å™¨ç”¨äºéå†å®¹å™¨å¹¶è®¿é—®å®¹å™¨çš„å…ƒç´ ã€‚è¿­ä»£å™¨æ¨¡å¼å°†ç®—æ³•ä¸å®¹å™¨è§£è€¦ï¼›åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œç®—æ³•å¿…ç„¶ç‰¹å®šäºå®¹å™¨ï¼Œå› æ­¤æ— æ³•è§£è€¦ã€‚</p>
</blockquote>
<p><strong>ç¨‹åºç¤ºä¾‹</strong></p>
<p>åœ¨ PHP ä¸­ä½¿ç”¨ SPL ï¼ˆæ ‡å‡†åº“ï¼‰ å¾ˆå®¹æ˜“å®ç°ã€‚è½¬æ¢ä¸Šé¢ç”µå°çš„ä¾‹å­ï¼Œé¦–å…ˆè®¾è®¡ç”µå°ç±»ã€‚</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">RadioStation</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">protected</span> $frequency;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">(float $frequency)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;frequency = $frequency;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getFrequency</span><span class="params">()</span>: <span class="title">float</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;frequency;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç„¶åå®ç°è¿­ä»£å™¨</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">use</span> <span class="title">Countable</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">Iterator</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">StationList</span> <span class="keyword">implements</span> <span class="title">Countable</span>, <span class="title">Iterator</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="comment">/** <span class="doctag">@var</span> RadioStation[] $stations */</span></span><br><span class="line">    <span class="keyword">protected</span> $stations = [];</span><br><span class="line"></span><br><span class="line">    <span class="comment">/** <span class="doctag">@var</span> int $counter */</span></span><br><span class="line">    <span class="keyword">protected</span> $counter;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">addStation</span><span class="params">(RadioStation $station)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;stations[] = $station;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">removeStation</span><span class="params">(RadioStation $toRemove)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $toRemoveFrequency = $toRemove-&gt;getFrequency();</span><br><span class="line">        <span class="keyword">$this</span>-&gt;stations = array_filter(<span class="keyword">$this</span>-&gt;stations, <span class="function"><span class="keyword">function</span> <span class="params">(RadioStation $station)</span> <span class="title">use</span> <span class="params">($toRemoveFrequency)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> $station-&gt;getFrequency() !== $toRemoveFrequency;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">count</span><span class="params">()</span>: <span class="title">int</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> count(<span class="keyword">$this</span>-&gt;stations);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">current</span><span class="params">()</span>: <span class="title">RadioStation</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;stations[<span class="keyword">$this</span>-&gt;counter];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">key</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;counter;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">next</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;counter++;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">rewind</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;counter = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">valid</span><span class="params">()</span>: <span class="title">bool</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">isset</span>(<span class="keyword">$this</span>-&gt;stations[<span class="keyword">$this</span>-&gt;counter]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿™ä¹ˆç”¨</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">$stationList = <span class="keyword">new</span> StationList();</span><br><span class="line"></span><br><span class="line">$stationList-&gt;addStation(<span class="keyword">new</span> RadioStation(<span class="number">89</span>));</span><br><span class="line">$stationList-&gt;addStation(<span class="keyword">new</span> RadioStation(<span class="number">101</span>));</span><br><span class="line">$stationList-&gt;addStation(<span class="keyword">new</span> RadioStation(<span class="number">102</span>));</span><br><span class="line">$stationList-&gt;addStation(<span class="keyword">new</span> RadioStation(<span class="number">103.2</span>));</span><br><span class="line"></span><br><span class="line"><span class="keyword">foreach</span>($stationList <span class="keyword">as</span> $station) &#123;</span><br><span class="line">    <span class="keyword">echo</span> $station-&gt;getFrequency() . PHP_EOL;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$stationList-&gt;removeStation(<span class="keyword">new</span> RadioStation(<span class="number">89</span>)); <span class="comment">// Will remove station 89</span></span><br></pre></td></tr></table></figure>
<h3 id="ğŸ‘½-è°ƒè§£å‘˜"><a href="#ğŸ‘½-è°ƒè§£å‘˜" class="headerlink" title="ğŸ‘½ è°ƒè§£å‘˜"></a>ğŸ‘½ è°ƒè§£å‘˜</h3><p>ç°å®ä¾‹å­</p>
<blockquote>
<p>ä¸€ä¸ªä¸€èˆ¬çš„ä¾‹å­ï¼Œå½“ä½ ä¸å…¶ä»–äººé€šè¿‡æ‰‹æœºé€šè¯æ—¶ï¼Œå¯¹è¯æ¶ˆæ¯æ˜¯é€šè¿‡ç½‘ç»œæä¾›å•†å‘é€è¿‡å»çš„ã€‚è¿™é‡Œç½‘ç»œæä¾›å•†å°±æ˜¯è°ƒè§£å‘˜ã€‚</p>
</blockquote>
<p>ç®€è€Œè¨€ä¹‹</p>
<blockquote>
<p>è°ƒè§£å‘˜æ¨¡å¼æ·»åŠ äº†ç¬¬ä¸‰æ–¹å¯¹è±¡ï¼ˆç§°ä½œè°ƒè§£å‘˜ï¼‰ç”¨äºæ§åˆ¶ä¸¤ä¸ªå¯¹è±¡ï¼ˆç§°ä½œåŒäº‹ï¼‰ä¹‹é—´çš„äº¤äº’ã€‚å®ƒæœ‰åŠ©äºå‡å°‘å½¼æ­¤é€šä¿¡çš„ç±»ä¹‹é—´çš„è€¦åˆã€‚å› ä¸ºä»–ä»¬ä¸éœ€è¦äº†è§£å½¼æ­¤çš„å®ç°ã€‚</p>
</blockquote>
<p>ç»´åŸºè¯´</p>
<blockquote>
<p>è½¯ä»¶å·¥ç¨‹ä¸­ï¼Œè°ƒè§£å‘˜æ¨¡å¼å®šä¹‰äº†ä¸€ä¸ªå¯¹è±¡ï¼Œè¯¥å¯¹è±¡å°è£…äº†ä¸€ç»„å¯¹è±¡çš„äº¤äº’æ–¹å¼ã€‚ç”±äºè¯¥æ¨¡å¼å¯ä»¥æ›´æ”¹ç¨‹åºè¿è¡Œè¡Œä¸ºï¼Œå› æ­¤è¯¥æ¨¡å¼è¢«è§†ä¸ºè¡Œä¸ºæ¨¡å¼ã€‚</p>
</blockquote>
<p><strong>ç¨‹åºç¤ºä¾‹</strong></p>
<p>è¿™æ˜¯ä¸€ä¸ªç®€å•çš„èŠå¤©å®¤ï¼ˆå³è°ƒè§£å‘˜ï¼‰ä¸­çš„ç”¨æˆ·ï¼ˆå³åŒäº‹ï¼‰äº’ç›¸å‘æ¶ˆæ¯çš„ä¾‹å­ã€‚</p>
<p>é¦–å…ˆï¼Œå®ç°è°ƒè§£å‘˜æ¥å£ï¼Œå³èŠå¤©å®¤ã€‚</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">interface</span> <span class="title">ChatRoomMediator</span> </span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">showMessage</span><span class="params">(User $user, string $message)</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Mediator</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ChatRoom</span> <span class="keyword">implements</span> <span class="title">ChatRoomMediator</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">showMessage</span><span class="params">(User $user, string $message)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $time = date(<span class="string">'M d, y H:i'</span>);</span><br><span class="line">        $sender = $user-&gt;getName();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">echo</span> $time . <span class="string">'['</span> . $sender . <span class="string">']:'</span> . $message;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç„¶åæ˜¯ç”¨æˆ·ï¼Œå³åŒäº‹</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line">    <span class="keyword">protected</span> $name;</span><br><span class="line">    <span class="keyword">protected</span> $chatMediator;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">(string $name, ChatRoomMediator $chatMediator)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;name = $name;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;chatMediator = $chatMediator;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">send</span><span class="params">($message)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;chatMediator-&gt;showMessage(<span class="keyword">$this</span>, $message);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç”¨ä¾‹</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">$mediator = <span class="keyword">new</span> ChatRoom();</span><br><span class="line"></span><br><span class="line">$john = <span class="keyword">new</span> User(<span class="string">'John Doe'</span>, $mediator);</span><br><span class="line">$jane = <span class="keyword">new</span> User(<span class="string">'Jane Doe'</span>, $mediator);</span><br><span class="line"></span><br><span class="line">$john-&gt;send(<span class="string">'Hi there!'</span>);</span><br><span class="line">$jane-&gt;send(<span class="string">'Hey!'</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Output will be</span></span><br><span class="line"><span class="comment">// Feb 14, 10:58 [John]: Hi there!</span></span><br><span class="line"><span class="comment">// Feb 14, 10:58 [Jane]: Hey!</span></span><br></pre></td></tr></table></figure>
<h3 id="ğŸ’¾-å¤‡å¿˜å½•"><a href="#ğŸ’¾-å¤‡å¿˜å½•" class="headerlink" title="ğŸ’¾ å¤‡å¿˜å½•"></a>ğŸ’¾ å¤‡å¿˜å½•</h3><p>ç°å®ä¾‹å­</p>
<blockquote>
<p>ä¸¾ä¸€ä¸ªè®¡ç®—å™¨çš„ä¾‹å­ï¼Œè®¡ç®—å™¨ï¼ˆå³ originator ï¼‰åœ¨è¿™é‡Œæ¯æ‰§è¡Œä¸€äº›è¿ç®—ï¼Œæœ€åçš„ç»“æœéƒ½ä¼šä¿å­˜åœ¨å†…å­˜ä¸­ï¼ˆå³å¤‡å¿˜å½•ï¼‰ï¼Œä»¥ä¾¿ä½ è¿”å›å®ƒï¼Œè¿˜å¯ä»¥ç”¨æŸäº›æ“ä½œæŒ‰é’®ï¼ˆå³çœ‹å®ˆè€…ï¼‰å°†å…¶æ¢å¤ã€‚</p>
</blockquote>
<p>ç®€è€Œè¨€ä¹‹</p>
<blockquote>
<p>å¤‡å¿˜å½•æ¨¡å¼æ˜¯å…³äºæ•è·å’Œå­˜å‚¨å¯¹è±¡çš„å½“å‰çŠ¶æ€çš„æ–¹å¼ï¼Œä»¥ä¾¿ä¹‹åå¯ä»¥å¹³æ»‘åœ°æ¢å¤å®ƒã€‚</p>
</blockquote>
<p>ç»´åŸºè¯´</p>
<blockquote>
<p>å¤‡å¿˜å½•æ¨¡å¼æ˜¯ä¸€ç§è½¯ä»¶è®¾è®¡æ¨¡å¼ï¼Œå®ƒæä¾›äº†å°†å¯¹è±¡æ¢å¤åˆ°å…¶å…ˆå‰çŠ¶æ€ï¼ˆå›æ»šæ’¤é”€ï¼‰çš„èƒ½åŠ›ã€‚</p>
</blockquote>
<p>é€šå¸¸åœ¨éœ€è¦æä¾›æŸç§æ’¤é”€åŠŸèƒ½æ—¶å¾ˆæœ‰ç”¨ã€‚</p>
<p><strong>ç¨‹åºç¤ºä¾‹</strong></p>
<p>æˆ‘ä»¬ä»¥æ–‡æœ¬ç¼–è¾‘å™¨ä¸ºä¾‹ï¼Œè¯¥ç¼–è¾‘å™¨ä¸æ—¶ä¿å­˜çŠ¶æ€ï¼Œå¹¶å¯ä»¥æ ¹æ®éœ€è¦è¿›è¡Œæ¢å¤ã€‚</p>
<p>é¦–å…ˆæ˜¯ä¿å­˜ç¼–è¾‘å™¨çŠ¶æ€çš„å¤‡å¿˜å½•å¯¹è±¡ã€‚</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">EditorMemento</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">protected</span> $content;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">(string $content)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;content = $content;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getContent</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;content;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æ¥ç€æˆ‘ä»¬çš„ç¼–è¾‘å™¨ï¼Œå³ originator ï¼Œå°†è¦ä½¿ç”¨è¿™ä¸ªå¤‡å¿˜å½•å¯¹è±¡ã€‚</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Editor</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">protected</span> $content = <span class="string">''</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">type</span><span class="params">(string $words)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;content = <span class="keyword">$this</span>-&gt;content . <span class="string">' '</span> . $words;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getContent</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;content;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">save</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> EditorMemento(<span class="keyword">$this</span>-&gt;content);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">restore</span><span class="params">(EditorMemento $memento)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;content = $memento-&gt;getContent();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æ¥ç€è¿™ä¹ˆç”¨</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">$editor = <span class="keyword">new</span> Editor();</span><br><span class="line"></span><br><span class="line"><span class="comment">// Type some stuff</span></span><br><span class="line">$editor-&gt;type(<span class="string">'This is the first sentence.'</span>);</span><br><span class="line">$editor-&gt;type(<span class="string">'This is second.'</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Save the state to restore to : This is the first sentence. This is second.</span></span><br><span class="line">$saved = $editor-&gt;save();</span><br><span class="line"></span><br><span class="line"><span class="comment">// Type some more</span></span><br><span class="line">$editor-&gt;type(<span class="string">'And this is third.'</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Output: Content before Saving</span></span><br><span class="line"><span class="keyword">echo</span> $editor-&gt;getContent(); <span class="comment">// This is the first sentence. This is second. And this is third.</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Restoring to last saved state</span></span><br><span class="line">$editor-&gt;restore($saved);</span><br><span class="line"></span><br><span class="line">$editor-&gt;getContent(); <span class="comment">// This is the first sentence. This is second.</span></span><br></pre></td></tr></table></figure>
<h3 id="ğŸ˜-è§‚å¯Ÿè€…"><a href="#ğŸ˜-è§‚å¯Ÿè€…" class="headerlink" title="ğŸ˜ è§‚å¯Ÿè€…"></a>ğŸ˜ è§‚å¯Ÿè€…</h3><p>ç°å®ä¾‹å­</p>
<blockquote>
<p>æ‰¾å·¥ä½œçš„äººåœ¨èŒä½å‘å¸ƒç½‘ç«™ä¸Šè®¢é˜…ï¼Œè·å¾—åŒ¹é…çš„å·¥ä½œæœºä¼šæ—¶ï¼Œä»–ä»¬å¯ä»¥æ”¶åˆ°æ¶ˆæ¯ã€‚</p>
</blockquote>
<p>ç®€è€Œè¨€ä¹‹</p>
<blockquote>
<p>å®šä¹‰å¯¹è±¡ä¹‹é—´çš„ä¾èµ–å…³ç³»ï¼Œä»¥ä¾¿æ¯å½“å¯¹è±¡æ”¹å˜çŠ¶æ€æ—¶ï¼Œéƒ½ä¼šé€šçŸ¥å…¶æ‰€æœ‰ä¾èµ–å¯¹è±¡ã€‚</p>
</blockquote>
<p>ç»´åŸºè¯´</p>
<blockquote>
<p>è§‚å¯Ÿè€…æ¨¡å¼æ˜¯ä¸€ç§è½¯ä»¶è®¾è®¡æ¨¡å¼ï¼Œå…¶ä¸­å¯¹è±¡ï¼ˆç§°ä¸ºä¸»é¢˜ï¼‰ç»´æŠ¤å…¶ä¾èµ–é¡¹çš„åˆ—è¡¨ï¼ˆç§°ä¸ºè§‚å¯Ÿè€…ï¼‰ï¼Œå¹¶é€šè¿‡è°ƒç”¨å…¶æ–¹æ³•æ¥è‡ªåŠ¨å°†çŠ¶æ€æ›´æ”¹é€šçŸ¥ä»–ä»¬ã€‚</p>
</blockquote>
<p><strong>ç¨‹åºç¤ºä¾‹</strong></p>
<p>å®ç°ä¸Šé¢çš„ä¾‹å­ï¼Œé¦–å…ˆï¼Œéœ€è¦å‘å¸ƒé€šçŸ¥ç»™æ±‚èŒè€…ã€‚</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">JobPost</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">protected</span> $title;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">(string $title)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;title = $title;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getTitle</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;title;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">JobSeeker</span> <span class="keyword">implements</span> <span class="title">Observer</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">protected</span> $name;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">(string $name)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;name = $name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">onJobPosted</span><span class="params">(JobPost $job)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="comment">// Do something with the job posting</span></span><br><span class="line">        <span class="keyword">echo</span> <span class="string">'Hi '</span> . <span class="keyword">$this</span>-&gt;name . <span class="string">'! New job posted: '</span>. $job-&gt;getTitle();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç„¶åæ±‚èŒè€…å°†è®¢é˜…èŒä½æ¶ˆæ¯</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">EmploymentAgency</span> <span class="keyword">implements</span> <span class="title">Observable</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">protected</span> $observers = [];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">protected</span> <span class="function"><span class="keyword">function</span> <span class="title">notify</span><span class="params">(JobPost $jobPosting)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">foreach</span> (<span class="keyword">$this</span>-&gt;observers <span class="keyword">as</span> $observer) &#123;</span><br><span class="line">            $observer-&gt;onJobPosted($jobPosting);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">attach</span><span class="params">(Observer $observer)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;observers[] = $observer;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">addJob</span><span class="params">(JobPost $jobPosting)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;notify($jobPosting);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç”¨ä¾‹</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">// Create subscribers</span></span><br><span class="line">$johnDoe = <span class="keyword">new</span> JobSeeker(<span class="string">'John Doe'</span>);</span><br><span class="line">$janeDoe = <span class="keyword">new</span> JobSeeker(<span class="string">'Jane Doe'</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Create publisher and attach subscribers</span></span><br><span class="line">$jobPostings = <span class="keyword">new</span> EmploymentAgency();</span><br><span class="line">$jobPostings-&gt;attach($johnDoe);</span><br><span class="line">$jobPostings-&gt;attach($janeDoe);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Add a new job and see if subscribers get notified</span></span><br><span class="line">$jobPostings-&gt;addJob(<span class="keyword">new</span> JobPost(<span class="string">'Software Engineer'</span>));</span><br><span class="line"></span><br><span class="line"><span class="comment">// Output</span></span><br><span class="line"><span class="comment">// Hi John Doe! New job posted: Software Engineer</span></span><br><span class="line"><span class="comment">// Hi Jane Doe! New job posted: Software Engineer</span></span><br></pre></td></tr></table></figure>
<h3 id="ğŸƒ-è®¿é—®è€…"><a href="#ğŸƒ-è®¿é—®è€…" class="headerlink" title="ğŸƒ è®¿é—®è€…"></a>ğŸƒ è®¿é—®è€…</h3><p>å®é™…ä¾‹å­</p>
<blockquote>
<p>åŠ å…¥æœ‰äººè¦å»è¿ªæ‹œæ—…æ¸¸ï¼Œä»–ä»¬éœ€è¦ä¸€ç§è¿›å…¥è¿ªæ‹œçš„æ–¹å¼ï¼ˆå³ç­¾è¯ï¼‰ã€‚æŠµè¾¾ä¹‹åï¼Œä»–ä»¬å¯ä»¥ç‹¬è‡ªå‰å¾€è¿ªæ‹œçš„ä»»ä½•åœ°æ–¹ï¼Œè€Œä¸éœ€è¦è·‘è…¿æè®¸å¯è¯ï¼›åªè¦å‘Šè¯‰ä»–ä»¬åœ°åï¼Œå°±å¯ä»¥å»å‚è§‚ã€‚è®¿é—®è€…æ¨¡å¼è®©ä½ åšåˆ°è¿™ä¸€ç‚¹ï¼Œå®ƒå¯ä»¥å¸®åŠ©ä½ æ·»åŠ æ¸¸è§ˆçš„åœ°ç‚¹ï¼Œä»¥ä¾¿ä»–ä»¬å¯ä»¥å°½å¯èƒ½å¤šè®¿é—®è€Œä¸éœ€è¦åšä»»ä½•ç¹ççš„å·¥ä½œã€‚</p>
</blockquote>
<p>ç®€è€Œè¨€ä¹‹</p>
<blockquote>
<p>è®¿é—®è€…æ¨¡å¼ä½¿ä½ å¯ä»¥ç»™å¯¹è±¡æ·»åŠ è¿›ä¸€æ­¥çš„æ“ä½œï¼Œè€Œæ— éœ€ä¿®æ”¹å®ƒä»¬ã€‚</p>
</blockquote>
<p>ç»´åŸºè¯´</p>
<blockquote>
<p>åœ¨é¢å‘å¯¹è±¡ç¨‹åºè®¾è®¡ä¸­ï¼Œè®¿é—®è€…è®¾è®¡æ¨¡å¼æ—¶ä¸€ç§å°†ç®—æ³•å’Œæ“ä½œå¯¹è±¡çš„ç»“æ„åˆ†ç¦»çš„æ–¹æ³•ã€‚è¿™ç§åˆ†ç¦»çš„å®é™…ç»“æœæ˜¯èƒ½å¤Ÿåœ¨ä¸ä¿®æ”¹è¿™äº›å¯¹è±¡ç»“æ„çš„æƒ…å†µä¸‹å‘ç°æœ‰å¯¹è±¡ç»“æ„æ·»åŠ æ–°æ“ä½œã€‚è¿™æ˜¯éµå¾ªå¼€é—­åŸåˆ™ï¼ˆOpen Closed Principleï¼‰çš„ä¸€ç§æ–¹æ³•ã€‚</p>
</blockquote>
<p><strong>ç¨‹åºç¤ºä¾‹</strong></p>
<p>æˆ‘ä»¬æ¥æ¨¡æ‹Ÿä¸€æ‰€åŠ¨ç‰©å›­ï¼Œå…¶ä¸­æœ‰å‡ ç§ä¸åŒçš„åŠ¨ç‰©ï¼Œæˆ‘ä»¬å¿…é¡»èµ‹äºˆå®ƒä»¬å£°éŸ³ã€‚ä¸‹é¢ç”¨è®¿é—®è€…æ¨¡å¼æ¥å®ç°å®ƒã€‚</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">// Visitee</span></span><br><span class="line"><span class="class"><span class="keyword">interface</span> <span class="title">Animal</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">accept</span><span class="params">(AnimalOperation $operation)</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Visitor</span></span><br><span class="line"><span class="class"><span class="keyword">interface</span> <span class="title">AnimalOperation</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">visitMonkey</span><span class="params">(Monkey $monkey)</span></span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">visitLion</span><span class="params">(Lion $lion)</span></span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">visitDolphin</span><span class="params">(Dolphin $dolphin)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å®ç°è¿™äº›åŠ¨ç‰©</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Monkey</span> <span class="keyword">implements</span> <span class="title">Animal</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">shout</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">'Ooh oo aa aa!'</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">accept</span><span class="params">(AnimalOperation $operation)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $operation-&gt;visitMonkey(<span class="keyword">$this</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Lion</span> <span class="keyword">implements</span> <span class="title">Animal</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">roar</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">'Roaaar!'</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">accept</span><span class="params">(AnimalOperation $operation)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $operation-&gt;visitLion(<span class="keyword">$this</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Dolphin</span> <span class="keyword">implements</span> <span class="title">Animal</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">speak</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">'Tuut tuttu tuutt!'</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">accept</span><span class="params">(AnimalOperation $operation)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $operation-&gt;visitDolphin(<span class="keyword">$this</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å®ç°è®¿é—®è€…</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Speak</span> <span class="keyword">implements</span> <span class="title">AnimalOperation</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">visitMonkey</span><span class="params">(Monkey $monkey)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $monkey-&gt;shout();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">visitLion</span><span class="params">(Lion $lion)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $lion-&gt;roar();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">visitDolphin</span><span class="params">(Dolphin $dolphin)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $dolphin-&gt;speak();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿™æ ·ç”¨</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">$monkey = <span class="keyword">new</span> Monkey();</span><br><span class="line">$lion = <span class="keyword">new</span> Lion();</span><br><span class="line">$dolphin = <span class="keyword">new</span> Dolphin();</span><br><span class="line"></span><br><span class="line">$speak = <span class="keyword">new</span> Speak();</span><br><span class="line"></span><br><span class="line">$monkey-&gt;accept($speak);    <span class="comment">// Ooh oo aa aa!    </span></span><br><span class="line">$lion-&gt;accept($speak);      <span class="comment">// Roaaar!</span></span><br><span class="line">$dolphin-&gt;accept($speak);   <span class="comment">// Tuut tutt tuutt!</span></span><br></pre></td></tr></table></figure>
<p>æˆ‘ä»¬å¯ä»¥é€šè¿‡å¯¹åŠ¨ç‰©å…·æœ‰ç»§æ‰¿å±‚æ¬¡ç»“æ„æ¥ç®€å•åœ°åšåˆ°è¿™ä¸€ç‚¹ï¼Œä½†æ˜¯æ¯å½“æˆ‘ä»¬å¿…é¡»å‘åŠ¨ç‰©æ·»åŠ æ–°åŠ¨ä½œæ—¶ï¼Œå°±å¿…é¡»ä¿®æ”¹åŠ¨ç‰©ã€‚ä½†æ˜¯ç°åœ¨æˆ‘ä»¬ä¸å¿…æ›´æ”¹å®ƒä»¬ã€‚ä¾‹å¦‚ï¼šå‡è®¾æˆ‘ä»¬è¢«è¦æ±‚å°†è·³è·ƒè¡Œä¸ºæ·»åŠ åˆ°åŠ¨ç‰©ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ç®€å•åœ°é€šè¿‡åˆ›å»ºä¸€ä¸ªæ–°çš„è®¿é—®è€…æ¥æ·»åŠ å®ƒï¼Œå³ï¼š</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Jump</span> <span class="keyword">implements</span> <span class="title">AnimalOperation</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">visitMonkey</span><span class="params">(Monkey $monkey)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">'Jumped 20 feet high! on to the tree!'</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">visitLion</span><span class="params">(Lion $lion)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">'Jumped 7 feet! Back on the ground!'</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">visitDolphin</span><span class="params">(Dolphin $dolphin)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">'Walked on water a little and disappeared'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä½¿ç”¨</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">$jump = <span class="keyword">new</span> Jump();</span><br><span class="line"></span><br><span class="line">$monkey-&gt;accept($speak);   <span class="comment">// Ooh oo aa aa!</span></span><br><span class="line">$monkey-&gt;accept($jump);    <span class="comment">// Jumped 20 feet high! on to the tree!</span></span><br><span class="line"></span><br><span class="line">$lion-&gt;accept($speak);     <span class="comment">// Roaaar!</span></span><br><span class="line">$lion-&gt;accept($jump);      <span class="comment">// Jumped 7 feet! Back on the ground!</span></span><br><span class="line"></span><br><span class="line">$dolphin-&gt;accept($speak);  <span class="comment">// Tuut tutt tuutt!</span></span><br><span class="line">$dolphin-&gt;accept($jump);   <span class="comment">// Walked on water a little and disappeared</span></span><br></pre></td></tr></table></figure>
<h3 id="ğŸ’¡-ç­–ç•¥"><a href="#ğŸ’¡-ç­–ç•¥" class="headerlink" title="ğŸ’¡ ç­–ç•¥"></a>ğŸ’¡ ç­–ç•¥</h3><p>ç°å®ä¾‹å­</p>
<blockquote>
<p>è€ƒè™‘ä¸€ä¸ªæ’åºçš„ä¾‹å­ï¼Œæˆ‘ä»¬å®ç°äº†å†’æ³¡æ’åºï¼Œä½†æ˜¯éšç€æ•°æ®çš„å¢é•¿ï¼Œå†’æ³¡æ’åºè¶Šæ¥è¶Šæ…¢ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å®ç°äº†å¿«æ’ã€‚ä½†æ˜¯ç°åœ¨ï¼Œå°½ç®¡å¿«é€Ÿæ’åºç®—æ³•å¯¹å¤§å‹æ•°æ®é›†è¡¨ç°æ›´å¥½ï¼Œä½†æ˜¯å¯¹äºè¾ƒå°æ•°æ®é›†å´å¾ˆæ…¢ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å®ç°äº†ä¸€ç§ç­–ç•¥ï¼Œå¯¹äºå°å‹æ•°æ®é›†ï¼Œä½¿ç”¨å†’æ³¡æ’åºï¼Œè€Œå¯¹äºè¾ƒå¤§çš„ä½¿ç”¨å¿«æ’ã€‚</p>
</blockquote>
<p>ç®€è€Œè¨€ä¹‹</p>
<blockquote>
<p>ç­–ç•¥æ¨¡å¼å¯ä»¥æ ¹æ®æƒ…å†µåˆ‡æ¢ç®—æ³•æˆ–ç­–ç•¥ã€‚</p>
</blockquote>
<p>ç»´åŸºè¯´</p>
<blockquote>
<p>åœ¨è®¡ç®—æœºç¼–ç¨‹ä¸­ï¼Œç­–ç•¥ï¼ˆstrategyï¼‰æ¨¡å¼ï¼ˆä¹Ÿç§°ä¸ºç­–ç•¥ï¼ˆpolicyï¼‰æ¨¡å¼ï¼‰æ˜¯ä¸€ç§è¡Œä¸ºå‹æ¨¡å¼ï¼Œå¯ä»¥åœ¨è¿è¡Œæ—¶é€‰æ‹©ç®—æ³•è¡Œä¸ºã€‚</p>
</blockquote>
<p><strong>ç¨‹åºç¤ºä¾‹</strong></p>
<p>é¦–å…ˆå¯¹æˆ‘ä»¬æµ‹ç­–ç•¥æ¥å£åšå‡ºä¸åŒå®ç°ã€‚</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">interface</span> <span class="title">SortStrategy</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">sort</span><span class="params">(array $dataset)</span>: <span class="title">array</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BubbleSortStrategy</span> <span class="keyword">implements</span> <span class="title">SortStrategy</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">sort</span><span class="params">(array $dataset)</span>: <span class="title">array</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"Sorting using bubble sort"</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Do sorting</span></span><br><span class="line">        <span class="keyword">return</span> $dataset;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">QuickSortStrategy</span> <span class="keyword">implements</span> <span class="title">SortStrategy</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">sort</span><span class="params">(array $dataset)</span>: <span class="title">array</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"Sorting using quick sort"</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Do sorting</span></span><br><span class="line">        <span class="keyword">return</span> $dataset;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç„¶åå®¢æˆ·å¯ä»¥ä½¿ç”¨ä»»æ„ç­–ç•¥</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Sorter</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">protected</span> $sorter;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">(SortStrategy $sorter)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;sorter = $sorter;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">sort</span><span class="params">(array $dataset)</span>: <span class="title">array</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;sorter-&gt;sort($dataset);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç”¨æ³•</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">$dataset = [<span class="number">1</span>, <span class="number">5</span>, <span class="number">4</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">8</span>];</span><br><span class="line"></span><br><span class="line">$sorter = <span class="keyword">new</span> Sorter(<span class="keyword">new</span> BubbleSortStrategy());</span><br><span class="line">$sorter-&gt;sort($dataset); <span class="comment">// Output : Sorting using bubble sort</span></span><br><span class="line"></span><br><span class="line">$sorter = <span class="keyword">new</span> Sorter(<span class="keyword">new</span> QuickSortStrategy());</span><br><span class="line">$sorter-&gt;sort($dataset); <span class="comment">// Output : Sorting using quick sort</span></span><br></pre></td></tr></table></figure>
<h3 id="ğŸ’¢-çŠ¶æ€"><a href="#ğŸ’¢-çŠ¶æ€" class="headerlink" title="ğŸ’¢ çŠ¶æ€"></a>ğŸ’¢ çŠ¶æ€</h3><p>å®é™…ä¾‹å­</p>
<blockquote>
<p>å‡è®¾ä½ æ­£åœ¨ä½¿ç”¨æŸäº›ç»˜å›¾ç¨‹åºï¼Œç»˜ç”»æ—¶é€‰æ‹©ç”»ç¬”ã€‚ç°åœ¨ï¼Œç”»ç¬”å°†æ ¹æ®æ‰€é€‰é¢œè‰²æ›´æ”¹å…¶è¡Œä¸ºï¼Œå³å¦‚æœé€‰æ‹©çº¢è‰²ï¼Œå®ƒå°†ç»˜åˆ¶ä¸ºçº¢è‰²ï¼Œé€‰æ‹©è“è‰²ï¼Œåˆ™å°†ç»˜åˆ¶ä¸ºè“è‰²ç­‰ã€‚</p>
</blockquote>
<p>ç®€è€Œè¨€ä¹‹</p>
<blockquote>
<p>å½“çŠ¶æ€æ”¹å˜æ—¶ï¼Œå®ƒå…è®¸ä½ æ”¹å˜ç±»çš„è¡Œä¸ºã€‚</p>
</blockquote>
<p>ç»´åŸºè¯´</p>
<blockquote>
<p>çŠ¶æ€æ¨¡å¼æ˜¯ä¸€ç§è¡Œä¸ºè½¯ä»¶è®¾è®¡æ¨¡å¼ï¼Œå®ƒä»¥é¢å‘å¯¹è±¡çš„æ–¹å¼å®ç°çŠ¶æ€æœºã€‚ä½¿ç”¨çŠ¶æ€æ¨¡å¼ï¼Œé€šè¿‡å°†æ¯ä¸ªå•ç‹¬çš„çŠ¶æ€å®ç°ä¸ºçŠ¶æ€æ¨¡å¼æ¥å£çš„æ´¾ç”Ÿç±»ï¼Œå¹¶é€šè¿‡è°ƒç”¨æ¨¡å¼çš„è¶…ç±»æ‰€å®šä¹‰çš„æ–¹æ³•æ¥å®ç°çŠ¶æ€è½¬æ¢ã€‚çŠ¶æ€æ¨¡å¼å¯ä»¥è§£é‡Šä¸ºç­–ç•¥æ¨¡å¼ï¼Œè¯¥æ¨¡å¼èƒ½å¤Ÿé€šè¿‡è°ƒç”¨æ¨¡å¼æ¥å£ä¸­å®šä¹‰çš„æ–¹æ³•æ¥åˆ‡æ¢å½“å‰ç­–ç•¥ã€‚</p>
</blockquote>
<p><strong>ç¨‹åºç¤ºä¾‹</strong></p>
<p>å†ç”¨æ–‡æœ¬ç¼–è¾‘å™¨çš„ä¾‹å­ï¼Œå®ƒä½¿ä½ å¯ä»¥æ”¹å˜é”®å…¥æ–‡æœ¬çš„çŠ¶æ€ï¼Œé€‰æ‹©æ–œä½“ï¼Œå°†ä»¥æ–œä½“æ˜¾ç¤ºï¼›å¦‚æœé€‰æ‹©ç²—ä½“ï¼Œå°†ä»¥ç²—ä½“æ˜¾ç¤ºã€‚</p>
<p>é¦–å…ˆæ˜¯çŠ¶æ€æ¥å£åŠå…¶å®ç°ã€‚</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">interface</span> <span class="title">WritingState</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">write</span><span class="params">(string $words)</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">UpperCase</span> <span class="keyword">implements</span> <span class="title">WritingState</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">write</span><span class="params">(string $words)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> strtoupper($words);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">LowerCase</span> <span class="keyword">implements</span> <span class="title">WritingState</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">write</span><span class="params">(string $words)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> strtolower($words);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">DefaultText</span> <span class="keyword">implements</span> <span class="title">WritingState</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">write</span><span class="params">(string $words)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> $words;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æ¥ç€æ˜¯ç¼–è¾‘å™¨</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TextEditor</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">protected</span> $state;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">(WritingState $state)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;state = $state;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">setState</span><span class="params">(WritingState $state)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;state = $state;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">type</span><span class="params">(string $words)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;state-&gt;write($words);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä½¿ç”¨</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">$editor = <span class="keyword">new</span> TextEditor(<span class="keyword">new</span> DefaultText());</span><br><span class="line"></span><br><span class="line">$editor-&gt;type(<span class="string">'First line'</span>);</span><br><span class="line"></span><br><span class="line">$editor-&gt;setState(<span class="keyword">new</span> UpperCase());</span><br><span class="line"></span><br><span class="line">$editor-&gt;type(<span class="string">'Second line'</span>);</span><br><span class="line">$editor-&gt;type(<span class="string">'Third line'</span>);</span><br><span class="line"></span><br><span class="line">$editor-&gt;setState(<span class="keyword">new</span> LowerCase());</span><br><span class="line"></span><br><span class="line">$editor-&gt;type(<span class="string">'Fourth line'</span>);</span><br><span class="line">$editor-&gt;type(<span class="string">'Fifth line'</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Output:</span></span><br><span class="line"><span class="comment">// First line</span></span><br><span class="line"><span class="comment">// SECOND LINE</span></span><br><span class="line"><span class="comment">// THIRD LINE</span></span><br><span class="line"><span class="comment">// fourth line</span></span><br><span class="line"><span class="comment">// fifth line</span></span><br></pre></td></tr></table></figure>
<h3 id="ğŸ“’-æ¨¡æ¿æ–¹æ³•"><a href="#ğŸ“’-æ¨¡æ¿æ–¹æ³•" class="headerlink" title="ğŸ“’ æ¨¡æ¿æ–¹æ³•"></a>ğŸ“’ æ¨¡æ¿æ–¹æ³•</h3><p>å®é™…ä¾‹å­</p>
<blockquote>
<p>å‡è®¾æˆ‘ä»¬è¦é€ æˆ¿å­ï¼Œæ„å»ºæ­¥éª¤å¯èƒ½å¦‚ä¸‹ï¼š</p>
<ul>
<li>æ‰“åœ°åŸº</li>
<li>ç Œå¢™</li>
<li>åŠ å±‹é¡¶</li>
<li>æ·»åŠ å…¶ä»–æ¥¼å±‚</li>
</ul>
<p>è¿™äº›æ­¥éª¤çš„é¡ºåºæ˜¯ä¸ä¼šæ”¹å˜çš„ï¼Œå³ä½ ä¸å¯ä»¥åœ¨ç Œå¢™ä¹‹å‰ç›–å±‹é¡¶ï¼Œä½†æ˜¯æ¯ä¸ªæ­¥éª¤å¯ä»¥ä¿®æ”¹ï¼Œä¾‹å¦‚å¢™å£å¯ä»¥ç”±æœ¨å¤´ã€èšé…¯æˆ–çŸ³å¤´åˆ¶æˆã€‚</p>
</blockquote>
<p>ç®€è€Œè¨€ä¹‹</p>
<blockquote>
<p>æ¨¡æ¿æ–¹æ³•å®šä¹‰äº†å¦‚ä½•æ‰§è¡ŒæŸç§ç®—æ³•çš„æ¡†æ¶ï¼Œä½†æ˜¯å°†è¿™äº›æ­¥éª¤çš„å®ç°äº¤ç»™å­—ç±»ã€‚</p>
</blockquote>
<p>ç»´åŸºè¯´</p>
<blockquote>
<p>è½¯ä»¶å·¥ç¨‹é¢†åŸŸï¼Œæ¨¡æ¿æ–¹æ³•æ¨¡å¼æ˜¯ä¸€ç§è¡Œä¸ºå‹æ¨¡å¼ï¼Œç”¨äºå®šä¹‰æ“ä½œä¸­ç®—æ³•çš„ç¨‹åºæ¡†æ¶ï¼Œä»è€Œå°†æŸäº›æ­¥éª¤æ¨è¿Ÿåˆ°å­ç±»ä¸­ã€‚</p>
</blockquote>
<p><strong>ç¨‹åºç¤ºä¾‹</strong></p>
<p>è®¾æƒ³æˆ‘ä»¬æœ‰ä¸€ä¸ªæ„å»ºå·¥å…·å¯ä»¥å¸®åŠ©æˆ‘ä»¬æµ‹è¯•ã€æ•´ç†ã€æ„å»ºï¼Œç”ŸæˆæŠ¥å‘Šï¼ˆå³è¦†ç›–ç‡æŠ¥å‘Šï¼Œlint æŠ¥å‘Šç­‰ï¼‰å¹¶ä¸”å°†æˆ‘ä»¬çš„ç¨‹åºéƒ¨ç½²åœ¨æµ‹è¯•æœåŠ¡å™¨ä¸Šã€‚</p>
<p>é¦–å…ˆï¼Œæ­å»ºåŸºç±»ï¼Œå®ƒæŒ‡å®šæ„å»ºç®—æ³•çš„æ¡†æ¶ã€‚</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Builder</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="comment">// Template method</span></span><br><span class="line">    <span class="keyword">final</span> <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">build</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;test();</span><br><span class="line">        <span class="keyword">$this</span>-&gt;lint();</span><br><span class="line">        <span class="keyword">$this</span>-&gt;assemble();</span><br><span class="line">        <span class="keyword">$this</span>-&gt;deploy();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">abstract</span> <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">test</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="keyword">abstract</span> <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">lint</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="keyword">abstract</span> <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">assemble</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="keyword">abstract</span> <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">deploy</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å®ç°æ¥å£</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">AndroidBuilder</span> <span class="keyword">extends</span> <span class="title">Builder</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">test</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">'Running android tests'</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">lint</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">'Linting the android code'</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">assemble</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">'Assembling the android build'</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">deploy</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">'Deploying android build to server'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">IosBuilder</span> <span class="keyword">extends</span> <span class="title">Builder</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">test</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">'Running ios tests'</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">lint</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">'Linting the ios code'</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">assemble</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">'Assembling the ios build'</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">deploy</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">'Deploying ios build to server'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç”¨æ³•</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">$androidBuilder = <span class="keyword">new</span> AndroidBuilder();</span><br><span class="line">$androidBuilder-&gt;build();</span><br><span class="line"></span><br><span class="line"><span class="comment">// Output:</span></span><br><span class="line"><span class="comment">// Running android tests</span></span><br><span class="line"><span class="comment">// Linting the android code</span></span><br><span class="line"><span class="comment">// Assembling the android build</span></span><br><span class="line"><span class="comment">// Deploying android build to server</span></span><br><span class="line"></span><br><span class="line">$iosBuilder = <span class="keyword">new</span> IosBuilder();</span><br><span class="line">$iosBuilder-&gt;build();</span><br><span class="line"></span><br><span class="line"><span class="comment">// Output:</span></span><br><span class="line"><span class="comment">// Running ios tests</span></span><br><span class="line"><span class="comment">// Linting the ios code</span></span><br><span class="line"><span class="comment">// Assembling the ios build</span></span><br><span class="line"><span class="comment">// Deploying ios build to server</span></span><br></pre></td></tr></table></figure>
<h2 id="æœ€å"><a href="#æœ€å" class="headerlink" title="æœ€å"></a>æœ€å</h2><p>åˆ°æ­¤ä¸ºæ­¢ã€‚æˆ‘å°†ç»§ç»­å¯¹æ­¤è¿›è¡Œæ”¹è¿›ï¼Œä½ å¯ä»¥ watch/star è¿™ä¸ª<a href="https://github.com/kamranahmedse/developer-roadmap/" target="_blank" rel="noopener">ä»“åº“</a>ã€‚ä¹‹åè®¡åˆ’ç¼–å†™æœ‰å…³æ¶æ„æ¨¡å¼çš„æ–‡ç« ï¼Œæ•¬è¯·æœŸå¾…ã€‚</p>
]]></content>
      <tags>
        <tag>translation</tag>
        <tag>design pattern</tag>
      </tags>
  </entry>
  <entry>
    <title>ä½¿ç”¨â€œè¯•é”™æ³•â€è§£å†³é—®é¢˜ï¼ˆè¯‘ï¼‰</title>
    <url>/2020/04/20/trial-and-error/</url>
    <content><![CDATA[<blockquote>
<p>åœ¨ leetcode ä¸Šçœ‹è¯„è®ºæ—¶ï¼Œçœ‹åˆ°ä¸€ç¯‡å†™å¾—å¾ˆå¥½çš„æ–‡ç« ï¼Œå­¦ä¹ ä¸€ä¸‹æ€ç»´æ–¹å¼ï¼Œé¡ºä¾¿ç¿»è¯‘ä¸€ä¸‹ã€‚</p>
</blockquote>
<p><a href="https://leetcode.com/explore/learn/card/binary-search/146/more-practices-ii/1041/discuss/109082/Approach-the-problem-using-the-%22trial-and-error%22-algorithm" target="_blank" rel="noopener">åŸæ–‡ï¼šApproach the problem using the â€œtrial and errorâ€ algorithm</a></p>
<a id="more"></a>
<p><strong>æ›´æ–°</strong>ï¼šå¦‚æœæˆ‘ä»¬æŠŠè¾“å…¥çš„æ•°ç»„æŒ‰å‡åºæ’åˆ—ï¼Œè¿™ä¸ªé—®é¢˜å®é™…ä¸Šå¯ä»¥æ”¹å†™æˆæ‰¾åˆ°æ’åºçŸ©é˜µä¸­çš„ç¬¬ K å°çš„å…ƒç´ ï¼Œåœ¨ <code>(i, j)</code> ä½ç½®çš„çŸ©é˜µå…ƒç´ ç”± <code>matrix[i][j] = nums[j] - nums[i]</code> å¾—å‡ºï¼Œè¿˜æœ‰ <code>k = K + n*(n+1)/2</code> å’Œ <code>n = nums.length</code>ã€‚è¿™ä¸ªé—®é¢˜å°±å¯ä»¥ç”¨æˆ‘<a href="https://leetcode.com/problems/k-th-smallest-prime-fraction/discuss/115819/Summary-of-solutions-for-problems-%22reducible%22-to-LeetCode-378" target="_blank" rel="noopener">ä¹‹å‰å‘å¸–</a>ä¸­çš„å¤šç§ç®—æ³•ï¼ˆä¼˜å…ˆé˜Ÿåˆ— PriorityQueueï¼Œ äºŒåˆ†æœç´¢ BinarySearchï¼Œ ä¹‹å­—å½¢æœç´¢ ZigzagSearchï¼‰æ¥è§£å†³ã€‚</p>
<hr>
<p>é€šå¸¸æˆ‘ä»¬ä¼šé¿å…ä½¿ç”¨å¤©çœŸçš„è¯•é”™ç®—æ³•ï¼ˆ<a href="https://en.wikipedia.org/wiki/Trial_and_error" target="_blank" rel="noopener">trial and error</a>ï¼‰æ¥è§£å†³é—®é¢˜ï¼Œå› ä¸ºå®ƒé€šå¸¸ä¼šå¯¼è‡´ç³Ÿç³•çš„æ—¶é—´å¤æ‚åº¦ã€‚ä½†æ˜¯ï¼Œæœ‰äº›æƒ…å†µä¸‹ï¼Œè¿™ç§å¤©çœŸçš„ç®—æ³•å¯èƒ½èƒœè¿‡å…¶ä»–æ›´å¤æ‚çš„è§£å†³æ–¹æ¡ˆï¼Œè€Œ LeetCode ç¡®å®æœ‰ä¸€äº›è¿™æ ·çš„é—®é¢˜ï¼ˆåœ¨æœ¬æ–‡çš„æœ«å°¾åˆ—å‡º â€”â€” å…·æœ‰è®½åˆºæ„å‘³çš„æ˜¯ï¼Œä»–ä»¬å¤§å¤šæ•°éƒ½æ˜¯â€œéš¾â€é¢˜ï¼‰ã€‚å› æ­¤ï¼Œæˆ‘è§‰å¾—åº”è¯¥åœ¨æ­¤æè¿°åº”ç”¨æ­¤ç®—æ³•çš„ä¸€èˆ¬è¿‡ç¨‹ã€‚</p>
<p>è¯•é”™ç®—æ³•çš„åŸºæœ¬æ€æƒ³å®é™…ä¸Šéå¸¸ç®€å•ï¼Œæ€»ç»“å¦‚ä¸‹ï¼š</p>
<ul>
<li><p>ç¬¬ä¸€æ­¥ï¼šæ„å»ºå€™é€‰è§£å†³æ–¹æ¡ˆã€‚</p>
</li>
<li><p>ç¬¬äºŒæ­¥ï¼šéªŒè¯å®ƒæ˜¯å¦ç¬¦åˆæˆ‘ä»¬çš„è¦æ±‚ã€‚</p>
</li>
<li><p>ç¬¬ä¸‰æ­¥ï¼šå¦‚æœæ˜¯ï¼Œåˆ™æ¥å—è§£å†³æ–¹æ¡ˆï¼›å¦åˆ™ä¸¢å¼ƒå¹¶é‡å¤ç¬¬ä¸€æ­¥ã€‚</p>
</li>
</ul>
<p>ä½†æ˜¯ï¼Œä¸ºäº†ä½¿æ­¤ç®—æ³•æœ‰æ•ˆå·¥ä½œï¼Œéœ€è¦æ»¡è¶³ä»¥ä¸‹ä¸¤ä¸ªæ¡ä»¶ï¼š</p>
<ul>
<li><p>æ¡ä»¶ä¸€ï¼šæˆ‘ä»¬åœ¨<code>ç¬¬äºŒæ­¥</code>ä¸­ä¸€ä¸ªæœ‰æ•ˆçš„éªŒè¯ç®—æ³•ï¼›</p>
</li>
<li><p>æ¡ä»¶äºŒï¼šç”±æ‰€æœ‰å€™é€‰è§£å†³æ–¹æ¡ˆå½¢æˆçš„æœç´¢ç©ºé—´å¾ˆå°ï¼Œæˆ–è€…å¦‚æœå®ƒå¾ˆå¤§ï¼Œæˆ‘ä»¬æœ‰æœ‰æ•ˆçš„æ–¹æ³•æ¥éå†ï¼ˆæˆ–æœç´¢ï¼‰è¿™ä¸ªç©ºé—´ã€‚</p>
</li>
</ul>
<p>ç¬¬ä¸€ä¸ªæ¡ä»¶ç¡®ä¿æ¯ä¸ªéªŒè¯æ“ä½œéƒ½å¯ä»¥å¿«é€Ÿå®Œæˆï¼Œè€Œç¬¬äºŒä¸ªæ¡ä»¶é™åˆ¶äº†éœ€è¦å®Œæˆçš„æ­¤ç±»æ“ä½œçš„æ€»æ•°ã€‚è¿™ä¸¤ä¸ªç»„åˆå°†ä¿è¯æˆ‘ä»¬æœ‰ä¸€ä¸ªæœ‰æ•ˆçš„è¯•é”™ç®—æ³•ï¼ˆè¿™æ„å‘³ç€å¦‚æœä¸èƒ½æ»¡è¶³å…¶ä¸­ä¸€ä¸ªï¼Œä½ ç”šè‡³å¯èƒ½ä¸ä¼šè€ƒè™‘è¿™ä¸ªç®—æ³•ï¼‰ã€‚</p>
<hr>
<p>ç°åœ¨æˆ‘ä»¬æ¥çœ‹çœ‹è¿™ä¸ªé—®é¢˜ï¼š <code>719. Find The K-th Smallest Pair Distance</code>ï¼Œçœ‹çœ‹æˆ‘ä»¬æ€ä¹ˆåº”ç”¨è¯•é”™ç®—æ³•ã€‚</p>
<p><strong>ä¸€ã€ æ„å»ºå€™é€‰è§£å†³æ–¹æ¡ˆ</strong></p>
<p>ä¸ºäº†æ„å»ºå€™é€‰è§£å†³æ–¹æ¡ˆï¼Œæˆ‘ä»¬é¦–å…ˆéœ€è¦äº†è§£æ‰€éœ€çš„è§£å†³æ–¹æ¡ˆã€‚è¿™ä¸ªé—®é¢˜æè¿°è¦æ±‚æˆ‘ä»¬è¾“å‡ºç¬¬ K ä¸ªæœ€å°çš„å¯¹è·ç¦»ï¼ˆpair distanceï¼‰ï¼Œè¿™ä¸è¿‡æ˜¯ä¸€ä¸ªéè´Ÿæ•´æ•°ï¼ˆå› ä¸ºè¾“å…¥æ•°ç»„ nums æ˜¯ä¸€ä¸ªæ•´æ•°æ•°ç»„ï¼Œå¯¹è·ç¦»çš„æ˜¯ç»å¯¹å€¼ï¼‰ã€‚å› æ­¤ï¼Œæˆ‘ä»¬çš„å€™é€‰è§£å†³æ–¹æ¡ˆåº”è¯¥ä¹Ÿæ˜¯éè´Ÿæ•´æ•°ã€‚</p>
<p><strong>äºŒã€ æœç´¢ç©ºé—´ç”±æ‰€æœ‰çš„å€™é€‰è§£å†³æ–¹æ¡ˆç»„æˆ</strong></p>
<p>è®¾ <code>min</code> å’Œ <code>max</code> ä¸ºè¾“å…¥æ•°ç»„ nums ä¸­çš„æœ€å°å’Œæœ€å¤§å€¼ï¼Œå¹¶ä¸” <code>d = max - min</code>ï¼Œç„¶åä»»ä½• nums ä¸­çš„å¯¹è·ç¦»å¿…é¡»ä½äº <code>[0, d]</code> çš„èŒƒå›´ã€‚å› æ­¤ï¼Œæˆ‘ä»¬æ‰€éœ€çš„è§£å†³æ–¹æ¡ˆä¸€å†æ­¤èŒƒå›´å†…ï¼Œè¿™æ„å‘³ç€æœç´¢ç©ºé—´å°†ä¸º<code>[0, d]</code> ï¼ˆè¶…å‡ºæ­¤èŒƒå›´çš„ä»»ä½•æ•°å­—éƒ½å¯ä»¥ç«‹å³æ’é™¤ï¼Œæ— éœ€è¿›ä¸€æ­¥éªŒè¯ï¼‰ã€‚</p>
<p><strong>ä¸‰ã€ éªŒè¯ç»™å®šçš„å€™é€‰è§£å†³æ–¹æ¡ˆ</strong></p>
<p>è¿™æ˜¯è¯•é”™ç®—æ³•çš„å…³é”®éƒ¨åˆ†ã€‚å› æ­¤ï¼Œç»™å®šä¸€ä¸ªå€™é€‰æ•´æ•°ï¼Œæˆ‘ä»¬å¦‚ä½•ç¡®å®šå®ƒæ˜¯å¦æ˜¯ç¬¬ K ä¸ªæœ€å°çš„å¯¹è·ç¦»å‘¢ï¼Ÿ</p>
<p>é¦–å…ˆï¼Œç¬¬ K ä¸ªæœ€å°çš„å¯¹è·ç¦»ç©¶ç«Ÿæ„å‘³ç€ä»€ä¹ˆï¼Ÿæ ¹æ®å®šä¹‰ï¼Œå¦‚æœæˆ‘ä»¬è®¡ç®—æ‰€æœ‰å¯¹è·ç¦»å¹¶æŒ‰ç…§å‡åºæ’åºï¼Œé‚£ä¹ˆç¬¬ K ä¸ªæœ€å°çš„å¯¹è·ç¦»å°†æ˜¯ç´¢å¼• <code>K-1</code> å¤„çš„è·ç¦»ã€‚è¿™å®é™…ä¸Šæ˜¯è§£å†³è¿™ä¸ªé—®é¢˜çš„å¤©çœŸæ–¹å¼ï¼ˆä½†æ˜¯ä¸å‡ºæ‰€æ–™ä¼šå› ä¸º <code>MLE</code> è€Œè¢«æ‹’ç»ï¼‰ã€‚</p>
<p>æ˜¾ç„¶ï¼Œä¸Šè¿°å®šä¹‰ä¸èƒ½ç”¨äºéªŒè¯ï¼Œå› ä¸ºå®ƒéœ€è¦æ˜¾ç¤ºè®¡ç®—å¯¹è·ç¦»æ•°ç»„ã€‚å¹¸è¿çš„æ˜¯ï¼Œè¿˜æœ‰å¦ä¸€ç§æ–¹æ³•æ¥å®šä¹‰ç¬¬ K ä¸ªæœ€å°çš„å¯¹è·ç¦»ï¼šç»™å®šä¸€ä¸ªæ•´æ•° <code>num</code>ï¼Œç”¨ <code>count(num)</code> è¡¨ç¤ºä¸å¤§äº <code>num</code> çš„å¯¹è·ç¦»æ•°ï¼Œåˆ™ç¬¬ K ä¸ªæœ€å°å¯¹è·ç¦»å°†æ˜¯æ»¡è¶³ <code>count(num) &gt;= K</code> çš„æœ€å°æ•´æ•°ã€‚</p>
<p>ä»¥ä¸‹æ˜¯æ›¿ä»£å®šä¹‰ã€‚ä»¤ <code>num_k</code> ä¸ºå…·æœ‰ç´¢å¼• <code>K-1</code> çš„æœ‰åºå¯¹è·ç¦»æ•°ç»„çš„ç¬¬ K ä¸ªå¯¹è·ç¦»ï¼Œå¦‚ç¬¬ä¸€å®šä¹‰ä¸­æ‰€æŒ‡å®šçš„ã€‚ç”±äºç´¢å¼• <code>K-1</code> åŠå…¶ä¹‹å‰çš„æ‰€æœ‰å¯¹è·ç¦»éƒ½ä¸å¤§äº <code>num_k</code> ï¼Œå› æ­¤ <code>count(num_k) &gt;= K</code> ã€‚ç°åœ¨å‡è®¾ <code>num</code> æ˜¯æ»¡è¶³ <code>count(num) &gt;= K</code> æœ€å°çš„æ•´æ•°ï¼Œæˆ‘ä»¬è®¤å®š <code>num</code> å¿…é¡»ç­‰äº <code>num_k</code> ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<ol>
<li>å¦‚æœ <code>num_k &lt; num</code> ï¼Œå› ä¸º <code>count(num) &gt;= K</code> ï¼Œé‚£ä¹ˆ <code>num</code>  å°†ä¸æ˜¯æ»¡è¶³ <code>count(num) &gt;= K</code> çš„æœ€å°æ•´æ•°ï¼Œè¿™ä¸æˆ‘ä»¬å‡è®¾ç›¸çŸ›ç›¾ã€‚</li>
<li>å¦‚æœ <code>num_k &gt; num</code> ï¼Œå› ä¸º <code>count(num) &gt;= K</code> ï¼Œæ ¹æ® <code>count</code> çš„å‡½æ•°å®šä¹‰ï¼Œè‡³å°‘æœ‰ K ä¸ªå¯¹è·ç¦»ä¸å¤§äº <code>num</code> ï¼Œè¿™æ„å‘³ç€è‡³å°‘æœ‰ K ä¸ªå¯¹è·ç¦»å°äº <code>num_k</code> ã€‚è¿™æ„å‘³ç€ <code>num_k</code> ä¸èƒ½æ˜¯ç¬¬ K ä¸ªå¯¹è·ç¦»ï¼Œè¿™å†æ¬¡ä¸æˆ‘ä»¬çš„å‡è®¾çŸ›ç›¾ã€‚</li>
</ol>
<p>åˆ©ç”¨ç¬¬ K ä¸ªæœ€å°å¯¹è·ç¦»çš„è¿™ç§æ›¿ä»£å®šä¹‰ï¼Œæˆ‘ä»¬å¯ä»¥å°†éªŒè¯è¿‡ç¨‹è½¬æ¢ä¸ºä¸€ä¸ªè®¡æ•°è¿‡ç¨‹ï¼Œé‚£ä¹ˆæˆ‘ä»¬ç©¶ç«Ÿå¦‚ä½•è®¡ç®—å‘¢ï¼Ÿ</p>
<p><strong>å››ã€ è®¡ç®—ä¸è¶…è¿‡ç»™å®šæ•´æ•°çš„å¯¹è·ç¦»æ•°</strong></p>
<p>æ­£å¦‚æˆ‘æåˆ°çš„ï¼Œæˆ‘ä»¬ä¸èƒ½ä½¿ç”¨å¯¹è·ç¦»æ•°ç»„ï¼Œè¿™æ„å‘³ç€å”¯ä¸€çš„é€‰æ‹©æ˜¯è¾“å…¥æ•°ç»„æœ¬èº«ã€‚å¦‚æœå…¶å…ƒç´ ä¹‹é—´æ²¡æœ‰é¡ºåºï¼Œé™¤äº†é€ä¸ªè®¡ç®—å’Œæµ‹è¯•æ¯ä¸ªå¯¹è·ç¦»ä¹‹å¤–ï¼Œæˆ‘ä»¬æ²¡æœ‰æ›´å¥½çš„æ–¹æ³•ã€‚è¿™å¯¼è‡´ <code>O(n^2)</code> çš„éªŒè¯ç®—æ³•ï¼Œå…¶ä¸ä¸Šè¿°æœ´ç´ è§£å†³æ–¹æ³•ä¸€æ ·å·®ã€‚æ‰€ä»¥æˆ‘ä»¬éœ€è¦å¯¹ nums å¼ºåŠ ä¸€äº›å‘½ä»¤ï¼Œé»˜è®¤æ˜¯æ’åºã€‚</p>
<p>ç°åœ¨å‡è®¾ <code>nums</code> æŒ‰å‡åºæ’åºï¼Œæˆ‘ä»¬å¦‚ä½•ç»§ç»­è®¡ç®—ç»™å®šçš„ <code>num</code> ï¼Ÿæ³¨æ„ï¼Œæ¯ä¸ªå¯¹è·ç¦» <code>d_ij</code> çš„ç‰¹å¾åœ¨äºä¸€å¯¹ç´¢å¼• <code>(i, j)</code> ï¼Œå…¶ä¸­ <code>i &lt; j</code> ï¼Œå³ <code>d_ij &lt;= nums[j] - nums[i]</code> ã€‚å¦‚æœæˆ‘ä»¬ä¿æŒç¬¬ä¸€ä¸ªç´¢å¼• <code>i</code> å›ºå®šï¼Œé‚£ä¹ˆ <code>d_ij &lt;= num</code> ç­‰ä»·äº <code>nums[j] &lt;= nums[i] + num</code> ã€‚è¿™è¡¨æ˜è‡³å°‘æˆ‘ä»¬å¯ä»¥è¿›è¡ŒäºŒåˆ†æœç´¢ä»¥æ‰¾åˆ°æœ€å°çš„ç´¢å¼• <code>j</code> ï¼Œä½¿å¾—æ¯ä¸ªç´¢å¼• <code>i</code> çš„ <code>nums[j] &gt; nums[i] + num</code> ï¼Œç„¶åç´¢å¼• <code>i</code> çš„ count å°†æ˜¯ <code>j-i-1</code> ï¼Œå¹¶ä¸”æ€»çš„æ¥è¯´ï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ª O(nlogn) çš„éªŒè¯ç®—æ³•ã€‚</p>
<p>äº‹å®è¯æ˜ï¼Œå¦‚æœæˆ‘ä»¬ä½¿ç”¨ä»¥ä¸‹å±æ€§ï¼Œåˆ™å¯ä»¥ä½¿ç”¨ç»å…¸çš„åŒæŒ‡é’ˆæŠ€æœ¯åœ¨çº¿æ€§æ—¶é—´å†…å®Œæˆè®¡æ•°ï¼šå‡è®¾æœ‰ä¸¤ä¸ªèµ·å§‹ç´¢å¼• <code>i1</code> å’Œ <code>i2</code> ï¼Œ <code>i1 &lt; i2</code> ï¼Œ è®© <code>j1</code> å’Œ <code>j2</code> æˆä¸ºæœ€å°çš„ç´¢å¼•ï¼Œä½¿å¾— <code>nums[j1] &gt; nums[i1] + num</code> he <code>nums[j2] &gt; nums[i2] + num</code> ï¼Œé‚£ä¹ˆ <code>j2 &gt;= j1</code> å¿…å®šæ˜¯çœŸçš„ã€‚è¯æ˜æ˜¯ç›´æˆªäº†å½“çš„ï¼šå‡è®¾ <code>j2 &lt; j1</code> ï¼Œå› ä¸º <code>j1</code> æ˜¯æ»¡è¶³ <code>nums[j1] &gt; nums[i1] + num</code> çš„æœ€å°çš„ç´¢å¼•ï¼Œ æˆ‘ä»¬åº”è¯¥æœ‰ <code>nums[j2] &lt;= nums[i1] + num</code> ã€‚å¦ä¸€æ–¹é¢ï¼Œ <code>nums[j2] &gt; nums[i2] + num &gt;= nums[i1] + num</code> ã€‚è¿™ä¸¤ä¸ªä¸ç­‰å¼ç›¸äº’çŸ›ç›¾ï¼Œä»è€Œè¯å®äº†æˆ‘ä»¬ä¸Šé¢çš„ç»“è®ºã€‚</p>
<p><strong>äº”ã€ å¦‚ä½•æœ‰æ•ˆåœ°éå†ï¼ˆæˆ–æœç´¢ï¼‰æœç´¢ç©ºé—´</strong></p>
<p>åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬çŸ¥é“æœç´¢ç©ºé—´ï¼ŒçŸ¥é“å¦‚ä½•æ„å»ºå€™é€‰è§£å†³æ–¹æ¡ˆä»¥åŠå¦‚ä½•é€šè¿‡è®¡æ•°æ¥éªŒè¯å®ƒï¼Œæˆ‘ä»¬ä»ç„¶éœ€è¦æœ€åä¸€å—æ‹¼å›¾ï¼šå¦‚ä½•éå†æœç´¢ç©ºé—´ã€‚</p>
<p>å½“ç„¶ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å°è¯•ä» <code>0</code> åˆ° <code>d</code> çš„æ¯ä¸ªæ•´æ•°æ¥è¿›è¡Œå¤©çœŸçš„çº¿æ€§éå†ï¼Œå¹¶é€‰æ‹©ç¬¬ä¸€ä¸ªæ»¡è¶³ <code>count(num) &gt;= K</code>  çš„æ•´æ•° <code>num</code>  ã€‚æ—¶é—´å¤æ‚åº¦å°†æ˜¯ <code>O(nd)</code> ã€‚ç„¶è€Œï¼Œå‡è®¾ <code>d</code> å¯ä»¥æ¯” <code>n</code> å¤§å¾—å¤šï¼Œåˆ™æ”¹ç®—æ³•å¯èƒ½æ¯”ä¹‹å‰æå‡ºçš„æœ´ç´  <code>O(n^2)</code> è§£æ›´å·®ã€‚</p>
<p>è¿™é‡Œå…³é”®æ˜¯è§‚å¯Ÿåˆ°å€™é€‰è§£å†³æ–¹æ¡ˆæ˜¯æŒ‰å‡åºè‡ªç„¶æ’åºçš„ï¼Œå› æ­¤å¯èƒ½ä½¿ç”¨äºŒåˆ†æœç´¢ã€‚å¦ä¸€ä¸ªäº‹å®æ˜¯ <code>count</code> å‡½æ•°çš„éé€’å‡å±æ€§ï¼šç»™å®šä¸¤ä¸ªæ•´æ•° <code>num1</code> å’Œ <code>num2</code> æ»¡è¶³ <code>num1 &lt; num2</code> ï¼Œæˆ‘ä»¬æœ‰ <code>count(num1) &lt;= count(num2)</code> ï¼ˆæˆ‘å°†è¯æ˜è¿‡ç¨‹ç•™ç»™ä½ ï¼‰ã€‚æ‰€ä»¥äºŒåˆ†æœç´¢æ­¥éª¤å¦‚ä¸‹ï¼š</p>
<ol>
<li>è®¾ <code>[l,r]</code> ä¸ºå½“å‰æœç´¢ç©ºé—´ï¼Œåˆå§‹åŒ– <code>l = 0, r = d</code> ã€‚</li>
<li>å¦‚æœ <code>l &lt; r</code> ï¼Œè®¡ç®—ä¸­é—´ç‚¹ <code>m = (l + r) / 2</code> å¹¶è¯„ä¼° <code>count(m)</code> ã€‚</li>
<li>å¦‚æœ <code>count(m) &lt; K</code> ï¼Œæˆ‘ä»¬ä¸¢å¼ƒå½“å‰æœç´¢ç©ºé—´çš„å·¦åŠè¾¹ï¼Œä»¤ <code>l = m + 1</code>ï¼›å¦åˆ™ <code>count(m) &gt;= K</code> ä¸¢å¼ƒå³åŠè¾¹ï¼Œä»¤ <code>r=m</code> ã€‚</li>
</ol>
<p>ä½ å¯èƒ½æƒ³çŸ¥é“ä¸ºä»€ä¹ˆå³ä½¿ <code>count(m) == K</code> ï¼Œæˆ‘ä»¬ä¹Ÿä¸¢å¼ƒæœç´¢ç©ºé—´çš„å³åŠéƒ¨åˆ†ã€‚æ³¨æ„ç¬¬ K å°çš„å¯¹è·ç¦» <code>num_k</code> æ˜¯æ»¡è¶³ <code>count(num_k) &gt;= K</code> çš„æœ€å°æ•´æ•°ã€‚å½“ <code>count(m) == K</code> æ—¶ï¼Œæˆ‘ä»¬çŸ¥é“ <code>num_k &lt;= K</code> ï¼ˆä½†ä¸ä¸€å®šæ˜¯ <code>num_k == m</code>ï¼Œæƒ³æƒ³å§ï¼ï¼‰æ‰€ä»¥ä¿æŒå³åŠè¾¹æ²¡æœ‰æ„ä¹‰ã€‚</p>
<p><strong>å…­ã€ æŠŠæ‰€æœ‰ä¸œè¥¿æ”¾åˆ°ä¸€èµ·ï¼Œåˆç§°è§£å†³æ–¹æ¡ˆ</strong></p>
<p>ä¸è¦è¢«ä¸Šè¿°åˆ†æå“åˆ°ã€‚ä¸€æ—¦ç†è§£ï¼Œæœ€ç»ˆçš„è§£å†³æ–¹æ¡ˆå°±æ›´å®¹æ˜“ç¼–å†™ã€‚ä¸‹é¢æ˜¯ Java ç‰ˆæœ¬çš„è¯•é”™ç®—æ³•ï¼Œæ—¶é—´å¤æ‚åº¦ <code>O(nlogd + nlogn)</code> ï¼ˆåˆ«å¿˜äº†æ’åºï¼‰ï¼Œç©ºé—´å¤æ‚åº¦ <code>O(1)</code> ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">smallestDistancePair</span><span class="params">(<span class="keyword">int</span>[] nums, <span class="keyword">int</span> k)</span> </span>&#123;</span><br><span class="line">    Arrays.sort(nums);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">int</span> n = nums.length;</span><br><span class="line">    <span class="keyword">int</span> l = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">int</span> r = nums[n - <span class="number">1</span>] - nums[<span class="number">0</span>];</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> cnt = <span class="number">0</span>; l &lt; r; cnt = <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">int</span> m = l + (r - l) / <span class="number">2</span>;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>, j = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">            <span class="keyword">while</span> (j &lt; n &amp;&amp; nums[j] &lt;= nums[i] + m) j++;</span><br><span class="line">            cnt += j - i - <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> (cnt &lt; k) &#123;</span><br><span class="line">            l = m + <span class="number">1</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            r = m;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> l;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<hr>
<p>æœ€åæ˜¯ LeetCode ä¸Šå¯ä»¥ç”¨è¯•é”™ç®—æ³•è§£å†³çš„é—®é¢˜åˆ—è¡¨ï¼ˆæ¬¢è¿æ·»åŠ æ–°çš„ä¾‹å­ï¼‰ï¼š</p>
<ul>
<li><p><a href="https://leetcode.com/problems/k-th-smallest-prime-fraction/description/" target="_blank" rel="noopener">786. K-th Smallest Prime Fraction</a></p>
</li>
<li><p><a href="https://leetcode.com/problems/minimize-max-distance-to-gas-station/description/" target="_blank" rel="noopener">774    Minimize Max Distance to Gas Station</a></p>
</li>
<li><p><a href="https://leetcode.com/problems/find-k-th-smallest-pair-distance/description/" target="_blank" rel="noopener">719. Find K-th Smallest Pair Distance</a></p>
</li>
<li><p><a href="https://leetcode.com/problems/kth-smallest-number-in-multiplication-table/description/" target="_blank" rel="noopener">668. Kth Smallest Number in Multiplication Table</a></p>
</li>
<li><p><a href="https://leetcode.com/problems/maximum-average-subarray-ii/description/" target="_blank" rel="noopener">644. Maximum Average Subarray II</a></p>
</li>
<li><p><a href="https://leetcode.com/problems/kth-smallest-element-in-a-sorted-matrix/description/" target="_blank" rel="noopener">378. Kth Smallest Element in a Sorted Matrix</a></p>
</li>
</ul>
<p>æ— è®ºå¦‚ä½•ï¼Œè¿™ç¯‡æ–‡ç« åªæ˜¯æé†’ä½ ï¼Œå¦‚æœä½ æ‰€æœ‰å…¶ä»–å¸¸è§è§£å†³æ–¹æ¡ˆä¸¥é‡å—åˆ°ä¸è‰¯æ—¶é—´æˆ–ç©ºé—´æ€§èƒ½çš„å½±å“ï¼Œåˆ™è¯•é”™ç®—æ³•å€¼å¾—å°è¯•ã€‚æ­¤å¤–ï¼Œæˆ‘ä»¬å§‹ç»ˆå»ºè®®ä½ åœ¨å®Œå…¨è‡´åŠ›äºæ­¤ç®—æ³•å‰ï¼Œå¿«é€Ÿè¯„ä¼°æœç´¢ç©ºé—´å¤§å°å’Œæ½œåœ¨çš„éªŒè¯ç®—æ³•ï¼Œä»¥åŠä¼°è®¡ç®—æ³•å¤æ‚åº¦ã€‚</p>
<p>å¸Œæœ›æœ‰å¸®åŠ©ï¼Œç¼–ç æ„‰å¿«ï¼</p>
]]></content>
      <tags>
        <tag>translation</tag>
        <tag>algorithm</tag>
      </tags>
  </entry>
  <entry>
    <title>SOLID åŸåˆ™ â€”â€” ç†è§£ç°å®ä¸­çš„é—®é¢˜ï¼ˆè¯‘ï¼‰</title>
    <url>/2020/04/14/SOLID-%E5%8E%9F%E5%88%99/</url>
    <content><![CDATA[<p><a href="https://medium.com/@minhajukhan/solid-principles-and-how-we-write-code-57beb1668db3" target="_blank" rel="noopener">åŸæ–‡ï¼šSOLID Principles â€” Understanding with Real-Life Problems.</a></p>
<p>æ¯•ä¸šè‡³ä»Šè¿›å…¥è½¯ä»¶å…¬å¸å·¥ä½œï¼Œæˆ‘ä»¬å¤šæ¬¡æ¥å—æœ‰å…³ SOLID åŸåˆ™çš„è®²åº§ï¼Œå…¶ä¸­åŒ…æ‹¬å…¶å®šä¹‰å’ŒæŠ½è±¡ç¤ºä¾‹ã€‚<br>ä»Šå¤©æˆ‘ä»¬å°†ä»¥ä¸åŒçš„æ–¹å¼å»ç†è§£è¿™ä¸ªåŸåˆ™ã€‚</p>
<p>æˆ‘ä»¬éµå¾ª SOLID åŸåˆ™ä»å¤´å¼€å§‹æ„é€ ä¸€äº›ä¸œè¥¿ã€‚</p>
<p>å¦‚æœä½ æ˜¯åˆå­¦è€…ï¼Œä¸çŸ¥é“ä»€ä¹ˆæ˜¯ SOLID ï¼Œæ²¡å…³ç³»ï¼Œè¾¹çœ‹è¾¹å­¦ã€‚</p>
<a id="more"></a>
<hr>
<p>æœ€è¿‘æˆ‘è¢«è¦æ±‚å®ç°ä¸€ä¸ªæœåŠ¡ï¼Œè¯¥æœåŠ¡åœ¨æŸäº›äº‹ä»¶å‘ç”Ÿæ—¶å‘é€æ–‡æœ¬æ¶ˆæ¯ã€‚</p>
<p>è¿™é‡Œæ˜¯éœ€æ±‚ï¼š</p>
<ol>
<li>åœ¨ç³»ç»Ÿå‘ç”Ÿç™»å½•äº‹ä»¶æ—¶ï¼Œä»åˆ†å¸ƒå¼é˜Ÿåˆ—æ¥æ”¶ä¸€æ¡æ¶ˆæ¯ã€‚</li>
<li>æ ¹æ®é…ç½®éªŒè¯ä¼ å…¥çš„æ¶ˆæ¯ï¼Œè¯„ä¼°å‘å“ªäº›ç”¨æˆ·å‘é€çŸ­ä¿¡æ¶ˆæ¯ã€‚</li>
<li>å‘é€çŸ­ä¿¡æ¶ˆæ¯ç»™è¯„ä¼°é€šè¿‡çš„ç”¨æˆ·ã€‚</li>
</ol>
<p>ç®€å•ï¼Œé‚£ä¹ˆç”¨æˆ‘æœ€å–œæ¬¢çš„ Go è¯­è¨€å®ç°ã€‚</p>
<h2 id="1-å•ä¸€èŒè´£åŸåˆ™-Single-Responsibility-Principle"><a href="#1-å•ä¸€èŒè´£åŸåˆ™-Single-Responsibility-Principle" class="headerlink" title="1. å•ä¸€èŒè´£åŸåˆ™ (Single Responsibility Principle)"></a>1. å•ä¸€èŒè´£åŸåˆ™ (Single Responsibility Principle)</h2><blockquote>
<p>ä¸€ä¸ªç±»æˆ–æ¨¡å—åº”è¯¥æœ‰ä¸”ä»…æœ‰ä¸€ä¸ªè¢«ä¿®æ”¹çš„åŸå› ã€‚</p>
</blockquote>
<p>è€ƒè™‘åˆ°éœ€æ±‚ï¼Œæˆ‘å°†åº”ç”¨æ‹†æˆä¸‰ä¸ªç»„ä»¶ã€‚</p>
<ol>
<li>æ¶ˆè´¹è€… ï¼ˆconsumerï¼‰ â€”â€” ä»åˆ†å¸ƒå¼é˜Ÿåˆ—è¯»å–æ¶ˆæ¯</li>
<li>è§„åˆ™å¼•æ“ ï¼ˆrule engineï¼‰ â€”â€” æ ¹æ®ä¼ å…¥æ¶ˆæ¯éªŒè¯ç”¨æˆ·</li>
<li>é€šçŸ¥è€…ï¼ˆnotifierï¼‰ â€”â€” å‘é€æ¶ˆæ¯ç»™é€šè¿‡éªŒè¯çš„ç”¨æˆ·</li>
</ol>
<h3 id="æ¶ˆè´¹è€…"><a href="#æ¶ˆè´¹è€…" class="headerlink" title="æ¶ˆè´¹è€…"></a>æ¶ˆè´¹è€…</h3><p>æ¶ˆè´¹è€…åº”è¯¥åªåšä¸€ä»¶äº‹ï¼šä»é˜Ÿåˆ—ä¸­è¯»å–æ¶ˆæ¯ï¼Œä¼ é€’ç»™è§„åˆ™å¼•æ“ã€‚</p>
<p>æˆ‘ä»¬æœåŠ¡ä¸­çš„è¿™ä¸ªæ¶ˆè´¹è€…æ˜¯ä¸€ä¸ªç®€å•çš„ Kafka æ¶ˆè´¹è€…ï¼Œå®ƒå¯ä»¥è¯»å–æ¶ˆæ¯ã€‚</p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span> message := <span class="keyword">range</span> claim.Messages() &#123;</span><br><span class="line">    n.Engine.ProcessEvent(message)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="è§„åˆ™å¼•æ“"><a href="#è§„åˆ™å¼•æ“" class="headerlink" title="è§„åˆ™å¼•æ“"></a>è§„åˆ™å¼•æ“</h3><p>å½“ä½ æŠŠæŸç‰©ç§°ä¸ºå¼•æ“æ—¶ï¼Œæ„å‘³ç€å®ƒå¾ˆå¼ºå¤§ï¼Œå®ƒç®¡ç†è¿™ç³»ç»Ÿä¸­å›°éš¾å·¥ä½œçš„æ ¸å¿ƒã€‚æ­¤å¤„å‘½åç†ç”±ç±»ä¼¼ã€‚</p>
<p>å½“æˆ‘çš„è§„åˆ™å¼•æ“å¯åŠ¨ï¼ˆå®ä¾‹åŒ–ï¼‰æ—¶ï¼Œå®ƒå°±ç­‰å¾… <code>ProcessEvent()</code> æ¥å£è¢«è°ƒç”¨ã€‚åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­æ˜¯ï¼Œæ¶ˆè´¹è€…å»è°ƒç”¨å®ƒã€‚</p>
<p>å› æ­¤ï¼Œå®ƒä¸»è¦è´Ÿè´£ä¸€ä»¶äº‹ï¼ˆè‡³å°‘å¯¹å¤–æ˜¯è¿™æ ·çš„ï¼‰ã€‚</p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">type</span> Engine <span class="keyword">interface</span> &#123;</span><br><span class="line">    ProcessEvent(message types.NotificationMessage) error</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="å°ç»“"><a href="#å°ç»“" class="headerlink" title="å°ç»“"></a>å°ç»“</h3><p>å¦‚æœä½ çœŸçš„ä»¥ SRPï¼ˆå•ä¸€èŒè´£åŸåˆ™ï¼‰ çš„æ–¹å¼è€ƒè™‘æ¶æ„ç»„ä»¶ï¼Œé‚£ä¹ˆå¯ä»¥åˆ›å»ºå‡ºç›¸åŒè¡Œä¸ºçš„æ¥å£æˆ–ç±»ã€‚</p>
<h2 id="2-å¼€é—­åŸåˆ™-ï¼ˆOpen-Closed-Principleï¼‰"><a href="#2-å¼€é—­åŸåˆ™-ï¼ˆOpen-Closed-Principleï¼‰" class="headerlink" title="2. å¼€é—­åŸåˆ™ ï¼ˆOpen Closed Principleï¼‰"></a>2. å¼€é—­åŸåˆ™ ï¼ˆOpen Closed Principleï¼‰</h2><blockquote>
<p>è½¯ä»¶å®ä½“åº”è¯¥ä¸ºæ‹“å±•è€Œå¼€æ”¾ï¼Œä¸ºä¿®æ”¹è€Œå°é—­ã€‚</p>
</blockquote>
<p>æ›´è¿›ä¸€æ­¥ï¼Œæˆ‘ä»¬æ¥å®ç°é€šçŸ¥è€…ç»„ä»¶ã€‚</p>
<h3 id="é€šçŸ¥è€…ï¼Œå¤©çœŸçš„å®ç°"><a href="#é€šçŸ¥è€…ï¼Œå¤©çœŸçš„å®ç°" class="headerlink" title="é€šçŸ¥è€…ï¼Œå¤©çœŸçš„å®ç°"></a>é€šçŸ¥è€…ï¼Œå¤©çœŸçš„å®ç°</h3><p>ä¸€ç§å¤©çœŸçš„æ–¹å¼å°†æ˜¯ç®€å•ï¼Œç®€æ´ä¸”ç›´æ¥çš„ï¼š</p>
<ol>
<li>å®ç°ä¸€ä¸ªç±»ã€‚</li>
<li>åœ¨éœ€è¦æ—¶ä¼ é€’ç±»å®ä¾‹ã€‚</li>
</ol>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">type</span> SMSNotifier <span class="keyword">struct</span> &#123;&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(s *SMSNotifier)</span> <span class="title">SendSMS</span><span class="params">(msg <span class="keyword">string</span>, recipient <span class="keyword">string</span>)</span> <span class="title">error</span></span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>å¯¹äºä¸ç†Ÿæ‚‰ Go çš„ç¨‹åºå‘˜ï¼Œç¬¬äºŒå¥è¡¨ç¤ºè¯¥ç±»æ‹¥æœ‰åä¸º SendSMS çš„æ–¹æ³•ã€‚</p>
</blockquote>
<h3 id="é€šçŸ¥è€…ï¼Œä¸€ç§æ›´å¥½çš„å®ç°"><a href="#é€šçŸ¥è€…ï¼Œä¸€ç§æ›´å¥½çš„å®ç°" class="headerlink" title="é€šçŸ¥è€…ï¼Œä¸€ç§æ›´å¥½çš„å®ç°"></a>é€šçŸ¥è€…ï¼Œä¸€ç§æ›´å¥½çš„å®ç°</h3><ol>
<li>å®šä¹‰ä¸€ä¸ªæ¥å£ï¼Œå…·ä½“ç±»è¦å®ç°è¿™ä¸ªæ¥å£ã€‚</li>
<li>ä¼ é€’å®ç°äº†è¯¥æ¥å£çš„å…·ä½“ç±»çš„å®ä¾‹ã€‚</li>
</ol>
<p>æ¥å£ï¼š</p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">type</span> Notifier <span class="keyword">interface</span> &#123;</span><br><span class="line">    Notify(msg <span class="keyword">string</span>, recipient <span class="keyword">string</span>) error</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç±»ï¼š</p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">type</span> SMSNotifier <span class="keyword">struct</span> &#123;&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(s *SMSNotifier)</span> <span class="title">Notify</span><span class="params">(msg <span class="keyword">string</span>, recipient <span class="keyword">string</span>)</span> <span class="title">error</span></span></span><br></pre></td></tr></table></figure>
<ul>
<li>é—®ï¼š ä¸ºä»€ä¹ˆåä¸€ç§æ–¹æ³•æ›´å¥½ï¼Ÿ</li>
<li><p>ç­”ï¼š è€ƒè™‘â€œå¤©çœŸâ€æ–¹å¼çš„å®ç°ï¼Œå¦‚æœå®¢æˆ·è¿˜è¦æ±‚æˆ‘ä»¬é€šè¿‡ç”µå­é‚®ä»¶å‘é€é€šçŸ¥ï¼Œæˆ‘ä»¬å°±è¦â€œæ‰“å¼€â€ SMSNotifier ç±»çš„å®ç°ï¼Œå¹¶åœ¨å…¶ä¸­æ·»åŠ ä»£ç ã€‚è¿™ä¸å¯é¿å…åœ°è¿åäº†å¼€é—­åŸåˆ™ã€‚å¦‚æœæˆ‘ä»¬è€ƒè™‘äº†åè€…çš„å®ç°ï¼Œæˆ‘ä»¬åªéœ€è¦å®ç°å¦ä¸€ä¸ªé€šçŸ¥è€…ã€‚</p>
  <figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">type</span> EmailNotifier <span class="keyword">struct</span> &#123;&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(s *EmailNotifier)</span> <span class="title">Notify</span><span class="params">(msg <span class="keyword">string</span>, recipient <span class="keyword">string</span>)</span> <span class="title">error</span></span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="å°ç»“-1"><a href="#å°ç»“-1" class="headerlink" title="å°ç»“"></a>å°ç»“</h3><p>å¹¶éæ€»æ˜¯å¦‚æ­¤ï¼Œä½†æ˜¯åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œéƒ½æ˜¯åœ¨ç¨‹åºä¸­ä¼ é€’æ¥å£è€Œä¸æ˜¯å…·ä½“å®ç°ï¼Œå› æ­¤å½“æ–°çš„éœ€æ±‚åˆ°æ¥æ—¶ï¼Œä½ åªéœ€å®ç°æ¥å£çš„å¦ä¸€ä¸ªå®ä¾‹ã€‚</p>
<h2 id="3-é‡Œæ°æ›¿æ¢åŸåˆ™-ï¼ˆLiskov-Substitution-Principleï¼‰"><a href="#3-é‡Œæ°æ›¿æ¢åŸåˆ™-ï¼ˆLiskov-Substitution-Principleï¼‰" class="headerlink" title="3. é‡Œæ°æ›¿æ¢åŸåˆ™ ï¼ˆLiskov Substitution Principleï¼‰"></a>3. é‡Œæ°æ›¿æ¢åŸåˆ™ ï¼ˆLiskov Substitution Principleï¼‰</h2><p>æŠ±æ­‰ã€‚</p>
<blockquote>
<p>è¯‘æ³¨ï¼š åŸæ–‡ä¸­æœªç”¨åˆ°è¯¥åŸåˆ™ã€‚</p>
</blockquote>
<h3 id="å°ç»“-2"><a href="#å°ç»“-2" class="headerlink" title="å°ç»“"></a>å°ç»“</h3><p>ä¸å¥½æ„æ€ã€‚</p>
<h2 id="4-æ¥å£éš”ç¦»-ï¼ˆInterface-Segregation-Principleï¼‰"><a href="#4-æ¥å£éš”ç¦»-ï¼ˆInterface-Segregation-Principleï¼‰" class="headerlink" title="4. æ¥å£éš”ç¦» ï¼ˆInterface Segregation Principleï¼‰"></a>4. æ¥å£éš”ç¦» ï¼ˆInterface Segregation Principleï¼‰</h2><blockquote>
<p>ä¸åº”å¼ºè¿«å®¢æˆ·ç«¯ä¾èµ–äºä¸ä½¿ç”¨çš„æ¥å£ã€‚</p>
</blockquote>
<h3 id="è§„åˆ™å¼•æ“-1"><a href="#è§„åˆ™å¼•æ“-1" class="headerlink" title="è§„åˆ™å¼•æ“"></a>è§„åˆ™å¼•æ“</h3><p>å›åˆ°æˆ‘ä»¬çš„è§„åˆ™å¼•æ“ï¼Œå¹¶å®ç°å…¶æ¥å£è¦æ±‚æˆ‘ä»¬å®ç°çš„å”¯ä¸€æ–¹æ³•ã€‚</p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">ProcessEvent</span><span class="params">(message types.NotificationMessage)</span> <span class="title">error</span></span></span><br></pre></td></tr></table></figure>
<p>è§„åˆ™å¼•æ“å¯ä»¥å¤„ç†è®¸å¤šä¸åŒç±»å‹çš„ä¼ å…¥æ¶ˆæ¯ã€‚æˆ‘å€¾å‘äºç§°å®ƒä¸ºäº‹ä»¶ï¼Œå› ä¸ºæˆ‘ä»¬æ­£åœ¨æ ¹æ®ç³»ç»Ÿä¸­å‘ç”Ÿçš„äº‹ä»¶æ¥æ¥æ”¶æ¶ˆæ¯ã€‚</p>
<p>è€ƒè™‘ä»¥ä¸Šæè¿°ï¼Œæˆ‘ä»¬å¯ä»¥è‚¯å®šåœ°å°†ä¸€æ¡æ¶ˆæ¯è½¬æ¢ä¸ºä¸€ä¸ªäº‹ä»¶ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨â€œ<a href="https://en.wikipedia.org/wiki/Factory_method_pattern" target="_blank" rel="noopener">å·¥å‚è®¾è®¡æ¨¡å¼</a>â€ï¼Œç¨åä»‹ç»è¿™ä¸ªã€‚</p>
<p>ç»§ç»­ï¼Œåˆ›å»ºä¸€ä¸ªäº‹ä»¶æ¥å£ï¼Œ</p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">type</span> Event <span class="keyword">interface</span> &#123;&#125;</span><br></pre></td></tr></table></figure>
<p>æ¦‚æ‹¬éœ€æ±‚ï¼Œæˆ‘ä»¬å¿…é¡»æ ¹æ®ä¼ å…¥ç³»ç»Ÿçš„äº‹ä»¶å‘ç”¨æˆ·å‘é€æ–‡æœ¬æ¶ˆæ¯ã€‚</p>
<p>å› ä¸ºäº‹ä»¶å·²ç»æˆä¸ºæˆ‘ä»¬æœåŠ¡ä¸­çš„ä¸€ä¸ªå®ä½“ï¼Œæˆ‘ä»¬åº”è¯¥åœ¨å®šä¹‰è¯¥å®ä½“è¾¹ç•Œæ—¶ï¼Œå›´ç»•æˆ‘ä»¬åˆšå­¦ä¹ çš„â€œå•ä¸€èŒè´£åŸåˆ™â€è¿›è¡Œæ€è€ƒã€‚</p>
<ol>
<li>äº‹ä»¶åº”è¯¥çŸ¥é“å®ƒè¦å‘é€ä»€ä¹ˆæ¶ˆæ¯ï¼Œä»¥å°è£…äº‹ä»¶çš„æ‰€æœ‰ç»†èŠ‚ã€‚</li>
<li>äº‹ä»¶ä¸åº”è¯¥çŸ¥é“å¦‚ä½•å‘é€æ¶ˆæ¯ã€‚</li>
</ol>
<p>ç”±äºè¦å‘é€æ¶ˆæ¯ï¼Œå°±å¿…é¡»å‘ŠçŸ¥äº‹ä»¶æœ‰å…³é€šçŸ¥è€…çš„ä¿¡æ¯ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å°†å…¶ä½œä¸ºå‚æ•°æä¾›ã€‚</p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">type</span> Event <span class="keyword">interface</span> &#123;</span><br><span class="line">    Send(n Notifier) error</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æœ€åï¼Œè¿™æ˜¯æˆ‘ä»¬è§„åˆ™å¼•æ“çš„æ¶ˆæ¯æå–æ–¹æ³•çš„å°è€Œç¾çš„å®ç°ã€‚</p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(e *engine)</span> <span class="title">ProcessMessage</span><span class="params">(message types.NotificationMessage)</span></span> &#123;</span><br><span class="line">    event, err := e.eventFactory(message)</span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> err</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> event.Notify(e.notifier)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æ¶ˆæ¯åˆ°äº‹ä»¶çš„è½¬æ¢å°±æ˜¯ EventFactory çš„å…¨éƒ¨å†…å®¹ã€‚</p>
<p>ä»¥ä¸‹æ˜¯å·¥å‚ä¸­çš„ä¸€æ®µä»£ç ï¼Œä»¥ä¾›ç†Ÿæ‚‰ï¼š</p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">switch</span> messageType &#123;</span><br><span class="line">    <span class="keyword">case</span> loginSuccessfulEvent:</span><br><span class="line">       <span class="keyword">return</span> NewLoginEvent()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="å°ç»“-3"><a href="#å°ç»“-3" class="headerlink" title="å°ç»“"></a>å°ç»“</h3><p>æ¥å£è¦æ±‚å¦‚ä¸‹ï¼š</p>
<ul>
<li><p>Notifier</p>
<ol>
<li>Notifier æ¥å£åªæƒ³è¦å®¢æˆ·ç«¯å®ç° Notify() æ¥å£ã€‚</li>
<li>é™¤äº†éœ€è¦çš„ä¹‹å¤–ï¼Œ SMSNotifier ä¸ä¼šå®ç° Notifier å¼ºè¿«å®ƒå®ç°çš„ä»»ä½•æ–¹æ³•ã€‚</li>
</ol>
</li>
<li><p>Event</p>
<ol>
<li>Event æ¥å£åªè¦å®¢æˆ·ç«¯å®ç° Send() æ¥å£ã€‚</li>
<li>é™¤äº†éœ€è¦çš„ä¹‹å¤–ï¼Œ LoginEvent ï¼ˆç”±å·¥å‚è¿”å›ï¼‰ ä¸ä¼šå®ç° Event å¼ºè¿«å®ƒå®ç°çš„ä»»ä½•æ–¹æ³•ã€‚</li>
</ol>
</li>
</ul>
<p>è¦ç‚¹ï¼š ä¿æŒæ¥å£å°½å¯èƒ½çŸ­ï¼Œæœ€å¤šä¸€ç§æ–¹æ³•å°±å¾ˆä¸é”™ã€‚</p>
<h2 id="5-ä¾èµ–å€’ç½®åŸåˆ™-ï¼ˆDependency-Inversion-Principleï¼‰"><a href="#5-ä¾èµ–å€’ç½®åŸåˆ™-ï¼ˆDependency-Inversion-Principleï¼‰" class="headerlink" title="5. ä¾èµ–å€’ç½®åŸåˆ™ ï¼ˆDependency Inversion Principleï¼‰"></a>5. ä¾èµ–å€’ç½®åŸåˆ™ ï¼ˆDependency Inversion Principleï¼‰</h2><blockquote>
<p>é«˜çº§æ¨¡å—ä¸åº”è¯¥ä¾èµ–ä½çº§æ¨¡å—ï¼Œä¸¤è€…éƒ½åº”ä¾èµ–æŠ½è±¡ã€‚</p>
</blockquote>
<p>æˆ‘ä»¬ç³»ç»Ÿä¸­ä¸»è¦ç”±ä¸¤ä¸ªç»„ä»¶ï¼ˆç”±äºæ¶ˆè´¹è€…é™¤äº†è¯»å–é˜Ÿåˆ—ä¸­çš„æ¶ˆæ¯å¹¶æ‰”åˆ°è§„åˆ™å¼•æ“ä¹‹å¤–ï¼Œæ²¡åšå¤šå°‘äº‹æƒ…ï¼Œæˆ‘ä»¬å¯ä»¥å¿½ç•¥å®ƒï¼‰ã€‚</p>
<p>è§„åˆ™å¼•æ“ç›¸æ¯”é€šçŸ¥è€…æ˜¯æ›´é«˜çº§çš„æ¨¡å—ã€‚</p>
<p>å‡å¦‚ Notifier ä¸æ˜¯æ¥å£ï¼Œä½†æ˜¯å…·ä½“å®ç°æ˜¯ SMSNotifierã€‚<br>è¿™ç§æƒ…å†µä¸‹ï¼ŒEngineï¼ˆé«˜çº§æ¨¡å—ï¼‰ä¾èµ–äº SMSNotifier ï¼ˆä½çº§æ¨¡å—ï¼‰ï¼Œå®ƒåœ¨å¼•å¯¼æ—¶å®ä¾‹åŒ–å¼•æ“æ—¶æ³¨å…¥ã€‚</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">+--------+   +-------------+</span><br><span class="line">| Engine +---&gt; SMSNotifier |</span><br><span class="line">+--------+   +-------------+</span><br></pre></td></tr></table></figure>
<p>åœ¨å®ä¾‹åŒ–ä¾èµ–é¡¹æ˜¯å°†å…¶æ³¨å…¥ Engine ä¸­ï¼š</p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line">fucn NewRuleEngine(config Config, notifier SMSNotifier) *Engine</span><br></pre></td></tr></table></figure>
<p>è€ƒè™‘åˆ°ä¾èµ–å…³ç³»æ ‘ï¼Œä»¥ä¸‹æ˜¯æ­¤æœåŠ¡çš„ç”Ÿå‘½å‘¨æœŸä¸­å¯èƒ½å‘ç”Ÿçš„äº‹ä»¶ï¼š</p>
<ul>
<li>12:00 AM â€”â€” æ›´æ”¹åœ¨ SMSNotifier ä¸­å®Œæˆã€‚</li>
<li>12:01 AM â€”â€” SMSNotifier é‡æ–°ç¼–è¯‘ï¼Œå› ä¸ºæœ‰æ›´æ”¹ã€‚</li>
<li>12:02 AM â€”â€” å› ä¸º SMSNotifier æ˜¯ Engine çš„ç›´æ¥ä¾èµ–ï¼Œå®ƒè¢«é‡æ–°ç¼–è¯‘ã€‚</li>
<li>04:20 AM â€”â€” è¿åä¾èµ–å€’ç½®åŸåˆ™ã€‚</li>
</ul>
<h3 id="å¼•å…¥æŠ½è±¡"><a href="#å¼•å…¥æŠ½è±¡" class="headerlink" title="å¼•å…¥æŠ½è±¡"></a>å¼•å…¥æŠ½è±¡</h3><p>é€šè¿‡å¼•å…¥æˆ‘ä»¬çš„ Notifier æ¥å£ï¼Œæˆ‘ä»¬å¯ä»¥åè½¬æ¥è‡ª Engine çš„ SMSNotifier çš„ä¾èµ–å…³ç³»ã€‚</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">      +----------+</span><br><span class="line">   +--&gt; Notifier +&lt;--+</span><br><span class="line">   |  +----------+   |</span><br><span class="line">   |                 |</span><br><span class="line">+--+-----+   +-------+-----+</span><br><span class="line">| Engine |   | SMSNotifier |</span><br><span class="line">+--------+   +-------------+</span><br></pre></td></tr></table></figure>
<p>å›çœ‹ä¹‹å‰çš„äº‹ä»¶ï¼š</p>
<ul>
<li>12:00 AM â€”â€” æ›´æ”¹åœ¨ SMSNotifier ä¸­å®Œæˆã€‚</li>
<li>12:01 AM â€”â€” SMSNotifier é‡æ–°ç¼–è¯‘ã€‚</li>
<li>12:02 AM â€”â€” æ­¤æ—¶ SMSNotifier ä¸æ˜¯ Engine çš„ç›´æ¥ä¾èµ–ï¼Œå®ƒä¸ä¼šè¢«é‡æ–°ç¼–è¯‘ã€‚</li>
<li>12:01 åŒä¸Š â€”â€” ä¾èµ–å€’ç½®åŸåˆ™å®Œå¥½ã€‚</li>
</ul>
<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><ol>
<li>åŸºäºç»„ä»¶çš„æ–¹æ³•æ¶æ„é€‚åˆä»¥ SOLID åŸåˆ™å®æ–½ã€‚</li>
<li>ç»„ä»¶å¿…é¡»ä¸åˆçº¦ä»¥åŠé…ç½®é€šä¿¡ï¼Œè€Œä¸æ˜¯ä¸å…·ä½“çš„å®ç°ã€‚</li>
<li>ä¿æŒåˆçº¦è¶Šå°è¶Šå¥½ï¼Œè¿™æ ·ç”Ÿæ´»æ›´è½»æ¾ã€‚</li>
<li>ä¸è¦ä¸€æ»¡æ„å°±ç­¾å…¥ä»£ç ã€‚ä¸Šè¿°è§£å†³æ–¹æ¡ˆä¸æ˜¯åˆç¨¿ã€‚èŠ±æ—¶é—´åˆ†æä½ å†™çš„å†…å®¹ã€‚</li>
</ol>
]]></content>
      <tags>
        <tag>translation</tag>
        <tag>design pattern</tag>
      </tags>
  </entry>
  <entry>
    <title>Rust å­¦ä¹ ç¬”è®° 3.1</title>
    <url>/2020/04/02/Rust-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-3-1/</url>
    <content><![CDATA[<p>é˜…è¯» <a href="https://doc.rust-lang.org/book" target="_blank" rel="noopener">ã€Š Rust ç¨‹åºè®¾è®¡ã€‹</a>çš„ä¸€äº›ç¬”è®°ã€‚</p>
<p>ç¬¬ 4 ç«  - ç†è§£æ‰€æœ‰æƒï¼ˆownershipï¼‰</p>
<a id="more"></a>
<p>æ‰€æœ‰æƒæ˜¯ Rust æœ€ç‹¬ç‰¹çš„åŠŸèƒ½ï¼Œå®ƒä½¿ Rust ä¸éœ€è¦åƒåœ¾å›æ”¶å™¨ä¹Ÿèƒ½ä¿è¯å†…å­˜å®‰å…¨ã€‚å› æ­¤ï¼Œäº†è§£æ‰€æœ‰æƒåœ¨ Rust ä¸­çš„å·¥ä½œæ–¹å¼éå¸¸é‡è¦ã€‚åœ¨æœ¬ç« ä¸­ï¼Œæˆ‘ä»¬å°†è®¨è®ºæ‰€æœ‰æƒä»¥åŠå‡ ä¸ªç›¸å…³åŠŸèƒ½ï¼šå€Ÿç”¨ï¼ˆborrowingï¼‰ï¼Œåˆ‡ç‰‡ï¼ˆsliceï¼‰å’Œ Rust å¦‚ä½•åœ¨å†…å­˜ä¸­å¸ƒç½®æ•°æ®ã€‚</p>
<h2 id="ä»€ä¹ˆæ˜¯æ‰€æœ‰æƒï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯æ‰€æœ‰æƒï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯æ‰€æœ‰æƒï¼Ÿ"></a>ä»€ä¹ˆæ˜¯æ‰€æœ‰æƒï¼Ÿ</h2><p>Rust çš„ä¸»è¦ç‰¹è‰²æ˜¯æ‰€æœ‰æƒï¼ˆownershipï¼‰ï¼Œå°½ç®¡è¿™ä¸ªåŠŸèƒ½æ˜“äºè§£é‡Šï¼Œä½†å¯¹å…¶ä»–è¯­è¨€å…·æœ‰æ·±è¿œçš„å½±å“ã€‚<br>æ‰€æœ‰ç¨‹åºå¿…é¡»åœ¨è¿è¡Œæ—¶ç®¡ç†å†…å­˜ã€‚æœ‰äº›è¯­è¨€æœ‰åƒåœ¾å›æ”¶åŠŸèƒ½ï¼Œåœ¨ç¨‹åºè¿è¡Œæ—¶ä¼šä¸æ–­å¯»æ‰¾ä¸å†ä½¿ç”¨çš„å†…å­˜ï¼›å¦æœ‰ä¸€äº›è¯­è¨€ï¼Œç¨‹åºå‘˜å¿…é¡»æ˜¾å¼åˆ†é…å’Œé‡Šæ”¾å†…å­˜ã€‚ Rust ä½¿ç”¨äº†ç¬¬ä¸‰ç§æ–¹æ³•ï¼šå†…å­˜æ˜¯é€šè¿‡æ‰€æœ‰æƒç®¡ç†çš„ï¼Œè¯¥ç³»ç»Ÿå…·æœ‰ä¸€ç»„è§„åˆ™ï¼Œç¼–è¯‘å™¨ä¼šåœ¨ç¼–è¯‘æ—¶æ£€æŸ¥è¿™äº›è§„åˆ™ã€‚æ‰€æœ‰æ‰€æœ‰æƒåŠŸèƒ½éƒ½ä¸ä¼šæ‹–æ…¢ç¨‹åºçš„è¿è¡Œé€Ÿåº¦ã€‚</p>
<p>ç”±äºæ‰€æœ‰æƒå¯¹è®¸å¤šç¨‹åºå‘˜æ¥è¯´æ˜¯ä¸€ä¸ªæ–°æ¦‚å¿µï¼Œéœ€è¦ä¸€äº›æ—¶é—´æ¥é€‚åº”ã€‚å¥½æ¶ˆæ¯æ˜¯ï¼Œä½ å¯¹ Rust å’Œæ‰€æœ‰æƒç³»ç»Ÿè§„åˆ™çš„äº†è§£è¶Šä¸°å¯Œï¼Œè‡ªç„¶å°±èƒ½å¼€å‘å‡ºå®‰å…¨é«˜æ•ˆçš„ä»£ç ã€‚ç»§ç»­å§ï¼</p>
<p>äº†è§£æ‰€æœ‰æƒä»¥åï¼Œä½ å°†å…·æœ‰åšå®çš„åŸºç¡€ï¼Œå¯ä»¥äº†è§£ Rust ç‹¬æ ‘ä¸€å¸œçš„åŠŸèƒ½ã€‚åœ¨æœ¬ç« ï¼Œä½ å°†é€šè¿‡ç ”ç©¶ä¸€ç§éå¸¸å¸¸è§çš„æ•°æ®ç»“æ„ç¤ºä¾‹æ¥å­¦ä¹ æ‰€æœ‰æƒï¼šå­—ç¬¦ä¸²ã€‚</p>
<blockquote>
<p><em>æ ˆï¼ˆStackï¼‰å’Œå †ï¼ˆHeapï¼‰</em><br>åœ¨è®¸å¤šç¼–ç¨‹è¯­è¨€ä¸­ï¼Œä½ éƒ½ä¸éœ€è¦å¤ªå…³æ³¨å †å’Œæ ˆã€‚ä½†æ˜¯åœ¨åƒ Rust è¿™æ ·çš„ç³»ç»Ÿç¼–ç¨‹è¯­è¨€ä¸­ï¼Œå†³å®šå€¼åˆ†é…åœ¨å †ä¸Šè¿˜æ˜¯æ ˆä¸Šï¼Œå¯¹è¯­è¨€çš„è¡Œä¸ºæ–¹å¼ä»¥åŠå†³ç­–ç†ç”±çš„å½±å“å¾ˆå¤§ã€‚è¿™é‡Œæ˜¯ç®€è¦è¯´æ˜ã€‚<br>å †å’Œæ ˆéƒ½æ˜¯å†…å­˜çš„ä¸€éƒ¨åˆ†ï¼Œä½ çš„ä»£ç å¯åœ¨è¿è¡Œæ—¶ä½¿ç”¨ï¼Œä½†å®ƒä»¬çš„ç»“æ„ä¸åŒã€‚å †æ ˆæŒ‰è·å–å€¼çš„é¡ºåºå­˜å‚¨å€¼ï¼Œå¹¶ä»¥ç›¸åçš„é¡ºåºåˆ é™¤å€¼ã€‚è¿™ä¹Ÿè¢«ç§°ä¸ºåè¿›å…ˆå‡ºã€‚è®¾æƒ³æœ‰ä¸€å †ï¼ˆstackï¼‰ç›˜å­ï¼šå½“ä½ æ·»åŠ ç›˜å­ï¼Œå°±æ”¾åœ¨ä¸Šé¢ï¼Œå½“ä½ éœ€è¦ç›˜å­ï¼Œä»é¡¶éƒ¨å–èµ°ï¼Œä»ä¸­é—´æˆ–è€…åº•éƒ¨å¢åŠ æˆ–ç§»é™¤ç›˜å­éƒ½æ˜¯ä¸è¡Œçš„ï¼æ·»åŠ æ•°æ®å°±å«å‹å…¥æ ˆï¼Œåˆ é™¤æ•°æ®å°±å«å¼¹å‡ºæ ˆã€‚<br>æ ˆä¸­ä¿å­˜çš„æ‰€æœ‰æ•°æ®å¿…é¡»å…·æœ‰å·²çŸ¥çš„å›ºå®šå¤§å°ã€‚ç¼–è¯‘æ—¶å¤§å°æœªçŸ¥æˆ–è€…å¤§å°å¯èƒ½å˜åŒ–çš„æ•°æ®å¿…é¡»å­˜åœ¨å †ä¸­ã€‚å †çš„ç»„ç»‡æ€§è¾ƒå·®ï¼šä¸ºäº†å°†æ•°æ®æ”¾åœ¨å †ä¸Šï¼Œä½ éœ€è¦è¯·æ±‚ä¸€å®šæ•°é‡çš„ç©ºé—´ã€‚æ“ä½œç³»ç»Ÿåœ¨å †ä¸Šæ‰¾åˆ°ä¸€ä¸ªè¶³å¤Ÿå¤§çš„ç©ºé—´ï¼Œå°†å…¶æ ‡è®°ä¸ºæ­£åœ¨ä½¿ç”¨ï¼Œç„¶åè¿”å›ä¸€ä¸ªæŒ‡é’ˆï¼ŒæŒ‡å‘è¿™ä¸ªä½ç½®ã€‚è¿™ä¸ªè¿‡ç¨‹ç§°ä½œåœ¨å †ä¸Šåˆ†é…ï¼Œæœ‰æ—¶ä¹Ÿç®€ç§°ä¸ºâ€œåˆ†é…ï¼ˆallocatingï¼‰â€ã€‚å°†å€¼å‹å…¥æ ˆä¸è¢«è§†ä¸ºåˆ†é…ã€‚å› ä¸ºæŒ‡é’ˆæ˜¯å·²çŸ¥ä¸”å›ºå®šå¤§å°çš„ï¼Œä½ å¯ä»¥å°†æŒ‡é’ˆå­˜åˆ°æ ˆé‡Œï¼Œä½†æ˜¯ä½ æƒ³æ‹¿åˆ°å®é™…æ•°æ®ï¼Œå°±è¦è·ŸéšæŒ‡é’ˆå¯»å€ã€‚<br>è€ƒè™‘ååœ¨é¤é¦†é‡Œçš„åœºæ™¯ã€‚å½“æ‚¨è¿›å…¥é¤é¦†ï¼Œè¯´æ˜ä½ ä»¬ä¸€å…±å¤šå°‘äººï¼Œç„¶åå·¥ä½œäººå‘˜ä¼šæ‰¾åˆ°ä¸€ä¸ªåº§ä½è¶³å¤Ÿçš„é¤æ¡Œï¼Œå¹¶å¸¦ä½ è¿‡å»ã€‚å¦‚æœä½ ä»¬ä¸€è¡Œäººä¸­æœ‰äººè¿Ÿåˆ°äº†ï¼Œä»–ä»¬å¯ä»¥è¯¢é—®ä½ ä»¬çš„åº§ä½å¹¶æ‰¾åˆ°ä½ ä»¬ã€‚<br>å‹æ ˆæ¯”åœ¨å †ä¸Šåˆ†é…è¦å¿«ï¼Œå› ä¸ºå †ä¸Šä½ è¦å¯»å€ã€‚å¦‚æœç°ä»£å¤„ç†å™¨åœ¨å†…å­˜ä¸­è·³åŠ¨æ¬¡æ•°è¶Šå°‘ï¼Œåˆ™é€Ÿåº¦è¶Šå¿«ã€‚ç»§ç»­ç±»æ¨ï¼Œè€ƒè™‘ä¸€å®¶é¤å…çš„æœåŠ¡å™¨ä»å¤šä¸ªæ¡Œå­ä¸Šæ¥è®¢å•ã€‚æœ€æœ‰æ•ˆçš„åšæ³•æ˜¯å°†æ‰€æœ‰çš„è®¢å•æ”¾åœ¨ä¸€å¼ æ¡Œå­ä¸Šï¼Œç„¶åè½¬åˆ°ä¸‹ä¸€å¼ æ¡Œå­ã€‚å‡ ä¸ªæ¡Œå­ä¸Šæ¥æ¥å›å›åœ°æ”¶è®¢å•å°±å¾ˆæ…¢ã€‚åŒæ ·åœ°ï¼Œå¦‚æœå¤„ç†å™¨å¤„ç†çš„æ•°æ®ä¸å…¶ä»–æ•°æ®ï¼ˆå¦‚æ ˆä¸Šæ•°æ®ï¼‰æ¥è¿‘ï¼Œè€Œä¸æ˜¯ä¸å…¶ä»–æ•°æ®ï¼ˆå¦‚å †ä¸Šçš„æ•°æ®ï¼‰ç›¸è·è¾ƒè¿œï¼Œåˆ™å¯ä»¥æ›´å¥½åœ°å®Œæˆå·¥ä½œã€‚åœ¨å †ä¸Šåˆ†é…å¤§é‡ç©ºé—´ä¹Ÿè€—æ—¶é—´ã€‚<br>å½“ä½ çš„ä»£ç è°ƒç”¨ä¸€ä¸ªå‡½æ•°ï¼Œä¼ é€’ç»™å‡½æ•°çš„å€¼ï¼ˆå¯èƒ½åŒ…æ‹¬æŒ‡å‘å †ä¸­æ•°æ®çš„æŒ‡é’ˆï¼‰å’Œå‡½æ•°çš„å±€éƒ¨å˜é‡è¢«å‹å…¥æ ˆã€‚å‡½æ•°ç»“æŸåï¼Œè¿™äº›å€¼ä»æ ˆä¸­å¼¹å‡ºã€‚<br>è·Ÿè¸ªä»£ç çš„å“ªäº›éƒ¨åˆ†æ­£åœ¨ä½¿ç”¨å¶ç»™å †ä¸­çš„å“ªäº›æ•°æ®ï¼Œä»è€Œæœ€å¤§ç¨‹åº¦åœ°å‡å°‘å †ä¸­çš„é‡å¤æ•°æ®ï¼Œå¹¶æ¸…ç†å †ä¸Šæœªä½¿ç”¨çš„æ•°æ®ï¼Œä»¥ç¡®ä¿ä½ ä¸ä¼šè€—å°½å†…å­˜ï¼Œè¿™äº›éƒ½æ˜¯æ‰€æœ‰æƒæ‰€è§£å†³çš„é—®é¢˜ã€‚äº†è§£æ‰€æœ‰æƒåï¼Œä½ å°±ä¸éœ€è¦ç»å¸¸è€ƒè™‘å †æ ˆäº†ï¼Œä½†æ˜¯çŸ¥é“ç®¡ç†å †æ•°æ®æ˜¯æ‰€æœ‰æƒå­˜åœ¨çš„åŸå› ï¼Œå¯ä»¥å¸®åŠ©ä½ ç†è§£å…¶å·¥ä½œåŸç†ã€‚</p>
</blockquote>
<h2 id="æ‰€æœ‰æƒè§„åˆ™"><a href="#æ‰€æœ‰æƒè§„åˆ™" class="headerlink" title="æ‰€æœ‰æƒè§„åˆ™"></a>æ‰€æœ‰æƒè§„åˆ™</h2><p>é¦–å…ˆï¼Œæˆ‘ä»¬çœ‹ä¸€çœ‹æ‰€æœ‰æƒè§„åˆ™ã€‚åœ¨æµè§ˆç¤ºä¾‹æ—¶è¯·è®°ä½ä»¥ä¸‹è§„åˆ™ï¼š</p>
<ul>
<li>Rust ä¸­çš„æ¯ä¸ªå€¼éƒ½æœ‰ä¸€ä¸ªå˜é‡ï¼Œç§°ä¸ºå…¶æ‰€æœ‰è€…ã€‚</li>
<li>åŒä¸€æ—¶åˆ»åªä¼šåˆä¸€ä¸ªæ‰€æœ‰è€…ã€‚</li>
<li>å½“æ‰€æœ‰è€…è¶…å‡ºä½œç”¨åŸŸï¼Œè¯¥å€¼å°†è¢«åˆ é™¤ã€‚</li>
</ul>
<h2 id="å˜é‡ä½œç”¨åŸŸ"><a href="#å˜é‡ä½œç”¨åŸŸ" class="headerlink" title="å˜é‡ä½œç”¨åŸŸ"></a>å˜é‡ä½œç”¨åŸŸ</h2><p>åœ¨ç¬¬ 2 ç« ä¸­æˆ‘ä»¬å·²ç»è§è¿‡ Rust ç¨‹åºçš„ä¾‹å­äº†ã€‚æ—¢ç„¶æˆ‘ä»¬å·²ç»äº†è§£äº†åŸºæœ¬è¯­æ³•ï¼Œä¹‹åçš„ä¾‹å­å°±ä¸åŒ…å« <code>fn main() {</code> ä»£ç äº†ï¼Œç»§ç»­å­¦ä¹ ï¼Œä½ éœ€è¦è‡ªå·±æŠŠä»£ç åŠ åˆ° main å‡½æ•°ä¸­å»è¿è¡Œã€‚è¿™æ ·ï¼Œæˆ‘ä»¬çš„ä¾‹å­å°±å¯ä»¥æ›´ç®€æ´ï¼Œä¸“æ³¨äºå®é™…å†…å®¹è€Œä¸æ˜¯æ ·æ¿ä»£ç ã€‚</p>
<p>æ‰€æœ‰æƒçš„ç¬¬ä¸€ä¸ªä¾‹å­ï¼Œæˆ‘ä»¬å°†ç ”ç©¶ä¸€äº›å˜é‡çš„ä½œç”¨åŸŸã€‚ä½œç”¨åŸŸå°±æ˜¯ä¸€ä¸ªé¡¹ç›®åœ¨ç¨‹åºä¸­çš„æœ‰æ•ˆèŒƒå›´ã€‚å‡è®¾æˆ‘ä»¬åˆä¸€ä¸ªè¿™æ ·çš„å˜é‡ï¼š</p>
<figure class="highlight rust"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> s = <span class="string">"hello"</span>;</span><br></pre></td></tr></table></figure>
<p>å˜é‡ s è¡¨ç¤ºå­—ç¬¦ä¸²æ–‡å­—ï¼Œå­—ç¬¦ä¸²çš„å€¼è¢«ç¡¬ç¼–ç åˆ°æˆ‘ä»¬ç¨‹åºæºç ä¸­ã€‚å˜é‡ä»å£°æ˜çš„é‚£ä¸€åˆ»èµ·å°±ä¸€ç›´æœ‰æ•ˆç›´åˆ°ä½œç”¨åŸŸçš„ç»“å°¾ã€‚æ¸…å• 4-1 æ³¨é‡Šè¯´æ˜äº†å˜é‡ s çš„ä½œç”¨åŸŸã€‚</p>
<figure class="highlight rust"><table><tr><td class="code"><pre><span class="line">&#123;   <span class="comment">// s åœ¨è¿™ä¸å¯ç”¨ï¼Œå®ƒè¿˜æœªè¢«å®šä¹‰</span></span><br><span class="line">    <span class="keyword">let</span> s = <span class="string">"hello"</span>; <span class="comment">// ä»è¿™ä¸€ç‚¹å¼€å§‹ s æ˜¯æœ‰æ•ˆçš„</span></span><br><span class="line">    <span class="comment">// ç”¨ s åšä¸€äº›äº‹æƒ…</span></span><br><span class="line">&#125;   <span class="comment">// ä½œç”¨åŸŸç»“æŸäº†ï¼Œs ä¸å†æœ‰æ•ˆ</span></span><br></pre></td></tr></table></figure>
<p>æ¸…å• 4-1: å˜é‡åŠå…¶ä½œç”¨åŸŸ</p>
<p>æ¢å¥è¯è¯´ï¼Œè¿™é‡Œæœ‰ä¸¤ä¸ªé‡è¦çš„æ—¶é—´ç‚¹ï¼š</p>
<ul>
<li>å½“ s è¿›å…¥ä½œç”¨åŸŸæ—¶ï¼Œå®ƒæ˜¯æœ‰æ•ˆçš„ã€‚</li>
<li>å®ƒä¿æŒæœ‰æ•ˆï¼Œç›´åˆ°è¶…å‡ºä½œç”¨åŸŸèŒƒå›´ã€‚</li>
</ul>
<p>æ­¤æ—¶ï¼Œä½œç”¨åŸŸå’Œå˜é‡æœ‰æ•ˆçš„å…³ç³»ä¸å…¶ä»–ç¼–ç¨‹è¯­è¨€ç±»ä¼¼ã€‚ç°åœ¨ï¼Œä»¥æ­¤ä¸ºåŸºç¡€ï¼Œæˆ‘ä»¬å°†ä»‹ç» String ç±»å‹ã€‚</p>
<h2 id="String-ç±»å‹"><a href="#String-ç±»å‹" class="headerlink" title="String ç±»å‹"></a><code>String</code> ç±»å‹</h2><p>ä¸ºäº†è¯´æ˜æ‰€æœ‰æƒè§„åˆ™ï¼Œæˆ‘ä»¬éœ€è¦çš„æ•°æ®ç±»å‹æ¯”ç¬¬ 3 ç« â€œæ•°æ®ç±»å‹â€ä¸€èŠ‚ä¸­ä»‹ç»çš„æ•°æ®ç±»å‹æ›´å¤æ‚ã€‚å…ˆå‰æ¶µç›–çš„ç±»å‹éƒ½å­˜å‚¨åœ¨æ ˆä¸­ï¼Œå½“å®ƒä»¬çš„ä½œç”¨åŸŸç»“æŸæ—¶ä¼šä»æ ˆä¸­å¼¹å‡ºï¼Œä½†æ˜¯æˆ‘ä»¬æƒ³æŸ¥çœ‹å­˜å‚¨åœ¨å †ä¸­çš„æ•°æ®ï¼Œå¹¶æ¢ç´¢ Rust å¦‚ä½•çŸ¥é“ä½•æ—¶è¯¥æ¸…ç†è¿™äº›æ•°æ®ã€‚</p>
<p>è¿™é‡Œæˆ‘ä»¬ç”¨ String ä¸¾ä¾‹å¹¶ä¸“æ³¨äº String ä¸æ‰€æœ‰æƒæœ‰å…³çš„éƒ¨åˆ†ã€‚è¿™äº›æ–¹é¢ä¹Ÿé€‚ç”¨äºå…¶ä»–å¤æ‚æ•°æ®ç±»å‹ï¼Œæ— è®ºæ˜¯æ ‡å‡†åº“æä¾›çš„è¿˜æ˜¯ä½ è‡ªé€ çš„ã€‚ç¬¬ 8  ç« ä¸­æˆ‘ä»¬ä¼šæ›´æ·±å…¥çš„è®¨è®º String ã€‚</p>
<p>æˆ‘ä»¬å·²ç»çœ‹è¿‡å­—ç¬¦ä¸²æ–‡å­—ï¼Œå…¶ä¸­å­—ç¬¦ç¡¬ç¼–ç åœ¨æˆ‘ä»¬çš„ç¨‹åºä¸­ã€‚å­—ç¬¦ä¸²æ–‡å­—å¾ˆæ–¹ä¾¿ï¼Œä½†æ˜¯å¹¶ä¸æ˜¯åœ¨æ‰€æœ‰ä½¿ç”¨æ–‡å­—çš„åœºæ™¯éƒ½åˆé€‚ã€‚å…¶ä¸­ä¸€ä¸ªåŸå› æ˜¯ï¼Œå®ƒä»¬æ˜¯ä¸å¯å˜çš„ã€‚å¦ä¸€ä¸ªæ˜¯åœ¨ç¼–å†™ä»£ç æ—¶ï¼Œå¹¶éæ¯ä¸ªå­—ç¬¦å€¼éƒ½å¯ä»¥çŸ¥é“ï¼šä¾‹å¦‚ï¼Œæˆ‘ä»¬æƒ³è·å¾—ç”¨æˆ·è¾“å…¥å¹¶ä¿å­˜è¯¥è¾“å…¥è¯¥æ€ä¹ˆåŠï¼Ÿå¯¹äºè¿™ç§æƒ…å†µï¼Œ Rust å…·æœ‰ç¬¬äºŒç§å­—ç¬¦ä¸²ç±»å‹ <code>String</code> ã€‚è¿™ç§ç±»å‹åˆ†é…åœ¨å †ä¸Šï¼Œå› æ­¤å¯ä»¥å­˜å‚¨åœ¨ç¼–è¯‘æ—¶æœªçŸ¥çš„å¤§é‡æ–‡æœ¬ã€‚ä½ å¯ä»¥ä½¿ç”¨ <code>from</code> å‡½æ•°ä»å­—ç¬¦ä¸²æ–‡å­—åˆ›å»ºå­—ç¬¦ä¸²ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<figure class="highlight rust"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> s = <span class="built_in">String</span>::from(<span class="string">"hello"</span>);</span><br></pre></td></tr></table></figure>
<p>åŒå†’å·ï¼ˆ::ï¼‰æ˜¯ä¸€ç§è¿ç®—ç¬¦ï¼Œè¿™ç§è¿ç®—ç¬¦ä½¿æˆ‘ä»¬å¯ä»¥è°ƒç”¨ç‰¹å®šå‘½åç©ºé—´ String ç±»å‹ä¸‹çš„ from å‡½æ•°ã€‚è€Œä¸æ˜¯ç”¨ç±»ä¼¼ string_from è¿™æ ·çš„åå­—ã€‚æˆ‘ä»¬å°†åœ¨ç¬¬ 5 ç« çš„â€œæ–¹æ³•è¯­æ³•â€éƒ¨åˆ†ä»¥åŠç¬¬ 7 ç« çš„â€œæ¨¡å—æ ‘ä¸­å¼•ç”¨é¡¹ç›®çš„è·¯å¾„â€ ä¸­æ›´å¤šè®¨è®ºè¿™ç§è¯­æ³•ã€‚</p>
<p>è¿™ç§å­—ç¬¦ä¸²å¯ä»¥è¢«æ”¹å˜ï¼š</p>
<figure class="highlight rust"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="keyword">mut</span> s = <span class="built_in">String</span>::from(<span class="string">"hello"</span>);</span><br><span class="line">s.push_str(<span class="string">", world!"</span>); <span class="comment">// push_str() æ·»åŠ æ–‡å­—åˆ°å­—ç¬¦ä¸²</span></span><br><span class="line"><span class="built_in">println!</span>(<span class="string">"&#123;&#125;"</span>, s); <span class="comment">// è¿™é‡Œå°†æ‰“å° `hello, world!`</span></span><br></pre></td></tr></table></figure>
<p>æ‰€ä»¥ï¼Œè¿™å„¿æœ‰ä»€ä¹ˆåŒºåˆ«å‘¢ï¼Ÿä¸ºä»€ä¹ˆ String å¯ä»¥è¢«æ”¹å˜è€Œæ–‡å­—å°±ä¸è¡Œï¼ŸåŒºåˆ«åœ¨è¿™ä¸¤ç§ç±»å‹å¦‚ä½•å¤„ç†å†…å­˜ã€‚</p>
<h2 id="å†…å­˜å’Œåˆ†é…"><a href="#å†…å­˜å’Œåˆ†é…" class="headerlink" title="å†…å­˜å’Œåˆ†é…"></a>å†…å­˜å’Œåˆ†é…</h2><p>å¯¹äºå­—ç¬¦ä¸²æ–‡å­—ï¼Œæˆ‘ä»¬åœ¨ç¼–è¯‘æ—¶å°±çŸ¥é“å†…å®¹ï¼Œå› æ­¤æ–‡æœ¬ç›´æ¥èƒŒå½±ç¼–ç åˆ°æœ€ç»ˆçš„å¯æ‰§è¡Œæ–‡ä»¶ä¸­ã€‚è¿™å°±æ˜¯å­—ç¬¦æ–‡å­—é«˜æ•ˆå¿«é€Ÿçš„åŸå› ã€‚ä½†æ˜¯è¿™äº›å±æ€§ä»…æ¥è‡ªå­—ç¬¦ä¸²æ–‡å­—çš„ä¸å¯å˜æ€§ã€‚ä¸å¹¸çš„æ˜¯ï¼Œå¯¹äºåœ¨ç¼–è¯‘æ—¶å¤§å°æœªçŸ¥ä¸”è¿è¡Œç¨‹åºæ—¶å¤§å°å¯èƒ½æ”¹å˜çš„æ–‡æœ¬ï¼Œæˆ‘ä»¬æ— æ³•åœ¨äºŒè¿›åˆ¶æ–‡ä»¶ä¸­æ·»åŠ å¤§é‡çš„å†…å­˜ã€‚</p>
<p>å¯¹äº String ç±»å‹ï¼Œä¸ºäº†æ”¯æŒå¯å˜çš„ï¼Œå¯å¢é•¿çš„æ–‡æœ¬ï¼Œæˆ‘ä»¬éœ€è¦åœ¨å †ä¸Šåˆ†é…ä¸€å®šæ•°é‡çš„å†…å­˜ï¼Œåœ¨ç¼–è¯‘æ—¶ä¸ºæ­¢ï¼Œç”¨ä»¥ä¿å­˜å†…å®¹ï¼Œè¿™æ„å‘³ç€ï¼š</p>
<ul>
<li>å¿…é¡»åœ¨è¿è¡Œæ—¶ä»æ“ä½œç³»ç»Ÿè¯·æ±‚å†…å­˜ã€‚</li>
<li>åœ¨ String æ“ä½œå®Œæˆåï¼Œæˆ‘ä»¬éœ€è¦ä¸€ç§æ–¹æ³•å°†è¯¥å†…å­˜è¿”è¿˜ç»™æ“ä½œç³»ç»Ÿã€‚</li>
</ul>
<p>ç¬¬ä¸€éƒ¨åˆ†æœ‰æˆ‘ä»¬å®Œæˆï¼šå½“æˆ‘ä»¬è°ƒç”¨ String::from æ—¶ï¼Œå…¶å®ç°ä¼šè¯·æ±‚æ‰€éœ€è¦çš„å†…å­˜ã€‚è¿™åœ¨ç¼–ç¨‹è¯­è¨€ä¸­å‡ ä¹æ˜¯é€šç”¨çš„ã€‚</p>
<p>ç„¶è€Œï¼Œç¬¬äºŒéƒ¨åˆ†å°±ä¸åŒäº†ï¼Œå¸¦æœ‰åƒåœ¾å›æ”¶å™¨ï¼ˆGCï¼‰çš„è¯­è¨€ï¼ŒGC ä¼šè·Ÿè¸ªå¹¶æ¸…ç†ä¸å†ä½¿ç”¨çš„å†…å­˜ï¼Œæˆ‘ä»¬ä¸éœ€è¦è€ƒè™‘ã€‚æ²¡æœ‰ GC ï¼Œæˆ‘ä»¬å°±è¦è´Ÿè´£ç¡®å®šä½•æ—¶ä¸å†ä½¿ç”¨å†…å­˜ï¼Œå¹¶è°ƒç”¨ä»£ç æ˜ç¡®çš„é‡Šæ”¾å†…å­˜ï¼Œå°±åƒæˆ‘ä»¬è¦æ±‚çš„é‚£æ ·ã€‚ä»å†å²ä¸Šçœ‹ï¼Œè¦æ­£ç¡®æ‰§è¡Œæ­¤æ“ä½œä¸€ç›´æ˜¯ç¼–ç¨‹éš¾é¢˜ã€‚å¦‚æœæˆ‘ä»¬å¿˜è®°äº†ï¼Œå°±ä¼šæµªè´¹å†…å­˜ã€‚å¦‚æœè¿‡æ—©çš„é‡Šæ”¾ï¼Œæˆ‘ä»¬å°±å¾—åˆ°äº†ä¸å¯ç”¨çš„å˜é‡ã€‚å¦‚æœæˆ‘ä»¬é‡å¤é‡Šæ”¾ï¼Œä¹Ÿæ˜¯æœ‰é—®é¢˜çš„ã€‚æˆ‘ä»¬éœ€è¦å°†ä¸€ä¸ª allocateï¼ˆåˆ†é…ï¼‰ æ°å¥½ä¸ä¸€ä¸ª freeï¼ˆé‡Šæ”¾ï¼‰ å¯¹åº”ã€‚</p>
<p>Rust é‡‡å–äº†å¦ä¸€ç§è·¯å¾„ï¼šæ‹¥æœ‰å®ƒçš„å˜é‡è¶…å‡ºèŒƒå›´åï¼Œå†…å­˜è‡ªåŠ¨å›æ”¶ã€‚è¿™æ˜¯æ¸…å• 4-1 ä¸­ä½œç”¨åŸŸå®ä¾‹çš„ä¸€ä¸ªç‰ˆæœ¬ï¼Œå…¶ä¸­ String æ›¿ä»£äº†å­—ç¬¦ä¸²å¸¸é‡ï¼š</p>
<figure class="highlight rust"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="keyword">let</span> s = <span class="built_in">String</span>::from(<span class="string">"hello"</span>); <span class="comment">// ä»è¿™ä¸€ç‚¹å¼€å§‹ s æ˜¯æœ‰æ•ˆçš„</span></span><br><span class="line">    <span class="comment">// ç”¨ s åšä¸€äº›äº‹æƒ…</span></span><br><span class="line">&#125;   <span class="comment">// ä½œç”¨åŸŸç»“æŸäº†ï¼Œs ä¸å†æœ‰æ•ˆ</span></span><br></pre></td></tr></table></figure>
<p>æˆ‘ä»¬å¯ä»¥å¾ˆè‡ªç„¶åœ°å°† String éœ€è¦çš„å†…å­˜è¿”å›ç»™æ“ä½œç³»ç»Ÿï¼šå½“è¶…å‡º s çš„ä½œç”¨åŸŸã€‚å½“å˜é‡è¶…å‡ºä½œç”¨åŸŸï¼Œ Rust è°ƒç”¨ä¸€ä¸ªç‰¹æ®Šçš„å‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°å« <code>drop</code> ï¼Œè¿™æ˜¯ String çš„ä½œè€…å¯ä»¥åœ¨å…¶ä¸­é˜²æ­¢ä»£ç ä»¥è¿”å›å†…å­˜çš„åœ°æ–¹ã€‚ Rust åœ¨å³å¤§æ‹¬å·å‡ºè‡ªåŠ¨è°ƒç”¨ drop å‡½æ•°ã€‚</p>
<blockquote>
<p>æ³¨æ„ï¼šåœ¨ C++ ä¸­ï¼Œè¿™ç§åœ¨é¡¹ç›®ç”Ÿå‘½å‘¨æœŸç»“æŸæ—¶åˆ†é…èµ„æºçš„æ¨¡å¼æœ‰æ—¶ç§°ä¸ºâ€œèµ„æºè·å–å³åˆå§‹åŒ–â€ï¼ˆ Resource Acquisition Is Initialization, RAIIï¼‰ï¼Œå¦‚æœä½ ä½¿ç”¨è¿‡ RAII æ¨¡å¼ï¼ŒRust ä¸­çš„ drop ä¹Ÿå°±ä¸ä¼šé™Œç”Ÿã€‚</p>
</blockquote>
<p>è¿™ç§æ¨¡å¼å¯¹ Rust ä»£ç çš„ç¼–å†™æ–¹å¼æœ‰æ·±è¿œå½±å“ã€‚ç°åœ¨çœ‹èµ·æ¥ä¼¼ä¹å¾ˆç®€å•ï¼Œä½†æ˜¯åœ¨æ›´å¤æ‚çš„æƒ…å†µä¸‹ï¼Œå½“æˆ‘ä»¬æƒ³è®©å¤šä¸ªå˜é‡ä½¿ç”¨æˆ‘ä»¬åœ¨å †ä¸Šåˆ†é…çš„æ•°æ®æ—¶ï¼Œä»£ç çš„è¡Œä¸ºå¯èƒ½å‡ºä¹æ„æ–™ã€‚ç°åœ¨æˆ‘ä»¬æ¢è®¨å…¶ä¸­çš„ä¸€äº›æƒ…å†µã€‚</p>
<h3 id="å˜é‡ä¸æ•°æ®äº¤äº’çš„æ–¹å¼ï¼šç§»åŠ¨ï¼ˆMoveï¼‰"><a href="#å˜é‡ä¸æ•°æ®äº¤äº’çš„æ–¹å¼ï¼šç§»åŠ¨ï¼ˆMoveï¼‰" class="headerlink" title="å˜é‡ä¸æ•°æ®äº¤äº’çš„æ–¹å¼ï¼šç§»åŠ¨ï¼ˆMoveï¼‰"></a>å˜é‡ä¸æ•°æ®äº¤äº’çš„æ–¹å¼ï¼šç§»åŠ¨ï¼ˆMoveï¼‰</h3><p>å¤šä¸ªå˜é‡å¯ä»¥åœ¨ Rust ä¸­ä»¥ä¸åŒæ–¹å¼ä¸åŒä¸€ä¸ªæ•°æ®äº¤äº’ã€‚çœ‹æ¸…å• 4-2 ä¸­çš„ä¾‹å­ï¼š</p>
<figure class="highlight rust"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> x = <span class="number">5</span>;</span><br><span class="line"><span class="keyword">let</span> y = x;</span><br></pre></td></tr></table></figure>
<p>æ¸…å• 4-2 ï¼šå°†å˜é‡ x èµ‹å€¼ç»™ y</p>
<p>æˆ‘ä»¬å¯èƒ½ä¼šçŒœå®ƒåšäº†ä»€ä¹ˆï¼šâ€œå°† 5 å€¼ç»‘å®šåˆ° x ï¼›ç„¶ååœ¨ x ä¸­å¤åˆ¶å€¼å¹¶å°†å…¶ç»‘å®šåˆ° y ã€‚â€ æˆ‘ä»¬ç°åœ¨æœ‰ä¸¤ä¸ªå˜é‡ x å’Œ y ï¼Œ å®ƒä»¬éƒ½ç­‰äº 5 ã€‚è¿™ç¡®å®æ˜¯æ­£åœ¨å‘ç”Ÿçš„äº‹æƒ…ï¼Œå› ä¸ºæ•´æ•°æ˜¯å·²çŸ¥ä¸”å›ºå®šå¤§å°çš„ç®€å•å€¼ï¼Œç„¶åå°†è¿™ä¸¤ä¸ª 5 å€¼å‹å…¥æ ˆã€‚</p>
<p>ç°åœ¨çœ‹ä¸€çœ‹ String ç‰ˆæœ¬:</p>
<figure class="highlight rust"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> s1 = <span class="built_in">String</span>::from(<span class="string">"hello"</span>);</span><br><span class="line"><span class="keyword">let</span> s2 = s1;</span><br></pre></td></tr></table></figure>
<p>è¿™å’Œå‰ä¸€æ®µä»£ç å¾ˆç›¸ä¼¼ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥å‡è®¾å®ƒçš„å·¥ä½œæ–¹å¼æ˜¯ç›¸åŒçš„ï¼šé‚£å°±æ˜¯ï¼Œç¬¬äºŒè¡Œä¼šå¾—åˆ° s1 çš„æ‹·è´å¹¶ç»‘å®šåˆ° s2 ã€‚ä½†æ˜¯å®é™…ä¸æ˜¯è¿™æ ·çš„ã€‚</p>
<p>çœ‹å›¾ 4-1 ,çœ‹çœ‹ String å¹•åå‘ç”Ÿäº†ä»€ä¹ˆã€‚ä¸€ä¸ª String åˆ†æˆä¸‰ä¸ªéƒ¨åˆ†ï¼Œç”»åœ¨äº†å·¦è¾¹ï¼šä¸€ä¸ªæŒ‡å‘ä¿å­˜å­—ç¬¦ä¸²å†…å®¹çš„å†…å­˜æŒ‡é’ˆï¼Œä¸€ä¸ªé•¿åº¦ï¼Œè¿˜æœ‰ä¸€ä¸ªå®¹é‡ã€‚è¿™ç»„æ•°æ®ä¿å­˜åœ¨æ ˆé‡Œã€‚å³è¾¹æ˜¯ä¿å­˜åœ¨å †å†…å­˜ä¸Šçš„å†…å®¹ã€‚</p>
<p><img src="trpl04-01.svg" alt="4-1"></p>
<p>å›¾ 4-1ï¼šå†…å­˜ä¸­ç»‘å®šåˆ° s1 çš„å€¼ â€œhelloâ€ çš„å­—ç¬¦ä¸²è¡¨ç¤ºå½¢å¼ã€‚</p>
<p>è¯¥é•¿åº¦ï¼ˆlenï¼‰æ˜¯ String å½“å‰æ­£åœ¨ä½¿ç”¨çš„å†…å­˜é‡ï¼ˆä»¥å­—èŠ‚ä¸ºå•ä½ï¼‰ã€‚æ­¤å¤„å®¹é‡ï¼ˆcapacityï¼‰æ˜¯ String ä»æ“ä½œç³»ç»Ÿæ¥å—çš„å†…å­˜æ€»é‡ï¼ˆä»¥å­—èŠ‚ä¸ºå•ä½ï¼‰ã€‚é•¿åº¦å’Œå®¹é‡ä¹‹é—´çš„å·®åˆ«å¾ˆé‡è¦ï¼Œä½†è¿™ç§æƒ…å†µä¸‹å¹¶ä¸é‡è¦ï¼Œæš‚æ—¶å¯ä»¥å¿½ç•¥å®¹é‡ã€‚</p>
<p>å½“æˆ‘ä»¬æŠŠ s1 èµ‹å€¼ç»™ s2 ï¼Œ String æ•°æ®è¢«å¤åˆ¶ï¼Œè¿™æ„å‘³ç€æˆ‘ä»¬å¤åˆ¶äº†æ ˆä¸Šçš„æŒ‡é’ˆï¼Œé•¿åº¦å’Œå®¹é‡ã€‚æˆ‘ä»¬ä¸ä¼šå¤åˆ¶æŒ‡é’ˆæŒ‡å‘çš„å †ä¸Šçš„æ•°æ®ï¼Œå†…å­˜ä¸­çš„æ•°æ®å¦‚å›¾ 4-2 æ‰€ç¤ºã€‚</p>
<p><img src="trpl04-02.svg" alt="4-2"></p>
<p>å›¾ 4-2ï¼šå˜é‡ <code>s2</code> åœ¨å†…å­˜ä¸­è¡¨ç¤ºå½¢å¼ï¼Œè¯¥å˜é‡å…·æœ‰ <code>s1</code> çš„æŒ‡é’ˆï¼Œé•¿åº¦å’Œå®¹é‡çš„å‰¯æœ¬ã€‚</p>
<p>å¦‚æœ Rust å¤åˆ¶äº†å †æ•°æ®çš„è¯ï¼Œå°±ä¼šåƒå›¾ 4-3 ï¼Œä½†ä¸æ˜¯è¿™æ ·çš„ã€‚å¦‚æœå †ä¸Šçš„æ•°æ®å¾ˆå¤§ï¼Œ Rust å¤åˆ¶å †ä¸Šçš„æ•°æ®ï¼Œå°±ä¼šä½¿ <code>s2 = s1</code> è¿è¡Œä»£ä»·å¾ˆé«˜ã€‚</p>
<p><img src="trpl04-03.svg" alt="4-3"></p>
<p>å›¾ 4-3ï¼šå¦‚æœ Rust ä¹Ÿå¤åˆ¶å †æ•°æ®ï¼Œåˆ™ s2 = s1 å¯èƒ½è¿™ä¹ˆåš</p>
<p>å…ˆå‰æˆ‘ä»¬è¯´è¿‡ï¼Œå½“å˜é‡è¶…å‡ºä½œç”¨åŸŸï¼Œ Rust è‡ªåŠ¨è°ƒç”¨ drop å‡½æ•°å¹¶æ¸…ç†è¯¥å˜é‡çš„å †å†…å­˜ã€‚ä½†æ˜¯å›¾ 4-2 æ˜¾ç¤ºäº†ä¸¤ä¸ªæŒ‡å‘ç›¸åŒä½ç½®çš„æ•°æ®æŒ‡é’ˆã€‚è¿™æ˜¯ä¸€ä¸ªé—®é¢˜ï¼šå½“ s2 å’Œ s1 éƒ½è¶…å‡ºèŒƒå›´æ—¶ï¼Œå®ƒä»¬éƒ½ä¼šå°è¯•é‡Šæ”¾ç›¸åŒä¸€å—çš„å†…å­˜ã€‚è¿™è¢«ç§°ä¸º <em>åŒé‡é‡Šæ”¾é”™è¯¯</em> ,æ˜¯æˆ‘ä»¬å‰é¢æåˆ°çš„å†…å­˜å®‰å…¨é”™è¯¯ä¹‹ä¸€ã€‚é‡Šæ”¾å†…å­˜ä¸¤æ¬¡å¯èƒ½å¯¼è‡´å†…å­˜æŸåï¼Œä»è€Œå¯èƒ½å¯¼è‡´å®‰å…¨æ¼æ´ã€‚</p>
<p>ä¸ºäº†ç¡®ä¿å†…å­˜å®‰å…¨ï¼Œåœ¨ Rust ä¸­ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ä¼šå‘ç”Ÿçš„äº‹æƒ…æœ‰å¾ˆå¤šç»†èŠ‚ã€‚Rust ä¸ä¼šå°è¯•å¤åˆ¶åˆ†é…çš„å†…å­˜ï¼Œè€Œæ˜¯è®¤ä¸º s1 ä¸å†æœ‰æ•ˆï¼Œå› æ­¤ï¼Œå½“ s1 è¶…å‡ºèŒƒå›´æ—¶ï¼Œ Rust ä¸éœ€è¦é‡Šæ”¾ä»»ä½•å†…å®¹ã€‚æ£€æŸ¥ä¸‹åˆ›å»º s2 ä¹‹åå°è¯•ä½¿ç”¨ s1 ä¼šå‘ç”Ÿä»€ä¹ˆï¼›å®ƒä¸èµ·ä½œç”¨ï¼š</p>
<figure class="highlight rust"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> s1 = <span class="built_in">String</span>::from(<span class="string">"hello"</span>);</span><br><span class="line"><span class="keyword">let</span> s2 = s1;</span><br><span class="line"></span><br><span class="line"><span class="built_in">println!</span>(<span class="string">"&#123;&#125;, world"</span>, s1);</span><br></pre></td></tr></table></figure>
<p>ä½ ä¼šå¾—åˆ°ä¸‹é¢çš„é”™è¯¯ï¼Œå› ä¸º Rust é˜»æ­¢ä½ ä½¿ç”¨æ— æ•ˆçš„å¼•ç”¨ï¼š</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">error[E0382]: use of moved value: `s1`</span><br><span class="line"> --&gt; src/main.rs:5:28</span><br><span class="line">  |</span><br><span class="line">3 |     <span class="built_in">let</span> s2 = s1;</span><br><span class="line">  |         -- value moved here</span><br><span class="line">4 |</span><br><span class="line">5 |     println!(<span class="string">"&#123;&#125;, world!"</span>, s1);</span><br><span class="line">  |                            ^^ value used here after move</span><br><span class="line">  |</span><br><span class="line">  = note: move occurs because `s1` has <span class="built_in">type</span> `std::string::String`, <span class="built_in">which</span> does</span><br><span class="line">  not implement the `Copy` trait</span><br></pre></td></tr></table></figure>
<p>å¦‚æœä½ åœ¨ä½¿ç”¨å…¶ä»–è¯­è¨€æ—¶å¬è¯´è¿‡æµ…æ‹·è´ï¼ˆshallow copyï¼‰å’Œæ·±æ‹·è´ï¼ˆdeep copyï¼‰è¿™ä¸¤ä¸ªæœ¯è¯­ï¼Œé‚£ä¹ˆå¤åˆ¶æŒ‡é’ˆã€é•¿åº¦å’Œå®¹é‡è€Œä¸å¤åˆ¶æ•°æ®çš„æ¦‚å¿µå¬èµ·æ¥å°±åƒæ˜¯æµ…æ‹·è´ã€‚ä½†æ˜¯ç”±äº Rust è¿˜ä½¿ç¬¬ä¸€ä¸ªå˜é‡æ— æ•ˆï¼Œè¿™ä¸æ˜¯æµ…æ‹·è´ï¼Œå› æ­¤ç§°ä¸ºç§»åŠ¨ï¼ˆmoveï¼‰ã€‚åœ¨æ­¤ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬è¯´ s1 å·²ç§»å…¥ s2ã€‚å› æ­¤å®é™…å‘ç”Ÿçš„æƒ…å†µå¦‚å›¾ 4-4 æ‰€ç¤ºã€‚</p>
<p><img src="trpl04-04.svg" alt="4-4"></p>
<p>å›¾ 4-4ï¼šs1 æ— æ•ˆåå†å†…å­˜ä¸­çš„è¡¨ç¤ºå½¢å¼</p>
<p>é‚£è§£å†³äº†æˆ‘ä»¬çš„é—®é¢˜ï¼åªæœ‰ s2 æœ‰æ•ˆï¼Œå½“å®ƒè¶…å‡ºèŒƒå›´æ—¶ï¼Œä»…å‡­å®ƒå°±å¯ä»¥é‡Šæ”¾å†…å­˜ï¼Œå®Œæˆäº†ã€‚</p>
<p>æ­¤å¤–ï¼Œè¿™æš—ç¤ºäº†ä¸€ç§è®¾è®¡é€‰æ‹©ï¼š Rust æ°¸è¿œä¸ä¼šè‡ªåŠ¨åˆ›å»ºæ•°æ®çš„â€œæ·±å±‚â€å‰¯æœ¬ã€‚å› æ­¤ï¼Œå°±è¿è¡Œæ•ˆç‡è€Œè¨€ï¼Œä»»ä½•è‡ªåŠ¨å¤åˆ¶éƒ½è¢«è®¤ä¸ºæ˜¯å»‰ä»·çš„ã€‚</p>
<h2 id="å˜é‡ä¸æ•°æ®äº¤äº’çš„æ–¹å¼ï¼šå…‹éš†ï¼ˆCloneï¼‰"><a href="#å˜é‡ä¸æ•°æ®äº¤äº’çš„æ–¹å¼ï¼šå…‹éš†ï¼ˆCloneï¼‰" class="headerlink" title="å˜é‡ä¸æ•°æ®äº¤äº’çš„æ–¹å¼ï¼šå…‹éš†ï¼ˆCloneï¼‰"></a>å˜é‡ä¸æ•°æ®äº¤äº’çš„æ–¹å¼ï¼šå…‹éš†ï¼ˆCloneï¼‰</h2><p>å¦‚æœæˆ‘ä»¬ç¡®å®è¦æ·±æ‹·è´ String çš„å †æ•°æ®ï¼Œè€Œä¸ä»…ä»…æ˜¯æ ˆæ•°æ®ï¼Œåˆ™å¯ä»¥ä½¿ç”¨ä¸€ç§ç§°ä¸º <code>clone</code> çš„é€šç”¨æ–¹æ³•ã€‚æˆ‘ä»¬å°†åœ¨ç¬¬ 5 ç« è®¨è®ºæ–¹æ³•è¯­æ³•ï¼Œä½†æ˜¯ç”±äºæ–¹æ³•æ˜¯è®¸å¤šç¼–ç¨‹è¯­è¨€ä¸­çš„å¸¸ç”¨åŠŸèƒ½ï¼Œå› æ­¤ä½ ä»¥å‰å¯èƒ½è§è¿‡å®ƒä»¬ã€‚</p>
<p>è¿™æ˜¯ <code>clone</code> æ–¹æ³•çš„å®é™…ä¾‹å­ï¼š</p>
<figure class="highlight rust"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> s1 = <span class="built_in">String</span>::from(<span class="string">"hello"</span>);</span><br><span class="line"><span class="keyword">let</span> s2 = s1.clone();</span><br><span class="line"></span><br><span class="line"><span class="built_in">println!</span>(<span class="string">"s1 = &#123;&#125;, s2 = &#123;&#125;"</span>, s1, s2);</span><br></pre></td></tr></table></figure>
<p>è¿™ä»£ç å¯ä»¥è¿è¡Œï¼Œå¹¶ä¸”æ˜¾ç¤ºå®Œæˆäº†å›¾ 4-3 çš„è¡Œä¸ºï¼Œå®ƒç¡®å®å¤åˆ¶äº†å †æ•°æ®ã€‚</p>
<p>å½“ä½ çœ‹åˆ°å…‹éš†è°ƒç”¨æ—¶ï¼Œä½ å› è¯¥çŸ¥é“æ­£åœ¨æ‰§è¡Œçš„ä»£ç å¯èƒ½è¿è¡Œå¼€é”€å¾ˆå¤§ã€‚è¿™ç§è§†è§‰æŒ‡ç¤ºå™¨è¡¨æ˜å‘ç”Ÿäº†ä¸€äº›ä¸åŒçš„æƒ…å†µã€‚</p>
<h2 id="ä»…æ ˆæ•°æ®ï¼šæ‹·è´ï¼ˆCopyï¼‰"><a href="#ä»…æ ˆæ•°æ®ï¼šæ‹·è´ï¼ˆCopyï¼‰" class="headerlink" title="ä»…æ ˆæ•°æ®ï¼šæ‹·è´ï¼ˆCopyï¼‰"></a>ä»…æ ˆæ•°æ®ï¼šæ‹·è´ï¼ˆCopyï¼‰</h2><p>è¿˜æœ‰ä¸ªé—®é¢˜æ²¡æœ‰è®¨è®ºã€‚è¿™æ®µä½¿ç”¨äº†æ•´æ•°çš„ä»£ç æ˜¯æœ‰æ•ˆçš„ï¼Œéƒ¨åˆ†ä»£ç å¦‚æ¸…å• 4-2 æ‰€ç¤ºï¼š</p>
<figure class="highlight rust"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> x = <span class="number">5</span>;</span><br><span class="line"><span class="keyword">let</span> y = x;</span><br><span class="line"><span class="built_in">println!</span>(<span class="string">"x = &#123;&#125;, y = &#123;&#125;"</span>, x, y);</span><br></pre></td></tr></table></figure>
<p>è¿™æ®µä»£ç ä¼¼ä¹ä¸æˆ‘ä»¬åˆšå­¦åˆ°çš„çŸ›ç›¾ï¼šæˆ‘ä»¬æ²¡æœ‰è°ƒç”¨ clone æ–¹æ³•ï¼Œä½†æ˜¯ x ä»ç„¶å¯ç”¨ä¸”ä¸æ˜¯ç§»å…¥ y ã€‚</p>
<p>åŸå› æ˜¯è¯¸å¦‚åœ¨ç¼–è¯‘æ—¶å·²çŸ¥å¤§å°çš„æ•´æ•°ä¹‹ç±»çš„ç±»å‹ï¼Œå®Œå…¨å­˜å‚¨åœ¨æ ˆä¸­ï¼Œå› æ­¤å¯ä»¥å¿«é€Ÿäº§ç”Ÿå®é™…å€¼çš„å‰¯æœ¬ã€‚è¿™æ„å‘³ç€åœ¨åˆ›å»ºå˜é‡ y ä¹‹åï¼Œæˆ‘ä»¬ä¸éœ€è¦é˜»æ­¢ x ç”Ÿæ•ˆã€‚æ¢å¥è¯è¯´ï¼Œè¿™é‡Œçš„æ·±æ‹·è´å’Œæµ…æ‹·è´æ²¡æœ‰åŒºåˆ«ï¼Œå› æ­¤è°ƒç”¨å…‹éš†ä¸é€šå¸¸çš„æµ…æ‹·è´æ²¡æœ‰ä¸åŒï¼Œæˆ‘ä»¬å¯ä»¥å°†å…¶çœç•¥ã€‚</p>
<p>Rust å…·æœ‰ä¸€ä¸ªç‰¹æ®Šçš„æ³¨é‡Šï¼Œç§°ä¸º <code>Copy</code> ç‰¹å¾ï¼Œæˆ‘ä»¬å¯ä»¥å°†å…¶æ”¾åœ¨å­˜å‚¨åœ¨æ ˆçš„ç±»å‹ä¸Šï¼ˆç¬¬ 10 ç« è¿›ä¸€æ­¥è®¨è®ºï¼‰ã€‚å¦‚æœç±»å‹å…·æœ‰ <code>Copy</code> ç‰¹å¾ï¼Œåˆ™åˆ†é…åä»ç„¶å¯ä»¥ä½¿ç”¨æ—§çš„å˜é‡å€¼ã€‚ä½†å¦‚æœè¯¥ç±»å‹æˆ–å…¶å®ç°éƒ¨åˆ†å®ç°äº† <code>Drop</code> ç‰¹æ€§ï¼Œ Rust å°†ä¸å…è®¸æˆ‘ä»¬ä½¿ç”¨ <code>Copy</code> ç‰¹å¾å¯¹è¯¥ç±»å‹è¿›è¡Œæ³¨é‡Šã€‚å¦‚æœåœ¨å€¼è¶…å‡ºèŒƒå›´æ—¶å¯¹è¯¥ç±»å‹éœ€è¦ç‰¹æ®Šå¤„ç†ï¼Œå‘è¯¥ç±»å‹æ·»åŠ  <code>Copy</code> æ³¨é‡Šï¼Œåˆ™ä¼šå‡ºç°ç¼–è¯‘é”™è¯¯ã€‚è¦äº†è§£å¦‚ä½•å°† <code>Copy</code> ç‰¹å¾æ·»åŠ åˆ°ä½ çš„ç±»å‹ä¸­ï¼Œå‚è€ƒé™„å½• C çš„â€œå¯å¯¼å‡ºç‰¹å¾â€ã€‚</p>
<p>é‚£ä¹ˆä»€ä¹ˆç±»å‹è¢«æ‹·è´ï¼Ÿä½ å¯ä»¥æŸ¥çœ‹ç»™å®šçš„æ–‡æ¡£ï¼Œä¸€èˆ¬è§„åˆ™æ˜¯ï¼Œä»»ä½•ä¸€ç»„ç®€å•çš„æ ‡é‡å€¼éƒ½å¯ä»¥æ‹·è´ï¼Œè€Œä¸éœ€è¦åˆ†é…æˆ–æ˜¯æŸç§å½¢å¼çš„èµ„æºéƒ½ä¸æ˜¯æ‹·è´ã€‚ä¸€ä¸‹æ˜¯ä¸€äº› Copy ç±»å‹ï¼š</p>
<ul>
<li>æ‰€æœ‰æ•´æ•°ç±»å‹ï¼Œä¾‹å¦‚ u32 ã€‚</li>
<li>å¸ƒå°”ç±»å‹ï¼Œ <code>bool</code>ã€‚</li>
<li>æ‰€æœ‰æµ®ç‚¹ç±»å‹ï¼Œä¾‹å¦‚ f64 ã€‚</li>
<li>å­—ç¬¦ç±»å‹ï¼Œ <code>char</code>ã€‚</li>
<li>å…ƒç»„ï¼Œå¦‚æœå®ƒä»¬ä»…åŒ…å«å¤åˆ¶ç±»å‹ï¼Œä¾‹å¦‚ï¼Œ (i32, i32) ã€‚è€Œ (i32, String) å°±ä¸æ˜¯ã€‚</li>
</ul>
<h2 id="æ‰€æœ‰æƒå’ŒèŒèƒ½"><a href="#æ‰€æœ‰æƒå’ŒèŒèƒ½" class="headerlink" title="æ‰€æœ‰æƒå’ŒèŒèƒ½"></a>æ‰€æœ‰æƒå’ŒèŒèƒ½</h2><p>ç”¨äºå°†å€¼ä¼ é€’ç»™å‡½æ•°çš„è¯­ä¹‰ç±»ä¼¼äºç”¨äºå°†å€¼åˆ†é…ç»™å˜é‡çš„è¯­ä¹‰ã€‚å°±åƒèµ‹å€¼ä¸€æ ·ï¼Œå°†å˜é‡ä¼ é€’ç»™å‡½æ•°å°†ç§»åŠ¨æˆ–æ‹·è´ã€‚æ¸…å• 4-3 ç»™å‡ºäº†ä¸€ä¸ªç¤ºä¾‹ï¼Œå¯åŠ¨å¸¦æœ‰æ³¨é‡Šï¼Œæ˜¾ç¤ºå˜é‡è¿›å…¥å’Œé€€å‡ºèŒƒå›´çš„ä½ç½®ã€‚</p>
<figure class="highlight rust"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">main</span></span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> s = <span class="built_in">String</span>::from(<span class="string">"hello"</span>);  <span class="comment">// s è¿›å…¥ä½œç”¨åŸŸ</span></span><br><span class="line"></span><br><span class="line">    takes_ownership(s);             <span class="comment">// s çš„å€¼ç§»å…¥å‡½æ•°</span></span><br><span class="line">                                    <span class="comment">// ... s ä»è¿™å¼€å§‹æ— æ•ˆäº†</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> x = <span class="number">5</span>;                      <span class="comment">// x è¿›å…¥ä½œç”¨åŸŸ</span></span><br><span class="line"></span><br><span class="line">    makes_copy(x);                  <span class="comment">// x ç§»å…¥å‡½æ•°ä¸­</span></span><br><span class="line">                                    <span class="comment">// ä½†æ˜¯ i32 æ˜¯æ‹·è´ç±»å‹ï¼Œæ‰€ä»¥ x ä»ç„¶æœ‰æ•ˆ</span></span><br><span class="line">                                    <span class="comment">// ç»§ç»­ä½¿ç”¨ x å˜é‡ã€‚</span></span><br><span class="line"></span><br><span class="line">&#125; <span class="comment">// è¿™é‡Œx è¶…å‡ºä½œç”¨åŸŸï¼Œæ¥ç€æ˜¯ s ã€‚ä½†æ˜¯å› ä¸º s çš„å€¼è¢«ç§»åŠ¨äº†ï¼Œæ²¡ä»€ä¹ˆç‰¹åˆ«æƒ…å†µã€‚</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">takes_ownership</span></span>(some_string: <span class="built_in">String</span>) &#123; <span class="comment">// some_string è¿›å…¥ä½œç”¨åŸŸ</span></span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">"&#123;&#125;"</span>, some_string);</span><br><span class="line">&#125; <span class="comment">// è¿™é‡Œï¼Œ some_string è¶…å‡ºä½œç”¨åŸŸï¼Œè°ƒç”¨ drop ï¼Œé‡Šæ”¾å†…å­˜ã€‚</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">makes_copy</span></span>(some_integer: <span class="built_in">i32</span>) &#123; <span class="comment">// some_integer è¿›å…¥ä½œç”¨åŸŸ</span></span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">"&#123;&#125;"</span>, some_integer);</span><br><span class="line">&#125; <span class="comment">// è¿™é‡Œï¼Œsome_integer è¶…å‡ºä½œç”¨åŸŸï¼Œæ²¡ä»€ä¹ˆç‰¹åˆ«çš„ã€‚</span></span><br></pre></td></tr></table></figure>
<p>æ¸…å• 4-3ï¼šå‡½æ•°çš„æ‰€æœ‰æƒå’Œä½œç”¨åŸŸæ³¨é‡Š</p>
<p>å¦‚æœæˆ‘ä»¬åœ¨è°ƒç”¨ <code>takes_ownership</code> ä¹‹åä½¿ç”¨ s , Rust å°†æŠ›å‡ºç¼–è¯‘ä¸€åœºï¼Œè¿™äº›é™æ€æ£€æŸ¥é˜²æ­¢æˆ‘ä»¬çŠ¯é”™è¯¯ã€‚å°è¯•å°†ä»£ç æ·»åŠ åˆ°ä½¿ç”¨ s å’Œ x çš„ main å‡½æ•°ä¸­ï¼Œä»¥æŸ¥çœ‹å¯ä»¥åœ¨å“ªé‡Œä½¿ç”¨å®ƒä»¬ä»¥åŠæ‰€æœ‰æƒè§„åˆ™åœ¨å“ªé‡Œé˜»æ­¢ä½ è¿™ä¹ˆåšã€‚</p>
<h2 id="è¿”å›å€¼å’Œä½œç”¨åŸŸ"><a href="#è¿”å›å€¼å’Œä½œç”¨åŸŸ" class="headerlink" title="è¿”å›å€¼å’Œä½œç”¨åŸŸ"></a>è¿”å›å€¼å’Œä½œç”¨åŸŸ</h2><p>è¿”å›å€¼ä¹Ÿå¯ä»¥è½¬ç§»æ‰€æœ‰æƒã€‚æ¸…å• 4-4 å¸¦æœ‰ä¸æ¸…å• 4-3 ç±»ä¼¼çš„æ³¨é‡Šã€‚</p>
<figure class="highlight rust"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">main</span></span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> s1 = gives_ownership();         <span class="comment">// gives_ownership å°†å…¶è¿”å›å€¼ç§»å…¥ s</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> s2 = <span class="built_in">String</span>::from(<span class="string">"hello"</span>);     <span class="comment">// s2 è¿›å…¥ä½œç”¨åŸŸ</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> s3 = takes_and_gives_back(s2);  <span class="comment">// s2 è¢«ç§»å…¥ takes_and_gives_backï¼Œ è¯¥</span></span><br><span class="line">                                        <span class="comment">//  å‡½æ•°ä¹Ÿå°†è¿”å›å€¼ç§»å…¥ s3</span></span><br><span class="line">&#125; <span class="comment">// è¿™é‡Œ, s3 è¶…å‡ºä½œç”¨åŸŸè€Œè¢« drop. s2 è¶…å‡ºä½œç”¨åŸŸä½†æ˜¯ç”±äºè¢«ç§»åŠ¨ï¼Œæ‰€ä»¥æ— äº‹å‘ç”Ÿ. </span></span><br><span class="line">  <span class="comment">//  s1 è¶…å‡ºä½œç”¨åŸŸè¢« drop ã€‚</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">gives_ownership</span></span>() -&gt; <span class="built_in">String</span> &#123;             <span class="comment">// gives_ownership å°†è¿”å›å€¼ç§»åŠ¨ç»™</span></span><br><span class="line">                                             <span class="comment">// è°ƒç”¨æ–¹ã€‚</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> some_string = <span class="built_in">String</span>::from(<span class="string">"hello"</span>); <span class="comment">// some_string è¿›å…¥ä½œç”¨åŸŸ</span></span><br><span class="line"></span><br><span class="line">    some_string                              <span class="comment">// some_string è¢«è¿”å›å¹¶ç§»åŠ¨åˆ°å‡½æ•°</span></span><br><span class="line">                                             <span class="comment">// è°ƒç”¨æ–¹ã€‚</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// takes_and_gives_back will take a String and return one</span></span><br><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">takes_and_gives_back</span></span>(a_string: <span class="built_in">String</span>) -&gt; <span class="built_in">String</span> &#123; <span class="comment">// a_string è¿›å…¥ä½œç”¨åŸŸ</span></span><br><span class="line"></span><br><span class="line">    a_string  <span class="comment">// a_string åˆ«è¿”å›ä¸”ç§»åŠ¨åˆ°å‡½æ•°è°ƒç”¨æ–¹</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æ¸…å• 4-4ï¼šè¿”å›å€¼è½¬ç§»æ‰€æœ‰æƒ</p>
<p>å˜é‡çš„æ‰€æœ‰æƒæ¯æ¬¡éƒ½éµå¾ªç›¸åŒçš„æ¨¡å¼ï¼šå°†å€¼åˆ†é…ç»™å®ƒç§»åŠ¨çš„å¦ä¸€ä¸ªå˜é‡ã€‚å½“åŒ…å«å †ä¸Šæ•°æ®çš„å˜é‡è¶…å‡ºèŒƒå›´ï¼Œåªæœ‰è¯¥æ•°æ®ç§»è‡³å¦ä¸€ä¸ªå˜é‡ï¼Œæ‰ drop è¿™ä¸ªå€¼ã€‚</p>
<p>æ‹¥æœ‰æ‰€æœ‰æƒï¼Œç„¶åè¿”å›æ¯ä¸ªå‡½æ•°çš„æ‰€æœ‰æƒï¼Œæœ‰ç‚¹ä¹å‘³ã€‚å¦‚æœæˆ‘ä»¬è¦è®©å‡½æ•°ä½¿ç”¨å€¼ä½†ä¸å–å¾—æ‰€æœ‰æƒæ€ä¹ˆåŠï¼Ÿä»¤äººçƒ¦æ¼çš„æ˜¯ï¼Œé™¤äº†æˆ‘ä»¬å¯èƒ½æƒ³è¿”å›çš„å‡½æ•°ä¸»ä½“çš„ä»»ä½•æ•°æ®ä¹‹å¤–ï¼Œå¦‚æœæˆ‘ä»¬æƒ³å†æ¬¡ä½¿ç”¨å®ƒä»¬ï¼Œè¿˜éœ€è¦å°†å…¶ä¼ é€’å›å»ã€‚</p>
<p>å¯ä»¥ä½¿ç”¨å…ƒç»„è¿”å›å¤šä¸ªå€¼ï¼Œå¦‚æ¸…å• 4-5 ã€‚</p>
<figure class="highlight rust"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">main</span></span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> s1 = <span class="built_in">String</span>::from(<span class="string">"hello"</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> (s2, len) = calculate_length(s1);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">"The length of '&#123;&#125;' is &#123;&#125;."</span>, s2, len);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">calculate_length</span></span>(s: <span class="built_in">String</span>) -&gt; (<span class="built_in">String</span>, <span class="built_in">usize</span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> length = s.len(); <span class="comment">// len() returns the length of a String</span></span><br><span class="line"></span><br><span class="line">    (s, length)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æ¸…å• 4-5ï¼šè¿”å›å‚æ•°æ‰€æœ‰æƒ</p>
<p>ä½†å¯¹äºä¸€ä¸ªåº”è¯¥æ˜¯é€šç”¨çš„æ¦‚å¿µæ¥è¯´ï¼Œè¿™æœ‰å¤ªå¤šçš„ä»ªå¼å’Œå¤§é‡çš„å·¥ä½œã€‚å¹¸è¿çš„æ˜¯ï¼Œ Rust æœ‰æ­¤æ¦‚å¿µçš„åŠŸèƒ½ï¼Œç§°ä¸ºå‚è€ƒï¼ˆreferencesï¼‰ ã€‚</p>
]]></content>
      <tags>
        <tag>rust</tag>
      </tags>
  </entry>
  <entry>
    <title>Rust å­¦ä¹ ç¬”è®° 2</title>
    <url>/2020/03/30/Rust-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-2/</url>
    <content><![CDATA[<p>é˜…è¯» <a href="https://doc.rust-lang.org/book" target="_blank" rel="noopener">ã€Š Rust ç¨‹åºè®¾è®¡ã€‹</a>çš„ä¸€äº›ç¬”è®°ã€‚</p>
<p>ç¬¬ 3 ç«  - é€šç”¨ç¼–ç¨‹æ¦‚å¿µ</p>
<a id="more"></a>
<h2 id="å˜é‡å’Œå¯å˜æ€§"><a href="#å˜é‡å’Œå¯å˜æ€§" class="headerlink" title="å˜é‡å’Œå¯å˜æ€§"></a>å˜é‡å’Œå¯å˜æ€§</h2><p>Rust ä¸­çš„å˜é‡é»˜è®¤ä¸ºä¸å¯å˜çš„ã€‚</p>
<p>åªè¦å˜é‡å®šä¹‰æœªåŠ ä¸Š <code>mut</code> ï¼Œå®ƒåœ¨ç¨‹åºä¸­å°±ä¸ç”¨æ‹…å¿ƒå®ƒè¢«æ”¹å˜ã€‚</p>
<p>å¯¹äºå¤§æ•°æ®ç»“æ„ï¼ŒåŠ ä¸Š <code>mut</code> ï¼Œå¯ä»¥ç›´æ¥æ“ä½œå®ä¾‹ï¼Œæ¯”å¤åˆ¶å¹¶è¿”å›æ–°å®ä¾‹è‚¯å®šè¦å¿«ã€‚</p>
<p>ä½†æ˜¯å¯¹äºå°æ•°æ®ç»“æ„ï¼Œåˆ›å»ºæ–°çš„å®ä¾‹æˆ–è€…æ›´å¤šå‡½æ•°å¼ç¼–ç¨‹é£æ ¼æ›´å®¹æ˜“è¢«ç†è§£ï¼Œæ‰€ä»¥ç•¥ä½çš„æ€§èƒ½åœ¨æé«˜ç¨‹åºå¯è¯»æ€§æ—¶æ˜¯å€¼å¾—çš„ã€‚</p>
<h3 id="å˜é‡ï¼ˆvariablesï¼‰å’Œå¸¸é‡ï¼ˆconstantsï¼‰çš„åŒºåˆ«"><a href="#å˜é‡ï¼ˆvariablesï¼‰å’Œå¸¸é‡ï¼ˆconstantsï¼‰çš„åŒºåˆ«" class="headerlink" title="å˜é‡ï¼ˆvariablesï¼‰å’Œå¸¸é‡ï¼ˆconstantsï¼‰çš„åŒºåˆ«"></a>å˜é‡ï¼ˆvariablesï¼‰å’Œå¸¸é‡ï¼ˆconstantsï¼‰çš„åŒºåˆ«</h3><p>å¸¸é‡æ˜¯ç»‘å®šåˆ°åç§°ä¸”ä¸å…è®¸æ›´æ”¹çš„å€¼ã€‚ä½†æ˜¯å¸¸é‡å’Œä¸å¯å˜é‡è¿˜æ˜¯æœ‰ä¸€äº›åŒºåˆ«ã€‚</p>
<p>é¦–å…ˆï¼Œä¸å…è®¸å°† <code>mut</code> å’Œå¸¸é‡ä¸€èµ·ä½¿ç”¨ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œå¸¸é‡ä¸ä»…ä¸å¯å˜ï¼Œå®ƒä»¬å§‹ç»ˆä¸å¯å˜ã€‚</p>
<p>ä½¿ç”¨ <code>const</code> å…³é”®å­—å®šä¹‰å¸¸é‡è€Œä¸æ˜¯ <code>let</code> å…³é”®å­—ï¼Œå¹¶ä¸”å¿…é¡»æ³¨é‡Šå€¼å¾—ç±»å‹ã€‚</p>
<p>å¸¸é‡å¯ä»¥åœ¨ä»»ä½•èŒƒå›´ï¼ˆscopeï¼‰ä¸­å£°æ˜ï¼ŒåŒ…æ‹¬å…¨å±€èŒƒå›´ã€‚</p>
<p>æœ€åä¸€ä¸ªä¸åŒï¼Œå¸¸é‡åªèƒ½è®¾ç½®æœªå¸¸é‡è¡¨è¾¾å¼ï¼Œä¸èƒ½è®¾ç½®æœªå‡½æ•°è°ƒç”¨ç»“æœæˆ–è€…åªèƒ½åœ¨è¿è¡Œæ—¶è®¡ç®—çš„ä»»ä½•å…¶ä»–å€¼ã€‚</p>
<p>ä¾‹å¦‚ï¼š</p>
<figure class="highlight rust"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> MAX_POINTS: <span class="built_in">u32</span> = <span class="number">100_000</span>;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>åœ¨æ•°å­—æ–‡æœ¬ä¸­æ’å…¥ä¸‹åˆ’çº¿ï¼Œå¯ä»¥æé«˜å¯è¯»æ€§ã€‚</p>
</blockquote>
<h3 id="éšè—ï¼ˆShadowingï¼‰"><a href="#éšè—ï¼ˆShadowingï¼‰" class="headerlink" title="éšè—ï¼ˆShadowingï¼‰"></a>éšè—ï¼ˆShadowingï¼‰</h3><p>æˆ‘ä»¬å¯ä»¥é€šè¿‡ä½¿ç”¨ç›¸åŒå˜é‡çš„åç§°å¹¶é‡å¤ä½¿ç”¨ <code>let</code> å…³é”®å­—æ¥éšè—å˜é‡ã€‚</p>
<p>éšè—å’Œå°†å˜é‡æ ‡è®°ä¸º <code>mut</code> ä¸åŒï¼Œå› ä¸ºä¸€æ—¦å¿˜è®°ä½¿ç”¨ <code>let</code> é‡æ–°åˆ†é…å˜é‡ï¼Œå°±ä¼šåœ¨ç¼–è¯‘æ—¶æŠ¥é”™ã€‚é€šè¿‡ä½¿ç”¨ <code>let</code> ï¼Œæˆ‘ä»¬å¯ä»¥å¯¹ä¸€ä¸ªå€¼æ‰§è¡Œä¸€äº›è½¬æ¢ï¼Œä½†æ˜¯åœ¨è½¬æ¢å®Œæˆåï¼Œå˜é‡æ˜¯ä¸å¯å˜çš„ã€‚</p>
<p><code>mut</code> å’Œ shadowing çš„å¦ä¸€ä¸ªä¸åŒæ˜¯ï¼Œä½¿ç”¨ <code>let</code> å…³é”®å­—å®é™…æ˜¯åˆ›å»ºäº†ä¸€ä¸ªæ–°çš„å˜é‡ï¼Œä½†æ˜¯å¯ä»¥é‡ç”¨åç§°ã€‚</p>
<h2 id="æ•°æ®ç±»å‹"><a href="#æ•°æ®ç±»å‹" class="headerlink" title="æ•°æ®ç±»å‹"></a>æ•°æ®ç±»å‹</h2><h3 id="æ ‡é‡ç±»å‹ï¼ˆscalar-typesï¼‰"><a href="#æ ‡é‡ç±»å‹ï¼ˆscalar-typesï¼‰" class="headerlink" title="æ ‡é‡ç±»å‹ï¼ˆscalar typesï¼‰"></a>æ ‡é‡ç±»å‹ï¼ˆscalar typesï¼‰</h3><p>æ ‡é‡ç±»å‹è¡¨ç¤ºå•ä¸ªå€¼ï¼Œ Rust ä¸­æœ‰ 4 ç§ä¸»è¦æ ‡é‡ç±»å‹ï¼šæ•´æ•°ã€æµ®ç‚¹æ•°ã€å¸ƒå°”å€¼ å’Œ å­—ç¬¦ã€‚</p>
<h4 id="æ•´æ•°ç±»å‹"><a href="#æ•´æ•°ç±»å‹" class="headerlink" title="æ•´æ•°ç±»å‹"></a>æ•´æ•°ç±»å‹</h4><p>æ•´æ•°ç±»å‹æœ‰ï¼š<br><code>i8</code>, <code>i16</code>, <code>i32</code>, <code>i64</code>, <code>i128</code>, <code>isize</code>,<br><code>u8</code>, <code>u16</code>, <code>u32</code>, <code>u64</code>, <code>u128</code>, <code>usize</code>ã€‚</p>
<p>Rust çš„é»˜è®¤æ•´æ•°ç±»å‹æ˜¯ <code>i32</code> ï¼Œå³ä½¿åœ¨ 64 ä½ç³»ç»Ÿä¸Šï¼Œè¿™ç§ç±»å‹é€šå¸¸ä¹Ÿæ˜¯æœ€å¿«çš„ã€‚</p>
<p>ä½¿ç”¨ <code>isize</code> æˆ– <code>usize</code> çš„ä¸»è¦ç”¨åœ¨å¯¹æŸç§é›†åˆè¿›è¡Œç´¢å¼•çš„åœºæ™¯ã€‚</p>
<blockquote>
<p>æ•´æ•°æº¢å‡ºï¼Œåœ¨ debug æ¨¡å¼ç¼–è¯‘çš„ç¨‹åºé‡åˆ°æ•´æ•°æº¢å‡ºé—®é¢˜ä¼š panicï¼Œ release æ¨¡å¼ç¼–è¯‘åˆ™ä¸ panic ï¼Œè€Œæ˜¯è¿›è¡Œä¸¤ä¸ªè¡¥ç æ¢è¡Œï¼Œä¾‹å¦‚ <code>u8</code> ç±»å‹ä¿å­˜ 256 ä¼šå˜æˆ 0ï¼Œ ä¿å­˜ 257 ä¼šå˜æˆ 1 ï¼Œä»¥æ­¤ç±»æ¨ã€‚ä¾èµ–æ•´æ•°ç§»é™¤çš„ wrapping è¡Œä¸ºè¢«è§†ä¸ºé”™è¯¯ï¼Œå¦‚æœè¦æ˜¾å¼ wrap ï¼Œåˆ™å¯ä»¥ä½¿ç”¨æ ‡å‡†åº“ç±»å‹ <code>Wrapping</code> ã€‚</p>
</blockquote>
<h4 id="æµ®ç‚¹ç±»å‹"><a href="#æµ®ç‚¹ç±»å‹" class="headerlink" title="æµ®ç‚¹ç±»å‹"></a>æµ®ç‚¹ç±»å‹</h4><p>æµ®ç‚¹ç±»å‹æœ‰ï¼š <code>f32</code>, <code>f64</code>ã€‚</p>
<p>é»˜è®¤ç±»å‹ä¸º <code>f64</code> ï¼Œå› ä¸ºåœ¨ç°ä»£ CPU ä¸Šï¼Œå®ƒçš„é€Ÿåº¦ä¸ <code>f32</code> å¤§è‡´ç›¸åŒï¼Œä½†ç²¾åº¦æ›´é«˜ã€‚</p>
<h4 id="æ•°å­—è¿ç®—"><a href="#æ•°å­—è¿ç®—" class="headerlink" title="æ•°å­—è¿ç®—"></a>æ•°å­—è¿ç®—</h4><p>Rust æ”¯æŒå››åˆ™è¿ç®—å’Œæ±‚ä½™è¿ç®—ã€‚</p>
<p>é™„å½• B ä¸­åˆ—å‡ºäº†æ›´å¤šè¿ç®—ç¬¦ã€‚</p>
<h4 id="å¸ƒå°”ç±»å‹"><a href="#å¸ƒå°”ç±»å‹" class="headerlink" title="å¸ƒå°”ç±»å‹"></a>å¸ƒå°”ç±»å‹</h4><p>å¸ƒå°”å€¼åªè¦ç”¨äºæ¡ä»¶è¡¨è¾¾å¼ï¼Œæ¯”å¦‚ <code>if</code> è¡¨è¾¾å¼ã€‚</p>
<h4 id="å­—ç¬¦ç±»å‹"><a href="#å­—ç¬¦ç±»å‹" class="headerlink" title="å­—ç¬¦ç±»å‹"></a>å­—ç¬¦ç±»å‹</h4><p><code>char</code> ç±»å‹æ˜¯ Rust ä¸­æœ€åŸºæœ¬çš„å­—æ¯ç±»å‹ï¼Œä½¿ç”¨å•å¼•å·æŒ‡å®šã€‚ï¼ˆç›¸å¯¹çš„å­—ç¬¦ä¸²æ–‡å­—ï¼Œä½¿ç”¨åŒå¼•å·ã€‚ï¼‰</p>
<p>Rust ä¸­ <code>char</code> ç±»å‹ï¼Œå¤§å°ä¸º 4 å­—èŠ‚ï¼Œä»£è¡¨ Unicode æ ‡é‡ã€‚Unicode æ ‡é‡å€¼èŒƒå›´ä» <code>U+0000</code> è‡³ <code>U+D7FF</code> å’Œ <code>U+E000</code> è‡³ <code>U+10FFFF</code> ã€‚ä½†æ˜¯ â€œå­—ç¬¦â€ å¹¶ä¸æ˜¯ Unicode ä¸­çœŸæ­£çš„æ¦‚å¿µï¼Œå› æ­¤ä½ å¯¹ â€œå­—ç¬¦â€ çš„ç›´è§‰å¯èƒ½ä¸ Rust ä¸­ä¸ä¸€è‡´ã€‚æˆ‘ä»¬åœ¨ç¬¬ 8 ç« ä¸­è®¨è®ºã€‚</p>
<h3 id="å¤åˆç±»å‹"><a href="#å¤åˆç±»å‹" class="headerlink" title="å¤åˆç±»å‹"></a>å¤åˆç±»å‹</h3><p>å¤åˆç±»å‹å¯ä»¥ç»„åˆå¤šä¸ªå€¼åˆ°ä¸€ä¸ªç±»å‹ä¸­ï¼Œ Rust æœ‰ä¸¤ä¸ªåŸºæœ¬å¤åˆç±»å‹ï¼š å…ƒç»„ï¼ˆtuplesï¼‰å’Œæ•°ç»„ï¼ˆarraysï¼‰</p>
<h4 id="å…ƒç»„ç±»å‹"><a href="#å…ƒç»„ç±»å‹" class="headerlink" title="å…ƒç»„ç±»å‹"></a>å…ƒç»„ç±»å‹</h4><p>å…ƒç»„æ˜¯ä¸€ç§å°†å¤šç§ç±»å‹çš„å€¼ç»„åˆä¸ºä¸€ä¸ªå¤åˆç±»å‹çš„ä¸€èˆ¬æ–¹æ³•ã€‚å…ƒç»„çš„é•¿åº¦æ˜¯å›ºå®šçš„ï¼šå£°æ˜ä¹‹åå®ƒä»¬çš„é•¿åº¦å°±æ— æ³•å¢é•¿æˆ–ç¼©å°ã€‚</p>
<p>æˆ‘ä»¬åœ¨æ‹¬å·å†…ç¼–å†™é€—å·åˆ†éš”çš„å€¼åˆ—è¡¨æ¥åˆ›å»ºå…ƒç»„ã€‚å…ƒç»„ä¸­æ¯ä¸ªä½ç½®éƒ½æœ‰ä¸€ä¸ªç±»å‹ï¼Œå¹¶ä¸”å…ƒç»„ä¸­ä¸é€šçŸ¥çš„ç±»å‹ä¸å¿…ç›¸åŒï¼Œæ­¤ä¾‹ä¸­ï¼Œæˆ‘ä»¬æ·»åŠ äº†å¯é€‰çš„ç±»å‹æ³¨é‡Šï¼š</p>
<figure class="highlight rust"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> tup: (<span class="built_in">i32</span>, <span class="built_in">f64</span>, <span class="built_in">u8</span>) = (<span class="number">1</span>, <span class="number">1.1</span>, <span class="number">1</span>);</span><br></pre></td></tr></table></figure>
<p>å…ƒç»„å¯ä»¥é€šè¿‡å’Œ <code>let</code> çš„ä¸€ç§æ¨¡å¼è§£æ„ï¼ˆdestructuringï¼‰ã€‚</p>
<figure class="highlight rust"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">main</span></span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> tup = (<span class="number">1</span>, <span class="number">2</span>, <span class="number">3.1</span>);</span><br><span class="line">    <span class="keyword">let</span> (_, y, _) = tup;</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">"The value of y is &#123;&#125;"</span>, y);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>é™¤äº†é€šè¿‡æ¨¡å¼åŒ¹é…è¿›è¡Œè§£æ„ï¼Œæˆ‘ä»¬è¿˜æ˜¯å¯ä»¥é€šè¿‡ç‚¹å·ï¼ˆ.ï¼‰åŠ ç´¢å¼•çš„æ–¹å¼è®¿é—®å…ƒç»„å…ƒç´ ã€‚ä¾‹å¦‚ï¼š</p>
<figure class="highlight rust"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">main</span></span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> x = (<span class="number">1</span>, <span class="number">2.1</span>, <span class="number">3</span>);</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">"&#123;&#125; &#123;&#125; &#123;&#125;"</span>, x.<span class="number">0</span>, x.<span class="number">1</span>, x.<span class="number">2</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="æ•°ç»„ç±»å‹"><a href="#æ•°ç»„ç±»å‹" class="headerlink" title="æ•°ç»„ç±»å‹"></a>æ•°ç»„ç±»å‹</h4><p>æ•°ç»„ä¸­çš„å…ƒç´ ç±»å‹å¿…é¡»ç›¸åŒï¼Œ Rust ä¸­çš„æ•°ç»„å…·æœ‰å›ºå®šé•¿åº¦ã€‚</p>
<p>æ”¾å…¥æ•°ç»„çš„å€¼è¢«å†™æˆç”¨æ–¹æ‹¬å·æ‹¬èµ·æ¥çš„éƒ½å¥½åˆ†éš”çš„åˆ—è¡¨ã€‚</p>
<p>å½“ä½ æƒ³æŠŠæ•°æ®åˆ†é…åœ¨æ ˆä¸Šè€Œä¸æ˜¯å †ä¸Šæ—¶ï¼Œæ•°ç»„å¾ˆæœ‰ç”¨ã€‚ï¼ˆç¬¬ 4 ç« ä¸­è®¨è®ºå †æ ˆï¼‰</p>
<p>æ•°ç»„ä¸å¦‚å‘é‡ç±»å‹ï¼ˆvector typeï¼‰çµæ´»ã€‚è™½ç„¶ï¼Œå‘é‡æ˜¯æ ‡å‡†åº“æä¾›çš„ç±»ä¼¼é›†åˆç±»å‹ï¼Œå…è®¸å¤§å°ç¼©æ”¾ã€‚å¦‚æœä¸ç¡®å®šä½¿ç”¨æ•°ç»„è¿˜æ˜¯å‘é‡ï¼Œåˆ™å¯èƒ½å°±è¯¥ä½¿ç”¨å‘é‡ã€‚ç¬¬ 8 ç« ç»†è°ˆå‘é‡ã€‚</p>
<p>ä¸€ä¸ªä½¿ç”¨æ•°ç»„è€Œä¸æ˜¯å‘é‡çš„ä¾‹å­ï¼šç¨‹åºä¸­éœ€è¦çŸ¥é“æ¯ä¸ªæœˆä»½çš„åç§°ï¼Œè¿™æ ·çš„ç¨‹åºä¸å¤ªå¯èƒ½å¢åŠ æˆ–åˆ é™¤æœˆä»½ï¼Œè¿™æ ·ä½ å¯ä»¥ä½¿ç”¨æ•°ç»„ï¼Œå› ä¸ºä½ çŸ¥é“å®ƒå§‹ç»ˆåŒ…å« 12 ä¸ªå…ƒç´ ã€‚</p>
<p>åˆå§‹åŒ–ç»™æ•°ç»„èµ‹å€¼çš„æ–¹å¼ï¼š</p>
<figure class="highlight rust"><table><tr><td class="code"><pre><span class="line"><span class="comment">// [ç±»å‹; é•¿åº¦] </span></span><br><span class="line"><span class="keyword">let</span> a: [<span class="built_in">i32</span>; <span class="number">5</span>] = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">// [åˆå§‹å€¼; é•¿åº¦]</span></span><br><span class="line"><span class="keyword">let</span> a = [<span class="number">3</span>; <span class="number">5</span>]; </span><br><span class="line"><span class="comment">// ç­‰åŒäº</span></span><br><span class="line"><span class="keyword">let</span> a = [<span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>];</span><br></pre></td></tr></table></figure>
<h5 id="è®¿é—®æ•°ç»„å…ƒç´ "><a href="#è®¿é—®æ•°ç»„å…ƒç´ " class="headerlink" title="è®¿é—®æ•°ç»„å…ƒç´ "></a>è®¿é—®æ•°ç»„å…ƒç´ </h5><p>æ•°ç»„æ˜¯æ ˆä¸Šåˆ†é…çš„å•ä¸€å†…å­˜å—ã€‚ä½ å¯ä»¥é€šè¿‡ç´¢å¼•è®¿é—®æ•°ç»„å…ƒç´ ï¼Œå¦‚ä¸‹ï¼š</p>
<figure class="highlight rust"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">main</span></span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> a = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>];</span><br><span class="line">    <span class="keyword">let</span> first = a[<span class="number">0</span>];</span><br><span class="line">    <span class="keyword">let</span> second = a[<span class="number">1</span>];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="æ— æ•ˆçš„æ•°ç»„å…ƒç´ è®¿é—®"><a href="#æ— æ•ˆçš„æ•°ç»„å…ƒç´ è®¿é—®" class="headerlink" title="æ— æ•ˆçš„æ•°ç»„å…ƒç´ è®¿é—®"></a>æ— æ•ˆçš„æ•°ç»„å…ƒç´ è®¿é—®</h5><p>å¦‚æœä½ å°è¯•è®¿é—®è¶…å‡ºæ•°ç»„æœ«å°¾çš„æ•°ç»„å…ƒç´ ä¼šå¦‚ä½•ï¼Ÿä¸‹é¢çš„ç¨‹åºå¯ä»¥é€šè¿‡ç¼–è¯‘ï¼Œä½†æ˜¯è¿è¡Œä¼šæŠ¥ panic ï¼š</p>
<figure class="highlight rust"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">main</span></span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> a = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">4</span>];</span><br><span class="line">    <span class="keyword">let</span> index = <span class="number">5</span>;</span><br><span class="line">    <span class="keyword">let</span> element = a[index];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç¬¬ 9 ç« è®¨è®ºé”™è¯¯å¤„ç†ã€‚</p>
<h2 id="å‡½æ•°"><a href="#å‡½æ•°" class="headerlink" title="å‡½æ•°"></a>å‡½æ•°</h2><p>Rust ä½¿ç”¨ snake case ä½œä¸ºå‡½æ•°å’Œå˜é‡åçš„å¸¸è§„æ ·å¼ï¼Œå³æ‰€æœ‰å­—æ¯å°å†™å¹¶ç”¨ä¸‹åˆ’çº¿åˆ†éš”å•è¯ã€‚</p>
<p>Rust ä¸­å‡½æ•°å¯ä»¥å†™åœ¨æºç ä¸­çš„ä»»ä½•ä½ç½®ï¼Œä¸ç”¨å…³æ³¨å£°æ˜é¡ºåºã€‚</p>
<h3 id="å‡½æ•°å‚æ•°"><a href="#å‡½æ•°å‚æ•°" class="headerlink" title="å‡½æ•°å‚æ•°"></a>å‡½æ•°å‚æ•°</h3><p>å®šä¹‰å‡½æ•°æ—¶å¯ä»¥æ‹¥æœ‰å½¢å‚ï¼ˆparametersï¼‰ï¼Œè¿™äº›ç‰¹æ®Šå˜é‡æ˜¯å‡½æ•°ç­¾åçš„ä¸€éƒ¨åˆ†ã€‚<br>ä¼ é€’ç»™å‡½æ•°çš„å…·ä½“å€¼ç§°ä¸ºå®å‚ï¼ˆargumentsï¼‰ã€‚åœ¨æ—¥å¸¸äº¤è°ˆä¸­ï¼Œäººä»¬å€¾å‘äºå°†å½¢å‚å’Œå®å‚äº¤æ›¿ç”¨äºå‡½æ•°å®šä¹‰ä¸­çš„å˜é‡å’Œè°ƒç”¨å‡½æ•°æ—¶ä¼ é€’çš„å…·ä½“å€¼ã€‚</p>
<p>å‡½æ•°ç­¾åä¸­ï¼Œå¿…é¡»å£°æ˜æ¯ä¸ªå‚æ•°çš„ç±»å‹ã€‚è¿™æ˜¯ Rust çš„åˆ»æ„è®¾è®¡ï¼šå‡½æ•°å®šä¹‰ä¸­æŒ‡æ˜ç±»å‹å°±æ„å‘³ç€ç¼–è¯‘å™¨ä¸éœ€è¦åœ¨å…¶ä»–åœ°æ–¹æ¨æ–­ä½ çš„æ„å›¾ã€‚</p>
<p>å¦‚æœå‡½æ•°éœ€è¦å¤šä¸ªå‚æ•°ï¼Œå®šä¹‰æ—¶ç”¨é€—å·åˆ†éš”ã€‚</p>
<h3 id="å‡½æ•°ä½“åŒ…å«è¯­å¥ï¼ˆStatementsï¼‰å’Œè¡¨è¾¾å¼ï¼ˆExpressionsï¼‰"><a href="#å‡½æ•°ä½“åŒ…å«è¯­å¥ï¼ˆStatementsï¼‰å’Œè¡¨è¾¾å¼ï¼ˆExpressionsï¼‰" class="headerlink" title="å‡½æ•°ä½“åŒ…å«è¯­å¥ï¼ˆStatementsï¼‰å’Œè¡¨è¾¾å¼ï¼ˆExpressionsï¼‰"></a>å‡½æ•°ä½“åŒ…å«è¯­å¥ï¼ˆStatementsï¼‰å’Œè¡¨è¾¾å¼ï¼ˆExpressionsï¼‰</h3><p>å‡½æ•°ä½“ç”±ä¸€ç³»åˆ—å¯é€‰çš„è¡¨è¾¾å¼ç»“å°¾çš„è¯­å¥ç»„æˆã€‚è‡³æ­¤ï¼Œæˆ‘ä»¬ä»…ä»‹ç»äº†æ²¡æœ‰ç»“å°¾è¡¨è¾¾å¼çš„å‡½æ•°ï¼Œä½†æ˜¯ä½ å·²ç»å°†è¡¨è¾¾å¼è§†ä¸ºè¯­å¥çš„ä¸€éƒ¨åˆ†äº†ã€‚<br>å› ä¸º Rust æ—¶åŸºäºè¡¨è¾¾å¼çš„è¯­è¨€ï¼Œæ‰€ä»¥è¿™é‡Œè¦ç†è§£å®ƒä»¬é‡è¦çš„åŒºåˆ«ã€‚å…¶ä»–è¯­è¨€ä¸­æ²¡æœ‰ç±»ä¼¼çš„åŒºåˆ«ï¼Œä¸‹é¢æˆ‘ä»¬çœ‹çœ‹è¯­å¥å’Œè¡¨è¾¾å¼çš„å·®å¼‚å¦‚ä½•å½±å“å‡½æ•°ä½“ã€‚</p>
<p>æˆ‘ä»¬å®é™…ä¸Šå·²ç»ä½¿ç”¨è¿‡è¯­å¥å’Œè¡¨è¾¾å¼ã€‚è¯­å¥æ˜¯æ‰§è¡ŒæŸäº›æ“ä½œä½†æ²¡æœ‰è¿”å›å€¼çš„æŒ‡ä»¤ã€‚è¡¨è¾¾å¼çš„è®¡ç®—ç»“æœæ˜¯ç»“æœå€¼ã€‚ä¸¾ä¸ªä¾‹å­ã€‚</p>
<p>åˆ›å»ºä¸€ä¸ªå˜é‡å¹¶ä½¿ç”¨ <code>let</code> å…³é”®å­—ä¸ºå…¶èµ‹å€¼å°±æ˜¯ä¸€æ¡è¯­å¥ã€‚</p>
<figure class="highlight rust"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">main</span></span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> y = <span class="number">6</span>; <span class="comment">// è¿™æ˜¯ä¸€æ¡è¯­å¥</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å‡½æ•°å®šä¹‰ä¹Ÿæ˜¯è¯­å¥ï¼›å‰é¢æ•´ä¸ªå®ä¾‹å°±æ˜¯ä¸€ä¸ªè¯­å¥ã€‚</p>
<p>è¯­å¥æ²¡æœ‰è¿”å›å€¼ã€‚æ‰€ä»¥ï¼Œä½ æ— æ³•ç”¨ <code>let</code> è¯­å¥ä¸ºå¦ä¸€ä¸ªå˜é‡èµ‹å€¼ã€‚ä¸‹é¢çš„ä¾‹å­æ˜¯é”™è¯¯çš„ï¼š</p>
<figure class="highlight rust"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">main</span></span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> x = (<span class="keyword">let</span> y = <span class="number">6</span>); <span class="comment">// è¿™æ˜¯é”™è¯¯çš„</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><code>let y = 6</code> è¯­å¥ä¸ä¼šæœ‰è¿”å›å€¼ï¼Œå› æ­¤ <code>x</code> ä¸ä¼šç»‘å®šä»»ä½•å†…å®¹ã€‚ä¸æƒ³å…¶ä»–è¯­è¨€ï¼Œä¾‹å¦‚ C å’Œ Ruby ï¼Œèµ‹å€¼ä¼šåœ¨èµ‹å€¼çš„ä½ç½®è¿”å›ï¼Œå…¶ä»–è¯­è¨€ä¸­ä½ å¯ä»¥å†™ <code>x = y = 6</code> æ¥ä¸º x å’Œ y å…±åŒèµ‹å€¼ã€‚</p>
<p>è¡¨è¾¾å¼æ±‚å€¼ï¼Œå°†å‡ºç°åœ¨ä½ ä¹‹åç¼–å†™çš„å¤§éƒ¨åˆ† Rust ä»£ç ä¸­ã€‚<br>è¡¨è¾¾å¼å¯ä»¥æ˜¯è¯­å¥çš„ä¸€éƒ¨åˆ†ï¼šä¸‹ä¸ªä¾‹å­ä¸­ï¼Œ6 å°±æ˜¯è¯­å¥ <code>let y = 6</code> ä¸­çš„è¡¨è¾¾å¼ã€‚è°ƒç”¨å‡½æ•°æ˜¯ä¸€ä¸ªè¡¨è¾¾å¼ã€‚è°ƒç”¨å®ä¸€ä¸ªè¡¨è¾¾å¼ã€‚åˆ›å»ºæ–°ä½œç”¨åŸŸçš„ä»£ç å—ä¹Ÿæ˜¯ä¸€ä¸ªè¡¨è¾¾å¼ï¼Œä¾‹å¦‚ï¼š</p>
<figure class="highlight rust"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">main</span></span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> x = <span class="number">5</span>;</span><br><span class="line">    <span class="keyword">let</span> y = &#123;</span><br><span class="line">        <span class="keyword">let</span> x = <span class="number">3</span>;</span><br><span class="line">        x + <span class="number">1</span></span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">"The value of y is: &#123;&#125;"</span>, y);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æ³¨æ„ <code>x + 1</code> è¿™ä¸€è¡Œæ²¡æœ‰åˆ†å·ã€‚è¡¨è¾¾å¼å°±ä¸åŒ…å«ç»“å°¾çš„åˆ†å·ã€‚å¦‚æœä½ åœ¨ç»“å°¾åŠ äº†åˆ†å·ï¼Œå°±æŠŠå®ƒå˜æˆäº†è¯­å¥ï¼Œå³ä¸ä¼šæœ‰è¿”å›å€¼ã€‚<br>åœ¨æ¥ä¸‹æ¥æ¢ç´¢è¿”å›å€¼å’Œè¡¨è¾¾å¼æ—¶ï¼Œè¯·è®°ä½è¿™ä¸€ç‚¹ã€‚</p>
<h3 id="å‡½æ•°è¿”å›å€¼"><a href="#å‡½æ•°è¿”å›å€¼" class="headerlink" title="å‡½æ•°è¿”å›å€¼"></a>å‡½æ•°è¿”å›å€¼</h3><p>å‡½æ•°å¯ä»¥æŠŠå€¼è¿”å›ç»™ä»£ç è°ƒç”¨æ–¹ã€‚æˆ‘ä»¬æ²¡æœ‰å‘½åè¿”å›å€¼ï¼Œä½†æ˜¯è¦åœ¨ <code>-&gt;</code> åå£°æ˜å®ƒä»¬çš„ç±»å‹ã€‚ Rust ä¸­ï¼Œå‡½æ•°çš„è¿”å›å€¼ä¸å‡½æ•°ä½“ä¸­çš„æœ€ç»ˆè¡¨è¾¾å¼çš„å€¼åŒä¹‰ã€‚ä½ å¯ä»¥ç”¨ <code>return</code> å…³é”®å­—æå‰è¿”å›ï¼Œä½†æ˜¯å¤§å¤šæ•°å‡½æ•°éƒ½éšå¼è¿”å›æœ€åä¸€ä¸ªè¡¨è¾¾å¼ã€‚è¿™æ˜¯ä¸€ä¸ªå¸¦è¿”å›å€¼çš„å‡½æ•°çš„å®ä¾‹ï¼š</p>
<figure class="highlight rust"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">five</span></span>() -&gt; <span class="built_in">i32</span> &#123;</span><br><span class="line">    <span class="number">5</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">main</span></span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> x = five();</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">"The value of x is :&#123;&#125;"</span>, x);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿™ä¸ª <code>five</code> å‡½æ•°åœ¨ Rust ä¸­æ˜¯åˆæ³•çš„ã€‚</p>
<p>å¦ä¸€ä¸ªä¾‹å­ï¼š</p>
<figure class="highlight rust"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">main</span></span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> x = plus_one(<span class="number">5</span>);</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">"The value of x is: &#123;&#125;"</span>, x);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// è¿™æ˜¯ä¸ªé”™è¯¯çš„å‡½æ•°</span></span><br><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">plus_one</span></span>(x: <span class="built_in">i32</span>) -&gt; <span class="built_in">i32</span> &#123;</span><br><span class="line">    x + <span class="number">1</span>; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç¼–è¯‘é”™è¯¯å¦‚ä¸‹ï¼š</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"> --&gt; src/main.rs:7:24</span><br><span class="line">  |</span><br><span class="line">7 | fn plus_one(x: i32) -&gt; i32 &#123;</span><br><span class="line">  |    --------            ^^^ expected `i32`, found `()`</span><br><span class="line">  |    |</span><br><span class="line">  |    implicitly returns `()` as its body has no tail or `<span class="built_in">return</span>` expression</span><br><span class="line">8 |     x + 1; </span><br><span class="line">  |          - <span class="built_in">help</span>: consider removing this semicolon</span><br></pre></td></tr></table></figure>
<p>ä¸»è¦æŠ¥é”™ä¿¡æ¯ â€œç±»å‹ä¸åŒ¹é…â€ æ­ç¤ºäº†è¿™æ®µä»£ç çš„æ ¸å¿ƒé—®é¢˜ã€‚ç”±äº <code>x + 1;</code> æ˜¯è¯­å¥ä¸ä¼šæœ‰è¿”å›å€¼ï¼Œåˆ™æœ«å°¾è¡¨è¾¾å¼å°±å˜æˆäº† <code>()</code>ï¼Œ ä¸€ä¸ªç©ºçš„å…ƒç»„ã€‚ä»€ä¹ˆéƒ½ä¸è¿”å›ï¼Œè¿™ä¸å‡½æ•°çš„å®šä¹‰ç›¸çŸ›ç›¾å¯¼è‡´é”™è¯¯ã€‚å¹¶ä¸”åœ¨æ­¤è¾“å‡ºä¸­ï¼Œ Rust æä¾›äº†ä¸€æ¡å»ºè®®ï¼Œå¯èƒ½çº æ­£è¿™ä¸ªé”™è¯¯ï¼šåˆ é™¤åˆ†å·ï¼Œå¯è§£å†³é”™è¯¯ã€‚</p>
<h2 id="æ³¨é‡Š"><a href="#æ³¨é‡Š" class="headerlink" title="æ³¨é‡Š"></a>æ³¨é‡Š</h2><p>Rust ä¸­çš„æ³¨é‡Šå¿…é¡»ä»¥åŒæ–œçº¿å¼€å¤´ï¼Œå¯¹äºè¶…è¿‡ä¸€è¡Œçš„æ³¨é‡Šï¼Œä½ éœ€è¦åœ¨æ¯ä¸€è¡Œå¼€å¤´éƒ½åŠ ä¸Š <code>//</code> ã€‚</p>
<p>Rust æ‹¥æœ‰å¦ä¸€ç§æ³¨é‡Š â€”â€” æ–‡æ¡£æ³¨é‡Šï¼Œæˆ‘ä»¬åœ¨ç¬¬ 14 ç« å…³äºå¦‚ä½•å‘å¸ƒ crate åˆ° crate.io ä¸­è®²è¿°ã€‚ </p>
<h2 id="æ§åˆ¶æµ"><a href="#æ§åˆ¶æµ" class="headerlink" title="æ§åˆ¶æµ"></a>æ§åˆ¶æµ</h2><p>åœ¨å¤§å¤šæ•°ç¼–ç¨‹è¯­è¨€ä¸­ï¼Œæ ¹æ®æ¡ä»¶æ˜¯å¦ä¸ºçœŸæ¥å†³å®šæ˜¯å¦è¿è¡ŒæŸå—ä»£ç ï¼Œè€Œåœ¨æ¡ä»¶ä¸ºçœŸæ—¶æ¥å†³å®šé‡å¤è¿è¡Œä¸€äº›ä»£ç æ˜¯åŸºæœ¬çš„æ„å»ºå—ã€‚è®©ä½ æ§åˆ¶ Rust ä»£ç æ‰§è¡Œæµç¨‹çš„æœ€å¸¸è§æ„é€ æ˜¯ <code>if</code> è¡¨è¾¾å¼å’Œå¾ªç¯ã€‚</p>
<h3 id="if-è¡¨è¾¾å¼"><a href="#if-è¡¨è¾¾å¼" class="headerlink" title="if è¡¨è¾¾å¼"></a><code>if</code> è¡¨è¾¾å¼</h3><p>ä¸ <code>if</code> è¡¨è¾¾å¼ä¸­çš„æ¡ä»¶ç›¸å…³è”çš„ä»£ç å—æœ‰æ—¶ç§°ä¸ºæ‰‹è‡‚ï¼ˆarmsï¼‰ï¼Œå°±åƒä¹‹å‰çŒœæ•°å­—æ¸¸æˆä¸­è®¨è®ºçš„ <code>match</code> è¡¨è¾¾å¼ä¸­çš„ arm ä¸€æ ·ã€‚</p>
<p>å¯é€‰çš„ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ <code>else</code> è¡¨è¾¾å¼ç»™ç¨‹åºåœ¨æ¡ä»¶ä¸ºå‡æ—¶æ‰§è¡Œä¸€ä¸ªæ›¿ä»£çš„ä»£ç å—ã€‚</p>
<p>å€¼å¾—æ³¨æ„çš„æ—¶ï¼Œæ¡ä»¶å¿…é¡»æ˜¯ <code>bool</code> ç±»å‹ã€‚ä¸åƒ Ruby æˆ–è€… JavaScriptï¼Œ Rust ä¸ä¼šè‡ªåŠ¨å°†éå¸ƒå°”ç±»å‹è½¬æ¢ä¸ºå¸ƒå°”ç±»å‹ã€‚</p>
<h4 id="ä½¿ç”¨-else-if-å¤„ç†å¤šæ¡ä»¶"><a href="#ä½¿ç”¨-else-if-å¤„ç†å¤šæ¡ä»¶" class="headerlink" title="ä½¿ç”¨ else if å¤„ç†å¤šæ¡ä»¶"></a>ä½¿ç”¨ <code>else if</code> å¤„ç†å¤šæ¡ä»¶</h4><p>è¿‡å¤šçš„ <code>else if</code> è¡¨è¾¾å¼ä½¿ä»£ç æ··ä¹±ï¼Œå› æ­¤å¦‚æœè¶…è¿‡ä¸€ä¸ªï¼Œå°±è¦è€ƒè™‘é‡æ„ä½ çš„ä»£ç ã€‚ç¬¬å…­ç« æè¿° Rust ä¸­å¼ºå¤§çš„åˆ†æ”¯é€‰æ‹©ç»“æ„ï¼Œç§°ä¸º <code>match</code> ã€‚</p>
<h4 id="let-è¯­å¥ä¸­ä½¿ç”¨-if"><a href="#let-è¯­å¥ä¸­ä½¿ç”¨-if" class="headerlink" title="let è¯­å¥ä¸­ä½¿ç”¨ if"></a><code>let</code> è¯­å¥ä¸­ä½¿ç”¨ <code>if</code></h4><p>ä¾‹å­ï¼š</p>
<figure class="highlight rust"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">mail</span></span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> condition = <span class="literal">true</span>;</span><br><span class="line">    <span class="keyword">let</span> number = <span class="keyword">if</span> condition &#123;</span><br><span class="line">        <span class="number">5</span></span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="number">6</span></span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">"The value of number is: &#123;&#125;"</span>, number);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å˜é‡ <code>number</code> å°†ä¼šè¢« <code>if</code> è¡¨è¾¾å¼çš„è¾“å‡ºå€¼ç»‘å®šã€‚ </p>
<p>è¯·è®°ä½ï¼Œä»£ç å—çš„è®¡ç®—ç»“æœä¸ºå®ƒä»¬ä¸­çš„æœ€åä¸€ä¸ªè¡¨è¾¾å¼ï¼Œæ•°å­—æœ¬èº«ä¹Ÿæ˜¯è¡¨è¾¾å¼ã€‚æ‰€ä»¥åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæ•´ä¸ª <code>if</code> è¡¨è¾¾å¼çš„å€¼å–å†³äºè¦æ‰§è¡Œçš„ä»£ç å—ã€‚è¿™æ„å‘³ç€æ¥è‡ª <code>if</code> çš„æ¯ä¸ªåˆ†æ”¯çš„å€¼å¿…é¡»ä½¿åŒä¸€ç±»å‹ã€‚å¦‚æœç±»å‹ä¸åŒ¹é…ï¼Œå°±ä¼šæŠ¥é”™ï¼š</p>
<figure class="highlight rust"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">main</span></span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> condition = <span class="literal">true</span>;</span><br><span class="line">    <span class="keyword">let</span> number = <span class="keyword">if</span> condition &#123; </span><br><span class="line">        <span class="number">5</span></span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="string">"six"</span> <span class="comment">// ç±»å‹ä¸åŒ¹é…</span></span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">"The value of number is: &#123;&#125;"</span>, number);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç¼–è¯‘æ—¶å°±ä¼šæŠ¥é”™ã€‚å¦‚æœä»…åœ¨è¿è¡Œæ—¶ç¡®å®šæ•°å­—ç±»å‹ï¼Œ Rust å°†æ— æ³•åšåˆ°è¿™ä¸€ç‚¹ï¼›å¦‚æœç¼–è¯‘å™¨å¿…é¡»è·Ÿè¸ªä»»ä½•å˜é‡çš„å¤šä¸ªå‡è®¾ç±»å‹ï¼Œé‚£ä¹ˆç¼–è¯‘å™¨ä¼šè¿‡äºå¤æ‚ä¸”å¯¹ä»£ç ç¼ºå°‘ä¿è¯ã€‚</p>
<h3 id="å¾ªç¯é‡å¤"><a href="#å¾ªç¯é‡å¤" class="headerlink" title="å¾ªç¯é‡å¤"></a>å¾ªç¯é‡å¤</h3><p>Rust ä¸­æœ‰ä¸‰ç§å¾ªç¯ï¼š <code>loop</code>, <code>while</code> å’Œ <code>for</code>ã€‚</p>
<h4 id="ç”¨-loop-é‡å¤ä»£ç "><a href="#ç”¨-loop-é‡å¤ä»£ç " class="headerlink" title="ç”¨ loop é‡å¤ä»£ç "></a>ç”¨ <code>loop</code> é‡å¤ä»£ç </h4><figure class="highlight rust"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">main</span></span>() &#123;</span><br><span class="line">    <span class="keyword">loop</span> &#123;</span><br><span class="line">        <span class="built_in">println!</span>(<span class="string">"again!"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿è¡Œè¿™æ®µä»£ç ä¼šé‡å¤è¾“å‡º <code>again!</code> ç›´åˆ°é€šè¿‡ ctrl+c ä¸­æ–­ç¨‹åºã€‚</p>
<p>ä½¿ç”¨ <code>break</code> å…³é”®å­—å¯ä»¥è·³å‡º loop å¾ªç¯ã€‚</p>
<h4 id="loop-å¾ªç¯ä¸­è¿”å›å€¼"><a href="#loop-å¾ªç¯ä¸­è¿”å›å€¼" class="headerlink" title="loop å¾ªç¯ä¸­è¿”å›å€¼"></a>loop å¾ªç¯ä¸­è¿”å›å€¼</h4><p><code>loop</code> çš„ç”¨é€”ä¹‹ä¸€æ˜¯é‡è¯•ä½ çŸ¥é“å¯èƒ½ä¼šå¤±è´¥çš„æ“ä½œï¼Œä¾‹å¦‚æ£€æŸ¥çº¿ç¨‹æ˜¯å¦å®Œæˆäº†å·¥ä½œã€‚ç„¶è€Œï¼Œä½ ä¹Ÿè®¸éœ€è¦æŠŠç»“æœä¼ é€’ç»™å…¶ä½™ä»£ç ï¼Œè¦åšåˆ°è¿™ä¸€ç‚¹ï¼Œä½ å¯ä»¥åœ¨ <code>break</code> è¡¨è¾¾å¼ä¹‹ååå•†ä½ è¦è¿”å›çš„å€¼ã€‚</p>
<figure class="highlight rust"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">main</span></span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="keyword">mut</span> counter = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">let</span> result = <span class="keyword">loop</span> &#123;</span><br><span class="line">        counter += <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span> counter == <span class="number">10</span> &#123;</span><br><span class="line">            <span class="keyword">break</span> counter * <span class="number">2</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">"The result is: &#123;&#125;"</span>, result);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="while-æ¡ä»¶å¾ªç¯"><a href="#while-æ¡ä»¶å¾ªç¯" class="headerlink" title="while æ¡ä»¶å¾ªç¯"></a><code>while</code> æ¡ä»¶å¾ªç¯</h4><figure class="highlight rust"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">main</span></span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="keyword">mut</span> number = <span class="number">3</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> number != <span class="number">0</span> &#123;</span><br><span class="line">        <span class="built_in">println!</span>(<span class="string">"&#123;&#125;!"</span>, number);</span><br><span class="line"></span><br><span class="line">        number -= <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">"LIFTOFF!!!"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä½¿ç”¨ <code>while</code> å¾ªç¯ï¼Œå¯ä»¥æ¶ˆé™¤è®¸å¤š <code>loop</code> <code>if</code> <code>else</code> <code>break</code> ç»“æ„äº§ç”Ÿçš„åµŒå¥—ï¼Œä½¿ä»£ç æ›´æ¸…æ™°ã€‚</p>
<h4 id="ç”¨-for-å¾ªç¯éå†ä¸€ä¸ªé›†åˆ"><a href="#ç”¨-for-å¾ªç¯éå†ä¸€ä¸ªé›†åˆ" class="headerlink" title="ç”¨ for å¾ªç¯éå†ä¸€ä¸ªé›†åˆ"></a>ç”¨ <code>for</code> å¾ªç¯éå†ä¸€ä¸ªé›†åˆ</h4><p>ç”¨ <code>while</code> å¾ªç¯éå†é›†åˆæ˜¯è¿™æ ·çš„ï¼š</p>
<figure class="highlight rust"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">main</span></span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> a = [<span class="number">10</span>, <span class="number">20</span>, <span class="number">30</span>, <span class="number">40</span>, <span class="number">50</span>];</span><br><span class="line">    <span class="keyword">let</span> <span class="keyword">mut</span> index = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> index &lt; <span class="number">5</span> &#123;</span><br><span class="line">        <span class="built_in">println!</span>(<span class="string">"the value is: &#123;&#125;"</span>, a[index]);</span><br><span class="line"></span><br><span class="line">        index += <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä½¿ç”¨ <code>for</code> å¾ªç¯ï¼Œå°±æ›´åŠ ç®€æ´ï¼š</p>
<figure class="highlight rust"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">main</span></span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> a = [<span class="number">10</span>, <span class="number">20</span>, <span class="number">30</span>, <span class="number">40</span>, <span class="number">50</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> element <span class="keyword">in</span> a.iter() &#123;</span><br><span class="line">        <span class="built_in">println!</span>(<span class="string">"the value is: &#123;&#125;"</span>, element);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä½¿ç”¨ <code>while</code> å¾ªç¯éå†é›†åˆæ—¶ï¼Œå¦‚æœ <code>a</code> é›†åˆå°‘äº†å…ƒç´ ï¼Œè€Œ <code>while</code> å¾ªç¯çš„æ¡ä»¶æ²¡æœ‰ä¿®æ”¹ï¼Œä»£ç ä¼š <code>panic</code> ï¼Œå½“ä½ ä½¿ç”¨ for å¾ªç¯æ—¶ï¼Œä¸éœ€è¦æ‹…å¿ƒè¿™ä¸ªé—®é¢˜ã€‚</p>
<p><code>for</code> å¾ªç¯çš„å®‰å…¨æ€§å’Œç®€æ´æ€§ä½¿å…¶ç§°ä¸º Rust ä¸­æœ€å¸¸ç”¨çš„å¾ªç¯æ„é€ ã€‚å³ä½¿åœ¨ä½ æƒ³è¦å¤šæ¬¡è¿è¡ŒæŸæ®µä»£ç çš„æƒ…å†µä¸‹ï¼Œå¤šæ•° Rust ç¨‹åºå‘˜ä¹Ÿé€‰æ‹©ç”¨ <code>for</code> å¾ªç¯ã€‚ä¸ºäº†åšåˆ°è¿™ä¸€ç‚¹è¦ä½¿ç”¨ <code>Range</code> ï¼Œå®ƒæ˜¯æ ‡å‡†åº“æä¾›çš„ä¸€ç§ç±»å‹ï¼Œäº§ç”Ÿä¸€ä¸ªæ•°å­—åºåˆ—ã€‚</p>
<p>è¿™æ˜¯ä¸€ä¸ªä½¿ç”¨ <code>for</code> å¾ªç¯çš„å€’è®¡æ•°ç¨‹åºï¼Œå®ƒè¿˜åŒ…å«æˆ‘ä»¬æœªæåˆ°è¿‡å¾—æ–¹æ³•ï¼Œç”¨äºåè½¬èŒƒå›´ï¼ˆrangeï¼‰ï¼š</p>
<figure class="highlight rust"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">main</span></span>() &#123;</span><br><span class="line">    <span class="keyword">for</span> number <span class="keyword">in</span> (<span class="number">1</span>..<span class="number">4</span>).rev() &#123;</span><br><span class="line">        <span class="built_in">println!</span>(<span class="string">"&#123;&#125;!"</span>, number);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">"LIFTOFF!!!"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿™æ®µä»£ç æ›´å¥½äº›ï¼Œå¯¹å§ï¼Ÿ</p>
<h3 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><p>æœ¬ç« ä½ å­¦åˆ°äº†ï¼šå˜é‡ã€æ ‡é‡ä»¥åŠç¬¦åˆç±»å‹ï¼Œå‡½æ•°ï¼Œæ³¨é‡Šï¼Œ<code>if</code>è¡¨è¾¾å¼ï¼Œè¿˜æœ‰å¾ªç¯ã€‚é€šè¿‡ä»¥ä¸‹ä¹ é¢˜å·©å›ºæœ¬ç« è®¨è®ºçš„æ¦‚å¿µï¼š</p>
<ul>
<li>è½¬æ¢æ¸©åº¦åæ°åº¦å’Œæ‘„æ°åº¦ã€‚</li>
<li>äº§ç”Ÿç¬¬ n ä¸ª Fibonacci æ•°ã€‚</li>
<li>åˆ©ç”¨æ­Œæ›²ä¸­çš„é‡å¤å†…å®¹ï¼Œå°†æ­Œè¯æ‰“å°åˆ°åœ£è¯èŠ‚é¢‚æ­Œâ€œåœ£è¯èŠ‚çš„åäºŒå¤©â€ä¸­ã€‚</li>
</ul>
<p>å½“ä½ å‡†å¤‡å¥½ç»§ç»­å‰è¿›æ—¶ï¼Œæˆ‘ä»¬å°†è®¨è®º Rust ä¸­å…¶ä»–ç¼–ç¨‹è¯­è¨€ä¸å¸¸è§çš„æ¦‚å¿µï¼šæ‰€æœ‰æƒï¼ˆownershipï¼‰ã€‚</p>
]]></content>
      <tags>
        <tag>rust</tag>
      </tags>
  </entry>
  <entry>
    <title>Rust å­¦ä¹ ç¬”è®° 1</title>
    <url>/2020/03/30/Rust-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-1/</url>
    <content><![CDATA[<p>é˜…è¯» <a href="https://doc.rust-lang.org/book" target="_blank" rel="noopener">ã€Š Rust ç¨‹åºè®¾è®¡ã€‹</a>çš„ä¸€äº›ç¬”è®°ã€‚</p>
<p>ç¬¬ 2 ç«  - ä»ä¸€ä¸ªçŒœæ•°å­—æ¸¸æˆäº†è§£è¯­è¨€ç‰¹æ€§</p>
<a id="more"></a>
<blockquote>
<p>å‚è€ƒ<a href="https://doc.rust-lang.org/book/ch02-00-guessing-game-tutorial.html" target="_blank" rel="noopener">åŸæ–‡</a></p>
</blockquote>
<h2 id="ä¿å­˜å€¼åˆ°å˜é‡"><a href="#ä¿å­˜å€¼åˆ°å˜é‡" class="headerlink" title="ä¿å­˜å€¼åˆ°å˜é‡"></a>ä¿å­˜å€¼åˆ°å˜é‡</h2><p>Rust ä¸­ï¼Œå˜é‡é»˜è®¤æ˜¯ä¸å¯å˜çš„ï¼ˆimmutableï¼‰ã€‚</p>
<p><code>String::new</code> å‡½æ•°è¿”å›çš„ <code>String.String</code> æ˜¯æ ‡å‡†åº“æä¾›çš„å­—ç¬¦ä¸²ç±»å‹ï¼Œå®ƒæ˜¯å¯å¢é•¿çš„ï¼ˆgrawableï¼‰ï¼ŒUTF-8 ç¼–ç çš„æ–‡æœ¬ã€‚</p>
<p><code>::new</code> ä¸­çš„ <code>::</code> è¯­æ³•è¡¨æ˜ <code>new</code> æ˜¯ <code>String</code> ç±»å‹çš„å…³è”å‡½æ•°ï¼ˆassociated functionï¼‰ï¼Œå…³è”å‡½æ•°éƒ½æ˜¯å†ç±»å‹ä¸Šå®ç°çš„ï¼Œè€Œä¸æ˜¯å†æŸä¸€ç±»å‹çš„ç‰¹å®šå®ä¾‹ä¸Šå®ç°ã€‚</p>
<p><code>&amp;</code> è¡¨æ˜è¿™ä¸ªå‚æ•°æ˜¯ä¸€ä¸ªå¼•ç”¨ï¼ˆreferenceï¼‰ï¼Œå³ç›´æ¥è®¿é—®æŸå—å†…å­˜ä¸­çš„æ•°æ®è€Œä¸éœ€è¦æ‹·è´ã€‚å¼•ç”¨æ˜¯ä¸€é¡¹å¤æ‚çš„åŠŸèƒ½ï¼Œ Rust çš„ä¸»è¦ä¼˜åŠ¿ä¹‹ä¸€æ˜¯ä½¿ç”¨å¼•ç”¨çš„å®‰å…¨æ€§å’Œä¾¿æ·æ€§ï¼ˆç¬¬ 4 ç« ä¼šæœ‰è¯¦ç»†ä»‹ç»ï¼‰ã€‚è€Œç›®å‰éœ€è¦çŸ¥é“çš„æ˜¯ï¼Œåƒå˜é‡ä¸€æ ·ï¼Œå¼•ç”¨ä¹Ÿé»˜è®¤æ˜¯ä¸å¯å˜çš„ï¼Œå› æ­¤ <code>read_line()</code> å‡½æ•°ä¸­éœ€è¦ä¼ é€’ <code>&amp;mut guess</code> å‚æ•°ï¼Œè€Œä¸æ˜¯ <code>&amp;guess</code> ã€‚</p>
<h2 id="ä½¿ç”¨ç»“æœï¼ˆResultï¼‰ç±»å‹å¤„ç†æ½œåœ¨çš„æ•…éšœ"><a href="#ä½¿ç”¨ç»“æœï¼ˆResultï¼‰ç±»å‹å¤„ç†æ½œåœ¨çš„æ•…éšœ" class="headerlink" title="ä½¿ç”¨ç»“æœï¼ˆResultï¼‰ç±»å‹å¤„ç†æ½œåœ¨çš„æ•…éšœ"></a>ä½¿ç”¨ç»“æœï¼ˆResultï¼‰ç±»å‹å¤„ç†æ½œåœ¨çš„æ•…éšœ</h2><p><code>read_line</code> æ¥æ”¶ç”¨æˆ·è¾“å…¥ï¼Œè¿”å›ä¸€ä¸ªå€¼ï¼Œæœ¬ä¾‹ä¸­å®ƒæ˜¯ <code>io::Result</code>ï¼Œ Rust åœ¨å…¶æ ‡å‡†åº“ä¸­æœ‰å¤§é‡åä¸º <code>Result</code> çš„ç±»å‹ï¼šé€šç”¨ <code>Result</code> å’Œç‰¹å®šç‰ˆæœ¬çš„å­æ¨¡å—ï¼Œä¾‹å¦‚ <code>io::Result</code> ã€‚</p>
<p><code>Result</code> ç±»å‹æ˜¯æšä¸¾ç±»å‹ï¼ˆenumerationsï¼‰ï¼Œé€šå¸¸è¢«æˆä¸º <code>enums</code>ï¼Œæšä¸¾ç±»å‹æ˜¯ä¸€ç§æœ‰å›ºå®šå€¼é›†åˆçš„ç±»å‹ï¼Œè¿™äº›å€¼æˆä¸ºæšä¸¾å˜é‡ï¼Œç¬¬ 6 ç« ä¼šè¯¦ç»†ä»‹ç»æšä¸¾ç±»å‹ã€‚</p>
<p><code>Result</code> ç±»å‹çš„ç›®çš„æ˜¯å¯¹é”™è¯¯å¤„ç†ï¼ˆerror-handlingï¼‰ä¿¡æ¯è¿›è¡Œç¼–ç ã€‚<code>io::Result</code> çš„å®ä¾‹æ‹¥æœ‰ <code>expect</code> æ–¹æ³•ã€‚å¦‚æœ <code>io::Result</code> å®ä¾‹æ˜¯ä¸€ä¸ª <code>Err</code> å€¼ï¼Œ <code>expect</code> å°†å¯¼è‡´ç¨‹åºå´©æºƒï¼Œå¹¶æ˜¾ç¤ºä½ ä¼ é€’ç»™ <code>expect</code> çš„å‚æ•°ã€‚å¦‚æœ <code>read_line</code> æ–¹æ³•è¿”å›ä¸€ä¸ª <code>Err</code> ï¼Œå¯èƒ½æ˜¯æ¥è‡ªåº•å±‚æ“ä½œç³»ç»Ÿçš„é”™è¯¯å¯¼è‡´çš„ã€‚å¦‚æœ <code>io::Result</code> å®ä¾‹æ˜¯ <code>Ok</code> å€¼ï¼Œ<code>expect</code> å°†è·å¾— <code>Ok</code> æŒæœ‰çš„è¿”å›å€¼ï¼Œå¹¶åªå°†è¯¥å€¼è¿”å›ç»™ä½ ï¼Œä»¥ä¾¿ä½ ä½¿ç”¨å®ƒã€‚è¿™ç§æƒ…å†µä¸‹ï¼Œè¯¥å€¼æ˜¯ç”¨æˆ·è¾“å…¥åˆ°æ ‡å‡†è¾“å…¥çš„å­—èŠ‚æ•°ã€‚</p>
<p>å¦‚æœä½ ä¸è°ƒç”¨ <code>expect</code> ï¼Œç¨‹åºå¯ä»¥é€šè¿‡ç¼–è¯‘ï¼Œä½†æ˜¯ä½ ä¼šè·å¾—è­¦å‘Šï¼š</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">warning: unused `std::result::Result` that must be used</span><br><span class="line"> --&gt; src/main.rs:8:5</span><br><span class="line">  |</span><br><span class="line">8 | /     io::stdin()</span><br><span class="line">9 | |         .read_line(&amp;mut guess);</span><br><span class="line">  | |_______________________________^</span><br><span class="line">  |</span><br><span class="line">  = note: `<span class="comment">#[warn(unused_must_use)]` on by default</span></span><br><span class="line">  = note: this `Result` may be an `Err` variant, <span class="built_in">which</span> should be handled</span><br></pre></td></tr></table></figure>
<p>æŠ‘åˆ¶è­¦å‘Šçš„æ­£ç¡®åšæ³•æ˜¯ç¼–å†™å®é™…çš„é”™è¯¯å¤„ç†ï¼Œä½†æ˜¯ä½ ä»…ä»…å¸Œæœ›é—®é¢˜å‘ç”Ÿæ—¶ç¨‹åºå´©æºƒï¼Œä½ å¯ä»¥ä½¿ç”¨ <code>expect</code> ã€‚ç¬¬ 9 ç« å¯ä»¥å­¦åˆ°å¦‚ä½•ä»é”™è¯¯ä¸­æ¢å¤ã€‚</p>
<h2 id="ä½¿ç”¨-println-å ä½ç¬¦"><a href="#ä½¿ç”¨-println-å ä½ç¬¦" class="headerlink" title="ä½¿ç”¨ println! å ä½ç¬¦"></a>ä½¿ç”¨ <code>println!</code> å ä½ç¬¦</h2><p>é—­åˆçš„å¤§æ‹¬å· <code>{}</code> å°±æ˜¯ä¸€ä¸ªå ä½ç¬¦ï¼š<code>{}</code> åƒèƒèŸ¹çš„å°é’³å­æŠ“ä½ä¸€ä¸ªå€¼ã€‚</p>
<h2 id="äº§ç”Ÿç§˜å¯†æ•°å­—"><a href="#äº§ç”Ÿç§˜å¯†æ•°å­—" class="headerlink" title="äº§ç”Ÿç§˜å¯†æ•°å­—"></a>äº§ç”Ÿç§˜å¯†æ•°å­—</h2><p>æˆ‘ä»¬ä½¿ç”¨ 1 è‡³ 100 ä¹‹é—´çš„éšæœºæ•°ï¼Œè™½ç„¶ Rust å½“å‰çš„æ ‡å‡†åº“ä¸­æ²¡æœ‰éšæœºæ•°å‡½æ•°ï¼Œä½†æ˜¯ Rust å›¢é˜Ÿæä¾›äº† <code>rand</code> æ¿æ¡ç®±ï¼ˆcrateï¼‰ã€‚</p>
<h2 id="ä½¿ç”¨æ¿æ¡ç®±è·å¾—æ›´å¤šåŠŸèƒ½"><a href="#ä½¿ç”¨æ¿æ¡ç®±è·å¾—æ›´å¤šåŠŸèƒ½" class="headerlink" title="ä½¿ç”¨æ¿æ¡ç®±è·å¾—æ›´å¤šåŠŸèƒ½"></a>ä½¿ç”¨æ¿æ¡ç®±è·å¾—æ›´å¤šåŠŸèƒ½</h2><p>ä¸€ä¸ª crate æ˜¯ Rust æºç æ–‡ä»¶çš„é›†åˆã€‚æˆ‘ä»¬æ­£åœ¨æ„å»ºçš„é¡¹ç›®æ˜¯ä¸€ä¸ªå¯æ‰§è¡Œçš„äºŒè¿›åˆ¶æ¿æ¡ç®±ï¼ˆbinary crateï¼‰ã€‚<code>rand</code> æ˜¯ä¸€ä¸ªåº“æ¿æ¡ç®±ï¼ˆlibrary crateï¼‰åŒ…å«å¯ä»¥è¢«å…¶ä»–ç¨‹åºä½¿ç”¨çš„ä»£ç ã€‚</p>
<p>åœ¨ <code>Cargo.toml</code> æ–‡ä»¶ä¸­ï¼Œä¾èµ–é¡¹éƒ¨åˆ†æ·»åŠ ä¸€è¡Œï¼š</p>
<figure class="highlight toml"><table><tr><td class="code"><pre><span class="line"><span class="section">[dependencies]</span></span><br><span class="line"><span class="attr">rand</span> = <span class="string">"0.5.5"</span></span><br></pre></td></tr></table></figure>
<p>æˆ‘ä»¬æŒ‡å®š <code>rand</code> æ¿æ¡ç®±çš„è¯­ä¹‰ç‰ˆæœ¬è¯´æ˜ç¬¦ï¼ˆsemantic version specifierï¼‰ä¸º <code>0.5.5</code> ï¼Œ Cargo ç†è§£è¯­ä¹‰ç‰ˆæœ¬ï¼ˆæœ‰æ—¶ç§°ä¸º <code>SemVer</code>ï¼‰ï¼Œè¿™æ˜¯ä¸€ç§ä¹¦å†™ç‰ˆæœ¬å·çš„æ ‡å‡†ã€‚<code>0.5.5</code> æ˜¯ <code>^0.5.5</code> çš„ç®€å†™ï¼Œå®ƒè¡¨ç¤ºâ€œå…·æœ‰å…¼å®¹ 0.5.5 ç‰ˆæœ¬å…¬å…± API çš„ä»»æ„ç‰ˆæœ¬â€ã€‚</p>
<p>æ‰§è¡Œ <code>cargo build</code> è·å–ä¾èµ–ã€‚</p>
<h2 id="ä½¿ç”¨-Cargo-lock-æ–‡ä»¶ç¡®ä¿å¯å¤åˆ¶çš„æ„å»º"><a href="#ä½¿ç”¨-Cargo-lock-æ–‡ä»¶ç¡®ä¿å¯å¤åˆ¶çš„æ„å»º" class="headerlink" title="ä½¿ç”¨ Cargo.lock æ–‡ä»¶ç¡®ä¿å¯å¤åˆ¶çš„æ„å»º"></a>ä½¿ç”¨ Cargo.lock æ–‡ä»¶ç¡®ä¿å¯å¤åˆ¶çš„æ„å»º</h2><p>Cargo å…·æœ‰ä¸€ç§æœºåˆ¶ï¼Œå¯ä»¥ç¡®ä¿ä½ æˆ–å…¶ä»–ä»»ä½•äººæ¯æ¬¡æ„å»ºä»£ç æ—¶éƒ½å¯ä»¥é‡å»ºç›¸åŒçš„å·¥ä»¶ï¼šé™¤éå¦æœ‰è¯´æ˜ï¼Œå¦åˆ™ Cargo å°†ä»…ä½¿ç”¨ä½ æŒ‡å®šçš„ä¾èµ–é¡¹ç‰ˆæœ¬ã€‚</p>
<h2 id="æ›´æ–°-Crate-è·å–æ–°ç‰ˆæœ¬"><a href="#æ›´æ–°-Crate-è·å–æ–°ç‰ˆæœ¬" class="headerlink" title="æ›´æ–° Crate è·å–æ–°ç‰ˆæœ¬"></a>æ›´æ–° Crate è·å–æ–°ç‰ˆæœ¬</h2><p><code>update</code> å‘½ä»¤å°†å¿½ç•¥ Cargo.lock æ–‡ä»¶å¹¶æ‰¾åˆ°æ‰€æœ‰æœ€æ–°ç‰ˆæœ¬ä¾èµ–ï¼Œå¹¶å†™å…¥ Cargo.lock æ–‡ä»¶ã€‚</p>
<p>é»˜è®¤æƒ…å†µä¸‹ï¼ŒCargo å°†ä»…æŸ¥æ‰¾ä»‹äº <code>0.5.5</code> å’Œ <code>0.6.0</code> çš„ç‰ˆæœ¬ã€‚</p>
<p>é€šè¿‡ä¿®æ”¹ Cargo.toml æ¥æŒ‡å®š rand 0.6.x ç‰ˆæœ¬ï¼Œå†æ¬¡æ‰§è¡Œ <code>cargo build</code>ï¼Œ Cargo å°†æ›´æ–°å¯ç”¨çš„æ³¨å†Œè¡¨ï¼Œå¹¶æ ¹æ®ä½ æŒ‡å®šçš„æ–°ç‰ˆæœ¬é‡æ–°è¯„ä¼°ä½ çš„ <code>rand</code> éœ€æ±‚ã€‚</p>
<h2 id="äº§ç”Ÿéšæœºæ•°"><a href="#äº§ç”Ÿéšæœºæ•°" class="headerlink" title="äº§ç”Ÿéšæœºæ•°"></a>äº§ç”Ÿéšæœºæ•°</h2><p>é¦–å…ˆæ·»åŠ  <code>use</code> è¡Œï¼š <code>use rand::Rng</code> ã€‚ <code>Rng</code> ç‰¹å¾ï¼ˆtraitï¼‰å®šä¹‰äº†äº§ç”Ÿéšæœºæ•°çš„å®ç°æ–¹æ³•ï¼Œå¹¶ä¸”è¯¥ç‰¹æ€§å¿…é¡»è¦åœ¨æˆ‘ä»¬å¯ä»¥ä½¿ç”¨è¿™äº›æ–¹æ³•çš„èŒƒå›´å†…ã€‚ç¬¬ 10 ç« è¯¦ç»†ä»‹ç» trait ã€‚</p>
<p>æ¥ç€æ·»åŠ ä¸¤è¡Œï¼Œ <code>rand::thread_rng</code> å‡½æ•°å°†ä¸ºæˆ‘ä»¬æä¾›å°†è¦ä½¿ç”¨çš„ç‰¹å®šéšæœºæ•°ç”Ÿæˆå™¨ï¼šå®ƒæœ‰å½“å‰çº¿ç¨‹æ‰§è¡Œå¹¶ä¸”æ“ä½œç³»ç»Ÿæä¾›éšæœºç§å­ã€‚</p>
<h2 id="æŸ¥çœ‹ä½¿ç”¨è¯´æ˜æ–‡æ¡£"><a href="#æŸ¥çœ‹ä½¿ç”¨è¯´æ˜æ–‡æ¡£" class="headerlink" title="æŸ¥çœ‹ä½¿ç”¨è¯´æ˜æ–‡æ¡£"></a>æŸ¥çœ‹ä½¿ç”¨è¯´æ˜æ–‡æ¡£</h2><p>ä½ ä¸å¯èƒ½ä¸€å¼€å§‹å°±çŸ¥é“è¦ä½¿ç”¨å“ªäº› traits æˆ–è€…è¦è°ƒç”¨å“ªäº›å‡½æ•°ï¼Œcrate çš„ä½¿ç”¨è¯´æ˜åœ¨å…¶æ–‡æ¡£ä¸­ï¼Œä½¿ç”¨ <code>cargo doc --open</code> å¯ä»¥æ„å»ºæ‰€æœ‰æœ¬åœ°ä¾èµ–çš„æ–‡æ¡£ã€‚</p>
<p>ä½¿ç”¨è¯´æ˜æ–‡æ¡£ç”Ÿæˆåœ¨ <code>./target/doc/guessing_game/index.html</code> ç›®å½•ä¸­ï¼Œæˆ‘ä»¬èµ·ä¸€ä¸ªç®€å•çš„ web æœåŠ¡æ–¹ä¾¿æŸ¥çœ‹æ–‡æ¡£ï¼ˆéœ€è¦ python3 æ”¯æŒï¼Œä½ ä¹Ÿå¯ä»¥ç›´æ¥æ‰“å¼€ç›®æ ‡æ–‡ä»¶ï¼‰ã€‚</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">python3 -m http.server -d ./target/doc/</span><br></pre></td></tr></table></figure>
<p>æµè§ˆå™¨æ‰“å¼€ <a href="http://localhost:8000/guessing_game" target="_blank" rel="noopener">http://localhost:8000/guessing_game</a> ã€‚</p>
<h2 id="æ¯”è¾ƒ-Guess-å’Œ-Secret-Number"><a href="#æ¯”è¾ƒ-Guess-å’Œ-Secret-Number" class="headerlink" title="æ¯”è¾ƒ Guess å’Œ Secret Number"></a>æ¯”è¾ƒ Guess å’Œ Secret Number</h2><p>æˆ‘ä»¬ç”¨åˆ°äº† match è¡¨è¾¾å¼ï¼Œä¸€ä¸ª <code>match</code> è¡¨è¾¾å¼ç”±æ‰‹è‡‚ï¼ˆarmsï¼‰æ„æˆï¼Œæ‰‹è‡‚ç”±æ¨¡å¼ï¼ˆpatternï¼‰å’Œæ‰§è¡Œä»£ç æ„æˆï¼Œå¦‚æœ <code>match</code> è¡¨è¾¾å¼å¼€å¤´çš„å€¼ç¬¦åˆè¯¥æ¨¡å¼ï¼Œå°±ä¼šæ‰§è¡Œè¿™æ®µä»£ç ã€‚<code>match</code> ç»“æ„å’Œæ¨¡å¼æ˜¯ Rust ä¸­çš„å¼ºå¤§åŠŸèƒ½ï¼Œå¯ä»¥å½“ä½ è¡¨è¾¾ä»£ç å¯èƒ½é‡åˆ°çš„å„ç§æƒ…å†µï¼Œå¹¶ç¡®ä¿å¯¹æ‰€æœ‰æƒ…å†µè¿›è¡Œå¤„ç†ã€‚è¿™äº›åŠŸèƒ½åˆ†åˆ«åœ¨ç¬¬ 6 ç« å’Œç¬¬ 18 ç« ä¸­è¯¦ç»†ä»‹ç»ã€‚</p>
<p>Rust å…·æœ‰å¼ºå¤§çš„é™æ€ç±»å‹ç³»ç»Ÿã€‚ç„¶è€Œï¼Œå®ƒä¹Ÿæœ‰ç±»å‹æ¨æ–­ï¼ˆtype inferenceï¼‰ã€‚å½“æˆ‘ä»¬å†™ä¸‹ <code>let mut guesss = String::new()</code> ï¼Œ Rust å°±èƒ½å¤Ÿæ¨æ–­å‡º <code>guess</code> åº”è¯¥æ˜¯ <code>String</code> ç±»å‹ã€‚</p>
<p>ç”±äº <code>guess</code> å’Œ <code>secret_number</code> ç±»å‹ä¸åŒ¹é…ï¼Œcmp æ–¹æ³•è°ƒç”¨å¤±è´¥ï¼Œåˆ™æˆ‘ä»¬éœ€è¦ç±»å‹è½¬æ¢ã€‚æˆ‘ä»¬å†åˆ›å»ºä¸€ä¸ªå˜é‡ <code>guess</code> ï¼Œè™½ç„¶å®ƒå’Œä¹‹å‰çš„å˜é‡é‡åï¼Œä½†æ˜¯ Rust å…è®¸æˆ‘ä»¬ç”¨ä¸€ä¸ªæ–°çš„å€¼æ¥æ©ç›–ï¼ˆshadowï¼‰ä»¥å‰çš„ <code>guess</code> å€¼ï¼Œæ¬¡åŠŸèƒ½é€šå¸¸ç”¨äºå€¼ç±»å‹è½¬æ¢çš„æƒ…å†µã€‚æ©ç›–ä½¿æˆ‘ä»¬å¯ä»¥é‡ç”¨å˜é‡åç§°ï¼Œè€Œä¸æ˜¯å¼ºè¿«æˆ‘ä»¬åˆ›å»ºä¸¤ä¸ªå”¯ä¸€å˜é‡ï¼Œä¾‹å¦‚ <code>guess_str</code> å’Œ <code>guess</code> ã€‚ï¼ˆç¬¬ 3 ç« è¯¦ç»†æè¿° shadowing ï¼‰</p>
<p><code>trim</code> æ–¹æ³•ç”¨äºæ¶ˆé™¤ï¼ˆeliminatesï¼‰æŒ‰ä¸‹å›è½¦é”®æ—¶è¢«è¯»å–åˆ°çš„ <code>\n</code> å­—ç¬¦ã€‚</p>
<p><code>parse</code> æ–¹æ³•ä½œç”¨äºå­—ç¬¦ä¸²å¯ä»¥å°†å­—ç¬¦ä¸²è§£æä¸ºæ•°å­—ã€‚ä½†æ˜¯è¿™ä¸ªæ–¹æ³•å¯ä»¥è§£æå‡ºå¤šç§ç±»å‹ï¼Œæˆ‘ä»¬è¦æ˜ç¡®æŒ‡å®š <code>guess</code> çš„ç±»å‹ï¼š<code>let guess: u32</code> ã€‚</p>
<p>ä¾‹ç¨‹ä¸­çš„ <code>u32</code> æ³¨è§£ï¼Œå½±å“åˆ°ä¸ <code>secret_number</code> æ¯”è¾ƒæ—¶ï¼Œå°†å…¶ä¹Ÿæ¨æ–­æˆ <code>u32</code> ç±»å‹ã€‚</p>
]]></content>
      <tags>
        <tag>rust</tag>
      </tags>
  </entry>
  <entry>
    <title>Rust å­¦ä¹ ç¬”è®° 0</title>
    <url>/2020/03/30/Rust-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-0/</url>
    <content><![CDATA[<p>é˜…è¯» <a href="https://doc.rust-lang.org/book" target="_blank" rel="noopener">ã€Š Rust ç¨‹åºè®¾è®¡ã€‹</a>çš„ä¸€äº›ç¬”è®°ã€‚</p>
<p>ç¬¬ 1 ç«  - ç¬¬ä¸€ä¸ª Rust é¡¹ç›®</p>
<a id="more"></a>
<h2 id="å®‰è£…-Rust"><a href="#å®‰è£…-Rust" class="headerlink" title="å®‰è£… Rust"></a>å®‰è£… Rust</h2><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">curl https://sh.rustup.rs -sSf | sh</span><br><span class="line"></span><br><span class="line"><span class="built_in">export</span> PATH=<span class="string">"<span class="variable">$HOME</span>/.cargo/bin:<span class="variable">$PATH</span>"</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>default æ¨¡å¼å®‰è£…ï¼Œä¼šä¿®æ”¹ ~/.profile æ–‡ä»¶ï¼Œéœ€è¦æ‰‹åŠ¨ä¿®æ”¹ä½ çš„ç¯å¢ƒå˜é‡ã€‚</p>
</blockquote>
<h2 id="æ–°å»ºé¡¹ç›®"><a href="#æ–°å»ºé¡¹ç›®" class="headerlink" title="æ–°å»ºé¡¹ç›®"></a>æ–°å»ºé¡¹ç›®</h2><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># ç”±äºæ•°å­—å¼€å¤´çš„ crate åç§°ä¸åˆæ³•ï¼Œæ‰€ä»¥ä½¿ç”¨ --name æŒ‡å®š crate åç§°</span></span><br><span class="line">cargo new 002_helloworld --name hello_cargo</span><br><span class="line"><span class="built_in">cd</span> 002_hello_cargo</span><br></pre></td></tr></table></figure>
<h2 id="ç¼–è¯‘è¿è¡Œ"><a href="#ç¼–è¯‘è¿è¡Œ" class="headerlink" title="ç¼–è¯‘è¿è¡Œ"></a>ç¼–è¯‘è¿è¡Œ</h2><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">cargo build</span><br><span class="line">./target/debug/hello_cargo</span><br></pre></td></tr></table></figure>
<p>ä¹Ÿå¯ä»¥</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">cargo run</span><br></pre></td></tr></table></figure>
<blockquote>
<p>ä»£ç æ²¡åšæ”¹åŠ¨çš„æƒ…å†µä¸‹ï¼Œä¸ä¼šé‡æ–°ç¼–è¯‘ï¼Œè€Œæ˜¯ç›´æ¥è¿è¡Œå¯æ‰§è¡Œæ–‡ä»¶ã€‚</p>
</blockquote>
<h2 id="ä»£ç æ£€æŸ¥"><a href="#ä»£ç æ£€æŸ¥" class="headerlink" title="ä»£ç æ£€æŸ¥"></a>ä»£ç æ£€æŸ¥</h2><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">cargo check</span><br></pre></td></tr></table></figure>
<blockquote>
<p>å› ä¸ºä¸éœ€è¦ç”Ÿæˆæ‰§è¡Œæ–‡ä»¶ï¼Œæ‰€ä»¥ <code>check</code> éå¸¸å¿«ã€‚</p>
</blockquote>
<h2 id="æ„å»ºå‘å¸ƒ"><a href="#æ„å»ºå‘å¸ƒ" class="headerlink" title="æ„å»ºå‘å¸ƒ"></a>æ„å»ºå‘å¸ƒ</h2><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">cargo build --release</span><br></pre></td></tr></table></figure>
<blockquote>
<p>åŠ ä¸Š <code>--release</code> ä¼šä¼˜åŒ–ç¼–è¯‘ï¼ˆç¼–è¯‘é€Ÿåº¦è¾ƒæ…¢ï¼‰ï¼Œå¯æ‰§è¡Œæ–‡ä»¶ç”Ÿæˆè‡³ <code>target/release</code> ç›®å½•ã€‚</p>
</blockquote>
<blockquote>
<p>å¦‚æœä½ éœ€è¦ benchmark ï¼Œé‚£ä¹ˆå°±è¦æŒ‡å®š <code>--release</code> ã€‚</p>
</blockquote>
<blockquote>
<p>å¤æ‚é¡¹ç›®çš„æ„å»ºä½¿ç”¨ <code>cargo</code> å°†èƒ½ä½“ç°å®ƒçš„ä»·å€¼ã€‚</p>
</blockquote>
]]></content>
      <tags>
        <tag>rust</tag>
      </tags>
  </entry>
  <entry>
    <title>Go è°šè¯­</title>
    <url>/2020/01/10/Go-Proverbs/</url>
    <content><![CDATA[<blockquote>
<p>Go è¯­è¨€ä¹‹çˆ¶ Rob Pike æ€»ç»“çš„å‡ æ¡ Go è°šè¯­ã€‚</p>
</blockquote>
<p> <a href="https://www.youtube.com/watch?v=PAAkCSZUG1c" target="_blank" rel="noopener">æ¥æºï¼š Go Proverbs - Rob Pike - Gopherfest - November 18, 2015</a></p>
 <a id="more"></a>
<ol>
<li>Donâ€™t communicate by sharing memory, share memory by communicating.</li>
<li>Concurrency is not parallism.</li>
<li>Channels orchestrate; mutexes serialize.</li>
<li>The bigger the interface, the weaker the abstraction.</li>
<li>Make the zero value useful. (e.g. bytes.Buffer or sync.Mutex)</li>
<li>interface{} says nothing.</li>
<li>Gofmtâ€™s style is no oneâ€™s favorite, yet gofmt is everyoneâ€™s favorite.</li>
<li>A little copying is better than a little dependency.</li>
<li>Syscall must always be guarded with build tags.</li>
<li>Cgo must always be guarded with build tags.</li>
<li>Cgo is not Go.</li>
<li>With the unsafe package, there are no guarantees.</li>
<li>Clear is better than clever.</li>
<li>Reflection is never clear.</li>
<li>Errors are values.</li>
<li>Donâ€™t just check errors, handle them gracefully.</li>
<li>Design the architecture, name the components, document the details.</li>
<li>Documentation is for users.</li>
<li>Donâ€™t panic.</li>
</ol>
<h2 id="è§£è¯»"><a href="#è§£è¯»" class="headerlink" title="è§£è¯»"></a>è§£è¯»</h2><ol>
<li>ä¸è¦é€šè¿‡å…±äº«å†…å­˜æ¥é€šä¿¡ï¼Œè€Œåº”è¯¥é€šè¿‡é€šä¿¡çš„æ–¹å¼å…±äº«å†…å­˜ã€‚<blockquote>
<p>Go å®˜æ–¹åšå®¢çš„<a href="https://blog.golang.org/share-memory-by-communicating" target="_blank" rel="noopener">è§£è¯»</a></p>
</blockquote>
</li>
<li>å¹¶å‘ä¸æ˜¯å¹¶è¡Œã€‚</li>
<li>Channels ç¼–æ’ï¼›äº’æ–¥é‡çš„ä¸²è¡ŒåŒ–ã€‚<blockquote>
<p>ä½¿ç”¨ chan ä¸²è¡Œå¤„ç†äº’æ–¥é‡ã€‚</p>
</blockquote>
</li>
<li>æ¥å£è¶Šå¤§ï¼ŒæŠ½è±¡èƒ½åŠ›è¶Šå¼±ã€‚<blockquote>
<p>å¥½çš„æ¥å£å®šä¹‰ä¸€èˆ¬ä¸è¶…è¿‡ä¸¤ç§æ–¹æ³•.</p>
</blockquote>
</li>
<li>è®©é›¶å€¼æœ‰ç”¨ï¼ˆæ¯”å¦‚ bytes.Buffer æˆ– sync.Mutexï¼‰ã€‚</li>
<li>interface{} æ²¡æœ‰ä¿¡æ¯ã€‚<blockquote>
<p>å› ä¸ºæ¥å£ç±»å‹æ— æ³•åšåˆ°é™æ€æ£€æŸ¥ã€‚</p>
</blockquote>
</li>
<li>Gofmt çš„é£æ ¼æ²¡æœ‰äººå–œæ¬¢ï¼Œä½† Gofmt å´æ˜¯æ¯ä¸ªäººçš„æœ€çˆ±ã€‚</li>
<li>åšä¸€ç‚¹å¤åˆ¶æ¯”ä¸€ç‚¹ä¾èµ–æ›´å¥½ã€‚</li>
<li>ç³»ç»Ÿè°ƒç”¨å¿…é¡»ç”±æ„å»ºæ ‡ç­¾ä¿è¯ã€‚</li>
<li>Cgo å¿…é¡»ç”±æ„å»ºæ ‡ç­¾ä¿è¯ã€‚</li>
<li>Cgo ä¸æ˜¯ Go ã€‚<blockquote>
<p>ä»–è¯´è‡ªå·±å‡ ä¹ä¸ä½¿ç”¨ cgo ã€‚<br>Dave åšå®¢çš„<a href="https://dave.cheney.net/2016/01/18/cgo-is-not-go" target="_blank" rel="noopener">è§£è¯»</a>ã€‚</p>
</blockquote>
</li>
<li>unsafe åŒ…ä¸­çš„å†…å®¹ï¼Œæ²¡æœ‰ä¿è¯ã€‚</li>
<li>æ¸…æ™°æ¯”èªæ˜æ›´é‡è¦ã€‚<blockquote>
<p>ä¹¦å†™é€»è¾‘æ¸…æ™°çš„ä»£ç ï¼Œä¸è¦è€å°èªæ˜ã€‚</p>
</blockquote>
</li>
<li>åå°„æ°¸è¿œæ˜¯ä¸æ¸…æ™°çš„ã€‚</li>
<li>é”™è¯¯ä¹Ÿæ˜¯å€¼ã€‚<blockquote>
<p>Go å®˜æ–¹åšå®¢çš„<a href="https://blog.golang.org/errors-are-values" target="_blank" rel="noopener">è§£è¯»</a>ã€‚</p>
</blockquote>
</li>
<li>ä¸è¦ä»…ä»…æ£€æŸ¥æŠ¥é”™ï¼Œè¦ä¼˜é›…çš„å¤„ç†å®ƒä»¬ã€‚<blockquote>
<p>Dave åšå®¢çš„<a href="https://dave.cheney.net/2016/04/27/dont-just-check-errors-handle-them-gracefully" target="_blank" rel="noopener">è§£è¯»</a>ã€‚</p>
</blockquote>
</li>
<li>è®¾è®¡æ¶æ„ï¼Œå‘½åç»„ä»¶ï¼Œè®°å½•ç»†èŠ‚ã€‚<blockquote>
<p>å–ä¸€ä¸ªå¥½åå­—è§£é‡Šèµ·æ¥ä¹Ÿçœäº‹ã€‚</p>
</blockquote>
</li>
<li>æ–‡æ¡£æ˜¯ç»™ç”¨æˆ·çœ‹çš„ã€‚<blockquote>
<p>æ–‡æ¡£åº”è¯¥è®°å½•ç”¨æˆ·éœ€è¦çŸ¥é“çš„å†…å®¹ã€‚</p>
</blockquote>
</li>
<li>ä¸è¦ææ…Œã€‚<blockquote>
<p>ç¨‹åº panic ä¸æ˜¯æ­£å¸¸çš„é”™è¯¯ï¼Œè¦æ‰¾åˆ°é—®é¢˜å¹¶è§£å†³ã€‚æ­£å¸¸é”™è¯¯ç”¨ error å¤„ç†ã€‚</p>
</blockquote>
</li>
</ol>
<h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><ul>
<li><a href="https://go-proverbs.github.io/" target="_blank" rel="noopener">Go Proverbs</a></li>
<li><a href="https://studygolang.com/articles/12327" target="_blank" rel="noopener">Go è¯­è¨€ä¸­æ–‡ç½‘ - Go è°šè¯­</a></li>
</ul>
]]></content>
      <tags>
        <tag>Go</tag>
      </tags>
  </entry>
  <entry>
    <title>Go ç§ç½‘å¼€å‘æœåŠ¡æ­å»ºè®°å½•</title>
    <url>/2019/10/29/Go-%E7%A7%81%E7%BD%91%E5%BC%80%E5%8F%91%E6%9C%8D%E5%8A%A1%E6%90%AD%E5%BB%BA%E8%AE%B0%E5%BD%95/</url>
    <content><![CDATA[<p>æœ¬æ–‡è®°å½•äº†ç§ç½‘ Go å¼€å‘æ‰€éœ€çš„æ‰€æœ‰ç›¸å…³æœåŠ¡ï¼ŒåŒ…æ‹¬ç‰ˆæœ¬ç®¡ç†ï¼Œæ¨¡å—ä»£ç†ï¼ŒæŒç»­é›†æˆã€‚</p>
<p>æ¶‰åŠæœåŠ¡å¦‚ä¸‹ï¼š</p>
<ul>
<li>Gogs</li>
<li>goproxy</li>
<li>Jenkins</li>
</ul>
<a id="more"></a>
<p>ç³»ç»Ÿé…ç½®ï¼š</p>
<ul>
<li>CentOS 7</li>
</ul>
<h2 id="ç‰ˆæœ¬ç®¡ç†"><a href="#ç‰ˆæœ¬ç®¡ç†" class="headerlink" title="ç‰ˆæœ¬ç®¡ç†"></a>ç‰ˆæœ¬ç®¡ç†</h2><h3 id="ç›®çš„"><a href="#ç›®çš„" class="headerlink" title="ç›®çš„"></a>ç›®çš„</h3><p>æ­å»ºç‰ˆæœ¬ç®¡ç†ç³»ç»Ÿï¼ˆVCSï¼‰çš„ç›®çš„ï¼šä¸€æ–¹é¢æ˜¯ä¸ºç§æœ‰é¡¹ç›®æä¾›ç‰ˆæœ¬ç®¡ç†ï¼Œä¸€æ–¹é¢æ˜¯æ‰˜ç®¡ä¿®æ”¹è¿‡çš„å¼€æºé¡¹ç›®ã€‚</p>
<h3 id="é€‰å‹"><a href="#é€‰å‹" class="headerlink" title="é€‰å‹"></a>é€‰å‹</h3><p>ç§ç½‘ç¯å¢ƒå¼€å‘ï¼Œé¡¹ç›®æºç å¯ä»¥æ‰˜ç®¡äºä»»ä½•ç‰ˆæœ¬ç®¡ç†ç³»ç»Ÿï¼Œä½†æ˜¯ Go å¯¹ Git çš„æ”¯æŒæ›´å¥½ï¼Œä¼˜å…ˆè€ƒè™‘æ­å»º Git æœåŠ¡ä½œä¸ºç‰ˆæœ¬ç®¡ç†ã€‚</p>
<p>Go è¦æ±‚ç‰ˆæœ¬ç®¡ç†ç³»ç»Ÿå®ç° <code>go-get</code> æ¥å£ã€‚æˆ‘ä»¬é€‰æ‹©äº† <a href="https://gogs.io/" target="_blank" rel="noopener">Gogs</a> ã€‚å®ƒæ˜¯ç”± Go è¯­è¨€ç¼–å†™çš„å¼€æº Git æœåŠ¡ï¼Œæ­å»ºååˆ†ä¾¿æ· ã€‚</p>
<h3 id="éƒ¨ç½²"><a href="#éƒ¨ç½²" class="headerlink" title="éƒ¨ç½²"></a>éƒ¨ç½²</h3><p>è¯¦è§ <a href="https://gogs.io/docs/installation" target="_blank" rel="noopener">å®˜æ–¹æ­å»ºæŒ‡å—</a> ï¼Œä»¥ä¸‹ä»…ä½œè®°å½•ã€‚</p>
<blockquote>
<p>å¦‚æœä½¿ç”¨ MySQL ï¼Œè¦æ±‚ç‰ˆæœ¬ä¸ä½äº 5.7 ã€‚å‚è€ƒè¿™ç¯‡ <a href="/2019/10/28/Install-MySQL-8-0-on-CentOS-7/">å®‰è£… MySQL 8.0</a></p>
</blockquote>
<h4 id="æ–°å»ºæ•°æ®åº“"><a href="#æ–°å»ºæ•°æ®åº“" class="headerlink" title="æ–°å»ºæ•°æ®åº“"></a>æ–°å»ºæ•°æ®åº“</h4><p>åç§°ï¼š gogs</p>
<p>ç¼–ç ï¼š utf8mb4</p>
<p>æ•°æ®åº“ä¸­é€šè¿‡ä»¥ä¸‹è„šæœ¬æ–°å»ºæ•°æ®åº“ï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">DATABASE</span> gogs <span class="built_in">CHARACTER</span> <span class="keyword">SET</span> utf8mb4 <span class="keyword">COLLATE</span> utf8mb4_unicode_ci;</span><br></pre></td></tr></table></figure>
<h4 id="ä¸‹è½½æœ€æ–°äºŒè¿›åˆ¶ç¨‹åºåŒ…"><a href="#ä¸‹è½½æœ€æ–°äºŒè¿›åˆ¶ç¨‹åºåŒ…" class="headerlink" title="ä¸‹è½½æœ€æ–°äºŒè¿›åˆ¶ç¨‹åºåŒ…"></a>ä¸‹è½½æœ€æ–°äºŒè¿›åˆ¶ç¨‹åºåŒ…</h4><p>ä¸‹è½½<a href="https://gogs.io/docs/installation/install_from_binary.html" target="_blank" rel="noopener">å®˜ç½‘</a>æä¾›çš„äºŒè¿›åˆ¶æ–‡ä»¶ã€‚</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">wget https://cdn.gogs.io/0.11.91/gogs_0.11.91_linux_amd64.tar.gz</span><br></pre></td></tr></table></figure>
<h4 id="è§£å‹è¿è¡Œ"><a href="#è§£å‹è¿è¡Œ" class="headerlink" title="è§£å‹è¿è¡Œ"></a>è§£å‹è¿è¡Œ</h4><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">tar xf gogs_0.11.91_linux_amd64.tar.gz</span><br><span class="line"><span class="built_in">cd</span> gogs</span><br><span class="line">./gogs web</span><br></pre></td></tr></table></figure>
<h4 id="æŒ‰ç…§æç¤ºè¿›è¡Œé…ç½®"><a href="#æŒ‰ç…§æç¤ºè¿›è¡Œé…ç½®" class="headerlink" title="æŒ‰ç…§æç¤ºè¿›è¡Œé…ç½®"></a>æŒ‰ç…§æç¤ºè¿›è¡Œé…ç½®</h4><blockquote>
<p>é…ç½®å‰ç¡®ä¿ Git å·²å®‰è£…</p>
</blockquote>
<details><br><summary>å®‰è£… Git</summary><br><br><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">sudo yum -y install git</span><br></pre></td></tr></table></figure><br><br></details>

<p>æµè§ˆå™¨è®¿é—®å½“å‰ä¸»æœºçš„ 3000 ç«¯å£ï¼Œå¼€å§‹é…ç½®ã€‚</p>
<p>æœ‰å‡ ä¸ªé…ç½®é¡¹éœ€è¦æ³¨æ„ï¼š</p>
<ul>
<li><p>åŸŸåï¼šå»ºè®®å¡«åŸŸåï¼Œä¸ç„¶å¼•ç”¨åœ°å€ä¼šå¾ˆå¥‡æ€ªï¼Œå³ä½¿æ²¡æœ‰çœŸå®åŸŸåä¹Ÿå¯ä»¥å†å®¢æˆ·ç«¯ä¸Šåšä¸ª host æ˜ å°„ã€‚ä¾‹å¦‚ï¼š<code>go.findshank.com</code>ã€‚</p>
</li>
<li><p>HTTP ç«¯å£å·ï¼šå¯ä»¥ä½¿ç”¨ä»»æ„æœªå ç”¨çš„ç«¯å£å·ï¼Œä¹‹åé€šè¿‡ nginx æ˜ å°„åˆ° 80 ç«¯å£ã€‚</p>
</li>
<li><p>åº”ç”¨ URLï¼šå¿…é¡»å¯ç”¨ HTTPSï¼Œä¾‹å¦‚ï¼š<code>https://go.findshank.com</code> ã€‚ä¹‹ååå‘ä»£ç†é…ç½®å¥½ HTTPS å³å¯ã€‚</p>
</li>
<li><p>ç¦æ­¢ç”¨æˆ·æ³¨å†Œï¼šå»ºè®®å‹¾é€‰ï¼Œä¹‹åç»Ÿä¸€ç”±ç®¡ç†å‘˜åˆ†é…è´¦å·ã€‚</p>
</li>
</ul>
<h4 id="é…ç½®å®ˆæŠ¤è¿›ç¨‹"><a href="#é…ç½®å®ˆæŠ¤è¿›ç¨‹" class="headerlink" title="é…ç½®å®ˆæŠ¤è¿›ç¨‹"></a>é…ç½®å®ˆæŠ¤è¿›ç¨‹</h4><p>ä¿®æ”¹ <code>./scripts/systemd/gogs.service</code></p>
<figure class="highlight ini"><table><tr><td class="code"><pre><span class="line"><span class="section">[Unit]</span></span><br><span class="line"><span class="attr">Description</span>=Gogs</span><br><span class="line"><span class="attr">After</span>=syslog.target</span><br><span class="line"><span class="attr">After</span>=network.target</span><br><span class="line"><span class="attr">After</span>=mysqld.service</span><br><span class="line"></span><br><span class="line"><span class="section">[Service]</span></span><br><span class="line"><span class="attr">LimitMEMLOCK</span>=infinity</span><br><span class="line"><span class="attr">LimitNOFILE</span>=<span class="number">65535</span></span><br><span class="line"><span class="attr">Type</span>=simple</span><br><span class="line"><span class="attr">User</span>=root</span><br><span class="line"><span class="attr">Group</span>=root</span><br><span class="line"><span class="attr">WorkingDirectory</span>=/home/shank/gogs</span><br><span class="line"><span class="attr">ExecStart</span>=/home/shank/gogs/gogs web</span><br><span class="line"><span class="attr">Restart</span>=always</span><br><span class="line"><span class="attr">Environment</span>=USER=shank HOME=/home/shank</span><br><span class="line"></span><br><span class="line"><span class="attr">ProtectSystem</span>=full</span><br><span class="line"><span class="attr">PrivateDevices</span>=<span class="literal">yes</span></span><br><span class="line"><span class="attr">PrivateTmp</span>=<span class="literal">yes</span></span><br><span class="line"><span class="attr">NoNewPrivileges</span>=<span class="literal">true</span></span><br><span class="line"></span><br><span class="line"><span class="section">[Install]</span></span><br><span class="line"><span class="attr">WantedBy</span>=multi-user.target</span><br></pre></td></tr></table></figure>
<blockquote>
<p>æ³¨æ„ä¿®æ”¹ä¸ºå®é™…çš„ç”¨æˆ·ç›®å½•</p>
</blockquote>
<p>å¤åˆ¶åˆ°ç³»ç»Ÿç›®å½•</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">sudo cp ./scripts/systemd/gogs.service /usr/lib/systemd/system/</span><br></pre></td></tr></table></figure>
<h4 id="å¯ç”¨å®ˆæŠ¤è¿›ç¨‹"><a href="#å¯ç”¨å®ˆæŠ¤è¿›ç¨‹" class="headerlink" title="å¯ç”¨å®ˆæŠ¤è¿›ç¨‹"></a>å¯ç”¨å®ˆæŠ¤è¿›ç¨‹</h4><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">sudo systemctl <span class="built_in">enable</span> gogs</span><br><span class="line">sudo systemctl start gogs</span><br></pre></td></tr></table></figure>
<h2 id="æ¨¡å—ä»£ç†"><a href="#æ¨¡å—ä»£ç†" class="headerlink" title="æ¨¡å—ä»£ç†"></a>æ¨¡å—ä»£ç†</h2><h3 id="ç›®çš„-1"><a href="#ç›®çš„-1" class="headerlink" title="ç›®çš„"></a>ç›®çš„</h3><p>Go 1.11 ä¹‹åæ¨èä½¿ç”¨ <code>go mod</code> ä½œä¸ºä¾èµ–ç®¡ç†ï¼Œä½¿ç”¨ <code>go mod</code> å¯ä»¥é€šè¿‡é…ç½®æ¨¡å—ä»£ç†æœåŠ¡åŠ å¿«ä¾èµ–åŒ…çš„ä¸‹è½½ã€‚è¿™ç±»ä»£ç†æœåŠ¡é€šè¿‡ç¯å¢ƒå˜é‡ <code>GOPROXY</code> è¿›è¡ŒæŒ‡å®šï¼Œåªè¦å®ç°äº†æ¨¡å—ä»£ç†åè®®ï¼ˆModule proxy protocolï¼‰çš„æœåŠ¡éƒ½ç§°ä¸ºæ¨¡å—ä»£ç†æœåŠ¡ã€‚</p>
<p>å› ä¸ºå…¬æœ‰ç½‘ç»œçš„ä¸ç¡®å®šæ€§ï¼ˆæ¯”å¦‚å¼€æºä½œè€…åˆ é™¤äº†ä»£ç ä»“åº“æˆ–è€…ç½‘ç»œè¢«é˜²ç«å¢™åŠ«æŒï¼‰ï¼Œå¯ä»¥è€ƒè™‘è‡ªå·±ç»´æŠ¤ä¸€ä¸ªä»£ç†æœåŠ¡ï¼Œæ–¹ä¾¿ç§ç½‘å†…æ„å»ºæ—¶æ‹‰å–å¸¸ç”¨ç¬¬ä¸‰æ–¹ä»£ç ä¾èµ–ã€‚</p>
<h3 id="é€‰å‹-1"><a href="#é€‰å‹-1" class="headerlink" title="é€‰å‹"></a>é€‰å‹</h3><p>ç›®å‰æœ‰è®¸å¤šå¼€æºé¡¹ç›®å®ç°äº† goproxy æœåŠ¡ï¼Œæˆ‘ä»¬é€‰æ‹©äº†ç¤¾åŒºæ´»è·ƒä¸”ç‰ˆæœ¬ç¨³å®šçš„ <a href="https://github.com/goproxyio/goproxy" target="_blank" rel="noopener">goproxyio/goproxy</a>ã€‚</p>
<h3 id="æºç æ„å»ºåŠéƒ¨ç½²"><a href="#æºç æ„å»ºåŠéƒ¨ç½²" class="headerlink" title="æºç æ„å»ºåŠéƒ¨ç½²"></a>æºç æ„å»ºåŠéƒ¨ç½²</h3><blockquote>
<p>Go ç‰ˆæœ¬ä¸ä½äº 1.11</p>
</blockquote>
<details><br><summary>é…ç½® Go 1.13.3 ç¼–è¯‘ç¯å¢ƒ</summary><br><br><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">wget https://dl.google.com/go/go1.13.3.linux-amd64.tar.gz</span><br><span class="line">sudo tar -C /usr/<span class="built_in">local</span> -xzf go1.13.3.linux-amd64.tar.gz</span><br><span class="line"><span class="built_in">echo</span> <span class="string">'export PATH=$PATH:/usr/local/go/bin'</span> &gt;&gt; <span class="variable">$HOME</span>/.profile</span><br><span class="line"><span class="built_in">source</span> <span class="variable">$HOME</span>/.profile</span><br></pre></td></tr></table></figure><br><br></details>

<details><br><summary>å®‰è£… make</summary><br><br><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">sudo yum -y install make</span><br></pre></td></tr></table></figure><br><br></details>

<h4 id="ä¸‹è½½ä¸€ä»½ç¨³å®šç‰ˆç‰ˆæœ¬çš„æºç "><a href="#ä¸‹è½½ä¸€ä»½ç¨³å®šç‰ˆç‰ˆæœ¬çš„æºç " class="headerlink" title="ä¸‹è½½ä¸€ä»½ç¨³å®šç‰ˆç‰ˆæœ¬çš„æºç "></a>ä¸‹è½½ä¸€ä»½ç¨³å®šç‰ˆç‰ˆæœ¬çš„æºç </h4><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">wget https://github.com/goproxyio/goproxy/archive/v2.0.1.tar.gz</span><br></pre></td></tr></table></figure>
<blockquote>
<p>v2.0.0 ç‰ˆæœ¬æœ‰ BUG ã€‚<br>æˆ‘é‡åˆ°å¦‚ä¸‹é—®é¢˜ <code>go get golang.org/x/tools/cmd/present: no matching versions for query &quot;upgrade&quot;</code> ã€‚<br>æ•…æ­¤å¤„å·²æ›´æ–°ã€‚</p>
</blockquote>
<h4 id="è§£å‹-amp-ç¼–è¯‘"><a href="#è§£å‹-amp-ç¼–è¯‘" class="headerlink" title="è§£å‹ &amp; ç¼–è¯‘"></a>è§£å‹ &amp; ç¼–è¯‘</h4><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">tar xf v2.0.1.tar.gz</span><br><span class="line"><span class="built_in">cd</span> goproxy-2.0.1</span><br><span class="line">make</span><br></pre></td></tr></table></figure>
<blockquote>
<p>å¦‚æœä½ ä½¿ç”¨çš„æ˜¯ go 1.13 ä»¥ä¸‹ç‰ˆæœ¬ï¼Œ make å¯èƒ½å› ç½‘ç»œé—®é¢˜è€—æ—¶ä¸¥é‡ï¼Œä½ éœ€è¦è®¾ç½®ç¯å¢ƒå˜é‡ GOPROXY åŠ é€Ÿæ„å»ºï¼Œä¾‹å¦‚ï¼š <code>export GOPROXY=https://goproxy.io</code>ã€‚å› ä¸º go 1.13 æŒ‡å®šäº†é»˜è®¤çš„ GOPROXY å¯ä»¥ä¸éœ€è¦å¦å¤–é…ç½®ã€‚</p>
</blockquote>
<h4 id="æ·»åŠ äºŒè¿›åˆ¶æ–‡ä»¶åˆ°ç³»ç»Ÿç›®å½•"><a href="#æ·»åŠ äºŒè¿›åˆ¶æ–‡ä»¶åˆ°ç³»ç»Ÿç›®å½•" class="headerlink" title="æ·»åŠ äºŒè¿›åˆ¶æ–‡ä»¶åˆ°ç³»ç»Ÿç›®å½•"></a>æ·»åŠ äºŒè¿›åˆ¶æ–‡ä»¶åˆ°ç³»ç»Ÿç›®å½•</h4><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">sudo cp ./bin/goproxy /usr/<span class="built_in">local</span>/bin</span><br></pre></td></tr></table></figure>
<h4 id="é…ç½®å®ˆæŠ¤è¿›ç¨‹-1"><a href="#é…ç½®å®ˆæŠ¤è¿›ç¨‹-1" class="headerlink" title="é…ç½®å®ˆæŠ¤è¿›ç¨‹"></a>é…ç½®å®ˆæŠ¤è¿›ç¨‹</h4><p>ä¿®æ”¹ <code>./scripts/goproxy.service</code></p>
<figure class="highlight ini"><table><tr><td class="code"><pre><span class="line"><span class="section">[Unit]</span></span><br><span class="line"><span class="attr">Description</span>=goproxy service</span><br><span class="line"><span class="attr">Documentation</span>=https://goproxy.io</span><br><span class="line"><span class="attr">After</span>=network-<span class="literal">on</span>line.target</span><br><span class="line"></span><br><span class="line"><span class="section">[Service]</span></span><br><span class="line"><span class="attr">User</span>=root</span><br><span class="line"><span class="attr">Group</span>=root</span><br><span class="line"><span class="attr">LimitNOFILE</span>=<span class="number">65536</span></span><br><span class="line"><span class="attr">Environment</span>=PATH=/usr/bin:/usr/local/go/bin</span><br><span class="line"><span class="attr">Environmnet</span>=GO111MODULE=<span class="literal">on</span></span><br><span class="line"><span class="attr">ExecStart</span>=/usr/local/bin/goproxy -listen=<span class="number">0.0</span>.<span class="number">0.0</span>:<span class="number">8081</span> -proxy=https://goproxy.io -exclude=go.findshank.com</span><br><span class="line"><span class="attr">KillMode</span>=control-group</span><br><span class="line"><span class="attr">SuccessExitStatus</span>=<span class="number">2</span></span><br><span class="line"><span class="attr">Restart</span>=always</span><br><span class="line"></span><br><span class="line"><span class="section">[Install]</span></span><br><span class="line"><span class="attr">WantedBy</span>=multi-user.target</span><br><span class="line"><span class="attr">Alias</span>=goproxy.service</span><br></pre></td></tr></table></figure>
<p>å‚æ•°è¯´æ˜</p>
<ul>
<li><code>-listen</code>ï¼šæœåŠ¡ç›‘å¬åœ°å€ã€‚</li>
<li><code>-proxy</code>ï¼šä¸Šæ¸¸ä»£ç†æ¨¡å—ï¼Œä¸é…ç½®åˆ™ç›´æ¥è¯·æ±‚ç›®çš„åœ°å€ã€‚</li>
<li><code>-exclude</code>ï¼šä¸èµ°ä»£ç†çš„åŸŸåï¼Œç§ç½‘åŸŸåå…¬ç½‘æ— æ³•è®¿é—®åº”ç›´æ¥è¯·æ±‚ã€‚</li>
</ul>
<p>å¤åˆ¶åˆ°ç³»ç»Ÿç›®å½•</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">sudo cp ./scripts/goproxy.service /usr/lib/systemd/system/</span><br></pre></td></tr></table></figure>
<h4 id="å¯ç”¨å®ˆæŠ¤è¿›ç¨‹-1"><a href="#å¯ç”¨å®ˆæŠ¤è¿›ç¨‹-1" class="headerlink" title="å¯ç”¨å®ˆæŠ¤è¿›ç¨‹"></a>å¯ç”¨å®ˆæŠ¤è¿›ç¨‹</h4><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">sudo systemctl <span class="built_in">enable</span> goproxy</span><br><span class="line">sudo systemctl start goproxy</span><br></pre></td></tr></table></figure>
<h2 id="æŒç»­é›†æˆï¼ˆå¯é€‰ï¼‰"><a href="#æŒç»­é›†æˆï¼ˆå¯é€‰ï¼‰" class="headerlink" title="æŒç»­é›†æˆï¼ˆå¯é€‰ï¼‰"></a>æŒç»­é›†æˆï¼ˆå¯é€‰ï¼‰</h2><h3 id="ç›®çš„-2"><a href="#ç›®çš„-2" class="headerlink" title="ç›®çš„"></a>ç›®çš„</h3><p>å¼€å‘è€…å°†ä»£ç æäº¤åˆ°ç‰ˆæœ¬ç®¡ç†ç³»ç»Ÿï¼Œä¹‹åçš„ç¼–è¯‘æ„å»ºï¼Œè‡ªåŠ¨åŒ–æµ‹è¯•ï¼Œæ‰“åŒ…ï¼Œå‘å¸ƒï¼Œéƒ¨ç½²ç­‰éƒ½æ˜¯å›ºå®šæµç¨‹ï¼Œåº”è¯¥ç”±æŒç»­é›†æˆç³»ç»Ÿå»å®Œæˆã€‚</p>
<p>ä½¿ç”¨æŒç»­é›†æˆï¼Œå¯ä»¥é™ä½é‡å¤ç¹çæ“ä½œçš„å‡ºé”™ç‡ã€‚</p>
<h3 id="é€‰å‹-2"><a href="#é€‰å‹-2" class="headerlink" title="é€‰å‹"></a>é€‰å‹</h3><p>æœ‰è®¸å¤šåœ¨çº¿çš„æŒç»­é›†æˆæœåŠ¡ï¼Œç”±äºæˆ‘ä»¬æ˜¯ç§ç½‘éƒ¨ç½²ï¼Œæˆ‘ä»¬é€‰æ‹©äº† <a href="https://jenkins.io" target="_blank" rel="noopener">Jenkins</a> ,å®ƒæ˜¯ç”± Java è¯­è¨€ç¼–å†™çš„å¼€æº CI&amp;CD æœåŠ¡ï¼Œæ­å»ºååˆ†ä¾¿æ· ã€‚</p>
<h3 id="éƒ¨ç½²-1"><a href="#éƒ¨ç½²-1" class="headerlink" title="éƒ¨ç½²"></a>éƒ¨ç½²</h3><p>è¯¦è§ <a href="https://jenkins.io/zh/doc/book/installing/" target="_blank" rel="noopener">å®˜æ–¹æ­å»ºæŒ‡å—</a> ï¼Œä»¥ä¸‹ä»…ä½œè®°å½•ã€‚</p>
<h4 id="å®‰è£…-Java-1-8-è¿è¡Œç¯å¢ƒ"><a href="#å®‰è£…-Java-1-8-è¿è¡Œç¯å¢ƒ" class="headerlink" title="å®‰è£… Java 1.8 è¿è¡Œç¯å¢ƒ"></a>å®‰è£… Java 1.8 è¿è¡Œç¯å¢ƒ</h4><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">sudo yum -y install java-1.8.0-openjdk-devel</span><br></pre></td></tr></table></figure>
<h4 id="å¯ç”¨-Jenkins-å­˜å‚¨åº“"><a href="#å¯ç”¨-Jenkins-å­˜å‚¨åº“" class="headerlink" title="å¯ç”¨ Jenkins å­˜å‚¨åº“"></a>å¯ç”¨ Jenkins å­˜å‚¨åº“</h4><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">curl --silent --location http://pkg.jenkins-ci.org/redhat-stable/jenkins.repo | sudo tee /etc/yum.repos.d/jenkins.repo</span><br><span class="line">sudo rpm --import https://jenkins-ci.org/redhat/jenkins-ci.org.key</span><br></pre></td></tr></table></figure>
<h4 id="å®‰è£…-Jenkins"><a href="#å®‰è£…-Jenkins" class="headerlink" title="å®‰è£… Jenkins"></a>å®‰è£… Jenkins</h4><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">sudo yum -y install jenkins</span><br></pre></td></tr></table></figure>
<h4 id="å¯ç”¨å®ˆæŠ¤ç¨‹åº"><a href="#å¯ç”¨å®ˆæŠ¤ç¨‹åº" class="headerlink" title="å¯ç”¨å®ˆæŠ¤ç¨‹åº"></a>å¯ç”¨å®ˆæŠ¤ç¨‹åº</h4><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">sudo systemctl start jenkins</span><br><span class="line">sudo systemctl <span class="built_in">enable</span> jenkins</span><br></pre></td></tr></table></figure>
<h4 id="æŒ‰ç…§æç¤ºè¿›è¡Œé…ç½®-1"><a href="#æŒ‰ç…§æç¤ºè¿›è¡Œé…ç½®-1" class="headerlink" title="æŒ‰ç…§æç¤ºè¿›è¡Œé…ç½®"></a>æŒ‰ç…§æç¤ºè¿›è¡Œé…ç½®</h4><p>æµè§ˆå™¨è®¿é—®å½“å‰ä¸»æœºçš„ 8080 ç«¯å£ï¼Œå¼€å§‹é…ç½®ã€‚</p>
<p>å®‰è£…å»ºè®®çš„æ’ä»¶ï¼ŒæŒ‰éœ€æ±‚ä»¥åæ·»åŠ æ’ä»¶ã€‚</p>
<h2 id="åå‘ä»£ç†"><a href="#åå‘ä»£ç†" class="headerlink" title="åå‘ä»£ç†"></a>åå‘ä»£ç†</h2><p>è¿™é‡Œæˆ‘ä»¬é€‰ç”¨ä½¿ç”¨æœ€å¹¿æ³›çš„ NGINX ä½œä¸ºåå‘ä»£ç†æœåŠ¡ã€‚</p>
<blockquote>
<p>é‰´äºç¯‡å¹…ï¼Œä»…ä»‹ç»å¯¹äº Gogs çš„åå‘ä»£ç†ã€‚</p>
</blockquote>
<h3 id="å®‰è£…-NGINX"><a href="#å®‰è£…-NGINX" class="headerlink" title="å®‰è£… NGINX"></a>å®‰è£… NGINX</h3><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">sudo yum install -y nginx</span><br></pre></td></tr></table></figure>
<h3 id="HTTPS-è¯ä¹¦"><a href="#HTTPS-è¯ä¹¦" class="headerlink" title="HTTPS è¯ä¹¦"></a>HTTPS è¯ä¹¦</h3><p>è·å–è¯ä¹¦çš„é€”å¾„æœ‰å¾ˆå¤šï¼Œå¯ä»¥è´­ä¹°å•†ä¸šè¯ä¹¦ï¼Œæˆ–è€…ç”³è¯·å…è´¹è¯ä¹¦ï¼Œç§ç½‘ç¯å¢ƒä¸ºäº†ç®€å•ï¼Œæˆ‘å°±é€‰æ‹©è‡ªç­¾è¯ä¹¦ã€‚</p>
<p>ä½¿ç”¨ openssl è‡ªç­¾è¯ä¹¦å¯ä»¥ <a href="/2019/06/26/enable-https-for-private-network/">å‚è€ƒè¿™ç¯‡</a></p>
<p>ä¹Ÿå¯ä»¥ç”¨ Gogs å¯æ‰§è¡Œç¨‹åºæä¾›çš„å­å‘½ä»¤ï¼š</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">./gogs cert -ca=<span class="literal">true</span> -duration=8760h0m0s -host=go.findshank.com</span><br></pre></td></tr></table></figure>
<p>ä¼šåœ¨æ‰§è¡Œç›®å½•ä¸‹å¾—åˆ°ä¸¤ä¸ªæ–‡ä»¶ï¼š <code>cert.pem</code> å’Œ <code>key.pem</code> ã€‚</p>
<h3 id="Gogs-é…ç½®"><a href="#Gogs-é…ç½®" class="headerlink" title="Gogs é…ç½®"></a>Gogs é…ç½®</h3><p>æ‰¾åˆ° Gogs çš„é…ç½®æ–‡ä»¶ <code>gogs/custom/conf/app.ini</code> ï¼Œç¡®ä¿ <code>ROOT_URL</code> ä¸º https åè®®ï¼Œæ¯”å¦‚ï¼š <code>https://go.findshank.com</code> ã€‚å…¶ä»–çš„é…ç½®éƒ½ä¸ç”¨æ”¹ã€‚</p>
<h3 id="NGINX-é…ç½®"><a href="#NGINX-é…ç½®" class="headerlink" title="NGINX é…ç½®"></a>NGINX é…ç½®</h3><p>å…ˆæŠŠ <code>/etc/nginx/nginx.conf</code> ä¸­çš„é»˜è®¤ <code>server</code> é…ç½®åˆ é™¤ï¼Œä½ ä¹Ÿå¯ä»¥æŠŠå®ƒæ³¨é‡Šæ‰ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">#server &#123;</span><br><span class="line">#    listen       80 default_server;</span><br><span class="line">#    listen       [::]:80 default_server;</span><br><span class="line">#    server_name  _;</span><br><span class="line">#    root         /usr/share/nginx/html;</span><br><span class="line"></span><br><span class="line">#    # Load configuration files for the default server block.</span><br><span class="line">#    include /etc/nginx/default.d/*.conf;</span><br><span class="line"></span><br><span class="line">#    location / &#123;</span><br><span class="line">#    &#125;</span><br><span class="line"></span><br><span class="line">#    error_page 404 /404.html;</span><br><span class="line">#        location = /40x.html &#123;</span><br><span class="line">#    &#125;</span><br><span class="line"></span><br><span class="line">#    error_page 500 502 503 504 /50x.html;</span><br><span class="line">#        location = /50x.html &#123;</span><br><span class="line">#    &#125;</span><br><span class="line">#&#125;</span><br></pre></td></tr></table></figure>
<p>æ–°å»ºé…ç½®æ–‡ä»¶ <code>/etc/nginx/conf.d/default.conf</code>ï¼Œå¡«å…¥å¦‚ä¸‹å†…å®¹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">server &#123;</span><br><span class="line">        listen 443 ssl;</span><br><span class="line">        listen [::]:443 ssl;</span><br><span class="line">        server_name go.findshank.com;</span><br><span class="line">        ssl_certificate &quot;/home/shank/gogs/keys/cert.pem&quot;;</span><br><span class="line">        ssl_certificate_key &quot;/home/shank/gogs/keys/key.pem&quot;;        </span><br><span class="line"></span><br><span class="line">        location / &#123;</span><br><span class="line">                proxy_set_header X-Real-IP $remote_addr;      </span><br><span class="line">                proxy_pass http://127.0.0.1:3000$request_uri; </span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">server &#123;</span><br><span class="line">        listen 80 default_server;</span><br><span class="line">        listen [::]:80 default_server;</span><br><span class="line">        server_name go.findshank.com;</span><br><span class="line">        return 301 https://$host$request_uri;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>éªŒè¯é…ç½®</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">nginx -t</span><br></pre></td></tr></table></figure>
<h3 id="å¯ç”¨å®ˆæŠ¤ç¨‹åº-1"><a href="#å¯ç”¨å®ˆæŠ¤ç¨‹åº-1" class="headerlink" title="å¯ç”¨å®ˆæŠ¤ç¨‹åº"></a>å¯ç”¨å®ˆæŠ¤ç¨‹åº</h3><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">sudo systemctl start nginx</span><br><span class="line">sudo systemctl <span class="built_in">enable</span> nginx</span><br></pre></td></tr></table></figure>
<h2 id="å¯èƒ½é‡åˆ°çš„é—®é¢˜"><a href="#å¯èƒ½é‡åˆ°çš„é—®é¢˜" class="headerlink" title="å¯èƒ½é‡åˆ°çš„é—®é¢˜"></a>å¯èƒ½é‡åˆ°çš„é—®é¢˜</h2><ul>
<li>æ— æ³•å¤–éƒ¨è®¿é—®æœåŠ¡ï¼šæ£€æŸ¥ CentOS çš„é˜²ç«å¢™ç­–ç•¥ï¼Œæ”¾è¡Œç‰¹å®šç«¯å£ã€‚å®‰å…¨æ€§è¦æ±‚ä¸é«˜ç”šè‡³å¯ä»¥å…³é—­é˜²ç«å¢™ã€‚</li>
<li>ç§ç½‘ä»“åº“é€šè¿‡æ¨¡å—ä»£ç† go get å¤±è´¥ï¼š<ul>
<li><code>...exec: &quot;git&quot;: executable file not found in $PATH...</code>ï¼š ç¡®ä¿ <code>git</code> å·²å®‰è£…ã€‚</li>
<li><code>... reading https://sum.golang.org/lookup/... 410 Gone</code>ï¼š æœ¬åœ°æ·»åŠ ç¯å¢ƒå˜é‡ <code>GOSUMDB=off</code></li>
</ul>
</li>
<li>NGINX å¯åŠ¨å¤±è´¥ï¼š<ul>
<li><code>...SSL: error:0200100D:system library:fopen:Permission denied...</code>ï¼š å¯¹è¯ä¹¦æ–‡ä»¶æ— è®¿é—®æƒé™ï¼Œè¿™æ˜¯ SELinux çš„å¼ºåˆ¶æ¨¡å¼å¯¼è‡´çš„ã€‚è§£å†³åŠæ³•å°±æ˜¯ <code>restorecon -v -R /path/to/keys</code>ã€‚</li>
<li><code>...[emerg] bind() to 0.0.0.0:XXXX failed...</code>ï¼š ä¹Ÿå¯èƒ½è¡¨ç°ä¸º NGINX åä»£çš„ç«¯å£è¿”å› 502 é”™è¯¯ï¼Œè¿™ä¹Ÿæ˜¯ SELinux çš„å‘ã€‚ä½¿ç”¨ semanage æ·»åŠ  HTTP ç«¯å£å³å¯ï¼Œè¯¦è§å‚è€ƒèµ„æ–™ã€‚</li>
</ul>
</li>
<li>å„ç§ ssl éªŒè¯å‡ºé”™çš„é—®é¢˜ï¼š ä½¿ç”¨è‡ªç­¾è¯ä¹¦ï¼Œè¦åœ¨æ‰€æœ‰å®¢æˆ·ç«¯çš„ç³»ç»Ÿä¸Šéƒ½ä¿¡ä»»è‡ªç­¾çš„è¯ä¹¦ã€‚</li>
</ul>
<h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><ul>
<li><a href="https://www.liquidweb.com/kb/how-to-stop-and-disable-firewalld-on-centos-7/" target="_blank" rel="noopener">How to Stop and Disable Firewalld on CentOS 7</a></li>
<li><a href="https://www.findshank.com/2019/06/26/setup-private-goproxy-server/">éƒ¨ç½² goproxy æœåŠ¡</a></li>
<li><a href="https://linuxize.com/post/how-to-install-jenkins-on-centos-7/" target="_blank" rel="noopener">How To Install Jenkins on CentOS 7</a></li>
<li><a href="https://github.com/Unknwon/wuwen.org/issues/12" target="_blank" rel="noopener">ä½¿ç”¨ HTTPS éƒ¨ç½² Gogs</a></li>
<li><a href="https://serverfault.com/questions/540537/nginx-permission-denied-to-certificate-files-for-ssl-configuration" target="_blank" rel="noopener">nginx permission denied to certificate files for ssl configuration
</a></li>
<li><a href="https://blog.csdn.net/RunSnail2018/article/details/81185653" target="_blank" rel="noopener">CentOS7 ä¸­ semanage å‘½ä»¤çš„å®‰è£…</a></li>
<li><a href="https://blog.csdn.net/RunSnail2018/article/details/81185138" target="_blank" rel="noopener">Nginx å¯åŠ¨æŠ¥ [emerg] bind() to 0.0.0.0:XXXX failed (13: Permission denied)é”™è¯¯å¤„ç†</a></li>
</ul>
]]></content>
      <tags>
        <tag>Go</tag>
        <tag>Gogs</tag>
        <tag>goproxy</tag>
        <tag>Jenkins</tag>
      </tags>
  </entry>
  <entry>
    <title>CentOS 7 å®‰è£… MySQL 8.0</title>
    <url>/2019/10/28/Install-MySQL-8-0-on-CentOS-7/</url>
    <content><![CDATA[<p>è®°å½•ä¸‹åœ¨ CentOS 7 ä¸Šå®‰è£… MySQL 8.0 ï¼Œå¹¶å¯ç”¨å…¼å®¹æ€§çš„å¯†ç éªŒè¯ã€‚</p>
<a id="more"></a>
<h2 id="å®‰è£…è®°å½•"><a href="#å®‰è£…è®°å½•" class="headerlink" title="å®‰è£…è®°å½•"></a>å®‰è£…è®°å½•</h2><p>æŸ¥çœ‹å½“å‰ linux ç‰ˆæœ¬ï¼Œæ‰§è¡Œ <code>uname -a</code>ï¼Œç»“æœå¦‚ä¸‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Linux localhost.localdomain 3.10.0-1062.el7.x86_64 #1 SMP Wed Aug 7 18:08:02 UTC 2019 x86_64 x86_64 x86_64 GNU/Linux</span><br></pre></td></tr></table></figure>
<p>è®¿é—®å®˜ç½‘è·å– linux 7 ç‰ˆæœ¬çš„ä»“åº“å®‰è£…åŒ…ã€‚</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">wget https://dev.mysql.com/get/mysql80-community-release-el7-3.noarch.rpm</span><br></pre></td></tr></table></figure>
<p>MD5 æ ¡éªŒ</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">md5sum mysql80-community-release-el7-3.noarch.rpm</span><br></pre></td></tr></table></figure>
<p>å¯¹ç…§è¾“å‡º</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">893b55d5d885df5c4d4cf7c4f2f6c153  mysql80-community-release-el7-3.noarch.rpm</span><br></pre></td></tr></table></figure>
<p>æ·»åŠ å®˜æ–¹ä»“åº“</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">sudo rpm -ivh mysql80-community-release-el7-3.noarch.rpm</span><br></pre></td></tr></table></figure>
<p>æ›¿æ¢é˜¿é‡Œäº‘é•œåƒåŠ é€Ÿä¸‹è½½ï¼ˆå¯é€‰ï¼‰</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">sudo wget -O /etc/yum.repos.d/CentOS-Base.repo http://mirrors.aliyun.com/repo/Centos-7.repo</span><br></pre></td></tr></table></figure>
<p>å®‰è£… MySQL </p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">sudo yum -y install mysql-server</span><br></pre></td></tr></table></figure>
<p>æ·»åŠ å¹¶å¯åŠ¨å®ˆæŠ¤è¿›ç¨‹</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">sudo systemctl <span class="built_in">enable</span> mysqld</span><br><span class="line">sudo systemctl start mysqld</span><br></pre></td></tr></table></figure>
<p>æ£€æŸ¥è¿è¡ŒçŠ¶æ€</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">systemctl status mysqld</span><br></pre></td></tr></table></figure>
<p>æŸ¥æ‰¾ä¸´æ—¶ root å¯†ç </p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">sudo grep <span class="string">'temporary password'</span> /var/<span class="built_in">log</span>/mysqld.log</span><br></pre></td></tr></table></figure>
<p>å¯†ç åœ¨è¡Œæœ«</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">2019-10-29T06:28:08.128300Z 5 [Note] [MY-010454] [Server] A temporary password is generated for root@localhost: Z-_%r1L3PRuJ</span><br></pre></td></tr></table></figure>
<p>é…ç½® MySQL</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">sudo mysql_secure_installation</span><br></pre></td></tr></table></figure>
<p>æŒ‰æç¤ºï¼Œè¾“å…¥åˆšæ‰æ‰¾åˆ°çš„å¯†ç ï¼Œç„¶åå˜æ›´ä¸ºæ–°å¯†ç ï¼ˆè¦æ±‚è¶³å¤Ÿå¤æ‚ï¼ŒåŒ…å«å¤§å°å†™å­—æ¯æ•°å­—åŠç‰¹æ®Šå­—ç¬¦ï¼‰ã€‚</p>
<p>ç™»å½•æ•°æ®åº“</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">mysql -u root -p</span><br></pre></td></tr></table></figure>
<p>æ–°å»ºç”¨æˆ·</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">use mysql;</span><br><span class="line">CREATE USER <span class="string">'appuser'</span>@<span class="string">'%'</span> IDENTIFIED BY <span class="string">'P@ssw0rd'</span>;</span><br><span class="line">FLUSH PRIVILEGES; </span><br><span class="line">ALTER USER <span class="string">'appuser'</span>@<span class="string">'%'</span> IDENTIFIED WITH mysql_native_password BY <span class="string">'P@ssw0rd'</span>;</span><br></pre></td></tr></table></figure>
<p>å¯ç”¨å¯†ç éªŒè¯æ’ä»¶ä¸æ—§ç‰ˆå…¼å®¹</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">sudo vim /etc/my.cnf</span><br><span class="line"></span><br><span class="line"><span class="comment"># æœ«å°¾æ·»åŠ ä¸€è¡Œ</span></span><br><span class="line">default-authentication-plugin=mysql_native_password</span><br></pre></td></tr></table></figure>
<p>é‡å¯ MySQL</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">sudo systemctl restart mysqld</span><br></pre></td></tr></table></figure>
<p>é˜²ç«å¢™è®¾ç½®ï¼ˆå¯é€‰ï¼‰</p>
<p>CentOS é»˜è®¤å¯ç”¨é˜²ç«å¢™è¿›ç¨‹ï¼ˆfirewalldï¼‰</p>
<p>ä¸º MySQL å¼€æ”¾å…¨ IP ç«¯å£</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">sudo firewall-cmd --zone=public --add-service=mysql --permanent</span><br><span class="line">sudo firewall-cmd --reload</span><br></pre></td></tr></table></figure>
<h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><ul>
<li><a href="https://www.digitalocean.com/community/tutorials/how-to-install-mysql-on-centos-7" target="_blank" rel="noopener">How To Install MySQL on CentOS 7</a></li>
<li><a href="https://wiki.mikejung.biz/Firewalld" target="_blank" rel="noopener">How to Allow MySQL Traffic using firewalld on CentOS 7</a></li>
</ul>
]]></content>
      <tags>
        <tag>CentOS</tag>
        <tag>MySQL</tag>
      </tags>
  </entry>
  <entry>
    <title>ç§ç½‘ git ä»“åº“ go mod å®è·µ</title>
    <url>/2019/08/07/%E7%A7%81%E7%BD%91-git-%E4%BB%93%E5%BA%93-go-mod-%E5%AE%9E%E8%B7%B5/</url>
    <content><![CDATA[<p>ä½¿ç”¨ gogs æ­å»ºç§ç½‘ git æœåŠ¡å™¨ï¼Œæ­å»ºååˆ†ä¾¿æ·ï¼Œå‚è€ƒ<a href="https://gogs.io/docs/installation" target="_blank" rel="noopener">å®˜æ–¹æ–‡æ¡£</a></p>
<p>æœ¬æ–‡æ—¨åœ¨æ¢ç©¶ç§ç½‘ git æœåŠ¡å¯¹ <code>go get</code> æ”¯æŒçš„é—®é¢˜ã€‚</p>
<a id="more"></a>
<h2 id="å†™åœ¨å‰é¢"><a href="#å†™åœ¨å‰é¢" class="headerlink" title="å†™åœ¨å‰é¢"></a>å†™åœ¨å‰é¢</h2><p>ä½¿ç”¨ go mod è·å–ä¾èµ–ï¼Œå®é™…ä¹Ÿæ˜¯è°ƒç”¨ go getï¼Œä½†æ˜¯ go mod ä¸­è·å–ä¾èµ–å¿…é¡»è¦ vcs æœåŠ¡å¼€å¯ httpsï¼Œå¦‚ä½•å¯ç”¨ https è§<a href="https://www.findshank.com/2019/06/26/enable-https-for-private-network/">ä¹‹å‰çš„æ–‡ç« </a>ï¼Œæœ¬æ–‡ç®€å•èµ·è§ä½¿ç”¨ go get çš„æ–¹å¼è·å–ä¾èµ–ã€‚</p>
<p>ç»“è®ºï¼š</p>
<p>gogs ä¸­è¦é…ç½®å¥½ <code>DOMAIN</code> åŠ <code>ROOT_URL</code> ã€‚</p>
<h2 id="åˆæ¬¡å°è¯•"><a href="#åˆæ¬¡å°è¯•" class="headerlink" title="åˆæ¬¡å°è¯•"></a><del>åˆæ¬¡å°è¯•</del></h2><details><br><br><summary>å±•å¼€</summary><br><br>### å‡†å¤‡å®éªŒç¯å¢ƒ<br><br>æœ¬åœ°æœºå™¨ host é‡Œæ·»åŠ ä¸€æ¡è®°å½•ã€‚<br><br>&gt; git æœåŠ¡çš„å®é™…å±€åŸŸç½‘ IP ä¸º <code>192.168.20.44</code>ã€‚<br><br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">192.168.20.44 vcs.private.org</span><br></pre></td></tr></table></figure><br><br>é…ç½® git æœåŠ¡çš„åŸŸåï¼Œåœ¨ gogs é…ç½®æ–‡ä»¶ä¸­ä¿®æ”¹å¦‚ä¸‹è¡Œï¼š<br><br><figure class="highlight ini"><table><tr><td class="code"><pre><span class="line"><span class="attr">DOMAIN</span> = vcs.private.org</span><br></pre></td></tr></table></figure><br><br>é‡å¯ gogs æœåŠ¡ã€‚<br><br>ä½¿ç”¨ <code>sko00o</code> ç”¨æˆ·æ–°å»ºä¸€ä¸ªä»“åº“ï¼Œåå« <code>demo</code> ã€‚<br><br>ä¸Šä¼ ä¸€ä¸ªç”± go mod ç®¡ç†çš„é¡¹ç›®ã€‚<br><br><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">mkdir demo &amp;&amp; <span class="built_in">cd</span> demo</span><br><span class="line">go mod init vcs.private.org/sko00o/demo</span><br><span class="line">touch main.go</span><br><span class="line"><span class="built_in">echo</span> package main &gt; main.go</span><br><span class="line">git init</span><br><span class="line">git add .</span><br><span class="line">git commit -m <span class="string">"initial commit"</span></span><br><span class="line">git remote add origin gogs@vcs.private.org:sko00o/demo.git</span><br><span class="line">git push -u origin master</span><br></pre></td></tr></table></figure><br><br>### clone æµ‹è¯•<br><br>ç›´æ¥ä½¿ç”¨ git clone vcs.private.org/sko00o/demo ä»“åº“æ‹‰å–æˆåŠŸã€‚<br><br>### go get æµ‹è¯•<br><br>å°è¯• go get æ‹‰å– sko00o/demo ä»“åº“ã€‚<br><br>&gt; æœåŠ¡æœªé…ç½® https ï¼Œæ•…æ·»ä¸Š <code>-insecure</code> å‚æ•°ã€‚<br><br><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">go get -v -insecure vcs.private.org/sko00o/demo</span><br></pre></td></tr></table></figure><br><br>æ‹‰å–å¤±è´¥ï¼Œé”™è¯¯æç¤ºï¼š<br><br><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">Parsing meta tags from https://vcs.private.org?go-get=1 (status code 502)</span><br><span class="line">go get vcs.private.org/sko00o/demo: unrecognized import path <span class="string">"vcs.private.org/sko00o/demo"</span> (parse https://vcs.private.org/sko00o/demo?go-get=1: no go-import meta tags</span><br></pre></td></tr></table></figure><br><br>å†æ¬¡å°è¯•ï¼š<br><br><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">go get -v -insecure vcs.private.org/sko00o/demo.git</span><br></pre></td></tr></table></figure><br><br>æ‹‰å–å¤±è´¥ï¼Œé”™è¯¯æç¤ºï¼š<br><br><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">go: vcs.private.org/sko00o/demo.git@v0.0.0-20190624043337-f2473e290d4d: parsing go.mod: unexpected module path <span class="string">"vcs.private.org/sko00o/demo"</span></span><br></pre></td></tr></table></figure><br><br>å°† demo ä»“åº“ä¸­çš„ go.mod æ”¹ä¸º <code>module vcs.private.org/sko00o/demo.git</code><br><br>å†æ¬¡å°è¯•ï¼š<br><br><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">go get -v -insecure vcs.private.org/sko00o/demo.git</span><br></pre></td></tr></table></figure><br><br>æˆåŠŸã€‚<br><br></details>

<h2 id="æ›´åˆç†çš„åŠæ³•"><a href="#æ›´åˆç†çš„åŠæ³•" class="headerlink" title="æ›´åˆç†çš„åŠæ³•"></a>æ›´åˆç†çš„åŠæ³•</h2><p>å› ä¸ºè¦ä¿®æ”¹ module åå­—ï¼Œä»¥ä¸Šå¤„ç†æ–¹å¼æ˜¾ç„¶ä¸åˆç†ã€‚</p>
<p>å‚è€ƒå®˜æ–¹æ–‡æ¡£åï¼Œ å¾—çŸ¥ go è¦æ±‚ç‰ˆæœ¬ç®¡ç†ç³»ç»Ÿçš„æœåŠ¡ç«¯å®ç° go-get=1 çš„è¯·æ±‚ï¼Œæ°å¥½ gogs æ˜¯æ”¯æŒè¿™ä¸ªè¯·æ±‚çš„ã€‚</p>
<p>å°è¯•ç›´æ¥è®¿é—®è¿™ä¸ª APIã€‚</p>
<p><code>curl &quot;http://vcs.private.org/sko00o/demo?go-get=1&quot;</code></p>
<p>è¿”å›å†…å®¹å¦‚ä¸‹</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!doctype <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"go-import"</span> <span class="attr">content</span>=<span class="string">"192.168.20.44/sko00o/demo git http://192.168.20.44/sko00o/demo.git"</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"go-source"</span> <span class="attr">content</span>=<span class="string">"192.168.20.44/sko00o/demo _ http://192.168.20.44/sko00o/demo/src/master&#123;/dir&#125; http://192.168.20.44/sko00o/demo/src/master&#123;/dir&#125;/&#123;file&#125;#L&#123;line&#125;"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">                go get --insecure 192.168.20.44/sko00o/demo</span><br><span class="line">        <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>é—®é¢˜åº”è¯¥å‡ºåœ¨è¿™é‡Œï¼Œè¯´æ˜ gogs æœåŠ¡ç«¯çš„é…ç½®è¿˜å­˜åœ¨é—®é¢˜ï¼Œæ¥ç€ä¿®æ”¹ï¼š</p>
<figure class="highlight ini"><table><tr><td class="code"><pre><span class="line"><span class="attr">ROOT_URL</span> = http://vcs.private.org</span><br></pre></td></tr></table></figure>
<p>é‡å¯ gogs ã€‚ <code>service gogos restart</code></p>
<p>å†æ¬¡è¯·æ±‚ï¼Œè¿”å›å†…å®¹ç¬¦åˆè¦æ±‚</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!doctype <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"go-import"</span> <span class="attr">content</span>=<span class="string">"vcs.private.org/sko00o/demo git http://vcs.private.org/sko00o/demo.git"</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"go-source"</span> <span class="attr">content</span>=<span class="string">"vcs.private.org/sko00o/demo _ http://vcs.private.org/sko00o/demo/src/master&#123;/dir&#125; http://vcs.private.org/sko00o/demo/src/master&#123;/dir&#125;/&#123;file&#125;#L&#123;line&#125;"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">                go get --insecure vcs.private.org/sko00o/demo</span><br><span class="line">        <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>ä»“åº“å›æ»šåˆ°æ²¡æœ‰ä¿®æ”¹ go.mod module çš„ç‰ˆæœ¬ï¼Œå¹¶å¼ºåˆ¶æäº¤ã€‚</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">git reset --hard &lt;SHA1&gt; <span class="comment"># must replace SHA1</span></span><br><span class="line">git push --force</span><br></pre></td></tr></table></figure>
<p>å†æ¬¡ <code>go get -v -insecure vcs.private.org/sko00o/demo</code></p>
<p>æˆåŠŸã€‚</p>
<h2 id="è¿˜å¯èƒ½é‡åˆ°çš„é—®é¢˜"><a href="#è¿˜å¯èƒ½é‡åˆ°çš„é—®é¢˜" class="headerlink" title="è¿˜å¯èƒ½é‡åˆ°çš„é—®é¢˜"></a>è¿˜å¯èƒ½é‡åˆ°çš„é—®é¢˜</h2><p>å¦‚æœä½ è®¾ç½®äº†ç¯å¢ƒå˜é‡ <code>http_proxy</code>ï¼Œ ä½ å¯èƒ½é‡åˆ°ä¸‹é¢çš„é—®é¢˜ã€‚</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">Fetching https://vcs.private.org/sko00o/demo?go-get=1</span><br><span class="line">https fetch failed: Get https://vcs.private.org/sko00o/demo?go-get=1: EOF</span><br><span class="line">Fetching http://vcs.private.org/sko00o/demo?go-get=1</span><br><span class="line">Parsing meta tags from http://vcs.private.org/sko00o/demo?go-get=1 (status code 500)</span><br><span class="line">Fetching https://vcs.private.org/lowan?go-get=1</span><br><span class="line">https fetch failed: Get https://vcs.private.org/lowan?go-get=1: EOF</span><br><span class="line">Fetching http://vcs.private.org/lowan?go-get=1</span><br><span class="line">Parsing meta tags from http://vcs.private.org/lowan?go-get=1 (status code 500)</span><br><span class="line">Fetching https://vcs.private.org?go-get=1</span><br><span class="line">https fetch failed: Get https://vcs.private.org?go-get=1: EOF</span><br><span class="line">Fetching http://vcs.private.org?go-get=1</span><br><span class="line">Parsing meta tags from http://vcs.private.org?go-get=1 (status code 500)</span><br><span class="line">go get vcs.private.org/sko00o/demo: unrecognized import path <span class="string">"vcs.private.org/sko00o/demo"</span> (parse http://vcs.private.org/sko00o/demo?go-get=1: no go-import meta tags ())</span><br></pre></td></tr></table></figure>
<p>è§£å†³åŠæ³•ï¼šå–æ¶ˆä»£ç†é…ç½® <code>export http_proxy=</code> ã€‚</p>
<p>å¦‚æœä½ è®¾ç½®äº† git ä»£ç†ï¼Œä½ å¯èƒ½é‡åˆ°ä¸‹é¢çš„é—®é¢˜ã€‚</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">Fetching https://vcs.private.org/sko00o/demo?go-get=1</span><br><span class="line">https fetch failed: Get https://vcs.private.org/sko00o/demo?go-get=1: EOF</span><br><span class="line">Fetching http://vcs.private.org/sko00o/demo?go-get=1</span><br><span class="line">Parsing meta tags from http://vcs.private.org/sko00o/demo?go-get=1 (status code 200)</span><br><span class="line">get <span class="string">"vcs.private.org/sko00o/demo"</span>: found meta tag get.metaImport&#123;Prefix:<span class="string">"vcs.private.org/sko00o/demo"</span>, VCS:<span class="string">"git"</span>, RepoRoot:<span class="string">"http://vcs.private.org/sko00o/demo.git"</span>&#125; at http://vcs.private.org/sko00o/demo?go-get=1</span><br><span class="line">Fetching https://vcs.private.org/lowan?go-get=1</span><br><span class="line">https fetch failed: Get https://vcs.private.org/lowan?go-get=1: EOF</span><br><span class="line">Fetching http://vcs.private.org/lowan?go-get=1</span><br><span class="line">Parsing meta tags from http://vcs.private.org/lowan?go-get=1 (status code 200)</span><br><span class="line">Fetching https://vcs.private.org?go-get=1</span><br><span class="line">https fetch failed: Get https://vcs.private.org?go-get=1: EOF</span><br><span class="line">Fetching http://vcs.private.org?go-get=1</span><br><span class="line">Parsing meta tags from http://vcs.private.org?go-get=1 (status code 404)</span><br><span class="line">go get vcs.private.org/sko00o/demo: git ls-remote -q http://vcs.private.org/sko00o/demo.git <span class="keyword">in</span> /mnt/d/GoDev/pkg/mod/cache/vcs/3172f8a70a0665ea75a1e7fb868f761ef269470c22b6a85cbe78b19c5608fbee: <span class="built_in">exit</span> status 128:</span><br><span class="line">        fatal: unable to access <span class="string">'http://vcs.private.org/sko00o/demo.git/'</span>: The requested URL returned error: 500</span><br></pre></td></tr></table></figure>
<p>è§£å†³åŠæ³•ï¼šå–æ¶ˆ git ä¸­çš„ http ä»£ç† <code>git config --global --unset http.proxy</code> ã€‚</p>
<h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><ul>
<li><p><a href="https://golang.org/cmd/go/#hdr-Download_and_install_packages_and_dependencies" target="_blank" rel="noopener">Download and install packages and dependencies</a></p>
</li>
<li><p><a href="https://golang.org/cmd/go/#hdr-Remote_import_paths" target="_blank" rel="noopener">Remote import paths</a></p>
</li>
</ul>
]]></content>
      <tags>
        <tag>git</tag>
        <tag>go</tag>
      </tags>
  </entry>
  <entry>
    <title>ä½¿ç”¨ git ç®¡ç† svn</title>
    <url>/2019/07/31/%E4%BD%BF%E7%94%A8-git-%E7%AE%A1%E7%90%86-svn/</url>
    <content><![CDATA[<p>ä¹ æƒ¯äºä½¿ç”¨ git çš„ä½ ï¼Œå¯èƒ½ä¼šå—ä¸äº† svn æ®‹ç¼ºçš„åŠŸèƒ½ã€‚</p>
<p>è¿˜å¥½ git æ‹¥æœ‰ä¸€ä¸ªååˆ†å¥½ç”¨çš„å‘½ä»¤ <code>git svn</code>ã€‚</p>
<p>æœ¬æ–‡ä»…è®°å½•æ™®é€šåœºæ™¯çš„ä½¿ç”¨ï¼Œè¯¦ç»†å†…å®¹è§<a href="https://git-scm.com/docs/git-svn" target="_blank" rel="noopener">å®˜æ–¹æ–‡æ¡£</a>ã€‚</p>
<a id="more"></a>
<h2 id="æ–°å»º-svn-ä»“åº“"><a href="#æ–°å»º-svn-ä»“åº“" class="headerlink" title="æ–°å»º svn ä»“åº“"></a>æ–°å»º svn ä»“åº“</h2><p>ä¸»å¹²ä»£ç æ”¾åœ¨ trunk ç›®å½•ä¸‹ï¼Œå³ git ä¸­çš„ master åˆ†æ”¯ã€‚</p>
<p>åˆ†æ”¯ä»£ç æŒ‰åˆ†æ”¯å‘½åçš„ç›®å½•æ”¾åœ¨ branches ç›®å½•ä¸‹ï¼Œå‡å¦‚æœ‰ä¸ªåˆ†æ”¯æ˜¯ bra1 é‚£ä¹ˆå®ƒå°†åœ¨ branches/bra1 ä¸‹ã€‚</p>
<p>æ ‡ç­¾ä»£ç åˆ†æ”¯ä»£ç ç›®å½•ç»“æ„ä¸€è‡´ï¼Œæ’å¸ƒåœ¨ tags ç›®å½•ä¸‹ï¼Œå­ç›®å½•ä¸ºæ ‡ç­¾åç§°ï¼Œä¸€èˆ¬ä¸ºç‰ˆæœ¬å·ï¼Œç±»ä¼¼äº tags/v1.0.0 ã€‚</p>
<p>æ‰€ä»¥ä¸€èˆ¬ svn ä»“åº“çš„æ ‡å‡†ç›®å½•ç»“æ„å¦‚ä¸‹ï¼š</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">project</span><br><span class="line">â”œâ”€â”€ branches</span><br><span class="line">â”‚   â”œâ”€â”€ bra1</span><br><span class="line">â”‚   â””â”€â”€ bra2</span><br><span class="line">â”œâ”€â”€ tags</span><br><span class="line">â”‚   â”œâ”€â”€ v1.0.0</span><br><span class="line">â”‚   â””â”€â”€ v1.1.0</span><br><span class="line">â””â”€â”€ trunk</span><br></pre></td></tr></table></figure>
<h2 id="æ‹‰å–-svn-ä»“åº“"><a href="#æ‹‰å–-svn-ä»“åº“" class="headerlink" title="æ‹‰å– svn ä»“åº“"></a>æ‹‰å– svn ä»“åº“</h2><p>ç¬¬ä¸€æ­¥ï¼Œä¹Ÿæ˜¯æœ€é‡è¦çš„ä¸€æ­¥ï¼Œæ‹‰å–ä»£ç ã€‚</p>
<p>å’±ä»¬ä½¿ç”¨ <code>git svn</code> å‘½ä»¤ç®¡ç† svn ä»“åº“å°±éœ€è¦åŒºåˆ†ä¸€ä¸‹ç›®å½•ç»“æ„åŠç›®å½•å±‚çº§ã€‚</p>
<h3 id="é¡¹ç›®åœ¨æ ¹ç›®å½•"><a href="#é¡¹ç›®åœ¨æ ¹ç›®å½•" class="headerlink" title="é¡¹ç›®åœ¨æ ¹ç›®å½•"></a>é¡¹ç›®åœ¨æ ¹ç›®å½•</h3><p>è¿™ç§æƒ…å†µï¼Œä½“éªŒç›¸å¯¹æœ€èˆ’é€‚ï¼Œä»¥ä¸‹å‘½ä»¤å³å¯å®Œæˆï¼š</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">git svn <span class="built_in">clone</span> -s svn://host/project</span><br></pre></td></tr></table></figure>
<p><code>-s</code> è®©å·¥å…·çŸ¥é“è¿™æ˜¯ä¸€ä¸ªæ ‡å‡†ç›®å½•ç»“æ„ã€‚</p>
<details><br><summary>å¯èƒ½é‡åˆ°çš„é—®é¢˜</summary><br><br><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">Can<span class="string">'t locate Term/ReadKey.pm in @INC (you may need to install the Term::ReadKey module)</span></span><br></pre></td></tr></table></figure><br><br>è¯¥é—®é¢˜æ˜¯ç¼ºå°‘ perl æ¨¡å—ï¼Œæ— æ³•è¯»å– svn å¯†ç <br><br>è§£å†³åŠæ³•ï¼š<br><br><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">sudo cpan Term::ReadKey</span><br></pre></td></tr></table></figure><br><br></details>

<details><br><summary>å¦‚æœä¸æ˜¯æ ‡å‡†ç›®å½•å‘½å</summary><br><br>å‡å¦‚ç›®å½•ç»“æ„æ˜¯è¿™æ ·çš„ï¼š<br><br><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">project</span><br><span class="line">â”œâ”€â”€ branches1</span><br><span class="line">â”œâ”€â”€ tags2</span><br><span class="line">â””â”€â”€ trunk0</span><br></pre></td></tr></table></figure><br><br>å°±è‡ªå·±æŒ‡å®šä¸‹å„ç±»ç›®å½•çš„å®é™…åç§°ï¼š<br><br><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">git svn <span class="built_in">clone</span> svn://host/project -T trunk0 -b branches1 -t tags2</span><br></pre></td></tr></table></figure><br><br>- <code>-T</code> ä¸»å¹²ç›®å½•<br>- <code>-b</code> åˆ†æ”¯ç›®å½•<br>- <code>-t</code> æ ‡ç­¾ç›®å½•<br><br></details>

<h3 id="é¡¹ç›®ä¸åœ¨æ ¹ç›®å½•"><a href="#é¡¹ç›®ä¸åœ¨æ ¹ç›®å½•" class="headerlink" title="é¡¹ç›®ä¸åœ¨æ ¹ç›®å½•"></a>é¡¹ç›®ä¸åœ¨æ ¹ç›®å½•</h3><blockquote>
<p>ä½†ç°å®å¯èƒ½æ²¡è¿™ä¹ˆç¾å¥½ã€‚</p>
</blockquote>
<p>æ­¤æ—¶æˆ‘ä»¬çš„å®é™…é¡¹ç›®å¯èƒ½åœ¨ï¼š <code>svn://host/s001/p002/project</code></p>
<p>å’±ä»¬ä¸èƒ½ç›´æ¥ <code>git svn clone</code>ï¼Œå› ä¸ºä¼šå‡ºé—®é¢˜ã€‚å’±ä»¬è¦æŠŠè¿™ä¸ªå‘½ä»¤æ‹†æˆå‡ æ­¥æ¥å®Œæˆã€‚</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">mkdir project &amp;&amp; <span class="built_in">cd</span> project</span><br><span class="line">git svn -s init svn://host/s001/p002/project</span><br></pre></td></tr></table></figure>
<p>æ¥ç€ä½ ä¼šçœ‹åˆ°ï¼š</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">Initialized empty Git repository <span class="keyword">in</span> ~/project/.git/</span><br><span class="line">Using higher level of URL: svn://host/s001/p002/project =&gt; svn://host/s001</span><br></pre></td></tr></table></figure>
<p>å®ƒé»˜è®¤å»ä½¿ç”¨äº†æ ¹ç›®å½•ï¼Œå¦‚æœæˆ‘ä»¬æœ‰æ ¹ç›®å½•çš„ä¿®æ”¹æƒé™ï¼Œè¿™æ ·ä¹Ÿèƒ½ç”¨ï¼Œä½†æ˜¯æˆ‘ä»¬ä¸€èˆ¬åªæœ‰ project é‚£å±‚çš„æƒé™ï¼Œæ‰€ä»¥å’±ä»¬è¦ä¿®æ”¹ä¸‹å½“å‰ç›®å½•çš„ git é…ç½®æ–‡ä»¶ã€‚</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">git config -e</span><br></pre></td></tr></table></figure>
<p>é…ç½®æ–‡ä»¶å¤§æ¦‚æ˜¯è¿™æ ·çš„ï¼š</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line"><span class="section">[core]</span></span><br><span class="line">    <span class="comment"># çœç•¥</span></span><br><span class="line"><span class="section">[svn-remote "svn"]</span></span><br><span class="line">    url = svn://host/s001</span><br><span class="line">    fetch = p002/project/trunk:refs/remotes/origin/trunk</span><br><span class="line">    branches = p002/project/branches/*:refs/remotes/origin/*</span><br><span class="line">    tags = p002/project/tags/*:refs/remotes/origin/tags/*</span><br></pre></td></tr></table></figure>
<p>ä¿®æ”¹å¦‚ä¸‹ï¼š</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line"><span class="section">[core]</span></span><br><span class="line">    <span class="comment"># çœç•¥</span></span><br><span class="line"><span class="section">[svn-remote "svn"]</span></span><br><span class="line">    url = svn://host/s001/p002/project</span><br><span class="line">    fetch = trunk:refs/remotes/origin/trunk</span><br><span class="line">    branches = branches/*:refs/remotes/origin/*</span><br><span class="line">    tags = tags/*:refs/remotes/origin/tags/*</span><br></pre></td></tr></table></figure>
<details><br><summary>å¦‚æœä¸æ˜¯æ ‡å‡†ç›®å½•å‘½å</summary><br><br><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">git svn init svn://host/s001/p002/project -T trunk0 -b branches1 -t tags2</span><br><span class="line">git config -e</span><br></pre></td></tr></table></figure><br><br><figure class="highlight"><table><tr><td class="code"><pre><span class="line"><span class="section">[svn-remote "svn"]</span></span><br><span class="line">    url = svn://host/s001/p002/project</span><br><span class="line">    fetch = trunk0:refs/remotes/origin/trunk</span><br><span class="line">    branches = branches1/*:refs/remotes/origin/*</span><br><span class="line">    tags = tags2/*:refs/remotes/origin/tags/*</span><br></pre></td></tr></table></figure><br><br></details>

<p>é…ç½®æ–‡ä»¶ä¿å­˜åï¼Œæ‹‰å–ä»£ç ï¼š</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">git svn fetch</span><br></pre></td></tr></table></figure>
<h2 id="é€’äº¤ç‰ˆæœ¬"><a href="#é€’äº¤ç‰ˆæœ¬" class="headerlink" title="é€’äº¤ç‰ˆæœ¬"></a>é€’äº¤ç‰ˆæœ¬</h2><p>ä¸€èˆ¬æµç¨‹å¦‚ä¸‹ï¼š</p>
<p><strong>æ­¥éª¤ä¸€:</strong></p>
<p>æ­£å¸¸çš„ git çš„æ–¹å¼æäº¤æœ¬åœ°è®°å½•</p>
<p>å½“éœ€è¦å°†æœ¬åœ°è®°å½•æ¨é€åˆ° svn æœåŠ¡çš„æ—¶å€™ï¼Œä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ï¼š</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">git svn dcommit</span><br></pre></td></tr></table></figure>
<blockquote>
<p>è¿™ä¸ªå‘½ä»¤å¼ºåˆ¶è¦æ±‚ï¼Œç‰ˆæœ¬ç®¡ç†ä¸­çš„æ–‡ä»¶çš„æ›´æ”¹éƒ½å·²æäº¤åˆ°æœ¬åœ°è®°å½•ã€‚</p>
</blockquote>
<p><strong>æ­¥éª¤äºŒ:</strong></p>
<p>å½“é‡åˆ°è¿œç¨‹ä»“åº“å·²ç»å­˜åœ¨åˆ«çš„æäº¤æ—¶ï¼Œä¼šæäº¤å¤±è´¥ï¼Œå’±ä»¬éœ€è¦å…ˆæ‹‰å–æœ€æ–°ç‰ˆæœ¬ï¼Œä½†ä¸æ˜¯ç”¨ <code>git pull</code>ï¼Œè€Œæ˜¯ç”¨ä»¥ä¸‹å‘½ä»¤ï¼š</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">git svn rebase</span><br></pre></td></tr></table></figure>
<p><strong>æ­¥éª¤ä¸‰:</strong></p>
<p>å¦‚æœæœ‰å†²çªï¼Œæ‰‹åŠ¨è§£å†³å†²çªï¼Œå†è¿›è¡Œ<code>æ­¥éª¤ä¸€</code>ã€‚</p>
<h2 id="æ–°å»ºåˆ†æ”¯"><a href="#æ–°å»ºåˆ†æ”¯" class="headerlink" title="æ–°å»ºåˆ†æ”¯"></a>æ–°å»ºåˆ†æ”¯</h2><p>å‡å¦‚è¦æ–°å»ºä¸€ä¸ªåˆ†æ”¯å« bra6</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">git svn branch -m <span class="string">"new branch bra6"</span> bra6</span><br></pre></td></tr></table></figure>
<p>æ£€æŸ¥æ‰€æœ‰åˆ†æ”¯</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">git branch -a</span><br></pre></td></tr></table></figure>
<p>ä½ èƒ½å‘ç°æœ‰ä¸ªæ–°çš„è¿œç¨‹åˆ†æ”¯å« <code>remotes/origin/bra6</code> ã€‚</p>
<blockquote>
<p>ä½†æ˜¯å½“å‰çš„æ´»åŠ¨åˆ†æ”¯è¿˜æ˜¯æŒ‡å‘ <code>remotes/origin/trunk</code> ã€‚</p>
</blockquote>
<h2 id="åˆ‡æ¢åˆ†æ”¯"><a href="#åˆ‡æ¢åˆ†æ”¯" class="headerlink" title="åˆ‡æ¢åˆ†æ”¯"></a>åˆ‡æ¢åˆ†æ”¯</h2><p>æ–°å»ºä¸€ä¸ªæœ¬åœ°åˆ†æ”¯æ˜ å°„è¿œç¨‹åˆ†æ”¯ï¼Œå†åˆ‡æ¢åˆ°æ–°çš„æœ¬åœ°åˆ†æ”¯ï¼š</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">git branch bra6 remotes/origin/bra6</span><br><span class="line">git checkout bra6</span><br></pre></td></tr></table></figure>
<p>æ¨¡æ‹Ÿæäº¤ä¸€æ¬¡ï¼Œç¡®è®¤å½“å‰æ´»åŠ¨åˆ†æ”¯æ¨é€åˆ°å¯¹åº”çš„ svn åˆ†æ”¯ç›®å½•ï¼š</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">git svn dcommit --dry-run</span><br><span class="line"><span class="comment"># Committing to svn://host/s001/p002/project/branches/bra6 ...</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>ä½ è¿˜å¯ä»¥é€šè¿‡ <code>git svn info</code> æŸ¥çœ‹è¯¦æƒ…</p>
</blockquote>
<h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><ul>
<li><a href="https://git-scm.com/docs/git-svn" target="_blank" rel="noopener">Reference/External Systems/svn</a></li>
<li><a href="https://git-scm.com/book/zh/v2/Git-%E4%B8%8E%E5%85%B6%E4%BB%96%E7%B3%BB%E7%BB%9F-%E4%BD%9C%E4%B8%BA%E5%AE%A2%E6%88%B7%E7%AB%AF%E7%9A%84-Git" target="_blank" rel="noopener">Git ä¸å…¶ä»–ç³»ç»Ÿ - ä½œä¸ºå®¢æˆ·ç«¯çš„ Git</a></li>
<li><a href="https://stackoverflow.com/questions/728931/how-to-switch-svn-branches-using-git-svn" target="_blank" rel="noopener">How to switch svn branches using git-svn?</a></li>
</ul>
]]></content>
      <categories>
        <category>Tools</category>
      </categories>
      <tags>
        <tag>git</tag>
        <tag>svn</tag>
      </tags>
  </entry>
  <entry>
    <title>LoRaWAN Backend Interfaces v1.0 å­¦ä¹  (p3)</title>
    <url>/2019/07/16/LoRaWAN-Backend-Interfaces-v1-0-%E5%AD%A6%E4%B9%A0-p3/</url>
    <content><![CDATA[<p>æ¥ä¸Šä¸€ç¯‡ã€‚</p>
<p><a href="https://lora-alliance.org/resource-hub/lorawantm-back-end-interfaces-v10" target="_blank" rel="noopener">åŸæ–‡æ¡£é“¾æ¥</a></p>
<p>æœ¬éƒ¨åˆ†ä¸»è¦ä»‹ç»æ¼«æ¸¸è¿‡ç¨‹ã€‚</p>
<a id="more"></a>
<h2 id="11-æ¼«æ¸¸è¿‡ç¨‹"><a href="#11-æ¼«æ¸¸è¿‡ç¨‹" class="headerlink" title="11. æ¼«æ¸¸è¿‡ç¨‹"></a>11. æ¼«æ¸¸è¿‡ç¨‹</h2><h3 id="11-1-æ¼«æ¸¸ç±»å‹"><a href="#11-1-æ¼«æ¸¸ç±»å‹" class="headerlink" title="11.1 æ¼«æ¸¸ç±»å‹"></a>11.1 æ¼«æ¸¸ç±»å‹</h3><p>æœ‰ä¸¤ç§ LoRa æ¼«æ¸¸ç±»å‹ï¼Œåä¸ºè¢«åŠ¨æ¼«æ¸¸ï¼ˆPassive Roamingï¼‰å’Œåˆ‡æ¢æ¼«æ¸¸ï¼ˆHandover Roamingï¼‰ã€‚è¢«åŠ¨æ¼«æ¸¸ä½¿ç»ˆç«¯è®¾å¤‡èƒ½å¤Ÿå—ç›Šäº NS çš„ LoRaWAN ç½‘ç»œæœåŠ¡ï¼Œå¤„äºä¸¤ä¸ªç½‘ç»œçš„ç»ˆç«¯è®¾å¤‡å³ä½¿åœ¨é‡å  RF åŠŸèƒ½å—é™ï¼ˆå³ä¿¡é“ï¼‰èŒƒå›´å†…åœ¨å¦ä¸€ä¸ª NS çš„æ§åˆ¶ä¸‹ä½¿ç”¨ç½‘å…³ï¼ˆGatewaysï¼‰æ—¶ä¹Ÿèƒ½å·¥ä½œã€‚LoRa ä¼šè¯å’Œç»ˆç«¯è®¾å¤‡çš„ MAC å±‚æ§åˆ¶ç”±å‰ NS ç»´æŠ¤ï¼Œç§°ä¸º sNS ï¼Œè€Œå¾€è¿”äºç©ºä¸­æ¥å£çš„å¸§ç”±å NS å¤„ç†ï¼Œåè€…ç§°ä¸º fNS ï¼ˆè½¬å‘ NS ï¼‰ã€‚å¯¹äºç»™å®šçš„ LoRa ä¼šè¯ï¼Œåªèƒ½æœ‰ä¸€ä¸ª sNSï¼Œè€ŒåŒä¸€ä¸ªä¼šè¯å¯èƒ½æ¶‰åŠé›¶ä¸ªæˆ–å¤šä¸ª fNS ã€‚</p>
<p>æœ‰ä¸¤ç§ç±»å‹çš„ fNS ï¼šæœ‰çŠ¶æ€å’Œæ— çŠ¶æ€ã€‚æœ‰çŠ¶æ€ fNS åœ¨ç»ˆç«¯è®¾å¤‡çš„è¢«åŠ¨æ¼«æ¸¸å¼€å§‹æ—¶åˆ›å»ºä¸Šä¸‹æ–‡ï¼ˆcontextï¼‰ï¼Œå¹¶åˆ©ç”¨è¯¥ä¸Šä¸‹æ–‡æ¥å¤„ç†ç›¸åŒç»ˆç«¯è®¾å¤‡çš„ä»»ä½•åç»­ä¸Šè¡Œé“¾è·¯/ä¸‹è¡Œé“¾è·¯åˆ†ç»„ï¼ˆsubsequentï¼‰ã€‚æ— çŠ¶æ€ fNS ä¸ä¼šåˆ›å»ºä»»ä½•ä¸Šä¸‹æ–‡ï¼Œå› æ­¤æœ€ç»ˆå¿…é¡»å½¼æ­¤ç‹¬ç«‹åœ°å¤„ç†ä»»ä½•ä¸Šè¡Œé“¾è·¯/ä¸‹è¡Œé“¾è·¯åˆ†ç»„ã€‚å‡è®¾æŸä¸ªè¶…èŒƒå›´æœºåˆ¶æ¼«æ¸¸ä¼™ä¼´çŸ¥é“ç»™å®šçš„ fNS æ˜¯æ— çŠ¶æ€è¿˜æ˜¯æœ‰çŠ¶æ€çš„ã€‚</p>
<p>å³ä½¿åœ¨ç»ˆç«¯è®¾å¤‡æ‰§è¡Œä»ä¸€ä¸ª NS åˆ°å¦ä¸€ä¸ª NS çš„åˆ‡æ¢æ¼«æ¸¸ä¹‹åï¼Œ hNS ä»ç„¶ä½¿ç”¨ JS å’Œ AS ç»´æŠ¤æ§åˆ¶å¹³é¢ï¼ˆcontrol-planeï¼‰å’Œæ•°æ®å¹³é¢ï¼ˆdata-planeï¼‰ã€‚å¯¹äºç»™å®š LoRa ä¼šè¯ï¼Œ hNS ä¿æŒä¸å˜ï¼Œç›´åˆ°ç»ˆç«¯è®¾å¤‡æ‰§è¡Œä¸‹ä¸€ä¸ªå…¥ç½‘è¿‡ç¨‹ã€‚ä¸ fNS ä¸åŒï¼Œ sNS å…·æœ‰æ§åˆ¶ç»ˆç«¯è®¾å¤‡ RF è®¾ç½®çš„èƒ½åŠ›ï¼Œè¿™å…è®¸æ›´çµæ´»çš„æ¼«æ¸¸åœºæ™¯ã€‚</p>
<p><img src="f6.png" alt="Figure 6 Use of Handover and Passive Roaming"></p>
<p>f6. ä½¿ç”¨åˆ‡æ¢æ¼«æ¸¸å’Œè¢«åŠ¨æ¼«æ¸¸</p>
<p>å›¾ f6 æ‰€ç¤ºï¼Œå…¶ä¸­åˆ‡æ¢æ¼«æ¸¸å’Œè¢«åŠ¨æ¼«æ¸¸åŒæ—¶ç”¨äº LoRa ä¼šè¯ã€‚è¿™ä¸ªä¾‹å­ä¸­ï¼Œç»ˆç«¯è®¾å¤‡é€šè¿‡ NS1 æ¿€æ´»ï¼Œ NS1 å……å½“ hNSã€‚éšåï¼Œå½“ NS2 æˆä¸º sNS æ—¶ï¼Œæ¼«æ¸¸è®¾å¤‡æ‰§è¡Œäº†ä» NS1 åˆ° NS2 çš„åˆ‡æ¢æ¼«æ¸¸ï¼Œå¹¶ä¸”å½“ NS3 æˆä¸ºç»ˆç«¯è®¾å¤‡çš„ fNS æ—¶ï¼Œè¿˜ä» NS2 åˆ° NS3 è¿›è¡Œè¢«åŠ¨æ¼«æ¸¸ã€‚</p>
<p>æ¼«æ¸¸æ¿€æ´»æ˜¯ç»ˆç«¯è®¾å¤‡åœ¨ vNS çš„è¦†ç›–èŒƒå›´å†…æ¿€æ´»çš„èƒ½åŠ›ã€‚</p>
<p>æœ¬è§„èŒƒæè¿°äº†ä¸‹åˆ—æ¼«æ¸¸æƒ…å†µçš„è¿‡ç¨‹ï¼š</p>
<ul>
<li>æ­£åœ¨è¿›è¡Œçš„ LoRa ä¼šè¯æœŸé—´çš„è¢«åŠ¨æ¼«æ¸¸</li>
<li>æ­£åœ¨è¿›è¡Œçš„ LoRa ä¼šè¯æœŸé—´çš„åˆ‡æ¢æ¼«æ¸¸</li>
<li>åŸºäº hNS å’Œ vNS ä¹‹é—´çš„åˆ‡æ¢æ¼«æ¸¸ï¼Œæ¼«æ¸¸æ¿€æ´»æ–°çš„ LoRa ä¼šè¯</li>
<li>åŸºäº hNS å’Œ vNS ä¹‹é—´çš„è¢«åŠ¨æ¼«æ¸¸ï¼Œæ¼«æ¸¸æ¿€æ´»æ–°çš„ LoRa ä¼šè¯</li>
</ul>
<p>å½“ hNS å’Œ vNS æ²¡æœ‰ä»»ä½•æ¼«æ¸¸åè®®æ—¶æ¿€æ´»æ–°çš„ LoRa ä¼šè¯è¶…å‡ºäº†æœ¬è§„èŒƒçš„èŒƒå›´ã€‚è¿™åŒ…å«ä¸¤ç§ NS å¯èƒ½ä¸ç¬¬ä¸‰ä¸ª NS ç­¾è®¢æ¼«æ¸¸åè®®çš„æƒ…å†µï¼ˆä¾‹å¦‚ï¼Œ hNS å’Œç¬¬ä¸‰ä¸ª NS å…·æœ‰åˆ‡æ¢æ¼«æ¸¸åè®®ï¼Œç¬¬ä¸‰ä¸ª NS å’Œ vNS å…·æœ‰è¢«åŠ¨æ¼«æ¸¸åè®®ï¼‰ã€‚</p>
<h3 id="11-2-æ¼«æ¸¸ç­–ç•¥"><a href="#11-2-æ¼«æ¸¸ç­–ç•¥" class="headerlink" title="11.2 æ¼«æ¸¸ç­–ç•¥"></a>11.2 æ¼«æ¸¸ç­–ç•¥</h3><p>æ¯ä¸ªç½‘ç»œè¿è¥å•†ï¼ˆnetwork operatorï¼‰éƒ½åº”è¯¥ï¼ˆSHALLï¼‰é…ç½®æ¼«æ¸¸ç­–ç•¥ï¼Œè¯¥æ¼«æ¸¸å¯ä»¥å•ç‹¬å…è®¸/ç¦æ­¢è¢«åŠ¨æ¼«æ¸¸ã€åˆ‡æ¢æ¼«æ¸¸ã€åŸºäºè¢«åŠ¨æ¼«æ¸¸çš„æ¿€æ´»ã€åŸºäºå…¶ NetID è¯†åˆ«çš„å…¶ä»–ç½‘ç»œè¿è¥å•†çš„åŸºäºåˆ‡æ¢æ¼«æ¸¸çš„æ¿€æ´»ã€‚å¯¹äºè¢«åŠ¨æ¼«æ¸¸ï¼Œç­–ç•¥è¿˜åº”è¯¥ï¼ˆSHALLï¼‰åŒ…æ‹¬ä¸Šè¡Œé“¾è·¯ MIC æ£€æŸ¥æ˜¯å¦ç”± fNS å®Œæˆã€‚</p>
<p>æ¯ä¸ªç½‘ç»œè¿è¥å•†ï¼ˆnetwork operatorï¼‰éƒ½åº”è¯¥ï¼ˆSHALLï¼‰é…ç½®æ¼«æ¸¸ç­–ç•¥ï¼Œè¯¥æ¼«æ¸¸å¯ä»¥å…è®¸/ç¦æ­¢è¢«åŠ¨æ¼«æ¸¸ã€åˆ‡æ¢æ¼«æ¸¸ã€åŸºäºè¢«åŠ¨æ¼«æ¸¸çš„æ¿€æ´»ã€åŸºäºå…¶ DevEUI è¯†åˆ«çš„å•ç‹¬ç»ˆç«¯è®¾å¤‡çš„åŸºäºåˆ‡æ¢æ¼«æ¸¸çš„æ¿€æ´»ã€‚</p>
<h3 id="11-3-è¢«åŠ¨æ¼«æ¸¸"><a href="#11-3-è¢«åŠ¨æ¼«æ¸¸" class="headerlink" title="11.3 è¢«åŠ¨æ¼«æ¸¸"></a>11.3 è¢«åŠ¨æ¼«æ¸¸</h3><p>æ­¤è¿‡ç¨‹é€‚ç”¨äº R1.0 [LW10, LW102] å’Œ R1.1 [LW11] ç»ˆç«¯è®¾å¤‡å’Œç½‘ç»œã€‚</p>
<h4 id="11-3-1-è¢«åŠ¨æ¼«æ¸¸å¼€å§‹"><a href="#11-3-1-è¢«åŠ¨æ¼«æ¸¸å¼€å§‹" class="headerlink" title="11.3.1 è¢«åŠ¨æ¼«æ¸¸å¼€å§‹"></a>11.3.1 è¢«åŠ¨æ¼«æ¸¸å¼€å§‹</h4><p>å›¾ f7 æ‰€ç¤ºé’ˆå¯¹ç»ˆç«¯è®¾å¤‡çš„æ­£åœ¨è¿›è¡Œçš„ LoRa ä¼šè¯çš„ä¸¤ä¸ª NS ä¹‹é—´çš„è¢«åŠ¨æ¼«æ¸¸è¿‡ç¨‹çš„æ¶ˆæ¯æµã€‚æœ‰å…³åŸºäºè¢«åŠ¨æ¼«æ¸¸çš„æ–° LoRa ä¼šè¯çš„æ¿€æ´»ï¼Œè¯·å‚é˜…ç¬¬ 12.2 èŠ‚ã€‚</p>
<p><img src="f7.png" alt="Figure 7 Passive Roaming start"></p>
<p>f7. è¢«åŠ¨æ¼«æ¸¸å¼€å§‹</p>
<p>æ­¥éª¤ 0ï¼š</p>
<p>ç»ˆç«¯è®¾å¤‡å·²é€šè¿‡ NS1 æ¿€æ´»ã€‚</p>
<p>æ­¥éª¤ 1ï¼š</p>
<p>å½“ç»ˆç«¯è®¾å¤‡å‘é€ä¸€ä¸ªæ•°æ®åŒ…ï¼Œå®ƒç”± NS2 æ¥æ”¶ï¼Œ NS2 ä¸ç»ˆç«¯è®¾å¤‡æ²¡æœ‰ä»»ä½•ä¸Šä¸‹æ–‡å…³è”ã€‚</p>
<p>æ­¥éª¤ 2ï¼š</p>
<p>å¦‚æœ NS2 è¢«å…¶ä»–ç½‘ç»œè¿è¥å•†å¯ç”¨äº†è¢«åŠ¨æ¼«æ¸¸ï¼Œé‚£ä¹ˆ NS2 åº”è¯¥ï¼ˆSHALLï¼‰å°†æ¥æ”¶æ•°æ®åŒ…ä¸­çš„ NwkID æ˜ å°„åˆ°å…·æœ‰è¢«åŠ¨æ¼«æ¸¸åè®®çš„è¿è¥å•† NetIDã€‚å¦‚æœæœªæŸ¥åˆ°ï¼Œ NS2 åº”è¯¥ï¼ˆSHALLï¼‰å¿½ç•¥è¿™ä¸ªæ•°æ®åŒ…ï¼Œç¨‹åºç»ˆæ­¢äºæ­¤ã€‚</p>
<p>æ­¥éª¤ 3ï¼š</p>
<p>å¦‚æœæŸ¥åˆ°äº†ä¸€ä¸ªæˆ–å¤šä¸ª NetID ï¼Œç„¶åå¦‚æœ NS2 æ²¡æœ‰é€šè¿‡ out-of-band æœºåˆ¶é…ç½® NS çš„ IP åœ°å€/ä¸»æœºåï¼Œ å®ƒå°±åº”è¯¥ï¼ˆSHALLï¼‰ä½¿ç”¨ DNS å»æŸ¥æ‰¾ï¼ˆè§ç¬¬ 19 ç« ï¼‰æ¯ä¸€ä¸ªåŒ¹é…ä¸Š NetID çš„ NS çš„ IP åœ°å€ï¼ˆæ¯”å¦‚ï¼ŒNS1 å¤„äºè¿™ç§æƒ…å½¢ï¼‰ã€‚å¦‚æœæœ‰ä¸æ­¢ä¸€ä¸ªåŒ¹é…é¡¹ï¼Œé‚£ä¹ˆå¯¹æ¯ä¸€ä¸ªåŒ¹é…çš„ NS æ‰§è¡Œæ­¥éª¤ 4-6 ã€‚</p>
<p>æ­¥éª¤ 4ï¼š</p>
<p>NS2 åº”è¯¥å‘é€ PRStartReq æ¶ˆæ¯åˆ° NS1 ï¼Œæºå¸¦æ”¶åˆ°æ•°æ®åŒ…çš„ PHYPayload ä»¥åŠå…³è”çš„ ULMetadata ã€‚å…ƒæ•°æ®ï¼ˆmetadataï¼‰çš„è¯¦æƒ…è§ç¬¬ 16 ç« ã€‚</p>
<p>æ­¥éª¤ 5ï¼š</p>
<p>NS1 åº”è¯¥ï¼ˆSHALLï¼‰æ£€æŸ¥å®ƒæ˜¯å¦ä¸æ”¶åˆ°çš„ NetID æ ‡è¯†çš„ç½‘ç»œè¿è¥å•†ç­¾æœ‰è¢«åŠ¨æ¼«æ¸¸åè®®ã€‚å¦‚æœæœªæ‰¾åˆ°åè®®ï¼Œè¦å†³å®šè¿”å›æºå¸¦ Result=NoRoamingAgreement çš„ PRStartAns ã€‚</p>
<p>NS1 åº”è¯¥ï¼ˆSHALLï¼‰ä» PHYPayload ä¸­æå–ç»ˆç«¯è®¾å¤‡çš„ DevAddr ï¼Œè¯†åˆ«ç›¸åº”çš„ç½‘ç»œä¼šè¯å®Œæ•´æ€§å¯†é’¥ï¼ˆR1.1 ä¸­ä¸º FNwkSIntKeyï¼Œåœ¨ R1.0/R1.0.2 ä¸­ä¸º NwkSKeyï¼‰ï¼Œå¹¶éªŒè¯ PHYPayload ä¸­çš„ MIC ã€‚å¦‚æœæœªæ‰¾åˆ°å¯†é’¥æˆ– MIC éªŒè¯å¤±è´¥ï¼Œåˆ™ NS1 åº”å†³å®šè¿”å›æºå¸¦ Result=MICFailed çš„ PRStartAns ã€‚</p>
<p>æ­¥éª¤ 6ï¼š</p>
<p>å¦‚æœè¯†åˆ«å‡ºçš„ç»ˆç«¯è®¾å¤‡é…ç½®ä¸ºä½¿ç”¨è¢«åŠ¨æ¼«æ¸¸å¹¶ä¸” NS1 å†³å®šé€šè¿‡ NS2 å¯ç”¨è¢«åŠ¨æ¼«æ¸¸ï¼Œåˆ™ NS1 åº”ï¼ˆSHALLï¼‰å‘ NS2 å‘é€æºå¸¦ Result=Success ä»¥åŠä¸è¢«åŠ¨æ¼«æ¸¸ç›¸å…³è”çš„ç”Ÿå‘½å‘¨æœŸçš„ PRStartAnsã€‚å¦‚æœ NS2 è¦ä½œä¸ºæœ‰çŠ¶æ€ fNS è¿è¡Œï¼Œåˆ™ NS1 è¿˜åº”ï¼ˆSHALLï¼‰åŒ…æ‹¬ DevEUI å’Œ ServiceProfile ã€‚å¦‚æœæ˜¯ NS1-NS2 çš„è¢«åŠ¨æ¼«æ¸¸åè®®è¦æ±‚ NS2 å¯¹ä¸Šè¡Œæ•°æ®åŒ…è¿›è¡Œ MIC æ£€æŸ¥ï¼Œåˆ™ PRStartAns æ¶ˆæ¯ä¸­è¿˜è¦æœ‰çš„ FCntUp å’Œ FNwkSIntKey ï¼ˆR1.1 çš„æƒ…å†µä¸‹ï¼‰ æˆ– NwkSKey ï¼ˆåœ¨ R1.0/1.02 çš„æƒ…å†µä¸‹ï¼‰ã€‚</p>
<p>å¦‚æœ NS1 æ­¤æ—¶ä¸å¸Œæœ›é€šè¿‡ NS2 å¯ç”¨è¢«åŠ¨æ¼«æ¸¸ï¼Œé‚£ä¹ˆå®ƒåº”è¯¥ï¼ˆSHALLï¼‰å°†æºå¸¦ Result=Deferred å’Œ Lifetime çš„ PRStartAns å‘é€åˆ° NS2 ã€‚åœ¨æ”¶åˆ°æ­¤æ¶ˆæ¯æ—¶ï¼Œ NS2 åœ¨ç”Ÿå‘½å‘¨æœŸå†…ä¸åº”ï¼ˆSHALL notï¼‰å†å‘åŒä¸€ç»ˆç«¯è®¾å¤‡çš„ NS1 å‘é€ PRStartReq ã€‚</p>
<p>å¦‚æœæ­¥éª¤ 5 å¤±è´¥äº†ï¼Œæ¥ç€ NS1 åº”è¯¥ï¼ˆSHALLï¼‰å‘é€å¸¦æœ‰æ ‡è¯†ç»“æœçš„ PRStartAns ç»™ NS2 ã€‚</p>
<p>NS1 å¯ä»¥åŒæ—¶ä»å¤šä¸ª NS æ¥æ”¶ PRStartReq ï¼Œå¹¶å†³å®šä½¿ç”¨é›¶ä¸ªæˆ–å¤šä¸ª NS æ¥å¯ç”¨è¢«åŠ¨æ¼«æ¸¸ã€‚</p>
<p>åœ¨ç›¸å…³ç”Ÿå‘½å‘¨æœŸåˆ°æœŸä¹‹åï¼Œ NS1 å’Œ NS2 åº”è‡ªè¡Œç»ˆæ­¢è¢«åŠ¨æ¼«æ¸¸ï¼ˆå³ï¼Œä¸æ¶‰åŠå½¼æ­¤çš„é¢å¤–ä¿¡ä»¤ï¼‰ï¼Œé™¤éåœ¨åˆ°æœŸä¹‹å‰ä½¿ç”¨æ–°ä¸€è½® PRStartReq/PRStartAns æ‰©å±•è¢«åŠ¨æ¼«æ¸¸ã€‚å¯¹äºæ— çŠ¶æ€ fNS æ“ä½œï¼Œ NS1 åº”ï¼ˆSHALLï¼‰å°†ä¸è¢«åŠ¨æ¼«æ¸¸å…³è”çš„ Lifetime è®¾ç½®ä¸ºé›¶ã€‚</p>
<p>æ­¥éª¤ 7ï¼š</p>
<p>ä¸€æ—¦æ”¶åˆ°æˆåŠŸçš„ PRStartAns ï¼ŒNS2 å°±ä¼šæˆä¸ºè¯¥ç»ˆç«¯è®¾å¤‡ LoRa ä¼šè¯ä¸­çš„ä¸€ä¸ª fNS ã€‚NS1 ç»§ç»­ä½œä¸º sNS æœåŠ¡ã€‚</p>
<p>åœ¨æ­¤ä¹‹åï¼Œ NS2 åº”è¯¥ï¼ˆSHALLï¼‰å°†ä»ç»ˆç«¯è®¾å¤‡æ¥æ”¶çš„æ•°æ®åŒ…è½¬å‘ç»™ NS1 ï¼Œ NS1 åº”ï¼ˆSHALLï¼‰æ¥æ”¶æ¥è‡ª NS2 çš„æ­¤ç±»æ•°æ®åŒ…ã€‚æ­¤å¤–ï¼Œ NS1 åº”ï¼ˆSHALLï¼‰è®°å½• NS2 ä½œä¸ºç”¨äºå°†æ•°æ®åŒ…å‘é€åˆ°ç»ˆç«¯è®¾å¤‡çš„å€™é€‰ fNS ã€‚ NS2 åº”ï¼ˆSHALLï¼‰æ¥å— NS1 å‘é€çš„æ•°æ®åŒ…ï¼Œé€šè¿‡å…¶ä¸­ä¸€ä¸ªç½‘å…³è½¬å‘åˆ°ç»ˆç«¯è®¾å¤‡ã€‚</p>
<h4 id="11-3-2-åˆ†ç»„ä¼ è¾“ï¼ˆPacket-Transmissionï¼‰"><a href="#11-3-2-åˆ†ç»„ä¼ è¾“ï¼ˆPacket-Transmissionï¼‰" class="headerlink" title="11.3.2 åˆ†ç»„ä¼ è¾“ï¼ˆPacket Transmissionï¼‰"></a>11.3.2 åˆ†ç»„ä¼ è¾“ï¼ˆPacket Transmissionï¼‰</h4><p>å›¾ f8 å±•ç¤ºäº†ç»ˆç«¯åœ¨è¢«åŠ¨æ¼«æ¸¸æ—¶æ”¶å‘æ•°æ®åŒ…çš„æ¶ˆæ¯æµã€‚è™½ç„¶æµç¨‹å›¾ä¸­ä¸€ä¸ªä¸Šè¡ŒåŒ…ç´§è·Ÿç€ä¸€ä¸ªä¸‹è¡ŒåŒ…ï¼Œå…¶å®ä¸Šä¸‹è¡Œé“¾è·¯éƒ¨åˆ†å¯ä»¥ä»¥ç»ˆç«¯è®¾å¤‡çš„ç±»å‹æ‰€å…è®¸çš„ä»»ä½•é¡ºåºç‹¬ç«‹æ‰§è¡Œã€‚</p>
<p>åœ¨æ— çŠ¶æ€ fNS è¿‡ç¨‹çš„æƒ…å†µä¸‹ï¼Œæ¯ä¸ªä¸Šè¡Œé“¾è·¯åˆ†ç»„åº”è¯¥ï¼ˆSHALLï¼‰æ ¹æ®ç¬¬ 11.3.1 èŠ‚è¿›è¡Œå¤„ç†ï¼ˆä¸æ˜¯æ ¹æ®æœ¬èŠ‚ä¸­çš„æ­¥éª¤ 1-4 ï¼Œå®ƒå‡å®šäº† fNS æ˜¯æœ‰çŠ¶æ€çš„ï¼‰ã€‚ç„¶è€Œï¼Œæœ¬èŠ‚ä¸­çš„æ­¥éª¤ 5-11 é€‚ç”¨äºä¸‹è¡Œé“¾è·¯è·Ÿç»„å¤„ç†ï¼Œå³ä½¿å¯¹æ— çŠ¶æ€çš„ fNS è¿‡ç¨‹ä¹Ÿæ˜¯å¦‚æ­¤ã€‚</p>
<p>æœ¬èŠ‚ä¸­çš„æ‰€æœ‰æ­¥éª¤éƒ½é€‚ç”¨äºæœ‰çŠ¶æ€ fNS è¿‡ç¨‹ä¸‹çš„ä¸Šä¸‹è¡Œé“¾è·¯çš„åˆ†ç»„å¤„ç†ã€‚</p>
<p><img src="f8.png" alt="Figure 8 Packet transmission using Passive Roaming"></p>
<p>f8. ä½¿ç”¨è¢«åŠ¨æ¼«æ¸¸çš„åˆ†ç»„ä¼ è¾“</p>
<p>æ­¥éª¤ 0ï¼š</p>
<p>åœ¨ fNS å’Œç»ˆç«¯è®¾å¤‡çš„ sNS ä¹‹é—´å¯ç”¨æœ‰çŠ¶æ€è¢«åŠ¨æ¼«æ¸¸ã€‚</p>
<p>æ­¥éª¤ 1ï¼š</p>
<p>ç»ˆç«¯è®¾å¤‡å‘é€ç”± fNS æ¥æ”¶çš„åˆ†ç»„ã€‚</p>
<p>æ­¥éª¤ 2ï¼š</p>
<p>å¦‚æœ fNS éœ€è¦æ ¹æ® sNS-fNS è¢«åŠ¨è·¯ç”±åè®®å¯¹ä¸Šè¡Œæ•°æ®åŒ…è¿›è¡Œ MIC æ£€æŸ¥ï¼Œåˆ™ fNS åº”ï¼ˆSHALLï¼‰ä»æ•°æ®åŒ…ä¸­æå–ç»ˆç«¯è®¾å¤‡çš„ DevAddr å¹¶è¯†åˆ« FNwkSIntKey/NwkSKey ï¼Œå†éªŒè¯æ•°æ®åŒ…ä¸­çš„ MIC ã€‚è‹¥æ— æ³•æ‰¾åˆ° FNwkSIntKey/NwkSKey æˆ–è€… MIC éªŒè¯å¤±è´¥ï¼Œé‚£ä¹ˆ fNS åº”è¯¥ï¼ˆSHALLï¼‰å¿½ç•¥è¿™ä¸ªåˆ†ç»„ã€‚</p>
<p>æ­¥éª¤ 3ï¼š</p>
<p>å¦‚æœè¯†åˆ«å‡ºç»ˆç«¯è®¾å¤‡ï¼Œåˆ™ fNS åº”è¯¥ï¼ˆSHALLï¼‰å‘æ‰€è¯†åˆ«çš„ç»ˆç«¯è®¾å¤‡çš„ sNS å‘é€ XmitDataReq æ¶ˆæ¯ï¼Œè¯¥ sNS æ‰¿è½½æ‰€æ¥æ”¶çš„åˆ†ç»„çš„ PHYPayload å’Œç›¸å…³è”çš„ ULMetadata ã€‚</p>
<p>æ­¥éª¤ 4ï¼š</p>
<p>åœ¨æ”¶åˆ° XmitDataReq åï¼Œ sNS åº”è¯¥ï¼ˆSHALLï¼‰å‘å›ä¸€æ¡æºå¸¦ç»“æœçš„ XmitDataAns æ¶ˆæ¯ç»™ fNS ã€‚</p>
<p>å½“ sNS å…·æœ‰è¦å‘é€åˆ°ç»ˆç«¯è®¾å¤‡çš„åˆ†ç»„æ—¶ï¼Œæ‰§è¡Œåç»­æ­¥éª¤ï¼Œè¯¥åˆ†ç»„å¯ä»¥æˆ–å¯ä»¥ä¸éµå¾ªå‰é¢çš„æ­¥éª¤ã€‚</p>
<p>æ­¥éª¤ 5ï¼š</p>
<p>sNS æœ‰åˆ†ç»„è¦å‘é€ç»™ç»ˆç«¯è®¾å¤‡ã€‚</p>
<p>æ­¥éª¤ 6ï¼š</p>
<p>sNS åº”è¯¥ï¼ˆSHALLï¼‰ç¡®å®šæ˜¯é€šè¿‡å…¶æ§åˆ¶ä¸‹çš„ GW ä¹‹ä¸€è¿˜æ˜¯é€šè¿‡ fNS æ§åˆ¶ä¸‹çš„ GW å‘é€æ•°æ®åŒ…ã€‚</p>
<p>æ­¥éª¤ 7ï¼š</p>
<p>å¦‚æœæ˜¯ sNS ç¡®å®šé€šè¿‡ fNS å‘é€åˆ†ç»„ï¼Œè¿™ä¸ª sNS åº”è¯¥ï¼ˆSHALLï¼‰å‘é€ XmitDataReq æ¶ˆæ¯ç»™ fNS ï¼Œæ¶ˆæ¯æºå¸¦æ‰€æ¥æ”¶çš„åˆ†ç»„çš„ PHYPayload å’Œç›¸å…³è”çš„ ULMetadata ã€‚</p>
<p>æ­¥éª¤ 8ï¼š</p>
<p>å¦‚æœæ¥æ”¶åˆ° XmitDataReq åŒ…å«é”™è¯¯ï¼Œ fNS åº”è¯¥ï¼ˆSHALLï¼‰å‘é€æºå¸¦å¤±è´¥å€¼çš„ XmitDataAns æ¶ˆæ¯ç»™ sNSï¼Œä¸åº”è¯¥ï¼ˆSHALL NOTï¼‰å°è¯•å‘é€è¿™ä¸ªåˆ†ç»„ã€‚å¦åˆ™ï¼Œ fNS å°†å°è¯•åŸºäºå…¶ä» sNS æ¥æ”¶çš„å…ƒæ•°æ®ä¿¡æ¯å°†åˆ†ç»„å‘é€åˆ°ç»ˆç«¯è®¾å¤‡ã€‚å¦‚æœå…ƒæ•°æ®åŒ…æ‹¬ GWInfo.ULToken ï¼Œåˆ™ fNS å¯ä»¥ä½¿ç”¨è¯¥å…ƒæ•°æ®æ¥é€‰æ‹©ä¸‹è¡Œé“¾è·¯ä¼ è¾“çš„ GW ã€‚ç”±äºæ—¶åºçº¦æŸï¼ˆtiming constraintsï¼‰å’Œç½‘ç»œæ¡ä»¶ï¼Œ fNS å¯èƒ½æ— æ³•å‘é€åˆ†ç»„ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œ fNS åº”è¯¥ï¼ˆSHALLï¼‰ä¸ä¼šé‡è¯•ä¼ è¾“ã€‚</p>
<p>æ­¥éª¤ 9ï¼š</p>
<p>åœ¨å°è¯•å‘é€æ•°æ®åŒ…ä¹‹åï¼Œ fNS åº”ï¼ˆSHALLï¼‰å‘æºå¸¦ DLFreq1 æˆ– DLFreq2 çš„ sNS å‘é€ XmitDataAns æ¶ˆæ¯ï¼ˆå–å†³äºæ•°æ®åŒ…æ˜¯åœ¨ RX1 è¿˜æ˜¯ RX2 æˆ–ä¸¤è€…ä¸Šå‘é€ï¼‰ï¼ŒResult=Success è¡¨ç¤ºä¼ è¾“æˆåŠŸï¼Œå¦åˆ™ç»“æœæ˜¯ Result=XmitFailed ã€‚</p>
<h3 id="11-3-3-è¢«åŠ¨æ¼«æ¸¸åœæ­¢"><a href="#11-3-3-è¢«åŠ¨æ¼«æ¸¸åœæ­¢" class="headerlink" title="11.3.3 è¢«åŠ¨æ¼«æ¸¸åœæ­¢"></a>11.3.3 è¢«åŠ¨æ¼«æ¸¸åœæ­¢</h3><p>å›¾ f9 å’Œ f10 å±•ç¤ºäº†ç»ˆæ­¢è¢«åŠ¨æ¼«æ¸¸çš„æµç¨‹ã€‚è¿™ä¸ªè¿‡ç¨‹ä»…é€‚ç”¨äºæœ‰çŠ¶æ€çš„ fNS ã€‚</p>
<p><img src="f9.png" alt="Figure 9 sNS-initiated Passive Roaming termination"></p>
<p>f9. sNS-å‘èµ·çš„ è¢«åŠ¨æ¼«æ¸¸çš„ç»ˆæ­¢</p>
<p>æ­¥éª¤ 0ï¼š</p>
<p>åœ¨ fNS å’Œç»ˆç«¯è®¾å¤‡çš„ sNS ä¹‹é—´å¯ç”¨è¢«åŠ¨æ¼«æ¸¸ã€‚</p>
<p>æ­¥éª¤ 1ï¼š</p>
<p>å½“ sNS å†³å®šåœ¨è¢«åŠ¨æ¼«æ¸¸ç”Ÿå‘½å‘¨æœŸè¶…æ—¶å‰ç»ˆæ­¢ä¸ç»ˆç«¯è®¾å¤‡çš„è¢«åŠ¨æ¼«æ¸¸æ—¶ï¼Œ sNS åº”è¯¥ï¼ˆSHALLï¼‰å‘é€ä¸€æ¡ PRStopReq æ¶ˆæ¯ç»™ fNS ï¼Œæ¶ˆæ¯æºå¸¦ç»ˆç«¯è®¾å¤‡çš„ DevAddr å’Œ DevEUIï¼Œä»¥åŠå¯é€‰çš„ç”Ÿå‘½å‘¨æœŸï¼ˆLifetimeï¼‰ ã€‚å¦‚æœ fNS æ˜¯æœ‰çŠ¶æ€çš„å¹¶ä¸” sNS ä¸å¸Œæœ›åœ¨è§„å®šçš„æ—¶é—´è·¨åº¦å†…ä»ç»ˆç«¯è®¾å¤‡çš„ fNS æ¥æ”¶å¦ä¸€ä¸ª PRStartReq ï¼Œåˆ™ sNS åº”è¯¥ï¼ˆSHALLï¼‰åº”è¯¥åŒ…å«ç”Ÿå‘½å‘¨æœŸï¼ˆLifetimeï¼‰ã€‚</p>
<p>æ­¥éª¤ 2ï¼š</p>
<p>fNS åº”è¯¥ï¼ˆSHALLï¼‰æ ¡éªŒå…·æœ‰ DevEUI çš„ç»ˆç«¯è®¾å¤‡æ˜¯å¦å·²ç»å¤„äºè¢«åŠ¨æ¼«æ¸¸å¹¶ä¸”ä¸ sNS ç›¸å…³è”ã€‚å¦‚æœè¿™ä¸¤ä¸ªæ¡ä»¶éƒ½æ»¡è¶³ï¼Œç„¶å fNS åº”è¯¥ï¼ˆSHALLï¼‰å‘é€æºå¸¦ Result=Success çš„ PRStopAns æ¶ˆæ¯ç»™ sNS ã€‚å¦åˆ™ï¼Œ fNS åº”è¯¥ï¼ˆSHALLï¼‰æºå¸¦ Result=UnknownDevEUI çš„ PRStopAns æ¶ˆæ¯ç»™ sNS ã€‚å¦‚æœæ”¶åˆ°çš„ PRStopReq æ¶ˆæ¯åŒ…å«ç”Ÿå‘½å‘¨æœŸ ï¼Œåˆ™ fNS åœ¨ç”Ÿå‘½å‘¨æœŸå†…åº”è¯¥ï¼ˆSHALLï¼‰ä¸ä¼šå‘ç»ˆç«¯è®¾å¤‡çš„ sNS å‘é€å¦ä¸€ä¸ª PRStartReq ã€‚</p>
<p>å¦‚æœç»ˆç«¯è®¾å¤‡çš„è¢«åŠ¨æ¼«æ¸¸å…ˆå‰å·²ä½¿ç”¨ PRStopReq æ¶ˆæ¯ç»ˆæ­¢æˆ–è€…è¢« PRStartAns/Result=Deferred æ‹’ç»ï¼Œåˆ™æ–°æ¥çš„ç”Ÿå‘½å‘¨æœŸä¸º 0 çš„ PRStopReq æ¶ˆæ¯ä½¿ NS2 èƒ½å¤Ÿå†æ¬¡å‘ç»ˆç«¯è®¾å¤‡å‘é€ PRStartReq ä»è¯¥ç»ˆç«¯è®¾å¤‡æ¥æ”¶æ•°æ®åŒ…ã€‚è¿™ä»…é€‚ç”¨äºæœ‰çŠ¶æ€çš„ fNS ã€‚</p>
<p><img src="f10.png" alt="Figure 10 fNS-initiated Passive Roaming termination"></p>
<p>f10. fNS-å‘èµ·çš„ è¢«åŠ¨æ¼«æ¸¸çš„ç»ˆæ­¢</p>
<p>æ­¥éª¤ 0ï¼š</p>
<p>åœ¨ fNS å’Œç»ˆç«¯è®¾å¤‡çš„ sNS ä¹‹é—´å¯ç”¨è¢«åŠ¨æ¼«æ¸¸ã€‚</p>
<p>æ­¥éª¤ 1ï¼š</p>
<p>å½“ fNS å†³å®šåœ¨è¢«åŠ¨æ¼«æ¸¸ç”Ÿå‘½å‘¨æœŸè¶…æ—¶å‰ç»ˆæ­¢ä¸ç»ˆç«¯è®¾å¤‡çš„è¢«åŠ¨æ¼«æ¸¸æ—¶ï¼Œ fNS åº”è¯¥ï¼ˆSHALLï¼‰å‘é€ä¸€æ¡ PRStopReq æ¶ˆæ¯ç»™ sNSï¼Œè¯¥æ¶ˆæ¯æºå¸¦ç»ˆç«¯è®¾å¤‡çš„ DevEUI ã€‚</p>
<p>æ­¥éª¤ 2ï¼š</p>
<p>sNS åº”è¯¥ï¼ˆSHALLï¼‰æ ¡éªŒå…·æœ‰ DevEUI çš„ç»ˆç«¯è®¾å¤‡æ˜¯å¦ç”±è‡ªå·±æä¾›æœåŠ¡å¹¶ä¸”å·²ç»å¤„äºä¸ fNS çš„è¢«åŠ¨æ¼«æ¸¸ã€‚å¦‚æœä¸¤ä¸ªæ¡ä»¶éƒ½æ»¡è¶³ï¼Œç„¶å sNS åº”è¯¥ï¼ˆSHALLï¼‰å‘é€æºå¸¦ Result=Success çš„ PRStopAns æ¶ˆæ¯ç»™ fNSã€‚å¦åˆ™ï¼Œ sNS åº”è¯¥ï¼ˆSHALLï¼‰å‘é€æºå¸¦ Result=UnknownDevEUI çš„ PRStopAns æ¶ˆæ¯ç»™ fNS ã€‚</p>
<p>åœ¨è¢«åŠ¨æ¼«æ¸¸ç»ˆæ­¢åï¼Œ sNS å’Œ fNS ä¹‹é—´åº”è¯¥ï¼ˆSHALLï¼‰åœæ­¢ä¸ºæŒ‡å®šçš„ç»ˆç«¯è®¾å¤‡å‘å½¼æ­¤è½¬å‘æ•°æ®åŒ…ã€‚</p>
<h3 id="11-4-åˆ‡æ¢æ¼«æ¸¸"><a href="#11-4-åˆ‡æ¢æ¼«æ¸¸" class="headerlink" title="11.4 åˆ‡æ¢æ¼«æ¸¸"></a>11.4 åˆ‡æ¢æ¼«æ¸¸</h3><p>è¿™ä¸ªè¿‡ç¨‹ä»…é€‚ç”¨äº R1.1 [LW11] ç»ˆç«¯è®¾å¤‡å’Œç½‘ç»œã€‚</p>
<h4 id="11-4-1-åˆ‡æ¢æ¼«æ¸¸å¼€å§‹"><a href="#11-4-1-åˆ‡æ¢æ¼«æ¸¸å¼€å§‹" class="headerlink" title="11.4.1 åˆ‡æ¢æ¼«æ¸¸å¼€å§‹"></a>11.4.1 åˆ‡æ¢æ¼«æ¸¸å¼€å§‹</h4><p>å›¾ f11 è¯´æ˜äº†ç»ˆç«¯è®¾å¤‡æ­£åœ¨è¿›è¡Œçš„ LoRa ä¼šè¯çš„åˆ‡æ¢æ¼«æ¸¸è¿‡ç¨‹çš„æ¶ˆæ¯æµã€‚åŸºäºæ–° LoRa ä¼šè¯çš„åˆ‡æ¢æ¼«æ¸¸æ¿€æ´»å‚é˜…ç¬¬ 12.1 èŠ‚ã€‚</p>
<p><img src="f11.png" alt="Figure 11 Handover Roaming start"></p>
<p>f11. åˆ‡æ¢æ¼«æ¸¸å¼€å§‹</p>
<p>æ­¥éª¤ 0ï¼š</p>
<p>è€ƒè™‘ç»ˆç«¯è®¾å¤‡å·²åœ¨ NS1 ä¸Šæ¿€æ´»çš„æƒ…å†µã€‚å› æ­¤ï¼Œ NS1 ä½œä¸ºç»ˆç«¯è®¾å¤‡çš„ fNS ã€ sNS ä»¥åŠ hNS ã€‚</p>
<p>æ­¥éª¤ 1ï¼š</p>
<p>ç»ˆç«¯è®¾å¤‡å“åº”æ”¶åˆ°çš„ ForceRejoinReq MAC æŒ‡ä»¤ï¼ˆæœªç¤ºå‡ºï¼‰æˆ–è€…åœ¨æ²¡æœ‰å¤–éƒ¨è§¦å‘çš„æƒ…å†µä¸‹è‡ªåŠ¨åœ°å‘é€ Rejoin-request Type 0 æ¶ˆæ¯ã€‚</p>
<p>æ­¥éª¤ 2ï¼š</p>
<p>å¦‚æœ NS2 å……å½“ç”±æ¥æ”¶åˆ° DevEUI æ ‡è¯†çš„ç»ˆç«¯è®¾å¤‡çš„ sNS ï¼Œå¹¶ä¸” NS2 æ²¡æœ‰é€šè¿‡å‘é€ ForceRejoinReq è¯·æ±‚ Rejoin-request Type 0 ï¼Œé‚£ä¹ˆ NS2 åº”è¯¥ï¼ˆSHOULDï¼‰é»˜é»˜åœ°ä¸¢å¼ƒæ¶ˆæ¯å¹¶ä¸”æµç¨‹ç»ˆæ­¢äºæ­¤ã€‚</p>
<p>å¦‚æœ NS2 ä¸æ­¢ç»ˆç«¯è®¾å¤‡çš„ sNSï¼Œé‚£ä¹ˆ NS2 åº”è¯¥ï¼ˆSHALLï¼‰åœ¨ Rejoin è¯·æ±‚ä¸­ä½¿ç”¨ NetID æ ‡è¯†çš„æ“ä½œç¬¦æŸ¥æ‰¾å…¶æ¼«æ¸¸ç­–ç•¥ã€‚å¦‚æœ NS2 æ²¡æœ‰è¢«æ“ä½œè€…é…ç½®æˆå…è®¸åˆ‡æ¢æ¼«æ¸¸ï¼Œé‚£ä¹ˆ NS2 åº”è¯¥ï¼ˆSHALLï¼‰å¿½ç•¥ Rejoin-request å¹¶ä¸”ç»ˆæ­¢è¯¥ç¨‹åºã€‚å¦åˆ™ï¼Œå¦‚æœ NS2 æ²¡æœ‰é€šè¿‡ out-of-band æœºåˆ¶é…ç½® NS1 çš„ IP åœ°å€/ä¸»æœºå ï¼Œå®ƒåº”è¯¥ï¼ˆSHALLï¼‰ä½¿ç”¨ DNS å‘ç° NS1 çš„ IP åœ°å€ï¼ˆå‚è§ç¬¬ 19 èŠ‚ï¼‰ã€‚</p>
<p>æ­¥éª¤ 3ï¼š</p>
<p>å¦‚æœ NS2 æ²¡æœ‰ç¼“å­˜ç»ˆç«¯è®¾å¤‡çš„è®¾å¤‡é…ç½®æ–‡ä»¶ï¼ˆDevice Profileï¼‰ï¼Œå®ƒåº”è¯¥ï¼ˆSHALLï¼‰å‘é€ä¸€æ¡æºå¸¦ DevEUI çš„ ProfileReq æ¶ˆæ¯ç»™ NS1 ã€‚å¦‚æœæ²¡æœ‰å‘é€ ProfileReq å°±è·³è¿‡æ­¥éª¤ 4 å’Œ 5 ã€‚</p>
<p>æ­¥éª¤ 4ï¼š</p>
<p>NS1 åº”è¯¥ï¼ˆSHALLï¼‰é€šè¿‡ NetID æ ‡è¯†çš„æ“ä½œç¬¦æŸ¥æ‰¾å…¶æ¼«æ¸¸ç­–ç•¥ã€‚</p>
<p>æ­¥éª¤ 5ï¼š</p>
<p>å¦‚æœ NS1 è¢«é…ç½®ä¸ºå…è®¸å‘ NS2 å’Œ ç»ˆç«¯è®¾å¤‡æä¾›åˆ‡æ¢æ¼«æ¸¸ï¼ŒNS1 åº”è¯¥ï¼ˆSHALLï¼‰å‘é€å¸¦æœ‰ Result=Success ã€ è®¾å¤‡é…ç½®æ–‡ä»¶ï¼ˆDevice Profileï¼‰ ä»¥åŠ Profile Timestampï¼ˆè®¾å¤‡é…ç½®æ–‡ä»¶æœ€è¿‘ä¸€æ¬¡ä¿®æ”¹çš„æ—¶é—´æˆ³ï¼‰çš„ ProfileAns æ¶ˆæ¯ç»™ NS2 ã€‚å¦‚æœæ²¡æœ‰å¯ç”¨åˆ‡æ¢æ¼«æ¸¸ï¼Œ ProfileAns æ¶ˆæ¯ä¸­æºå¸¦ Result=(NoRoamingAgreement æˆ–è€… DevRoamingDisallowed) ä»¥åŠç”Ÿå‘½å‘¨æœŸï¼ˆLifetimeï¼‰ï¼Œç„¶åç¨‹åºç»ˆæ­¢ã€‚Lifetime å…è®¸ NS1 åœ¨ç”Ÿå‘½å‘¨æœŸç»“æŸå‰è¯·æ±‚ NS2 è€Œä¸ç”¨å‘ç»ˆç«¯è®¾å¤‡å‘é€é¢å¤–çš„ ProfileReq ã€‚</p>
<p>æ­¥éª¤ 6ï¼š</p>
<p>NS2 åº”ï¼ˆSHALLï¼‰å‘ NS1 å‘é€æºå¸¦ PHYPayload çš„ HRStartReq æ¶ˆæ¯ï¼Œ PHYPayload ä¸­åŒ…å« Rejoin-request æ¶ˆæ¯ ã€ MACVersion ã€ ULMetadata ã€ è®¾å¤‡é…ç½®æ—¶é—´æˆ³ ï¼ˆDevice Profile Timestampï¼‰ï¼Œä»¥åŠç”± NS2 æ ‡è¯†çš„å‚æ•° DevAddr ã€ DLSettigns ã€ RxDelay å’Œå¯é€‰çš„ CFList ä»¥åˆ†é…ç»™ç»ˆç«¯è®¾å¤‡ã€‚ NS2 åº”è¯¥ï¼ˆSHALLï¼‰å°† MACVersion çš„å€¼è®¾ç½®ä¸ºç»ˆç«¯è®¾å¤‡å’Œ NS2 ä¹‹é—´çš„æœ€é«˜é€šç”¨ç‰ˆæœ¬ã€‚</p>
<p>æ­¥éª¤ 7ï¼š</p>
<p>å¦‚æœ NS2 æˆ–ç»ˆç«¯è®¾å¤‡ä¸å…è®¸åˆ‡æ¢æ¼«æ¸¸ï¼Œå†æˆ–è€…æ¶ˆæ¯çš„ MIC æ ¡éªŒå¤±è´¥ï¼Œåˆ™ NS1 åº”è¯¥ï¼ˆSHALLï¼‰ç»§ç»­æ‰§è¡Œæ­¥éª¤ 9 ã€‚åˆ‡æ¢æ¼«æ¸¸æ‹’ç»å¯èƒ½æ—¶ç”±äºæ¯ä¸ª NS æˆ–æ¯ä¸ªè®¾å¤‡çš„æ¼«æ¸¸ç­–ç•¥ï¼Œæˆ–è€…åœ¨ç»ˆç«¯è®¾å¤‡å·²ç»è¢«å¦ä¸€ä¸ª sNS æœåŠ¡æ—¶å¯èƒ½ä¸éœ€è¦åˆ‡æ¢æ¼«æ¸¸ã€‚</p>
<p>å¦‚æœ NS1 ç¡®å®šè‡ªä»æ”¶åˆ°çš„è®¾å¤‡é…ç½®æ–‡ä»¶æ—¶é—´æˆ³æŒ‡ç¤ºçš„æ—¶é—´ä»¥æ¥è®¾å¤‡é…ç½®æ–‡ä»¶å·²æ›´æ”¹ï¼Œåˆ™ NS1 æ–­å®š NS2 å…·æœ‰è¿‡æ—¶çš„ï¼ˆstaleï¼‰è®¾å¤‡é…ç½®æ–‡ä»¶ä¿¡æ¯ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œ NS1 åº”è¯¥ï¼ˆSHELLï¼‰ç»§ç»­æ‰§è¡Œæ­¥éª¤ 9 ã€‚</p>
<p>å¦åˆ™ï¼Œ NS1 åº”è¯¥ï¼ˆSHALLï¼‰è½¬å‘ RejoinReq æ¶ˆæ¯ç»™ JS ï¼Œæ¶ˆæ¯æºå¸¦ä» NS2 æ¥æ”¶çš„ PHYPayload ï¼Œå…¶ä¸­åŒ…å« Rejoin-request æ¶ˆæ¯ã€ MACVersion ã€ DevEUI ã€ DevAddr ã€ DLSettings ã€ RxDelay ä»¥åŠå¯é€‰çš„ CFList ã€‚</p>
<p>æ­¥éª¤ 8ï¼š</p>
<p>å¦‚æœ JS æ¥å—äº† Rejoin-request ï¼Œå®ƒåº”è¯¥ï¼ˆSHALLï¼‰æŒ‰ç…§ MACVersion ç»§ç»­æ‰§è¡Œ Rejoin-request ï¼Œå³å‘é€ RejoinAns æ¶ˆæ¯ç»™ NS1ï¼Œ æ¶ˆæ¯æºå¸¦ Result=Success ã€ PHYPayload (åŒ…å« Join-accept ä¿¡æ¯ã€ SNwkSIntKey ã€ FNwkSIntKey ã€ NwkSEncKey ã€ Lifetime)ã€‚ å¦åˆ™ JS åº”è¯¥ï¼ˆSHALLï¼‰å‘é€ä¸€æ¡ RejoinAns æ¶ˆæ¯ç»™ NS1ï¼Œ æ¶ˆæ¯å¸¦æœ‰ Result=(UnknownDevEUI æˆ–è€… MICFailed) ã€‚</p>
<p>NS1 åº”è¯¥ï¼ˆSHALLï¼‰å°†æ¥æ”¶çš„ Lifetime å€¼è§†ä¸ºå®ƒåˆ†é…ç»™ LoRa ä¼šè¯çš„ä¼šè¯ç”Ÿå­˜æœŸï¼ˆsession lifetimeï¼‰çš„ä¸Šé™ï¼ˆupper-boundï¼‰ã€‚</p>
<p>æ­¥éª¤ 9ï¼š</p>
<p>å¦‚æœ NS1 åœ¨æ­¥éª¤ 7 ä¸­å†³å®šä¸å…è®¸åˆ‡æ¢æ¼«æ¸¸ï¼Œé‚£ä¹ˆ NS1 åº”è¯¥ï¼ˆSHALLï¼‰å‘é€ä¸€æ¡ HRStartAns æ¶ˆæ¯ç»™ NS2 ï¼Œæ¶ˆæ¯å¸¦æœ‰è®¾ç½®é”™è¯¯å€¼çš„ Resule ï¼ˆå‚è§è¡¨ t24ï¼‰ä»¥åŠ Lifetime ã€‚Lifetime å…è®¸ NS1 åœ¨ç”Ÿå‘½å‘¨æœŸç»“æŸå‰è¯·æ±‚ NS2 è€Œä¸ç”¨å‘ç»ˆç«¯è®¾å¤‡å‘é€é¢å¤–çš„ HRStartReq ã€‚</p>
<p>å¦‚æœ NS1 æ–­å®š NS2 å·²çŸ¥çš„è®¾å¤‡é…ç½®æ–‡ä»¶æ˜¯è¿‡æ—¶çš„ï¼Œåˆ™ NS1 åº”ï¼ˆSHALLï¼‰å°† HRStartAns æ¶ˆæ¯å‘ç»™ NS2 ï¼Œæ¶ˆæ¯æºå¸¦ Result=StaleDeviceProfile ã€æœ€æ–°è®¾å¤‡é…ç½®æ–‡ä»¶ä»¥åŠå®ƒçš„è®¾å¤‡é…ç½®æ–‡ä»¶æ—¶é—´æˆ³ã€‚ NS2 åº”è¯¥ï¼ˆSHALLï¼‰è·³å›æ­¥éª¤ 6 å»ä½¿ç”¨åˆšåˆšæ”¶åˆ°çš„æ–°è®¾å¤‡é…ç½®æ–‡ä»¶ã€‚</p>
<p>å¦åˆ™ï¼Œ NS1 åº”è¯¥ï¼ˆSHALLï¼‰é€šè¿‡è¿˜åŒ…å« DLMetadata å’ŒæœåŠ¡é…ç½®æ–‡ä»¶ï¼ˆService Profileï¼‰å°† HRStartAns æ¶ˆæ¯çš„æœ‰æ•ˆè½½è·å‘é€ç»™ NS2 ã€‚ NS1 ä¹Ÿåº”è¯¥ï¼ˆSHALLï¼‰ç¼“å­˜æ”¶åˆ°çš„ SNwkSIntKey ï¼Œè¿™æ ·å®ƒå°±å¯ä»¥åœ¨å†³å®šå°†å®ƒä»¬è½¬å‘ç»™ JS ä¹‹å‰éªŒè¯åç»­ Rejoin-Type 0 æ¶ˆæ¯çš„ MIC ã€‚</p>
<p>æ­¥éª¤ 10ï¼š</p>
<p>å¦‚æœ HRStartAns æŒ‡ç¤ºäº†æˆåŠŸï¼ŒNS2 åº”è¯¥ï¼ˆSHALLï¼‰è½¬å‘æ”¶åˆ°çš„å¸¦æœ‰ Join-accept æ¶ˆæ¯çš„ PHYPayload ç»™ç»ˆç«¯è®¾å¤‡ã€‚å¦åˆ™ NS2 åº”è¯¥ï¼ˆSHALLï¼‰ä¸å‘é€ä»»ä½•ä¼šåº”è¯¥ç»ˆç«¯è®¾å¤‡ã€‚</p>
<p>å¦‚æœé‡æ–°å…¥ç½‘è¿‡ç¨‹ï¼ˆRejoin Procedureï¼‰æˆåŠŸï¼Œæ¥ç€ NS2 åº”è¯¥ï¼ˆSHALLï¼‰å¼€å§‹è½¬å‘ä»ç»ˆç«¯è®¾å¤‡æ”¶åˆ°çš„æ•°æ®åŒ…ç»™ NS1 ï¼Œ NS1 åº”è¯¥ï¼ˆSHALLï¼‰æ¥å—è¿™ç§æ•°æ®åŒ…ã€‚å¦å¤–ï¼Œ NS1 åº”è¯¥ï¼ˆSHALLï¼‰å¼€å§‹è½¬å‘ä» AS æ”¶åˆ°æ•°æ®åŒ…ç»™ NS2 ï¼Œå¹¶ä¸” NS2 åº”è¯¥ï¼ˆSHALLï¼‰æ¥æ”¶è¿™ç§æ•°æ®åŒ…ã€‚</p>
<p>æ­¥éª¤ 11ï¼š</p>
<p>ç»ˆç«¯è®¾å¤‡å‘é€ç¬¬ä¸€æ¬¡ä¸Šè¡Œé“¾è·¯æ•°æ®åŒ…ã€‚NS2 åº”è¯¥ï¼ˆSHALLï¼‰å‘é€è¿™ä¸ªæ•°æ®åŒ…ç»™ NS1 ã€‚</p>
<p>æ­¥éª¤ 12ï¼š</p>
<p>å½“ NS2 æ¥æ”¶åˆ°ç»ˆç«¯è®¾å¤‡çš„ç¬¬ä¸€æ¬¡ä¸Šè¡Œé“¾è·¯æ•°æ®åŒ…æ—¶ï¼Œ NS2 å¼€å§‹å……å½“ sNSï¼Œ è€Œ NS1 åœæ­¢å……å½“ sNS ã€‚åŒæ—¶ï¼Œ NS1 ç»§ç»­ä½œä¸º hNS æœåŠ¡äºç»ˆç«¯è®¾å¤‡ã€‚</p>
<h4 id="11-4-2-æ•°æ®åŒ…ä¼ è¾“"><a href="#11-4-2-æ•°æ®åŒ…ä¼ è¾“" class="headerlink" title="11.4.2 æ•°æ®åŒ…ä¼ è¾“"></a>11.4.2 æ•°æ®åŒ…ä¼ è¾“</h4><p>åˆ‡æ¢æ¼«æ¸¸çš„æ¡ˆä¾‹ä¸­ï¼ŒhNS å’Œ sNS åº”è¯¥ï¼ˆSHALLï¼‰ä½¿ç”¨å’Œè¢«åŠ¨æ¼«æ¸¸ï¼ˆå‚è§ 11.3.2 èŠ‚ï¼‰ç›¸åŒæ–¹å¼çš„ XmitDataReq/Ans æ¶ˆæ¯ã€‚å”¯ä¸€çš„ä¸åŒå°±æ˜¯ï¼Œ hNS-sNS æ¥å£æºå¸¦çš„æ˜¯ FRMPayload è€Œä¸æ˜¯ PHYPayloadï¼ŒULMetadata/DLMetadata åŒ…å«ä¸åŒçš„å¯¹è±¡é›†åˆåœ¨ç¬¬ 16 èŠ‚æè¿°ã€‚</p>
<h4 id="11-4-3-åˆ‡æ¢æ¼«æ¸¸åœæ­¢"><a href="#11-4-3-åˆ‡æ¢æ¼«æ¸¸åœæ­¢" class="headerlink" title="11.4.3 åˆ‡æ¢æ¼«æ¸¸åœæ­¢"></a>11.4.3 åˆ‡æ¢æ¼«æ¸¸åœæ­¢</h4><p>å›¾ f12 é˜æ˜åœ¨ç»ˆç«¯è®¾å¤‡æ‰§è¡Œåˆ‡æ¢æ¼«æ¸¸åˆ°æ–°çš„ sNS ä¹‹åï¼ŒhNS ä¸ä¹‹å‰æä¾›æœåŠ¡çš„ sNS ç»ˆæ­¢äº†åˆ‡æ¢æ¼«æ¸¸ã€‚</p>
<p><img src="f12.png" alt="Figure 12 Termination of sNS"></p>
<p>æ­¥éª¤ 0ï¼š</p>
<p>ç»ˆç«¯è®¾å¤‡åœ¨ NS1 å’Œ NS2 ä¹‹é—´æ‰§è¡Œåˆ‡æ¢æ¼«æ¸¸ã€‚</p>
<p>æ­¥éª¤ 1ï¼š</p>
<p>ç»ˆç«¯è®¾å¤‡åœ¨ NS1 å’Œ NS3 ä¹‹é—´æ‰§è¡Œåˆ‡æ¢æ¼«æ¸¸ã€‚</p>
<p>æ­¥éª¤ 2ï¼š</p>
<p>ç»ˆç«¯è®¾å¤‡çš„ç¬¬ä¸€æ¬¡ä¸Šè¡Œæ•°æ®åŒ…é€šè¿‡æ–°çš„ sNS ï¼ˆNS3ï¼‰ è¢« NS1 æ¥æ”¶åˆ°ã€‚</p>
<p>æ­¥éª¤ 3ï¼š</p>
<p>å½“ NS1 é€šè¿‡æ–°çš„ sNS ï¼ˆNS3ï¼‰æ”¶åˆ°ç»ˆç«¯è®¾å¤‡çš„ç¬¬ä¸€æ¡ä¸Šè¡ŒåŒ…æ—¶ï¼Œ NS1 åº”è¯¥ï¼ˆSHALLï¼‰å‘é€ä¸€æ¡å¸¦æœ‰ DevEUI çš„ HRStopReq æ¶ˆæ¯åˆ°ä¹‹å‰çš„ sNS ï¼ˆNS2ï¼‰ã€‚</p>
<p>HRStopReq æ¶ˆæ¯å¸¦æœ‰å¯é€‰çš„ Lifetime ï¼Œè¡¨ç¤º NS1 ä¸å¸Œæœ›åœ¨è§„å®šæ—¶é—´å†…æ”¶åˆ° NS2 çš„å¦ä¸€æ¡ HRStartReq æ¶ˆæ¯ã€‚</p>
<p>æ­¥éª¤ 4ï¼š</p>
<p>å¦‚æœ NS2 ä¸ºæ”¶åˆ° DevEUI æ ‡è¯†çš„ç»ˆç«¯è®¾å¤‡å’Œç›¸å…³è”çš„ NS1 æ¿€æ´»äº†åˆ‡æ¢æ¼«æ¸¸ï¼Œ åˆ™å…ˆå‰æä¾›æœåŠ¡çš„ sNS ï¼ˆNS2ï¼‰åº”è¯¥ç»ˆæ­¢åˆ‡æ¢æ¼«æ¸¸å¹¶ä¸”å‘é€æºå¸¦ Result=Success çš„ HRStopAns æ¶ˆæ¯ç»™ NS1 ã€‚ å¦‚æœ NS2 æ²¡æœ‰ä¸ºä¸­æ–­è®¾åˆ«å’Œç›¸å…³è”çš„ NS1 æ¿€æ´»åˆ‡æ¢æ¼«æ¸¸ï¼Œåˆ™ NS2 åº”è¯¥ï¼ˆSHALLï¼‰å‘é€æºå¸¦ Result=UnknownDevEUI çš„ HRStopAns æ¶ˆæ¯ç»™ NS1 ã€‚</p>
<p>æ­¥éª¤ 5ï¼š</p>
<p>NS2 åœæ­¢ä½œä¸º sNS ä¸ºç»ˆç«¯è®¾å¤‡çš„ LoRa ä¼šè¯æä¾›æœåŠ¡ã€‚å¦‚æœ NS2 ä¸ºç»ˆç«¯è®¾å¤‡çš„ LoRa ä¼šè¯å¯ç”¨äº†å’Œå…¶ä»– NS çš„è¢«åŠ¨æ¼«æ¸¸ï¼Œåˆ™ NS2 åº”è¯¥ï¼ˆSHALLï¼‰ ä¹Ÿç»ˆæ­¢å’Œé‚£ä¸ª NS çš„è¢«åŠ¨æ¼«æ¸¸ã€‚</p>
<p>å¦‚æœå…ˆå‰ç”¨ HRStopReq å‘½ä»¤ç»ˆæ­¢äº†å¯¹ç»ˆç«¯è®¾å¤‡çš„åˆ‡æ¢æ¼«æ¸¸ï¼Œåˆ™æ–°çš„ HRStopReq å‘½ä»¤ Lifetime å€¼ä¸º 0 ï¼Œä½¿ NS2 èƒ½å¤Ÿåœ¨æ”¶åˆ°æ–°çš„ç±»å‹ä¸º 0 çš„ Rejoin-request è¯·æ±‚åå†æ¬¡å‘è¯¥ç»ˆç«¯è®¾å¤‡å‘é€ HRStart è¯·æ±‚ã€‚</p>
<p>å¦ä¸€ç§æƒ…å†µæ˜¯å½“ sNS å†³å®šç»ˆæ­¢æ¼«æ¸¸æ—¶ç»ˆæ­¢åˆ‡æ¢æ¼«æ¸¸ã€‚sNS å¯ä»¥é€šè¿‡å‘é€ ForceRejoinReq å‘½ä»¤ç»™ç»ˆç«¯è®¾å¤‡æ¥æ‰§è¡Œç»ˆæ­¢æµç¨‹ã€‚ç„¶åï¼Œ sNS åº”è¯¥ï¼ˆSHALLï¼‰å‘é€å¸¦æœ‰ DevEUI çš„ HRStopReq ç»™ hNS ã€‚å¦‚æœ hNS å·²ç»æ¿€æ´»äº† DevEUI æ ‡è¯†çš„ç»ˆç«¯è®¾åˆ«å’Œç›¸å…³è” sNS çš„åˆ‡æ¢æ¼«æ¸¸ï¼Œ hNS åº”è¯¥ï¼ˆSHALLï¼‰ç»ˆæ­¢åˆ‡æ¢æ¼«æ¸¸å¹¶ä¸”å‘é€ä¸€æ¡å¸¦æœ‰ Result=Success çš„ HRStopAns ç»™ sNS ã€‚å¦‚æœ hNS æ²¡æœ‰å’Œç›¸å…³è”çš„ç»ˆç«¯è®¾å¤‡æ¿€æ´»åˆ‡æ¢æ¼«æ¸¸ï¼Œé‚£ä¹ˆ hNS åº”è¯¥ï¼ˆSHALLï¼‰å‘é€æºå¸¦ Result=UnknownDevEUI çš„ HRStopAns æ¶ˆæ¯ç»™ sNS ã€‚å³ä½¿ sNS ä» hNS æ”¶åˆ°äº†é”™è¯¯ç»“æœï¼Œä»ç„¶å¯ä»¥ç»ˆæ­¢åˆ‡æ¢æ¼«æ¸¸ã€‚</p>
<h4 id="11-4-4-hNS-é‡è·æ§åˆ¶æƒ"><a href="#11-4-4-hNS-é‡è·æ§åˆ¶æƒ" class="headerlink" title="11.4.4 hNS é‡è·æ§åˆ¶æƒ"></a>11.4.4 hNS é‡è·æ§åˆ¶æƒ</h4><p>å›¾ f13 é˜é‡Šäº† hNS é€šè¿‡æ¥ç®¡å½“å‰æœåŠ¡çš„ sNS è€Œå˜æˆ sNS çš„æ¶ˆæ¯æµç¨‹ã€‚</p>
<p><img src="f13.png" alt="Figure 13 hNS regaining sNS control"></p>
<p>æ­¥éª¤ 0ï¼š</p>
<p>ç»ˆç«¯è®¾å¤‡åœ¨ NS1 å’Œ NS2 ä¹‹é—´æ‰§è¡Œåˆ‡æ¢æ¼«æ¸¸ã€‚</p>
<p>æ­¥éª¤ 1ï¼š</p>
<p>NS1 å†³å®šå˜æˆ sNS ã€‚</p>
<p>æ­¥éª¤ 2ï¼š</p>
<p>NS1 åº”è¯¥ï¼ˆSHALLï¼‰å‘é€ä¸€æ¡å¸¦æœ‰ DevEUI çš„ HRStartReq æ¶ˆæ¯ç»™ NS2 è§¦å‘åˆ‡æ¢æ¼«æ¸¸ã€‚ </p>
<blockquote>
<p>åŸæ–‡æœ‰è¯¯ï¼Œç¨ä½œä¿®æ”¹ã€‚åŸæ–‡ï¼š<code>The NS1 SHALL send an HRStartReq message to the NS1 carrying DevEUI to trigger the Handover Roaming.</code></p>
</blockquote>
<p>æ­¥éª¤ 3ï¼š</p>
<p>å¦‚æœ NS2 é€šè¿‡æ”¶åˆ°çš„ DevEUI æ ‡è¯†å’Œç›¸å…³è”çš„ NS1 ä¸ºç»ˆç«¯è®¾å¤‡æ¿€æ´»äº†åˆ‡æ¢æ¼«æ¸¸ï¼Œé‚£ NS2 å°±åº”è¯¥ï¼ˆSHALLï¼‰å‘é€æºå¸¦ Result=Success çš„ HRStartAns ç»™ NS1 ï¼Œå¦åˆ™æºå¸¦ Result=UnknownDevEUI ã€‚ </p>
<p>æ­¥éª¤ 4ï¼š</p>
<p>NS2 åº”è¯¥ï¼ˆSHALLï¼‰åˆå§‹åŒ–ç½‘ç»œè§¦å‘ï¼ˆnetwork-triggeredï¼‰çš„åˆ‡æ¢æ¼«æ¸¸ï¼Œå¦‚ 11.4.1 èŠ‚æ‰€æè¿°ã€‚å®ƒå‡è®¾è¿™ä¸ªæµç¨‹åˆå§‹åŒ–çš„æ—¶å€™ç»ˆç«¯è®¾å¤‡åœ¨ NS1 çš„æ— çº¿ç”µè¦†ç›–èŒƒå›´å†…ï¼Œ NS1 æ‹’ç»äº†æ¥è‡ªå…¶ä»– NS çš„åˆ‡æ¢æ¼«æ¸¸å°è¯•ï¼ŒåŒ…æ‹¬ NS2 ï¼Œè€Œå˜æˆäº† sNS ã€‚</p>
<p>æ­¥éª¤ 5ï¼š</p>
<p>NS1 ç›´æ¥ä»ç»ˆç«¯è®¾å¤‡è·å–åˆ°ç¬¬ä¸€æ¬¡ä¸Šè¡Œæ•°æ®åŒ…ã€‚</p>
<p>æ­¥éª¤ 6ï¼š</p>
<p>NS1 åº”è¯¥ï¼ˆSHALLï¼‰ä¸ NS2 æ‰§è¡Œåˆ‡æ¢æ¼«æ¸¸çš„åœæ­¢æµç¨‹ï¼Œå¦‚ 11.4.3 èŠ‚æ‰€ç¤ºã€‚</p>
<p>æ­¥éª¤ 7ï¼š</p>
<p>NS2 åœæ­¢ä½œä¸º sNS æœåŠ¡äºç»ˆç«¯è®¾å¤‡çš„ LoRa ä¼šè¯ã€‚å¦‚æœ NS2 å·²ç»å’Œå…¶ä»– NS ä¸ºç»ˆç«¯è®¾å¤‡çš„ LoRa ä¼šè¯å¯ç”¨äº†è¢«åŠ¨æ¼«æ¸¸ï¼Œé‚£ä¹ˆ NS2 ä¹Ÿåº”è¯¥ï¼ˆSHALLï¼‰ç»ˆæ­¢å’Œé‚£ä¸ª NS çš„è¢«åŠ¨æ¼«æ¸¸ã€‚</p>
<p>æˆ–è€…ï¼ŒNS1 å¯ä»¥ç­‰åˆ°ç»ˆç«¯è®¾å¤‡è‡ªå·±å†³å®šè¦åˆå§‹åŒ–åˆ‡æ¢æ¼«æ¸¸ï¼Œæœ‰æ•ˆçš„è·³è¿‡æ­¥éª¤ 2 å’Œ 3ï¼Œç»§ç»­æ­¥éª¤ 4 è‡³ 7 ã€‚</p>
]]></content>
      <categories>
        <category>LoRaWAN</category>
      </categories>
      <tags>
        <tag>LoRaWAN</tag>
      </tags>
  </entry>
  <entry>
    <title>LoRaWAN Backend Interfaces v1.0 å­¦ä¹  (p2)</title>
    <url>/2019/07/11/LoRaWAN-Backend-Interfaces-v1-0-%E5%AD%A6%E4%B9%A0-p2/</url>
    <content><![CDATA[<p>æ¥ä¸Šä¸€ç¯‡ã€‚</p>
<p><a href="https://lora-alliance.org/resource-hub/lorawantm-back-end-interfaces-v10" target="_blank" rel="noopener">åŸæ–‡æ¡£é“¾æ¥</a></p>
<p>æœ¬éƒ¨åˆ†ä¸»è¦ä»‹ç»ç»ˆç«¯çŠ¶æ€ã€æ¿€æ´»æµç¨‹ä»¥åŠåœç”¨æµç¨‹ã€‚</p>
<a id="more"></a>
<h2 id="4-ç»ˆç«¯ç±»å‹å’ŒçŠ¶æ€"><a href="#4-ç»ˆç«¯ç±»å‹å’ŒçŠ¶æ€" class="headerlink" title="4. ç»ˆç«¯ç±»å‹å’ŒçŠ¶æ€"></a>4. ç»ˆç«¯ç±»å‹å’ŒçŠ¶æ€</h2><p>LoRaWAN ç»ˆç«¯è®¾å¤‡æœ‰ä¸¤ç§ç±»å‹ï¼šABPï¼ˆActivation-by-Personalizationï¼Œä¸ªæ€§åŒ–æ¿€æ´»ï¼‰ æ¿€æ´»ç»ˆç«¯è®¾å¤‡ï¼Œä»¥åŠ OTA (Over-the-Airï¼Œç©ºä¸­æ¿€æ´») æ¿€æ´»ç»ˆç«¯è®¾å¤‡ã€‚ABP ç»ˆç«¯é€šè¿‡è·³è¿‡å…¥ç½‘è¿‡ç¨‹ç›´æ¥ç»‘å®šåˆ°ç‰¹å®šç½‘ç»œï¼ŒOTA ç»ˆç«¯æ‰§è¡Œå…¥ç½‘è¿‡ç¨‹ä»¥åœ¨é€‰å®šç½‘ç»œä¸Šæ¿€æ´»ã€‚</p>
<p>å›¾ f3 å±•ç¤ºäº†ä¸¤ç§ç±»å‹ç»ˆç«¯ä»¥åŠä¸ OTA ç»ˆç«¯è®¾å¤‡å…³è”çš„å„ç§ç»ˆç«¯è®¾å¤‡çŠ¶æ€ã€‚</p>
<p><img src="f3.png" alt="Figure 3 End-Device types and states"></p>
<p>f3. ç»ˆç«¯ç±»å‹å’ŒçŠ¶æ€</p>
<p>ä¸€å° ABP ç»ˆç«¯è®¾å¤‡ç¦»å¼€åˆ¶é€ å•†æˆ–ä¹‹åé…ç½®æ—¶åº”è¯¥ï¼ˆSHALLï¼‰å…·æœ‰ä»¥ä¸‹ä¿¡æ¯ï¼š DevAddr ã€ AppSKey ã€ ç½‘ç»œä¼šè¯å¯†é’¥ï¼ˆnetwork session keysï¼‰ã€‚ç½‘ç»œä¼šè¯å¯†é’¥åœ¨ R1.1 (LoRaWAN1.1) ä¸­æ˜¯ SNwkSIntKey ã€ FNwkSIntKey ã€ NwkSEncKey ï¼Œåœ¨ R1.0/1.0.2 ï¼ˆLoRaWAN1.0/1.0.2ï¼‰ä¸­æ˜¯ NwkSKeyã€‚ä¸ºäº†ä½¿ç»ˆç«¯è®¾å¤‡èƒ½å¤Ÿè½»æ¾ä½¿ç”¨ç½‘ç»œï¼Œå…¶ hNS ï¼ˆHome NSï¼‰åº”è¯¥ï¼ˆSHALLï¼‰å…·æœ‰ DevAddr ã€ ç½‘ç»œä¼šè¯å¯†é’¥ ã€ ç»ˆç«¯è®¾å¤‡çš„ AS ä¿¡æ¯ï¼›å¹¶ä¸” AS åº”è¯¥ï¼ˆSHALLï¼‰å…·æœ‰ç»ˆç«¯è®¾å¤‡çš„ DevAddr ã€ AppSKey ã€‚</p>
<p>ä¸€å° OTA ç»ˆç«¯è®¾å¤‡ç¦»å¼€åˆ¶é€ å•†æˆ–ä¹‹åé…ç½®æ—¶åº”è¯¥ï¼ˆSHALLï¼‰å…·æœ‰ä»¥ä¸‹ä¿¡æ¯ï¼š DevEUI ã€ NwkKey (ä»…é™ R1.1) ã€ AppKey ã€ JoinEUI ã€‚æ­¤æ—¶ï¼Œå®ƒè¢«ç§°ä¸ºé€šç”¨ç»ˆç«¯è®¾å¤‡ã€‚å…³è”çš„ JS (Join Server) åº”è¯¥ï¼ˆSHALLï¼‰å…·æœ‰ç»ˆç«¯è®¾å¤‡çš„ DevEUI ã€ AppKey ã€ NwkKey ï¼ˆä»…é™ R1.1ï¼‰ã€‚åœ¨è¢«å§”æ‰˜ï¼ˆcommissionedï¼‰ä¹‹å‰ï¼ŒNS æˆ– AS å¯èƒ½æ²¡æœ‰å…³äºé€šç”¨ç»ˆç«¯è®¾å¤‡çš„ä»»ä½•ä¿¡æ¯ã€‚</p>
<p>åœ¨å…¶ç”Ÿå‘½å‘¨æœŸä¸­é‡æ–°é…ç½®ç»ˆç«¯è®¾å¤‡ã€‚é…ç½®å’Œé‡æ–°é…ç½®è¿‡ç¨‹è¯¦ç»†å†…å®¹è¶…å‡ºæœ¬æ–‡æ¡£èŒƒå›´ã€‚</p>
<p>å§”æ‰˜è¿‡ç¨‹å°†ç»ˆç«¯è®¾å¤‡å…³è”åˆ°å…¶ hNS å’Œç‰¹å®š AS ã€‚å·²å§”æ‰˜çš„ OTA ç»ˆç«¯è®¾å¤‡çš„ JS åº”è¯¥ï¼ˆSHALLï¼‰å…·æœ‰ç»ˆç«¯è®¾å¤‡çš„ hNS ä¿¡æ¯ã€‚ä¸ç»ˆç«¯è®¾å¤‡å…³è”çš„ AS åº”è¯¥ï¼ˆSHALLï¼‰å…·æœ‰ç»ˆç«¯è®¾å¤‡çš„ DevEUI ã€‚hNS åº”è¯¥ï¼ˆSHALLï¼‰å…·æœ‰ä¸ç»ˆç«¯è®¾å¤‡åŠå…¶è®¢é˜…ç›¸å…³çš„å„ç§é…ç½®æ–‡ä»¶ä¿¡æ¯ã€‚ç”¨äºä¸º AS ã€ JS å’Œ NS æä¾›æ‰€éœ€ä¿¡æ¯çš„æœºåˆ¶è¶…å‡ºæœ¬æ–‡æ¡£èŒƒå›´ã€‚</p>
<p>å½“ä¸€ä¸ªè¢«å§”æ‰˜çš„ OTA ç»ˆç«¯è®¾å¤‡æˆåŠŸæ‰§è¡Œäº†å…¥ç½‘ï¼ˆæ¿€æ´»ï¼‰è¿‡ç¨‹ï¼Œå®ƒèƒ½çŸ¥é“ DevAddr ã€ ç½‘ç»œä¼šè¯å¯†é’¥å’Œ AppSKey ã€‚JS èƒ½çŸ¥é“ DevEUI ã€ DevAddr ã€ ç½‘ç»œä¼šè¯å¯†é’¥ ã€AppSKey å’Œ DevNonce ã€‚JS å°† DevEUI å’Œ AppSKey äº¤ä»˜ç»™ AS ã€‚JS å°†ç½‘ç»œä¼šè¯å¯†é’¥å’Œå¯é€‰çš„åŠ å¯† AppSKey ä¼ é€’ç»™ NS ã€‚</p>
<h2 id="5-è°ƒè¯•ç¨‹åºï¼ˆCommissioning-Procedureï¼‰"><a href="#5-è°ƒè¯•ç¨‹åºï¼ˆCommissioning-Procedureï¼‰" class="headerlink" title="5. è°ƒè¯•ç¨‹åºï¼ˆCommissioning Procedureï¼‰"></a>5. è°ƒè¯•ç¨‹åºï¼ˆCommissioning Procedureï¼‰</h2><p>è°ƒè¯•ç¨‹åºæœ‰ AS ã€ JSï¼ˆä»…é€‚ç”¨äº OTA) å’Œç»™å®šç»ˆç«¯è®¾å¤‡çš„ NS æ‰§è¡Œã€‚å®ƒæ¶‰åŠ JS å°†ç»ˆç«¯è®¾å¤‡ä¸ hNS (ä»…é€‚ç”¨äº OTA) ç›¸å…³è”ï¼Œ hNS å’Œ AS æ¥æ”¶ä¸ç»ˆç«¯è®¾å¤‡åŠå…¶æœåŠ¡è®¢é˜…ç›¸å…³çš„é…ç½®æ–‡ä»¶ä¿¡æ¯ã€‚ç”¨äºæä¾›å…³äºå‰è¿°ç½‘ç»œå…ƒä»¶çš„æ‰€éœ€ä¿¡æ¯çš„æœºåˆ¶è¶…å‡ºæœ¬æ–‡æ¡£èŒƒå›´ã€‚</p>
<p>é€€å½¹ç¨‹åºï¼ˆDecommissioning Procedureï¼‰ä¼šç ´åç»ˆç«¯è®¾å¤‡ä¸ hNS å’Œ AS ä¹‹é—´çš„å…³è”ã€‚æ­¤è¿‡ç¨‹æ¶‰åŠåœ¨è°ƒè¯•æ—¶é‡ç½®åœ¨ AS å’Œ NS ä¸Šåˆ›å»ºçš„çŠ¶æ€ï¼Œè§£é™¤ JS ä¸Šçš„ç»ˆç«¯è®¾å¤‡å’Œ hNS çš„ç»‘å®šï¼ˆä»…é€‚ç”¨äº OTAï¼‰ã€‚</p>
<p>è°ƒè¯•å’Œé€€å½¹ç¨‹åºçš„ç»†èŠ‚è¶…å‡ºäº†æœ¬è§„èŒƒçš„èŒƒå›´ã€‚</p>
<h2 id="6-æ¿€æ´»-ABP-ç»ˆç«¯è®¾å¤‡"><a href="#6-æ¿€æ´»-ABP-ç»ˆç«¯è®¾å¤‡" class="headerlink" title="6. æ¿€æ´» ABP ç»ˆç«¯è®¾å¤‡"></a>6. æ¿€æ´» ABP ç»ˆç«¯è®¾å¤‡</h2><p>å›¾ f4 å±•ç¤ºäº†å…·æœ‰ NS çš„ ABP ç»ˆç«¯è®¾å¤‡æ¿€æ´»ã€‚æ­¤è¿‡ç¨‹é€‚ç”¨äº R1.0 å’Œ R1.1 ç»ˆç«¯è®¾å¤‡å’Œç½‘ç»œã€‚</p>
<p>ï¼<a href="f4.png">Figure 4 Activation of ABP End-Device</a><br>f4. æ¿€æ´» ABP ç»ˆç«¯è®¾å¤‡</p>
<p>æ­¥éª¤ 0ï¼š</p>
<p>ç»ˆç«¯è®¾å¤‡ã€ NS å’Œ AS é…ç½®äº†æ‰€éœ€çš„ä¿¡æ¯ï¼Œå› æ­¤ç»ˆç«¯è®¾å¤‡å¯ä»¥åœ¨ä¸Šç”µä¹‹åç«‹å³å‘é€æ•°æ®åŒ…ã€‚</p>
<p>æ­¥éª¤ 1ï¼š</p>
<p>å½“ç»ˆç«¯è®¾å¤‡å…·æœ‰è¦å‘é€çš„åº”ç”¨æœ‰æ•ˆè´Ÿè½½ï¼ˆPayloadï¼‰æ—¶ï¼Œå®ƒå¯ä»¥åœ¨ä¸æ‰§è¡Œä¸ç½‘ç»œçš„çš„ä»»ä½•è®¾ç½®ä¿¡ä»¤çš„æƒ…å†µä¸‹è¿™æ ·åšã€‚æ•°æ®åŒ…åŒ…å«ç”¨ AppSKey åŠ å¯†çš„åº”ç”¨æœ‰æ•ˆè´Ÿè½½ï¼Œä»¥åŠä½¿ç”¨ç½‘ç»œä¼šè¯å®Œæ•´æ€§å¯†é’¥ï¼ˆR1.1 ä¸­æ˜¯ SNwkSIntKey å’Œ FNwkSIntKey ï¼Œå¦åˆ™æ˜¯ NwkSKeyï¼‰ç”Ÿæˆçš„ MIC ã€‚</p>
<p>å½“ NS æ”¶åˆ°æ•°æ®åŒ…æ˜¯ï¼Œå®ƒåº”è¯¥ï¼ˆSHALLï¼‰æ ¹æ®æ”¶åˆ°çš„æ•°æ®åŒ…çš„ DevAddr æ‰§è¡Œç½‘ç»œä¼šè¯å®Œæ•´æ€§å¯†é’¥æŸ¥æ‰¾ã€‚ NS åº”è¯¥ï¼ˆSHALLï¼‰ä½¿ç”¨æ£€ç´¢åˆ°çš„å¯†é’¥éªŒè¯ MIC ã€‚å¦‚æœä¸ºæ‰¾åˆ°å¯†é’¥ï¼Œæˆ–è€… MIC æ ¡éªŒå¤±è´¥ï¼Œåˆ™ NS åº”è¯¥ä¸¢å¼ƒè¯¥æ•°æ®åŒ…ã€‚</p>
<p>æ­¥éª¤ 2ï¼š</p>
<p>NS åº”å°†æ¥æ”¶çš„æ•°æ®åŒ…çš„åŠ å¯†æœ‰æ•ˆè´Ÿè½½å‘é€åˆ°ä¸ç»ˆç«¯è®¾å¤‡ç›¸å…³è”çš„ AS ã€‚åº”ç”¨ç¨‹åºæœ‰æ•ˆè´Ÿè½½å¯ä»¥ä¼´éšå…ƒæ•°æ®ï¼Œä¾‹å¦‚ DevAddr ã€ FPort ã€ æ—¶é—´æˆ³ï¼ˆtimestampï¼‰ç­‰ã€‚ NS åº”è¯¥ï¼ˆSHALLï¼‰è€ƒè™‘ä»ç»ˆç«¯è®¾å¤‡æ¥æ”¶ç¬¬ä¸€ä¸ªæ•°æ®åŒ…æ—¶æ¿€æ´»ç»ˆç«¯è®¾å¤‡çš„ LoRa ä¼šè¯ã€‚</p>
<h2 id="7-æ¿€æ´»-OTA-ç»ˆç«¯è®¾å¤‡"><a href="#7-æ¿€æ´»-OTA-ç»ˆç«¯è®¾å¤‡" class="headerlink" title="7. æ¿€æ´» OTA ç»ˆç«¯è®¾å¤‡"></a>7. æ¿€æ´» OTA ç»ˆç«¯è®¾å¤‡</h2><p>ç»ˆç«¯è®¾å¤‡ä½¿ç”¨ OTA æ¿€æ´»è¿‡ç¨‹ï¼Œä»¥ä¾¿ä¸ç½‘ç»œç›¸äº’è®¤è¯ï¼Œå¹¶è·å¾—æˆæƒå‘é€ä¸Šè¡Œé“¾è·¯å’Œæ¥æ”¶ä¸‹è¡Œé“¾è·¯æ•°æ®åŒ…ã€‚å¯¹äºç»ˆç«¯è®¾å¤‡ï¼Œ NS åˆ†æˆä¸¤ç§ã€‚ä¸€ç±»æ˜¯ hNS ï¼ŒåŒ…å«ç»ˆç«¯è®¾å¤‡çš„ç»ˆç«¯è®¾å¤‡ä¿¡æ¯ã€æœåŠ¡ä»¥åŠè·¯ç”±é…ç½®æ–‡ä»¶ï¼Œå¹¶åœ¨æ¿€æ´»åæä¾›é¢å‘ AS å’Œ JS çš„æ¥å£ã€‚æä¾› hNS æ‰€éœ€é…ç½®æ–‡ä»¶ä¿¡æ¯çš„æœºåˆ¶è¶…å‡ºæœ¬æ–‡æ¡£èŒƒå›´ã€‚å¦ä¸€ç±»æ˜¯ vNS ï¼ˆVisited NSï¼‰ï¼Œå®ƒä¸ hNS ä¹‹é—´åˆ¶å®šäº†ä¸šåŠ¡åŠæŠ€æœ¯åè®®ä»¥ä¾¿èƒ½å¤Ÿä¸ºç»ˆç«¯è®¾å¤‡æä¾›æœåŠ¡ã€‚</p>
<p>æ¿€æ´»ç¨‹åºæœ‰ä¸¤ç§å˜ä½“ï¼Œå³å›ºå®šæ¿€æ´»ï¼ˆActivation at Homeï¼‰å’Œæ¼«æ¸¸æ¿€æ´»ï¼ˆRoaming Activationï¼‰ã€‚</p>
<p>å›ºå®šæ¿€æ´»ï¼šç»ˆç«¯è®¾å¤‡åœ¨ hNS çš„æ— çº¿ç”µè¦†ç›–èŒƒå›´å†…æ‰§è¡Œæ¿€æ´»è¿‡ç¨‹ã€‚åœ¨ç¨‹åºç»“æŸæ—¶ï¼Œ hNS æ—¶å”¯ä¸€ä¸ºç»ˆç«¯æœåŠ¡çš„ NS ,ç”¨äºè”ç³» AS å’Œ JS ã€‚</p>
<p>æ¼«æ¸¸æ¿€æ´»ï¼šç»ˆç«¯è®¾å¤‡åœ¨ hNS çš„æ— çº¿ç”µè¦†ç›–èŒƒå›´ä¹‹å¤–ä½†æ˜¯åœ¨ vNS çš„è¦†ç›–èŒƒå›´ä¹‹å†…æ‰§è¡Œæ¿€æ´»è¿‡ç¨‹ã€‚åœ¨æ­¤è¿‡ç¨‹ä¸­ï¼Œ vNS åœ¨ JS çš„å¸®åŠ©ä¸‹å–å¾— hNS çš„èº«ä»½æ ‡è¯†ï¼Œå¹¶ä» hNS è·å¾—æ‰€éœ€çš„ç»ˆç«¯è®¾å¤‡å’ŒæœåŠ¡é…ç½®æ–‡ä»¶ã€‚åœ¨ç¨‹åºç»“æŸæ—¶ï¼Œç»ˆç«¯è®¾å¤‡ç”± vNS å’Œ hNS æä¾›æœåŠ¡ï¼Œä»¥ä¾¿è”ç³» AS å’Œ JS ã€‚</p>
<p>å½“ç»ˆç«¯è®¾å¤‡æˆåŠŸæ‰§è¡Œå…¥ç½‘å’Œé‡æ–°å…¥ç½‘çš„è¿‡ç¨‹æ—¶ï¼Œç»ˆç«¯è®¾å¤‡è¢«ç§°ä¸ºä¸åç«¯è¿›è¡Œäº† LoRa ä¼šè¯ã€‚æ¯æ¬¡ LoRa ä¼šè¯éƒ½ä¸ç»ˆç«¯è®¾å¤‡ä¸Šç®¡ç†çš„ä¸Šä¸‹æ–‡å‚æ•°ä»¥åŠ NS ã€ JS å’Œ AS ç›¸å…³è”ã€‚ï¼ˆä¾‹å¦‚ï¼Œä¼šè¯å¯†é’¥ã€ DevAddr ã€ NS çš„ ID ç­‰ï¼‰ã€‚å½“ç»ˆç«¯è®¾å¤‡æ‰§è¡Œåœç”¨ï¼ˆé€€å‡ºï¼‰è¿‡ç¨‹æˆ–å…¶ä»–æˆåŠŸçš„å…¥ç½‘/é‡æ–°å…¥ç½‘è¿‡ç¨‹æ—¶ï¼ŒLoRa ä¼šè¯ç»ˆæ­¢ã€‚</p>
<h2 id="8-å›ºå®šæ¿€æ´»ï¼ˆOTA-Activation-at-Home-Procedureï¼‰"><a href="#8-å›ºå®šæ¿€æ´»ï¼ˆOTA-Activation-at-Home-Procedureï¼‰" class="headerlink" title="8. å›ºå®šæ¿€æ´»ï¼ˆOTA Activation at Home Procedureï¼‰"></a>8. å›ºå®šæ¿€æ´»ï¼ˆOTA Activation at Home Procedureï¼‰</h2><p>å›¾ f5 è¯´æ˜äº†å›ºå®šæ¿€æ´»æµç¨‹ä¸­çš„æ¶ˆæ¯æµã€‚æ­¤è¿‡ç¨‹é€‚ç”¨äº R1.0 [LW10,LW102] å’Œ R1.1 [LW11] ç»ˆç«¯è®¾å¤‡å’Œç½‘ç»œã€‚</p>
<p><img src="f5.png" alt="Figure 5 Message flow for OTA Activation at Home Procedure."></p>
<p>f5. å›ºå®šæ¿€æ´»æµç¨‹ä¸­çš„æ¶ˆæ¯æµ</p>
<p>æ­¥éª¤ 1ï¼š</p>
<p>ç»ˆç«¯è®¾å¤‡åº”è¯¥ï¼ˆSHALLï¼‰å‘å°„å…¥ç½‘è¯·æ±‚ï¼ˆJoin-requestï¼‰æ¶ˆæ¯ã€‚</p>
<p>æ­¥éª¤ 2ï¼š</p>
<p>å½“ NS æ”¶åˆ°å…¥ç½‘è¯·æ±‚æ¶ˆæ¯ï¼Œ NS åº”è¯¥ï¼ˆSHALLï¼‰æŒ‰ç…§ç»ˆç«¯è®¾å¤‡çš„ DevEUI åˆ¤æ–­è‡ªå·±æ˜¯ä¸æ˜¯ hNS ã€‚åœ¨è¿™ä¸ªæµç¨‹ä¸­å‡è®¾è¿™ä¸ª NS å°±æ˜¯å½“å‰ç»ˆç«¯è®¾å¤‡çš„ hNS ã€‚æœ‰å…³ NS ä¸æ˜¯ç»ˆç«¯è®¾å¤‡çš„ hNS çš„æƒ…å†µï¼Œè¯·å‚é˜…ç¬¬ 12 èŠ‚ï¼Œä½† NS é…ç½®ä¸ºä½¿ç”¨ JS è¿›è¡Œæ¼«æ¸¸æ¿€æ´»è¿‡ç¨‹ã€‚å¦‚æœ NS æ—¢ä¸æ˜¯ hNS ä¹Ÿæ²¡æœ‰é…ç½®ä¸ºä½¿ç”¨ JS ï¼Œé‚£ä¹ˆè¿™ä¸ª NS åº”è¯¥é»˜é»˜åœ°å¿½ç•¥è¿™æ¡å…¥ç½‘è¯·æ±‚ï¼Œç¨‹åºç»ˆæ­¢äºæ­¤ã€‚</p>
<p>å¦‚æœ NS å°šæœªé€šè¿‡ out-of-band æœºåˆ¶é…ç½® JS çš„ IP åœ°å€/ä¸»æœºåï¼Œ NS åº”è¯¥ï¼ˆSHALLï¼‰ä½¿ç”¨ DNS æ ¹æ®æ”¶åˆ°åœ° Join-request æ¶ˆæ¯ä¸­çš„ JoinEUI æ¥æŸ¥æ‰¾ JS åœ° IP åœ°å€ï¼ˆå‚è§ç¬¬ 19 èŠ‚ï¼‰ã€‚å¦‚æœ DNS æŸ¥è¯¢å¤±è´¥ï¼Œé‚£ä¹ˆ NS åº”è¯¥ï¼ˆSHALLï¼‰åœ¨æ­¤å¤„ç»ˆæ­¢ç¨‹åºã€‚</p>
<p>å¯¹äºé…ç½®äº†æœªæ ‡è¯† JS çš„ AppEUI çš„ R1.0 [LW10] ç»ˆç«¯è®¾å¤‡ï¼Œ NS åº”è¯¥ï¼ˆSHOULDï¼‰é€šè¿‡ out-of-band æœºåˆ¶é…ç½® JS çš„ IP åœ°å€/ä¸»æœºåã€‚</p>
<p>æ­¥éª¤ 3ï¼š</p>
<p>NS å‘ JS å‘é€ JoinReq æ¶ˆæ¯ï¼Œè¯¥æ¶ˆæ¯æºå¸¦ Join-request æ¶ˆæ¯çš„ PHYPayload ã€ MACVersion ã€ DevEUI ã€ DevAddr ã€ DLSettings ã€ RxDelay å’Œå¯é€‰çš„ CFList ã€‚NS åº”è¯¥ï¼ˆSHALLï¼‰å°† MACVersion çš„å€¼è®¾ç½®ä¸ºç»ˆç«¯è®¾å¤‡å’Œ NS ä¹‹é—´çš„æœ€é«˜é€šç”¨ç‰ˆæœ¬ã€‚</p>
<p>æ­¥éª¤ 4ï¼š</p>
<p>JS åº”è¯¥ï¼ˆSHALLï¼‰æ ¹æ® MACVersion å¤„ç† Join-request æ¶ˆæ¯ï¼Œå¹¶å°† JoinAns å‘é€åˆ°æºå¸¦ Result=Success çš„ NS ï¼Œå¸¦æœ‰ Join-accept æ¶ˆæ¯çš„ PHYPayloadã€ç½‘ç»œä¼šè¯å¯†é’¥ï¼ˆåœ¨ R1.1 æƒ…å†µä¸‹ä¸º SNwkSIntKey ã€ FNwkSIntKey å’Œ NwkSEncKey ï¼Œä»¥åŠåœ¨ R1.0/R1.0.2 ç»ˆç«¯è®¾å¤‡çš„æƒ…å†µä¸‹ä¸º NwkSKeyï¼‰ã€åŠ å¯†çš„ AppSKey æˆ– SessionKeyID æˆ–ä¸¤è€…ä»¥åŠæˆåŠŸæ—¶çš„ Lifetimeï¼Œè¿˜æœ‰åœ¨å¤±è´¥çš„æƒ…å†µä¸‹ Result=UnknownDevEUI æˆ– MICFailedï¼ˆä¾‹å¦‚ï¼Œå¦‚æœ JS æ— æ³•è¯†åˆ«è®¾å¤‡ï¼Œæˆ–è€… Join-request çš„ MIC æœªé€šè¿‡æ ¡éªŒï¼‰ã€‚</p>
<p>JS å¯ä»¥åˆ›å»ºä¸ç”Ÿæˆçš„ä¼šè¯å¯†é’¥ç›¸å…³è”çš„ SessionKeyID ã€‚</p>
<p>ä¸º R1.1 ç»ˆç«¯è®¾å¤‡ç”Ÿæˆçš„ SNwkSIntKey ï¼Œ FNwkSIntKey ï¼Œ NwkSEncKey ä»¥åŠ AppSKey éµå¾ª LoRaWAN1.1 è§„èŒƒ [LW11]ã€‚ä¸º R1.0/R1.0.2 ç»ˆç«¯è®¾å¤‡ç”Ÿæˆçš„ NwkSKey éµå¾ª LoRaWAN1.0 è§„èŒƒ [LW10]ã€‚å½“ä» JS ä¼ é€åˆ° NS æ—¶ï¼Œä½¿ç”¨ JS å’Œ AS ä¹‹é—´å…±äº«çš„å¯†é’¥å¯¹ AppSKey è¿›è¡ŒåŠ å¯†ã€‚</p>
<p>å¯¹äº R1.0 [LW10] ç»ˆç«¯è®¾å¤‡ï¼Œå½“ AppEUI æœªè¯†åˆ« JS æ—¶ï¼Œ JS ä¹Ÿåº”ï¼ˆSHALLï¼‰å¤„ç† Join-request æ¶ˆæ¯ã€‚</p>
<p>æ­¥éª¤ 5ï¼š</p>
<p>å¦‚æœæ”¶åˆ° JoinAns æ¶ˆæ¯æç¤ºæˆåŠŸï¼Œåˆ™ NS åº”è¯¥ï¼ˆSHALLï¼‰å°†æ¥æ”¶åˆ°çš„å…·æœ‰ Join-accept æ¶ˆæ¯çš„ PHYPayload è½¬å‘ç»™ç»ˆç«¯è®¾å¤‡ã€‚ç»ˆç«¯è®¾å¤‡åœ¨æ¥æ”¶åˆ° Join-accept æ¶ˆæ¯æ—¶åº”ï¼ˆSHALLï¼‰ç”ŸæˆåŸºäº LoRaWAN è§„èŒƒ [LW10, LW102, LW11] çš„ç½‘ç»œä¼šè¯å¯†é’¥å’Œ AppSKey ã€‚</p>
<p>æ­¥éª¤ 6ï¼š</p>
<p>å½“ NS æ”¶åˆ°ç»ˆç«¯è®¾å¤‡ä¸Šè¡Œé“¾è·¯çš„æ•°æ®åŒ…æ—¶ï¼Œ NS åº”è¯¥ï¼ˆSHALLï¼‰å‘é€å…·æœ‰åŠ å¯†çš„ AppSKey æˆ– SessionKeyID æˆ–ä¸¤è€…çš„åº”ç”¨æœ‰æ•ˆè´Ÿè½½ç»™ AS ã€‚</p>
<p>æ­¥éª¤ 7ï¼š</p>
<p>å½“ AS æ”¶åˆ°åŠ å¯†çš„ AppSKey ä»¥åŠåº”ç”¨ç¨‹åºæœ‰æ•ˆè´Ÿè½½æ—¶ï¼Œ AS åº”ï¼ˆSHALLï¼‰ä½¿ç”¨ JS å’Œ AS ä¹‹é—´å…±äº«çš„å¯†é’¥è§£å¯† AppSKey ï¼Œå¹¶ä½¿ç”¨ AppSKey è§£å¯†æ”¶åˆ°çš„æœ‰æ•ˆè´Ÿè½½ã€‚å¦‚æœ NS æœªæä¾›åŠ å¯†çš„ AppSKey ï¼Œåˆ™ AS åº”ï¼ˆSHALLï¼‰ç»§ç»­ä¸‹ä¸€æ­¥ã€‚</p>
<p>æ­¥éª¤ 8ï¼š</p>
<p>å¦‚æœ AS æƒ³è¦ç›´æ¥ä» JS æ¥æ”¶ AppSKey ,åˆ™æ‰§è¡Œæ­¤æ­¥éª¤ã€‚</p>
<p>AS åº”è¯¥ï¼ˆSHALLï¼‰è¯·æ±‚ç”±ç»ˆç«¯è®¾å¤‡çš„ DevEUI æ ‡è¯†çš„ AppSKey å’Œæ¥è‡ª JS çš„ SessionKeyID ã€‚ä½¿ç”¨ JS å’Œ AS ä¹‹é—´å…±äº«çš„å¯†é’¥åŠ å¯† AppSKey ã€‚JS å°†åŠ å¯†çš„ AppSKey ã€ DevEUI å’Œ SessionKeyID å‘é€ç»™ AS ã€‚ç„¶å AS åº”è¯¥ï¼ˆSHALLï¼‰ä½¿ç”¨ JS å’Œ AS ä¹‹é—´å…±äº«çš„å¯†é’¥è§£å¯† AppSKey ã€‚ç„¶åï¼Œ AS å¼€å§‹ä½¿ç”¨ AppSKey æ¥åŠ å¯†å’Œè§£å¯†åº”ç”¨ç¨‹åºæœ‰æ•ˆè´Ÿè½½ã€‚</p>
<p>æ— è®º NS å’Œ JS å±äºç»Ÿä¸€ç®¡ç†åŸŸè¿˜æ˜¯å®ƒä»¬å±äºä¸¤ä¸ªå•ç‹¬çš„ç®¡ç†åŸŸæ—¶ï¼Œéƒ½å¯ä»¥å¯¹å§”æ‰˜çš„ç»ˆç«¯è®¾å¤‡è¿›è¡Œ OTA æ¿€æ´»ã€‚</p>
<h2 id="9-OTA-ç»ˆç«¯è®¾å¤‡çš„åœç”¨ï¼ˆé€€å‡ºï¼‰"><a href="#9-OTA-ç»ˆç«¯è®¾å¤‡çš„åœç”¨ï¼ˆé€€å‡ºï¼‰" class="headerlink" title="9. OTA ç»ˆç«¯è®¾å¤‡çš„åœç”¨ï¼ˆé€€å‡ºï¼‰"></a>9. OTA ç»ˆç«¯è®¾å¤‡çš„åœç”¨ï¼ˆé€€å‡ºï¼‰</h2><p>OTA æ¿€æ´»çš„ç»ˆç«¯è®¾å¤‡çš„ LoRa ä¼šè¯ä¹Ÿå¯èƒ½å› å„ç§åŸå› è€Œç»ˆæ­¢ã€‚ä¾‹å¦‚ç”¨æˆ·åˆåŒåˆ°æœŸã€æ¶æ„ç»ˆç«¯è®¾å¤‡è¡Œä¸ºç­‰ã€‚ç”¨äºåœæ­¢ä¼šè¯çš„è¿‡ç¨‹æ—¶é€€å‡ºç¨‹åºï¼ˆExit Procedure)ï¼Œå®ƒæ˜¯å…¥ç½‘ç¨‹åºçš„å¯¹ç«‹éƒ¨åˆ†ï¼ˆcounter-partï¼‰ã€‚</p>
<p>æ²¡æœ‰ç”¨äºæ‰§è¡Œé€€å‡ºè¿‡ç¨‹çš„æ˜ç¡®ä¸”ä¸“ç”¨çš„ LoRaWAN ä¿¡ä»¤ã€‚å‡è®¾ç»ˆç«¯è®¾å¤‡å’Œåç«¯ä¾èµ–äºåº”ç”¨å±‚ä¿¡ä»¤æ¥æ‰§è¡Œè¯¥è¿‡ç¨‹ã€‚è§¦å‘å™¨å’Œåº”ç”¨å±‚ä¿¡ä»¤çš„å®ç°ç»†èŠ‚è¶…å‡ºæœ¬æ–‡æ¡£èŒƒå›´ã€‚</p>
<p>å½“ AS é€šçŸ¥äº† hNS æ‰§è¡Œé€€å‡ºè¿‡ç¨‹æ—¶è¿˜å­˜åœ¨å•ç‹¬çš„ sNS æ—¶ï¼Œ hNS åº”ï¼ˆSHALLï¼‰æ‰§è¡Œåˆ‡æ¢æ¼«æ¸¸åœæ­¢è¿‡ç¨‹ï¼ˆHandover Roaming Stop Procedure)ä»¥å°† LoRaWAN ä¼šè¯çš„ç»ˆæ­¢ä¼ è¾¾ç»™ sNS ã€‚</p>
<p>æˆåŠŸæ‰§è¡Œæ–°çš„å…¥ç½‘/é‡æ–°å…¥ç½‘è¿‡ç¨‹çš„ç»ˆç«¯è®¾å¤‡ä¹Ÿç»ˆæ­¢å½“å‰çš„ LoRaWAN ä¼šè¯ï¼Œå¹¶ä¸”åœ¨æŸç§ç¨‹åº¦ä¸Šï¼Œå®ƒå¯ä»¥è¢«è§†ä¸ºåœç”¨ï¼ˆDeactivationï¼‰å…³è”è¯¥ä¼šè¯ã€‚</p>
<h2 id="10-å®‰å…¨å…³è”"><a href="#10-å®‰å…¨å…³è”" class="headerlink" title="10. å®‰å…¨å…³è”"></a>10. å®‰å…¨å…³è”</h2><p>è¡¨ t1 æ˜¾ç¤º LoRaWAN éƒ¨ç½²ä½¿ç”¨çš„å®Œå…¨å…³è”ã€‚ä¸€äº›å¿…é¡»çš„å®‰å…¨å…³è”å°†åœ¨ LoRaWAN è§„èŒƒä¸­è¯¦ç»†è¯´æ˜ï¼Œæœ‰äº›åˆ™ç•™ç»™éƒ¨ç½²ã€‚</p>
<table>
<thead>
<tr>
<th>ç»ˆç‚¹ï¼ˆEnd-pointsï¼‰</th>
<th>ç±»å‹</th>
<th>æ˜¯å¦å±äº LoRa è§„èŒƒ</th>
<th>ç”¨é€”</th>
<th>ç”Ÿæˆäºï¼ˆè‹¥åŠ¨æ€ï¼‰</th>
<th>å¯†é’¥åç§°</th>
</tr>
</thead>
<tbody>
<tr>
<td>ED-JS</td>
<td>é™æ€</td>
<td>èŒƒå›´å†…</td>
<td>ä¿æŠ¤ Join/Rejoin</td>
<td>-</td>
<td>AppKey, NwkKey</td>
</tr>
<tr>
<td>ED-NS</td>
<td>åŠ¨æ€</td>
<td>èŒƒå›´å†…</td>
<td>ä¿æŠ¤ OTA å¸§é€’äº¤</td>
<td>Join è¿‡ç¨‹</td>
<td>SNwkSIntKey, FNwkSIntKey, NwkSEncKey, NwkSKey</td>
</tr>
<tr>
<td>ED-AS</td>
<td>åŠ¨æ€</td>
<td>èŒƒå›´å†…</td>
<td>ä¿æŠ¤ç«¯å¯¹ç«¯å¸§è´Ÿè½½çš„é€’äº¤</td>
<td>Join è¿‡ç¨‹</td>
<td>AppSKey</td>
</tr>
<tr>
<td>JS-NS</td>
<td>é™æ€</td>
<td>è¶…èŒƒå›´</td>
<td>ä¿æŠ¤ Join/Rejoin ä»¥åŠä¼šè¯å¯†é’¥ä¼ é€’</td>
<td>-</td>
<td>-</td>
</tr>
<tr>
<td>AS-JS</td>
<td>é™æ€</td>
<td>èŒƒå›´å†…</td>
<td>ä¿æŠ¤ AppSkey ä¼ é€’</td>
<td>-</td>
<td>ASJSKey</td>
</tr>
<tr>
<td>AS-JS</td>
<td>é™æ€</td>
<td>è¶…èŒƒå›´</td>
<td>å§”æ‰˜/é€€å½¹</td>
<td>-</td>
<td>ASJSKey</td>
</tr>
<tr>
<td>JS-Manufacturer</td>
<td>é™æ€</td>
<td>è¶…èŒƒå›´</td>
<td>ä¿æŠ¤ AppKey/NwkKey ä¼ é€’</td>
<td>-</td>
<td>-</td>
</tr>
<tr>
<td>NS-NS</td>
<td>é™æ€</td>
<td>è¶…èŒƒå›´</td>
<td>ä¿æŠ¤ Join/Rejoin ä»¥åŠ NS é—´å¸§ä¼ é€’</td>
<td>-</td>
<td>-</td>
</tr>
</tbody>
</table>
<p>t1. LoRaWAN å®‰å…¨å…³è”</p>
]]></content>
      <categories>
        <category>LoRaWAN</category>
      </categories>
      <tags>
        <tag>LoRaWAN</tag>
      </tags>
  </entry>
  <entry>
    <title>LoRaWAN Backend Interfaces v1.0 å­¦ä¹  (p1)</title>
    <url>/2019/07/10/LoRaWAN-Backend-Interfaces-v1-0-%E5%AD%A6%E4%B9%A0-p1/</url>
    <content><![CDATA[<p>æœ¬æ–‡ä¸ºå­¦ä¹  LoRaWAN åç«¯æ¥å£ v1.0 æ–‡æ¡£æ—¶ï¼Œé¡ºä¾¿ç¿»è¯‘æ‰€å¾—ã€‚æ–‡æ¡£è¾ƒé•¿ï¼Œé¢„è®¡åˆ†ä¸ºå¤šç¯‡ã€‚</p>
<p><a href="https://lora-alliance.org/resource-hub/lorawantm-back-end-interfaces-v10" target="_blank" rel="noopener">åŸæ–‡æ¡£é“¾æ¥</a></p>
<p>æœ¬éƒ¨åˆ†ä¸»è¦ä»‹ç»ç½‘ç»œå‚è€ƒæ¨¡å‹ã€‚</p>
<a id="more"></a>
<h2 id="1-ä»‹ç»"><a href="#1-ä»‹ç»" class="headerlink" title="1. ä»‹ç»"></a>1. ä»‹ç»</h2><p>è¿™ä»½æ–‡æ¡£æè¿°äº†ä»¥ä¸‹æœåŠ¡é—´çš„æ ‡å‡†æ¥å£å’Œæ•°æ®æµï¼š</p>
<ol>
<li>ç½‘ç»œæœåŠ¡å™¨ï¼ˆNetwork Severï¼‰å’Œå…¥ç½‘æœåŠ¡å™¨ï¼ˆJoin Serverï¼‰</li>
<li>å…¥ç½‘æœåŠ¡å™¨ï¼ˆJoin Serverï¼‰å’Œåº”ç”¨æœåŠ¡å™¨ï¼ˆApplication Serverï¼‰</li>
<li>æ¼«æ¸¸æµé‡è·¯ç”±çš„ä¸¤ä¸ªç½‘ç»œæœåŠ¡å™¨ï¼ˆNetwork Servers)</li>
</ol>
<p>Network Server å’Œ Application Server ä¹‹é—´çš„æ¥å£è¶…å‡ºæœ¬æ–‡æ¡£èŒƒå›´ã€‚<br>é‡ç‚¹å…³æ³¨æœ¬æ–‡æ¡£ä¸­æè¿°çš„ OTAAï¼ˆOver-the-Air Activationï¼‰åŠå•ç»ˆç«¯æ¼«æ¸¸æ—¶ï¼Œç½‘ç»œä¸­å¤šå®ä½“é—´ä¿¡æ¯æµã€‚</p>
<h2 id="2-å…¬çº¦"><a href="#2-å…¬çº¦" class="headerlink" title="2. å…¬çº¦"></a>2. å…¬çº¦</h2><p>æœ¬æ–‡ä¸­çš„å…³é”®è¯ï¼ˆâ€MUSTâ€, â€œMUST NOTâ€, â€œREQUIREDâ€, â€œSHALLâ€, â€œSHALL NOTâ€, â€œSHOULDâ€, â€œSHOULD NOTâ€, â€œRECOMMENDEDâ€, â€œMAYâ€, ä»¥åŠ â€œOPTIONALâ€ï¼‰çš„è§£é‡Šå¦‚ <a href="https://tools.ietf.org/html/rfc2119" target="_blank" rel="noopener">RFC 2119</a> åè®®æè¿°ã€‚</p>
<h2 id="3-ç½‘ç»œå‚è€ƒæ¨¡å‹ï¼ˆNetwork-Reference-Modelï¼‰"><a href="#3-ç½‘ç»œå‚è€ƒæ¨¡å‹ï¼ˆNetwork-Reference-Modelï¼‰" class="headerlink" title="3. ç½‘ç»œå‚è€ƒæ¨¡å‹ï¼ˆNetwork Reference Modelï¼‰"></a>3. ç½‘ç»œå‚è€ƒæ¨¡å‹ï¼ˆNetwork Reference Modelï¼‰</h2><p>LoRaWAN æ¶æ„ç½‘ç»œå‚è€ƒæ¨¡å‹å¦‚å›¾ f0, f1 æ‰€ç¤ºï¼š</p>
<p><img src="f0.png" alt="Figure 1 LoRaWAN Network Reference Model (NRM), End-Device at home"></p>
<p>f0. å›ºå®šç»ˆç«¯ï¼ˆEnd-Device at homeï¼‰</p>
<p><img src="f1.png" alt="Figure 2 LoRaWAN Network Reference Model (NRM), roaming End-Device"></p>
<p>f1. æ¼«æ¸¸ç»ˆç«¯ï¼ˆroaming End-Deviceï¼‰</p>
<p><strong>ç»ˆç«¯ï¼ˆEnd-Deviceï¼‰ï¼š</strong></p>
<p>ç»ˆç«¯æ˜¯ä¼ æ„Ÿå™¨æˆ–æ‰§è¡Œå™¨ã€‚å®ƒæ˜¯æ— çº¿æ–¹å¼é€šè¿‡æ— çº¿ç½‘å…³è¿å…¥ä¸€ä¸ª LoRaWAN ç½‘ç»œçš„ã€‚ç»ˆç«¯çš„åº”ç”¨å±‚è¿æ¥åˆ°äº‘ç«¯ç‰¹å®šçš„ Application Serverï¼ˆç®€ç§°ï¼šASï¼‰ã€‚è¿™ä¸ªç»ˆç«¯çš„æ‰€æœ‰åº”ç”¨å±‚è½½è·ï¼ˆpayloadsï¼‰éƒ½ä¼šè·¯ç”±åˆ°å“åº”çš„ ASã€‚</p>
<p><strong>æ— çº¿ç½‘å…³ï¼ˆRadio-Gatewayï¼‰ï¼š</strong></p>
<p>æ— çº¿ç½‘å…³ä¼ é€’æ‰€æœ‰æ¥æ”¶åˆ°çš„ LoRaWAN æ— çº¿æ•°æ®æŠ¥åˆ° Network Serverï¼ˆç®€ç§°ï¼šNSï¼‰,è¿æ¥ä½¿ç”¨ IP ç«¯å£ã€‚æ— çº¿ç½‘å…³å®Œå…¨å·¥ä½œåœ¨ç‰©ç†å±‚ã€‚å®ƒçš„èŒè´£æ˜¯ç®€å•è§£ç ä¸Šè¡Œæ— çº¿æ•°æ®æŠ¥å¹¶å°†æ•°æ®æŠ¥å®šå‘åˆ° NSã€‚ç›¸å¯¹åœ°ï¼Œä¸‹è¡Œæ—¶ï¼Œæ— çº¿ç½‘å…³ç®€å•å¤„ç†ï¼ˆä¸è§£æï¼‰ä¼ é€’ NS çš„è¯·æ±‚æŠ¥æ–‡ã€‚</p>
<p><strong>ç½‘ç»œæœåŠ¡å™¨ï¼ˆNetwork Serverï¼‰ï¼š</strong></p>
<p>NS æ˜¯ç»ˆç«¯è®¾å¤‡è¿æ¥çš„ç½‘ç»œï¼Œç»ˆæ­¢äº LoRaWAN MAC å±‚ã€‚å®ƒæ˜¯æ˜Ÿå‹æ‹“æ‰‘çš„ä¸­å¿ƒã€‚</p>
<p>NS çš„ä¸€èˆ¬ç‰¹å¾ï¼š</p>
<ul>
<li>ç»ˆç«¯åœ°å€æ£€æŸ¥</li>
<li>å¸§éªŒè¯å’Œå¸§è®¡æ•°æ£€æŸ¥</li>
<li>ç¡®è®¤ï¼ˆAcknowledgmentsï¼‰</li>
<li>æ•°æ®é€Ÿç‡é€‚åº”</li>
<li>å“åº”ç»ˆç«¯è®¾å¤‡çš„æ‰€æœ‰ MAC å±‚è¯·æ±‚</li>
<li>ä¼ é€’ä¸Šè¡Œåº”ç”¨æ•°æ®åˆ°åˆé€‚çš„ AS</li>
<li>å°†ä»»ä½• AS çš„ä¸‹è¡Œæ¶ˆæ¯æ’é˜Ÿåˆ°è¿æ¥ä¸Šç½‘ç»œçš„ä»»ä½•ç»ˆç«¯</li>
<li>åœ¨ç»ˆç«¯å’Œ Join Servers ä¹‹é—´ä¼ é€’ Join-requestï¼ˆå…¥ç½‘è¯·æ±‚ï¼‰ å’Œ Join-acceptï¼ˆå…¥ç½‘ç¡®è®¤ï¼‰</li>
</ul>
<p>åœ¨æ¼«æ¸¸æ¶æ„ä¸­ï¼Œä¸€ä¸ª NS å¯èƒ½æ‰®æ¼”ä¸‰ä¸ªä¸åŒçš„è§’è‰²ï¼Œè¿™å–å†³äºç»ˆç«¯æ˜¯å¦å¤„äºæ¼«æ¸¸åœºæ™¯ä»¥åŠæ¶‰åŠçš„æ¼«æ¸¸ç±»å‹ã€‚</p>
<p>Serving NSï¼ˆç®€ç§°ï¼šsNSï¼‰æ§åˆ¶ç»ˆç«¯çš„ MAC å±‚ã€‚</p>
<p>Home NS ï¼ˆç®€ç§°ï¼šhNSï¼‰æ˜¯è®¾å¤‡é…ç½®ï¼ˆDevice Profile)ã€æœåŠ¡é…ç½®ï¼ˆService Profileï¼‰ã€è·¯ç”±é…ç½®ï¼ˆRouting Profileï¼‰å­˜å‚¨çš„ä½ç½®ã€‚hNS å°†ç”¨äºå…¥ç½‘è¿‡ç¨‹ä¸­ç›´æ¥å…³è” Join Serverã€‚å®ƒè¿æ¥åˆ° ASã€‚å¦‚æœ hNS å’Œ sNS åˆ†ç¦»ï¼Œä»–ä»¬éµå¾ªæ¼«æ¸¸åè®®ã€‚ä¸Šä¸‹è¡Œæ•°æ®æŠ¥åœ¨ sNS å’Œ hNS é—´ä¼ é€’ã€‚</p>
<p>Forwarding NSï¼ˆç®€ç§°ï¼šfNSï¼‰ç®¡ç†ç€æ— çº¿ç½‘å…³ã€‚å½“ sNS å’Œ fNS åˆ†ç¦»ï¼Œä»–ä»¬éµå¾ªæ¼«æ¸¸åè®®ã€‚å°†æœ‰ä¸€ä¸ªæˆ–å¤šä¸ª fNS æœåŠ¡äºç»ˆç«¯è®¾å¤‡ã€‚ä¸Šä¸‹è¡Œæ•°æ®æŠ¥åœ¨ fNS å’Œ sNS é—´ä¼ é€’ã€‚</p>
<p><strong>å…¥ç½‘æœåŠ¡å™¨ï¼ˆJoin Serverï¼‰ï¼š</strong></p>
<p>Join Serverï¼ˆç®€ç§°ï¼šJSï¼‰å¤„ç†ç»ˆç«¯è®¾å¤‡çš„ OTAï¼ˆOver-the-Airï¼‰æ¿€æ´»æµç¨‹ã€‚å¯èƒ½æœ‰è®¸å¤š JS è¿æ¥åˆ°ä¸€ä¸ª NSï¼Œä¸”ä¸€ä¸ª JS å¯èƒ½è¿æ¥å¤šä¸ª NSã€‚</p>
<p>ç»ˆç«¯è®¾å¤‡é€šè¿‡ Join-request æ¶ˆæ¯ä¸­çš„ JoinEUI å­—æ®µå‘ä¿¡å·é€šçŸ¥ JSã€‚æ¯ä¸ª JS è¢«å”¯ä¸€ JoinEUI å€¼æ ‡è¯†ã€‚ï¼ˆæ³¨æ„ï¼šAppEUI å­˜åœ¨äº LoRaWAN1.0/1.0.2ï¼ˆLW10ï¼ŒLW102ï¼‰ çš„ Join-request ä¸­ï¼Œè¢«é‡å‘½åæœª LoRaWAN1.1ï¼ˆLW11ï¼‰ ä¸­çš„ JoinEUI ã€‚æœ¯è¯­ JoinEUI è¢«ç”¨äºæŒ‡ä»£è¯¥è§„èŒƒä¸­ LW10/LW102 ç»ˆç«¯è®¾å¤‡ä¸Šä¸‹æ–‡ä¸­çš„ AppEUI ã€‚</p>
<p>JS çŸ¥é“ç»ˆç«¯è®¾å¤‡çš„ hNS æ ‡è¯†ç¬¦ï¼Œå¹¶åœ¨æ¼«æ¸¸è¿‡ç¨‹ä¸­å°†æ‰€éœ€ä¿¡æ¯æä¾›ç»™å…¶ä»– NSã€‚<br>JS åŒ…å«æ‰€éœ€ä¿¡æ¯å¤„ç†ä¸Šè¡Œå…¥ç½‘è¯·æ±‚å¸§å¹¶ä¸”ç”Ÿæˆä¸‹è¡Œå…¥ç½‘ç¡®è®¤å¸§ã€‚å®ƒä¹Ÿæ‰§è¡Œç½‘ç»œå’Œåº”ç”¨ç¨‹åºä¼šè¯å¯†é’¥ï¼ˆsession keyï¼‰çš„æ´¾ç”Ÿã€‚å®ƒå°†ç»ˆç«¯è®¾å¤‡çš„ç½‘ç»œå¯†é’¥ä¼ é€åˆ° NS ï¼Œå°†åº”ç”¨ä¼šè¯å¯†é’¥ä¼ é€ç»™ç›¸åº”çš„åº”ç”¨æœåŠ¡å™¨ã€‚</p>
<p>ä¸ºæ­¤ï¼ŒJS åº”è¯¥ï¼ˆSHALLï¼‰åŒ…å«å…¶æ§åˆ¶ä¸‹çš„æ¯ä¸ªç»ˆç«¯è®¾å¤‡çš„å¦‚ä¸‹ä¿¡æ¯ï¼š</p>
<ul>
<li>DevEUI</li>
<li>AppKey</li>
<li>NwkKeyï¼ˆä»…é€‚ç”¨äº LW11 ç»ˆç«¯è®¾å¤‡ï¼‰</li>
<li>hNS æ ‡è¯†</li>
<li>AS æ ‡è¯†</li>
<li>ä¸€ç§é¦–é€‰ç½‘ç»œçš„æ–¹æ³•ï¼Œä»¥é˜²å¤šä¸ªç½‘ç»œå¯ä»¥ä¸ºç»ˆç«¯æä¾›æœåŠ¡</li>
<li>ç»ˆç«¯è®¾å¤‡ LoRaWAN ç‰ˆæœ¬ï¼ˆLoRaWAN 1.0ï¼Œ1.0.2 æˆ– 1.1ï¼‰</li>
</ul>
<p>æ ¹å¯†é’¥ï¼ˆroot keyï¼‰ NwkKey å’Œ AppKey ä»…å¯ç”¨äº JS å’Œç»ˆç«¯è®¾å¤‡ï¼Œä»–ä»¬ä¸ä¼šè¢«å‘é€åˆ° NS æˆ– AS ã€‚</p>
<p>å®‰å…¨é…ç½®ï¼ˆsecure provisioningï¼‰ï¼Œå­˜å‚¨å’Œä½¿ç”¨æ ¹å¯†é’¥ NwkKey å’Œ AppKey åœ¨ç»ˆç«¯è®¾å¤‡å’Œåç«¯æ˜¯è§£å†³æ–¹æ¡ˆæ•´ä½“å®‰å…¨æ€§çš„å†…åœ¨è¦ç´ ã€‚è¿™äº›ç•™å¾…å®æ–½ä¸”è¶…å‡ºæœ¬æ–‡æ¡£çš„èŒƒç•´ã€‚ç„¶è€Œï¼Œè¯¥è§£å†³æ–¹æ¡ˆå¯åŒ…æ‹¬ SE ï¼ˆSecure Elements å®‰å…¨è¦ç´ ï¼‰ å’Œ HSM ï¼ˆHardware Security Modules ç¡¬ä»¶å®‰å…¨æ¨¡å—ï¼‰ã€‚</p>
<p>è¿™äº›ä¿¡æ¯å®é™…å¦‚ä½•ç¼–ç¨‹åˆ° JS ä¸­è¶…å‡ºæœ¬æ–‡æ¡£èŒƒå›´ï¼Œå¯èƒ½å›  JS è€Œå¼‚ã€‚è¿™å¯ä»¥é€šè¿‡ä¾‹å¦‚é—¨æˆ·ç½‘ç«™æˆ–è€…ä¸€ç»„ API æ¥å®ç°ã€‚</p>
<p>JS å’Œ NS åº”è¯¥ï¼ˆSHALLï¼‰åº”è¯¥èƒ½å¤Ÿå»ºç«‹å®‰å…¨é€šä¿¡ï¼Œæä¾›ç«¯ç‚¹èº«ä»½éªŒè¯ï¼ˆend-point authenticationï¼‰ï¼Œå®Œæ•´æ€§ï¼ˆintegrityï¼‰å’Œé‡æ”¾ä¿æŠ¤ï¼ˆreplay protectionï¼‰ä»¥åŠæœºå¯†æ€§ï¼ˆconfidentialityï¼‰ã€‚JS è¿˜åº”è¯¥ï¼ˆSHALLï¼‰èƒ½å¤Ÿå®‰å…¨åœ°ä¼ é€’åº”ç”¨ä¼šè¯å¯†é’¥ï¼ˆAppSKeyï¼‰ç»™ AS ã€‚</p>
<p>JS å¯ä»¥è¿æ¥åˆ°å¤šä¸ª ASï¼Œä¸€ä¸ª AS å¯ä»¥è¿æ¥åˆ°å¤šä¸ª JS ã€‚</p>
<p>JS å’Œ AS åº”è¯¥ï¼ˆSHALLï¼‰èƒ½å»ºç«‹å®‰å…¨é€šä¿¡ï¼Œæä¾›ç«¯ç‚¹èº«ä»½éªŒè¯ï¼ˆend-point authenticationï¼‰ï¼Œå®Œæ•´æ€§ï¼ˆintegrityï¼‰å’Œé‡æ”¾ä¿æŠ¤ï¼ˆreplay protectionï¼‰ä»¥åŠæœºå¯†æ€§ï¼ˆconfidentialityï¼‰ã€‚</p>
<p><strong>åº”ç”¨æœåŠ¡å™¨ï¼ˆApplication Serverï¼‰ï¼š</strong></p>
<p>AS å¤„ç†ç›¸å…³ç»ˆç«¯è®¾å¤‡åœ°æ‰€æœ‰åº”ç”¨å±‚æœ‰æ•ˆè´Ÿè½½ï¼ˆpayloadï¼‰ï¼Œå¹¶ä¸ºæœ€ç»ˆç”¨æˆ·æä¾›åº”ç”¨çº§æœåŠ¡ã€‚å®ƒè¿˜ä¸ºè¿æ¥çš„ç»ˆç«¯è®¾å¤‡ç”Ÿæˆæ‰€æœ‰åº”ç”¨å±‚ä¸‹è¡Œé“¾è·¯æœ‰æ•ˆè½½è·ã€‚</p>
<p>å¯ä»¥æœ‰å¤šä¸ª AS è¿æ¥åˆ°ä¸€ä¸ª NS ï¼Œä¹Ÿå¯ä»¥ä¸€ä¸ª AS è¿æ¥åˆ°è®¸å¤š NSï¼ˆä¾‹å¦‚é€šè¿‡å¤šå±‚ç½‘ç»œæ“ä½œç»ˆç«¯ï¼‰ã€‚ä¸€ä¸ª AS ä¹Ÿå¯ä»¥è¿æ¥å¤šä¸ª JS ã€‚</p>
<p>hNS åŸºäº DevEUI è·¯ç”±ä¸Šè¡Œé“¾è·¯åˆ°åˆé€‚çš„ AS ã€‚</p>
<p>é™¤äº†å‰è¿°çš„ç½‘ç»œå…ƒç´ å¤–ï¼ŒLoRaWAN æ¶æ„è¿˜åœ¨è¿™äº›å®ä½“é—´å®šä¹‰äº†ä»¥ä¸‹ç½‘ç»œæ¥å£ï¼š</p>
<p>hNS-JSï¼šæ­¤æ¥å£ç”¨äºæ”¯æŒ JS å’Œ NS ä¹‹é—´çš„å…¥ç½‘ï¼ˆæ¿€æ´»ï¼‰è¿‡ç¨‹ã€‚</p>
<p>vNS-JSï¼šæ­¤æ¥å£ç”¨äºæ¼«æ¸¸æ¿€æ´»è¿‡ç¨‹ã€‚å®ƒç”¨äºæ£€ç´¢äºç»ˆç«¯è®¾å¤‡å…³è”çš„ hNS å’Œ NetID ã€‚</p>
<p>ED-NSï¼šæ­¤æ¥å£ç”¨äºæ”¯æŒç»ˆç«¯è®¾å¤‡å’Œ NS ä¹‹é—´çš„ LoRaWAN MAC å±‚ä¿¡ä»¤å’Œæœ‰æ•ˆè½½è·ä¼ é€ã€‚</p>
<p>AS-hNSï¼šæ­¤æ¥å£ç”¨äºæ”¯æŒåº”ç”¨ç¨‹åºæœ‰æ•ˆè½½è·çš„ä¼ é€ä»¥åŠåœ¨ AS å’Œ NS ä¹‹é—´å…³è”å…ƒæ•°æ®ï¼ˆmeta-dataï¼‰ã€‚</p>
<p>hNS-sNSï¼šæ­¤æ¥å£ç”¨äºæ”¯æŒ hNS å’Œ sNS ä¹‹é—´çš„æ¼«æ¸¸ä¿¡ä»¤å’Œæœ‰æ•ˆè½½è·ä¼ é€’ã€‚</p>
<p>sNS-fNSï¼šæ­¤æ¥å£ç”¨äºæ”¯æŒ sNS å’Œ fNS ä¹‹é—´çš„æ¼«æ¸¸ä¿¡ä»¤å’Œæœ‰æ•ˆè½½è·ä¼ é€’ã€‚</p>
<p>AS-JSï¼šæ­¤æ¥å£ç”¨äºå°†åº”ç”¨ä¼šè¯å¯†é’¥ï¼ˆAppSKeyï¼‰ä» JS ä¼ é€åˆ° AS ã€‚</p>
]]></content>
      <categories>
        <category>LoRaWAN</category>
      </categories>
      <tags>
        <tag>LoRaWAN</tag>
      </tags>
  </entry>
  <entry>
    <title>éƒ¨ç½² goproxy æœåŠ¡</title>
    <url>/2019/06/26/setup-private-goproxy-server/</url>
    <content><![CDATA[<p>ä¸Šä¸€ç¯‡å·²ç»å®è·µäº†åœ¨ç§ç½‘ç¯å¢ƒä¸­é…ç½®è‡ªç­¾åçš„è¯ä¹¦ï¼Œå¹¶å¼€å¯ httpsã€‚</p>
<p>è¿™ä¸€åˆ‡éƒ½æ˜¯ä¸ºäº†èƒ½åœ¨ç§ç½‘ä¸­æ­å»ºä¸€ä¸ªæ–¹ä¾¿å¯ç”¨çš„ Go é›†æˆç¯å¢ƒã€‚</p>
<p>Go åœ¨ 1.11 ç‰ˆæœ¬æ·»åŠ äº† Go Module ç‰¹æ€§ï¼Œæˆä¸ºå®˜æ–¹æ¨èçš„åŒ…ç®¡ç†æ–¹å¼ã€‚<br><a href="https://github.com/golang/go/wiki/Modules" target="_blank" rel="noopener">è¯¦æƒ…è§å®˜æ–¹ wiki</a></p>
<p>ä¸ go mod åŒæ—¶åˆ°æ¥çš„è¿˜æœ‰ goproxy ï¼Œå…è®¸ä½¿ç”¨ä»£ç†çš„æ–¹å¼æ‹‰å–ä¾èµ–åŒ…ã€‚</p>
<a id="more"></a>
<h2 id="ä»‹ç»"><a href="#ä»‹ç»" class="headerlink" title="ä»‹ç»"></a>ä»‹ç»</h2><p>goproxy è§£å†³äº†å‡ ä¸ªé•¿æœŸå­˜åœ¨çš„é—®é¢˜ï¼š</p>
<ol>
<li>å›½å†…ç½‘ç»œç¯å¢ƒä¸‹ä» github æ‹‰å»ä¾èµ–åŒ…é€Ÿåº¦å¾ˆæ…¢</li>
<li>å¦‚æœå¼€æºä½œè€…åˆ é™¤äº†ä»“åº“ï¼Œå¯¹åº”ä¾èµ–åŒ…å°±æ— æ³•æ‰¾åˆ°</li>
</ol>
<p>goproxy ä»£ç†æœåŠ¡ä¼šç¼“å­˜ä¾èµ–åŒ…ç‰ˆæœ¬ï¼Œä¸éœ€è¦é‡å¤ä¸‹è½½ï¼Œä¹Ÿä¸éœ€è¦æ‹…å¿ƒåŸåº“è¢«åˆ é™¤ã€‚</p>
<p>æœ‰è®¸å¤šå¼€æ”¾çš„ä»£ç†æœåŠ¡ï¼Œæ¯”å¦‚æˆ‘å¸¸ç”¨çš„æ˜¯ <a href="https://goproxy.io" target="_blank" rel="noopener">https://goproxy.io</a></p>
<p>åªéœ€è¦è®¾ç½®ç¯å¢ƒå˜é‡ <code>GOPROXY=https://goproxy.io</code> å°±èƒ½äº«å—ä»£ç†çš„å¿«æ·ã€‚</p>
<p>ä½†æ˜¯å…¬å¼€çš„ goproxy æœåŠ¡ä»…å¯ä»¥è®¿é—®å…¬å¼€çš„ä»“åº“ï¼Œå¯¹äºç§æœ‰é¡¹ç›®æˆ–è€…<br>ç§ç½‘ç¯å¢ƒï¼Œå’±ä»¬è¿˜å¾—è‡ªå·±å»ºã€‚</p>
<h2 id="é€‰å‹"><a href="#é€‰å‹" class="headerlink" title="é€‰å‹"></a>é€‰å‹</h2><p>æœ‰å‡ æ¬¾ä¸é”™çš„ goproxy é¡¹ç›®</p>
<ul>
<li><p><a href="https://github.com/gomods/athens" target="_blank" rel="noopener">gomods/athens</a></p>
</li>
<li><p><a href="https://github.com/goproxyio/goproxy" target="_blank" rel="noopener">goproxyio/goproxy</a></p>
</li>
<li><p><a href="https://github.com/goproxy/goproxy.cn" target="_blank" rel="noopener">goproxy/goproxy.cn</a></p>
</li>
</ul>
<p>è™½ç„¶ <code>athens</code> star æ•°æœ€å¤šï¼Œé…ç½®æ–‡ä»¶å¾ˆçµæ´»å¯é…é¡¹å¾ˆå¤šï¼Œä½†æ˜¯æˆ‘è§‰å¾—å®ƒå¾ˆé•¿ä¸€æ®µæ—¶é—´éƒ½ä¼šæ˜¯ beta çŠ¶æ€ï¼Œæˆ‘è‡ªå·±éƒ¨ç½²ä¹Ÿä¸éœ€è¦å¤ªå¤šå®šåˆ¶åŒ–ã€‚</p>
<p>æˆ‘æœ€åé€‰æ‹©äº† <code>goproxyio</code> çš„é¡¹ç›®ï¼Œä»£ç ä¸å¤šï¼Œä¹Ÿå¾ˆç¨³å®šã€‚</p>
<h2 id="ç¼–è¯‘"><a href="#ç¼–è¯‘" class="headerlink" title="ç¼–è¯‘"></a>ç¼–è¯‘</h2><p>goproxyio å‘å¸ƒäº† docker é•œåƒï¼Œå¯ä»¥å¾ˆæ–¹ä¾¿åœ°ä½¿ç”¨ docker éƒ¨ç½² goproxyã€‚</p>
<p>è¿™é‡Œæˆ‘ä»¬è®²ä¸€ä¸‹æºç ç¼–è¯‘ã€‚å…¶å®ä¹Ÿæ˜¯ç›¸å½“ç®€å•ï¼ŒæŒ‰ç…§ README æ–‡æ¡£ï¼Œä¸€æ¡å‘½ä»¤æå®šã€‚</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">make</span><br></pre></td></tr></table></figure>
<blockquote>
<p>å½“ç„¶ä½ å…ˆè¦è£…å¥½ <code>go</code> å’Œ <code>make</code></p>
</blockquote>
<p>linux ä¸‹ç¼–è¯‘å®Œæˆåå°±å‡ºç°äº† goproxy æ‰§è¡Œæ–‡ä»¶ã€‚</p>
<h2 id="éƒ¨ç½²"><a href="#éƒ¨ç½²" class="headerlink" title="éƒ¨ç½²"></a>éƒ¨ç½²</h2><blockquote>
<p>æ–°ç‰ˆ <code>goproxy</code> éœ€è¦è°ƒç”¨ <code>go mod</code> å‘½ä»¤ï¼Œæ‰€ä»¥éƒ¨ç½²ç¯å¢ƒè¦å®‰è£… <code>go 1.12</code> ï¼ˆ1.12 ç‰ˆæœ¬ä»¥åæ”¯æŒåœ¨ä»»æ„ç›®å½•è°ƒç”¨ <code>go mod download</code> å‘½ä»¤ï¼‰ã€‚</p>
</blockquote>
<p>ä¸Šä¼  goproxy æ‰§è¡Œæ–‡ä»¶åˆ° linux ä¸»æœºä¸Šï¼Œæ”¾åœ¨ä»»æ„ç›®å½•ä¸‹ã€‚</p>
<p>ç›´æ¥ <code>./goproxy</code> è¿è¡Œï¼Œä¼šåœ¨ <code>8081</code> ç«¯å£ä¸Šå¼€å¯ä»£ç†æœåŠ¡ï¼Œç„¶åæœ¬åœ°å¼€å‘ç¯å¢ƒï¼Œé…ç½® GOPROXY ç¯å¢ƒå˜é‡ã€‚</p>
<blockquote>
<p>å‡è®¾å†…ç½‘ linux ä¸»æœº ip åœ°å€æ˜¯ 10.0.0.1ï¼Œè¯·è‡ªè¡Œæ›¿æ¢ ip åœ°å€ã€‚</p>
</blockquote>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="built_in">export</span> GOPROXY=http://10.0.0.1:8081</span><br></pre></td></tr></table></figure>
<p>å†ä»»æ„ go mod ç®¡ç†åœ°é¡¹ç›®ä¸‹æ‰§è¡Œ go get ï¼Œä½ å°±èƒ½çœ‹åˆ° goproxy æœåŠ¡ä»£ä½ è¯·æ±‚äº†ç›®æ ‡åœ°å€ã€‚</p>
<p>å¦‚æœä½ é…ç½®äº† GOPATH ç¯å¢ƒå˜é‡ï¼Œ goproxy æœåŠ¡å°±ä¼šç¼“å­˜åˆ° <code>$GOPATH/pkg/mod</code> ä¸‹ã€‚</p>
<p>å¦‚æœä½ ä¸æ„¿æ„è®¾ç½® GOPATH ç¯å¢ƒå˜é‡ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ <code>-cacheDir</code> å‚æ•°æŒ‡å®šç¼“å­˜ç›®å½•ã€‚</p>
<p>å¦‚æœä½ ä¸æƒ³ä½¿ç”¨ <code>8081</code> ç«¯å£ï¼Œå¯ä»¥ä½¿ç”¨ <code>-listen</code> å‚æ•°æŒ‡å®šæ–°çš„ç«¯å£ã€‚</p>
<p>æœ¬åœ°ç½‘ç»œä¸å¥½å¸Œæœ›åŠ ä¸€ä¸ªå…¬å…± goproxy ä½œä»£ç†è½¬å‘ï¼Œé‚£ä¹ˆè®¾ç½® <code>-proxy</code>ã€‚</p>
<p>å‡è®¾ç§æœ‰ä»“åº“åœ°å€ <code>cvs.private.com</code> ä¸å¸Œæœ›èµ°ä»£ç†ï¼Œé‚£ä¹ˆè®¾ç½® <code>-exclude</code>ï¼Œé…ç½®åŸŸåæˆ–è€…å®Œæ•´ä»“åº“è·¯å¾„ã€‚</p>
<p>æ›´å¤šä½¿ç”¨è¯´æ˜è§ <code>./goproxy -h</code>ã€‚</p>
<h2 id="è¿›ç¨‹ç®¡ç†"><a href="#è¿›ç¨‹ç®¡ç†" class="headerlink" title="è¿›ç¨‹ç®¡ç†"></a>è¿›ç¨‹ç®¡ç†</h2><p>ä»…ä»… nohup çš„æ–¹å¼å¯åŠ¨ goproxy æœåŠ¡å¤ª low äº†ï¼Œå’±ä»¬ä½¿ç”¨ systemd ç®¡ç†ã€‚</p>
<blockquote>
<p>è·¯ç”±æ¨¡å¼ä¾èµ– <code>go mod -m</code> å‘½ä»¤éœ€è¦æ‰§è¡Œç›®å½•æ˜¯ <code>go mod</code> ç›®å½•ï¼Œæ‰€ä»¥æ— æ³•ä½¿ç”¨ systemd ç®¡ç†ã€‚</p>
</blockquote>
<p><del>ç¼–å†™ä¸€ä¸ª <code>goproxy.service</code> æ–‡ä»¶</del><br>é¡¹ç›®æºç ç›®å½•ä¸‹ scripts ä¸‹æœ‰ service é…ç½®æ–‡ä»¶ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨ã€‚</p>
<blockquote>
<p>ä¸€å®šè¦é…ç½® <code>Environment</code> ã€‚</p>
</blockquote>
<details><br><summary>æ”¾åˆ° <code>/etc/systemd/system/</code> ç›®å½•ä¸‹</summary><br><br>&gt; å‡è®¾ç¨‹åºåœ¨ <code>/root/goproxy/goproxy</code>ï¼Œ è¯·è‡ªè¡Œæ›¿æ¢å¯åŠ¨æ–‡ä»¶è·¯å¾„ã€‚<br><br><figure class="highlight ini"><table><tr><td class="code"><pre><span class="line"><span class="section">[Unit]</span></span><br><span class="line"><span class="attr">Description</span>=goproxy service</span><br><span class="line"><span class="attr">Documentation</span>=https://goproxy.io</span><br><span class="line"><span class="attr">After</span>=network-<span class="literal">on</span>line.target</span><br><span class="line"></span><br><span class="line"><span class="section">[Service]</span></span><br><span class="line"><span class="attr">Environment</span>=PATH=/usr/local/go/bin</span><br><span class="line"><span class="attr">User</span>=root</span><br><span class="line"><span class="attr">Group</span>=root</span><br><span class="line"><span class="attr">LimitNOFILE</span>=<span class="number">65536</span></span><br><span class="line"><span class="attr">ExecStart</span>=/root/goproxy/goproxy -cacheDir=/root/go -proxy=https://goproxy.io -exclude=<span class="string">"*.private.com"</span></span><br><span class="line"><span class="attr">KillMode</span>=control-group</span><br><span class="line"><span class="attr">SuccessExitStatus</span>=<span class="number">2</span></span><br><span class="line"><span class="attr">Restart</span>=always</span><br><span class="line"></span><br><span class="line"><span class="section">[Install]</span></span><br><span class="line"><span class="attr">WantedBy</span>=multi-user.target</span><br><span class="line"><span class="attr">Alias</span>=goproxy.service</span><br></pre></td></tr></table></figure><br><br></details>

<p>å…³äºå¦‚ä½•ç¼–å†™ service æ–‡ä»¶ï¼Œæˆ‘æ¨èä¸€ç¯‡ä¸é”™åœ°<a href="https://www.digitalocean.com/community/tutorials/how-to-use-systemctl-to-manage-systemd-services-and-units" target="_blank" rel="noopener">æ•™ç¨‹</a></p>
<p>æœ€åå¯åŠ¨æœåŠ¡</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># å¯åŠ¨æœåŠ¡</span></span><br><span class="line">sudo systemctl start goproxy</span><br><span class="line"></span><br><span class="line"><span class="comment"># ï¼ˆå¯é€‰ï¼‰å¼€å¯è‡ªå¯</span></span><br><span class="line">sudo systemctl <span class="built_in">enable</span> goproxy</span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥çœ‹çŠ¶æ€</span></span><br><span class="line">sudo systemctl status goproxy</span><br></pre></td></tr></table></figure>
<h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><ul>
<li><p><a href="https://github.com/goproxyio/goproxy" target="_blank" rel="noopener">goproxy.io</a></p>
</li>
<li><p><a href="https://www.digitalocean.com/community/tutorials/how-to-use-systemctl-to-manage-systemd-services-and-units" target="_blank" rel="noopener">How To Use Systemctl to Manage Systemd Services and Units</a></p>
</li>
</ul>
]]></content>
      <tags>
        <tag>Go</tag>
        <tag>GOPROXY</tag>
      </tags>
  </entry>
  <entry>
    <title>ç§ç½‘ç¯å¢ƒå¯ç”¨ https</title>
    <url>/2019/06/26/enable-https-for-private-network/</url>
    <content><![CDATA[<p>æœ¬æ–‡æ˜¯æ­å»ºç§ç½‘ç¯å¢ƒä¸‹çš„ go è‡ªåŠ¨é›†æˆç¯å¢ƒçš„ä¸€éƒ¨åˆ†ã€‚</p>
<p>go é¡¹ç›®ä½¿ç”¨ go mod ä½œä¾èµ–åŒ…ç®¡ç†ï¼Œé‡åˆ°ä¸€äº›é—®é¢˜ã€‚<br>å¯¹äºä¾èµ–åº“æ˜¯ä¿å­˜åœ¨å†…ç½‘ä»“åº“çš„æƒ…å†µï¼Œæ‹‰å–ä»£ç ä¼šå¤±è´¥ï¼ŒåŸå› æ˜¯ go mod è·å–<br>ä¾èµ–åŒ…ç‰ˆæœ¬éœ€è¦ä½¿ç”¨ https è¯·æ±‚ï¼Œè€Œè‡ªå»ºçš„ git æœåŠ¡æ²¡æœ‰å¯ç”¨ https ã€‚</p>
<p>å¦‚æœæ˜¯ä¼ ç»Ÿçš„ gopath ä¾èµ–é¡¹ç›®ï¼Œ åªéœ€è¦ go get -insecure å³å¯ç»•è¿‡ https é™åˆ¶ï¼Œ<br>ä½†æ˜¯è¿™é‡Œæˆ‘ä»¬é€‰æ‹©ç”¨ go mod ï¼Œä¸€æ–¹é¢è¿™æ˜¯ go å®˜æ–¹æ¨èçš„æ–¹å¼ï¼Œä¹Ÿæ˜¯æœªæ¥çš„å‘å±•è¶‹åŠ¿ï¼Œ<br>å¦ä¸€æ–¹é¢æ˜¯ä¸å¸Œæœ›ä¾èµ–åŒ…æ”¾åœ¨ vendor ç›®å½•ä¸‹ä¸€èµ·æäº¤åˆ°ç‰ˆæœ¬åº“é€ æˆæºç ç›®å½•è¿‡äºåºå¤§ã€‚</p>
<p>æ¥ä¸‹æ¥è®²ä¸€è®²å¦‚ä½•åœ¨ç§ç½‘ä¸­å¯ç”¨ httpsï¼Œ æœåŠ¡ç«¯ç³»ç»Ÿä»¥ CentOS7 ä¸ºä¾‹ã€‚</p>
<a id="more"></a>
<h2 id="ç¯å¢ƒå‡†å¤‡"><a href="#ç¯å¢ƒå‡†å¤‡" class="headerlink" title="ç¯å¢ƒå‡†å¤‡"></a>ç¯å¢ƒå‡†å¤‡</h2><p>ä¸ºäº†è¾¾åˆ°å®éªŒç›®çš„ï¼Œå…ˆä¿®æ”¹æœ¬åœ°æœºå™¨çš„ host æ–‡ä»¶ã€‚</p>
<p>web æœåŠ¡è¿è¡Œåœ¨ 192.168.20.44 çš„å±€åŸŸç½‘ IP çš„ä¸»æœºä¸Š<br>æ·»åŠ ä¸€æ¡è™šæ‹Ÿçš„åŸŸåæ˜ å°„åˆ°è¿™ä¸ª IP ã€‚</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">192.168.20.44 vcs.private.org</span><br></pre></td></tr></table></figure>
<h2 id="åˆ›å»º-SSL-è¯ä¹¦"><a href="#åˆ›å»º-SSL-è¯ä¹¦" class="headerlink" title="åˆ›å»º SSL è¯ä¹¦"></a>åˆ›å»º SSL è¯ä¹¦</h2><h3 id="åˆ›å»ºç›®å½•"><a href="#åˆ›å»ºç›®å½•" class="headerlink" title="åˆ›å»ºç›®å½•"></a>åˆ›å»ºç›®å½•</h3><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># åˆ›å»ºç›®å½•ç”¨äºä¿å­˜å…¬å…±è¯ä¹¦</span></span><br><span class="line">sudo mkdir /etc/ssl/certs</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ›å»ºç›®å½•ç”¨äºä¿å­˜ç§é’¥æ–‡ä»¶</span></span><br><span class="line">sudo mkdir /etc/ssl/private</span><br><span class="line"></span><br><span class="line"><span class="comment"># å…³é”®ç›®å½•ï¼Œè®¾ç½®è®¿é—®æƒé™</span></span><br><span class="line">sudo chmod 700 /etc/ssl/private</span><br></pre></td></tr></table></figure>
<h3 id="åˆ›å»ºè‡ªç­¾åå¯†é’¥è¯ä¹¦å¯¹"><a href="#åˆ›å»ºè‡ªç­¾åå¯†é’¥è¯ä¹¦å¯¹" class="headerlink" title="åˆ›å»ºè‡ªç­¾åå¯†é’¥è¯ä¹¦å¯¹"></a>åˆ›å»ºè‡ªç­¾åå¯†é’¥è¯ä¹¦å¯¹</h3><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">sudo openssl req -x509 -nodes -days 365 \</span><br><span class="line">    -newkey rsa:2048 -keyout /etc/ssl/private/selfsigned.key \</span><br><span class="line">    -out /etc/ssl/certs/selfsigned.crt</span><br></pre></td></tr></table></figure>
<h3 id="å‘½ä»¤å‚æ•°è§£é‡Š"><a href="#å‘½ä»¤å‚æ•°è§£é‡Š" class="headerlink" title="å‘½ä»¤å‚æ•°è§£é‡Š"></a>å‘½ä»¤å‚æ•°è§£é‡Š</h3><p><code>openssl</code> ç”¨äºåˆ›å»ºå’Œç®¡ç†OpenSSLè¯ä¹¦ï¼Œå¯†é’¥å’Œå…¶ä»–æ–‡ä»¶çš„åŸºæœ¬å‘½ä»¤è¡Œå·¥å…·ã€‚</p>
<p><code>req -x509</code> è¡¨ç¤ºæˆ‘ä»¬æƒ³è¦ä½¿ç”¨ X.509 è¯ä¹¦ç­¾åè¯·æ±‚ï¼ˆCSRï¼Œcertificate signing requestï¼‰ç”Ÿæˆç­¾åè¯ä¹¦ã€‚</p>
<p><code>-nodes</code> è·³è¿‡ç”¨å¯†ç ä¿æŠ¤è¯ä¹¦çš„é€‰é¡¹ã€‚</p>
<p><code>-days 365</code> æœ‰æ•ˆæœŸ 365 å¤©ã€‚</p>
<p><code>-newkey rsa:2048</code> åŒæ—¶ç”Ÿæˆæ–°è¯ä¹¦å’Œæ–°å¯†é’¥ï¼Œç”Ÿæˆ 2048 ä½çš„ RSA å¯†é’¥ã€‚</p>
<p><code>-keyout</code> å¯†é’¥è¾“å‡ºç›®å½•ã€‚</p>
<p><code>-out</code> è¯ä¹¦è¾“å‡ºç›®å½•ã€‚</p>
<p>æ¥ä¸‹æ¥ä¼šè¢«è¦æ±‚å¡«å†™ä¸€äº›è¯ä¹¦çš„åŸºæœ¬ä¿¡æ¯ï¼Œéœ€è¦æ³¨æ„çš„ä¸€ç‚¹æ˜¯<br><code>CommonName</code> è¦å¡«å†™æœåŠ¡ç›¸å…³çš„åŸŸåæˆ–è€…å…¬å…± IP åœ°å€ã€‚<br>æ­¤å¤„å’±ä»¬å¡«å†™ <code>vcs.private.org</code></p>
<details><br><br><summary>è¿˜å¯ä»¥ä¸€æ¡å‘½ä»¤å®Œæˆ</summary><br><br><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">sudo openssl req -x509 -nodes -days 365 \</span><br><span class="line">    -subj <span class="string">"/C=CN/ST=ZJ/L=HZ/O=private.org/CN=vcs.private.org"</span> \</span><br><span class="line">    -newkey rsa:2048 -keyout /etc/ssl/private/selfsigned.key \</span><br><span class="line">    -out /etc/ssl/certs/selfsigned.crt</span><br></pre></td></tr></table></figure><br><br></details>

<h3 id="åˆ›å»º-Diffie-Hellman-ç»„"><a href="#åˆ›å»º-Diffie-Hellman-ç»„" class="headerlink" title="åˆ›å»º Diffie-Hellman ç»„"></a>åˆ›å»º Diffie-Hellman ç»„</h3><p>æ®è¯´ç”¨äºä¸å®¢æˆ·ç«¯åå•† PFS (<a href="https://en.wikipedia.org/wiki/Forward_secrecy" target="_blank" rel="noopener">Perfect Forward Secrecy</a>)ï¼Œèƒ½åœ¨ç§é’¥å—æŸçš„æƒ…å†µä¸‹ä¿è¯ä¼šè¯å¯†é’¥ä¸å—æŸå®³ã€‚</p>
<p>åˆ›å»ºè¦å‡ åç§’ï¼Œéœ€è¦ç¨å¾®ç­‰ä¸€ä¸‹ã€‚</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">sudo openssl dhparam -out /etc/ssl/certs/dhparam.pem 2048</span><br></pre></td></tr></table></figure>
<blockquote>
<p>è¿™ä¸ª DH ç»„åˆ°åº•æœ‰å¤šå¼ºå¤§å‘¢ï¼Œç­‰æˆ‘å­¦ä¹ åå†æ€»ç»“ä¸‹â€¦â€¦ Orz</p>
</blockquote>
<h2 id="é…ç½®-Nginx-ä½¿ç”¨-SSL"><a href="#é…ç½®-Nginx-ä½¿ç”¨-SSL" class="headerlink" title="é…ç½® Nginx ä½¿ç”¨ SSL"></a>é…ç½® Nginx ä½¿ç”¨ SSL</h2><h3 id="å®‰è£…-Nginx"><a href="#å®‰è£…-Nginx" class="headerlink" title="å®‰è£… Nginx"></a>å®‰è£… Nginx</h3><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># å¯ç”¨ EPEL åº“</span></span><br><span class="line">sudo yum install epel-release</span><br><span class="line"><span class="comment"># å®‰è£…</span></span><br><span class="line">sudo yum install nginx</span><br><span class="line"><span class="comment"># å¼€å¯</span></span><br><span class="line">sudo systemctl start nginx</span><br><span class="line"><span class="comment"># æ£€æŸ¥çŠ¶æ€</span></span><br><span class="line">systemctl status nginx</span><br></pre></td></tr></table></figure>
<h3 id="é˜²ç«å¢™é…ç½®ï¼ˆå¦‚æœæœªå¼€å¯äº†é˜²ç«å¢™ï¼Œå¯è·³è¿‡ï¼‰"><a href="#é˜²ç«å¢™é…ç½®ï¼ˆå¦‚æœæœªå¼€å¯äº†é˜²ç«å¢™ï¼Œå¯è·³è¿‡ï¼‰" class="headerlink" title="é˜²ç«å¢™é…ç½®ï¼ˆå¦‚æœæœªå¼€å¯äº†é˜²ç«å¢™ï¼Œå¯è·³è¿‡ï¼‰"></a>é˜²ç«å¢™é…ç½®ï¼ˆå¦‚æœæœªå¼€å¯äº†é˜²ç«å¢™ï¼Œå¯è·³è¿‡ï¼‰</h3><ul>
<li>firewalld ç›¸å…³</li>
</ul>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">sudo firewall-cmd --add-service=http</span><br><span class="line">sudo firewall-cmd --add-service=https</span><br><span class="line">sudo firewall-cmd --runtime-to-permanent</span><br></pre></td></tr></table></figure>
<ul>
<li>iptables ç›¸å…³</li>
</ul>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">sudo iptables -I INPUT -p tcp -m tcp --dport 80 -j ACCEPT</span><br><span class="line">sudo iptables -I INPUT -p tcp -m tcp --dport 443 -j ACCEPT</span><br></pre></td></tr></table></figure>
<h3 id="æ·»åŠ -TLS-SSL-æœåŠ¡é…ç½®å—"><a href="#æ·»åŠ -TLS-SSL-æœåŠ¡é…ç½®å—" class="headerlink" title="æ·»åŠ  TLS/SSL æœåŠ¡é…ç½®å—"></a>æ·»åŠ  TLS/SSL æœåŠ¡é…ç½®å—</h3><p><code>sudo vim /etc/nginx/conf.d/ssl.conf</code></p>
<p>å†…å®¹å¦‚ä¸‹</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">server &#123;</span><br><span class="line">    listen 443 http2 ssl;</span><br><span class="line">    listen [::]:443 http2 ssl;</span><br><span class="line"></span><br><span class="line">    server_name vcs.private.org;</span><br><span class="line"></span><br><span class="line">    ssl_certificate /etc/ssl/certs/selfsigned.crt;</span><br><span class="line">    ssl_certificate_key /etc/ssl/private/selfsigned.key;</span><br><span class="line">    ssl_dhparam /etc/ssl/certs/dhparam.pem;</span><br><span class="line"></span><br><span class="line">    root /usr/share/nginx/html;</span><br><span class="line"></span><br><span class="line">    location / &#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    error_page 404 /404.html;</span><br><span class="line">    location = /404.html &#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    error_page 500 502 503 504 /50x.html;</span><br><span class="line">    location = /50x.html &#123;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>å‚è€ƒ<a href="https://raymii.org/s/tutorials/Strong_SSL_Security_On_nginx.html" target="_blank" rel="noopener">è¿™ç¯‡æ–‡ç« </a>æ·»åŠ æ›´å¤šå®‰å…¨æ€§é…ç½®</p>
</blockquote>
<h2 id="å¯ç”¨æ–°é…ç½®"><a href="#å¯ç”¨æ–°é…ç½®" class="headerlink" title="å¯ç”¨æ–°é…ç½®"></a>å¯ç”¨æ–°é…ç½®</h2><p>å…ˆæ£€æŸ¥é…ç½®æ–‡ä»¶æ˜¯å¦æœ‰é”™è¯¯</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">sudo nginx -t</span><br></pre></td></tr></table></figure>
<p>é‡è½½æ–°é…ç½®</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">sudo service nginx reload</span><br></pre></td></tr></table></figure>
<h2 id="æµ‹è¯•"><a href="#æµ‹è¯•" class="headerlink" title="æµ‹è¯•"></a>æµ‹è¯•</h2><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">curl https://vcs.private.org</span><br></pre></td></tr></table></figure>
<p>ä½ ä¼šçœ‹åˆ°æŠ¥é”™</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">curl: (60) Peer<span class="string">'s certificate issuer has been marked as not trusted by the user.</span></span><br><span class="line"><span class="string">More details here: http://curl.haxx.se/docs/sslcerts.html</span></span><br><span class="line"><span class="string">.....</span></span><br></pre></td></tr></table></figure>
<h2 id="æ›´æ–°å®¢æˆ·ç«¯ä¿¡ä»»è¯ä¹¦"><a href="#æ›´æ–°å®¢æˆ·ç«¯ä¿¡ä»»è¯ä¹¦" class="headerlink" title="æ›´æ–°å®¢æˆ·ç«¯ä¿¡ä»»è¯ä¹¦"></a>æ›´æ–°å®¢æˆ·ç«¯ä¿¡ä»»è¯ä¹¦</h2><p>æœåŠ¡ç«¯å¯ç”¨äº† httpsï¼Œæ¥ä¸‹æ¥è®©å®¢æˆ·ç«¯æ¥å—è¿™ä¸ªè‡ªç­¾ç½²çš„è¯ä¹¦ã€‚</p>
<ul>
<li>ArchLinux</li>
</ul>
<p>ç­¾ç½²å¥½çš„ <code>selfsigned.crt</code> æ–‡ä»¶å¤åˆ¶åˆ° <code>/etc/ca-certificates/trust-source/anchors</code> ç›®å½•ä¸‹<br>è¿è¡Œ <code>sudo update-ca-trust</code>ï¼Œ æ²¡æœ‰ä»»ä½•è¾“å‡ºå³æ›´æ–°æˆåŠŸã€‚</p>
<ul>
<li>CentOS7</li>
</ul>
<p>ç­¾ç½²å¥½çš„ <code>selfsigned.crt</code> æ–‡ä»¶å¤åˆ¶åˆ° <code>/etc/pki/ca-trust/source/anchors</code> ç›®å½•ä¸‹<br>è¿è¡Œ <code>sudo update-ca-trust extract</code>ï¼Œ æ²¡æœ‰ä»»ä½•è¾“å‡ºå³æ›´æ–°æˆåŠŸã€‚</p>
<ul>
<li>Windows10</li>
</ul>
<p>æ·»åŠ æ¯”è¾ƒéº»çƒ¦å‚è€ƒ<a href="https://reactpaths.com/how-to-get-https-working-in-localhost-development-environment-f17de34af046" target="_blank" rel="noopener">è¿™ç¯‡æ–‡ç« </a>ã€‚<br>è™½ç„¶æ·»åŠ å®Œæˆå chrome ä¾æ—§æ˜¯ä¸æ¥å—è¿™ä¸ªè¯ä¹¦çš„ï¼ˆåº”è¯¥æ˜¯æµè§ˆå™¨ç­–ç•¥çš„é—®é¢˜ï¼‰ï¼Œä½†æ˜¯<br>cmd é‡Œ curl éªŒè¯å¯ä»¥é€šè¿‡ã€‚</p>
<p>å®¢æˆ·ç«¯ä¿¡ä»»äº†è¯ä¹¦ä¹‹åï¼Œå†æ¬¡ curl è¯·æ±‚å°±èƒ½æˆåŠŸäº†ã€‚</p>
<h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><ul>
<li><p><a href="https://www.digitalocean.com/community/tutorials/how-to-create-a-self-signed-ssl-certificate-for-nginx-on-centos-7" target="_blank" rel="noopener">How To Create a Self-Signed SSL Certificate for Nginx on CentOS 7</a></p>
</li>
<li><p><a href="https://raymii.org/s/tutorials/Strong_SSL_Security_On_nginx.html" target="_blank" rel="noopener">Strong SSL Security on nginx</a></p>
</li>
<li><p><a href="https://jlk.fjfi.cvut.cz/arch/manpages/man/update-ca-trust.8" target="_blank" rel="noopener">update-ca-trust</a></p>
</li>
<li><p><a href="https://manuals.gfi.com/en/kerio/connect/content/server-configuration/ssl-certificates/adding-trusted-root-certificates-to-the-server-1605.html" target="_blank" rel="noopener">Adding trusted root certificates to the server</a></p>
</li>
<li><p><a href="https://reactpaths.com/how-to-get-https-working-in-localhost-development-environment-f17de34af046" target="_blank" rel="noopener">How to get HTTPS working in localhost development environment</a></p>
</li>
</ul>
]]></content>
      <tags>
        <tag>Linux</tag>
        <tag>https</tag>
        <tag>TLS</tag>
        <tag>CA</tag>
      </tags>
  </entry>
  <entry>
    <title>Go è°ƒåº¦å™¨</title>
    <url>/2019/05/15/Go-Scheduler/</url>
    <content><![CDATA[<blockquote>
<p>æœ¬æ–‡ç¿»è¯‘è‡ª Go æ ¸å¿ƒå¼€å‘è€… Ian Lance Taylor, åœ¨ Quora ä¸Šçš„<a href="https://qr.ae/pNrVMG" target="_blank" rel="noopener">å›ç­”</a>ã€‚</p>
</blockquote>
<a id="more"></a>
<p>æˆ‘å°†æ¦‚è¿°ä» Go ç‰ˆæœ¬ 1.7 å¼€å§‹ä½¿ç”¨çš„è°ƒåº¦ç¨‹åºã€‚</p>
<p>æœ‰ä¸‰ä¸ªåŸºç¡€æ•°æ®ç»“æ„ï¼Œè¢«ç§°ä½œ Gã€M å’Œ P ã€‚G æ˜¯ goroutineï¼Œ M æ˜¯æ“ä½œç³»ç»Ÿçº¿ç¨‹ï¼Œ P æ˜¯ï¼ˆé€»è¾‘ï¼‰å¤„ç†å•å…ƒã€‚</p>
<p>è°ƒåº¦å™¨æ‹¥æœ‰ç¡®åˆ‡çš„ GOMAXPROCS æ•°é‡çš„ P ï¼ˆGOMAXPROCS æ˜¯ä¸€ä¸ªç¯å¢ƒå˜é‡ï¼Œå¹¶ä¸”è¿è¡Œæ—¶å‡½æ•°ç”¨å®ƒæ¥è®¾ç½®ç¨‹åºä¸­çš„å¹¶å‘åº¦ï¼‰ã€‚ä¸ºäº†è®©ä¸€ä¸ª M æ‰§è¡Œä¸€ä¸ª G ï¼Œå®ƒéœ€è¦å…ˆè·å–ä¸€ä¸ª P ã€‚ç„¶åè¿è¡Œ G ç›´åˆ°åœæ­¢ã€‚ G é€šè¿‡è¯¸å¦‚ I/O æ“ä½œçš„ç³»ç»Ÿè°ƒç”¨ã€é€šè¿‡é˜»å¡ä¸€ä¸ª channel æ“ä½œã€é€šè¿‡è°ƒç”¨ä¸€ä¸ª C å‡½æ•°ã€é€šè¿‡è¢«é¢„æŠ¢å ï¼ˆpre-emptedï¼‰ï¼Œæˆ–è€…ä¸€äº›å°‘æ•°æƒ…å†µæ¥åœæ­¢ã€‚ä¸€ä¸ª G åªèƒ½åœ¨å®‰å…¨çš„åœ°æ–¹è¢«é¢„æŠ¢å ï¼Œå½“å‰å®ç°ä¸­åªèƒ½åœ¨ä»£ç å‘ç”Ÿå‡½æ•°è°ƒç”¨æ—¶å‘ç”Ÿã€‚</p>
<p>å½“ä¸€ä¸ª G è¢« channel æ“ä½œä¹‹ç±»çš„ä¸œè¥¿æ‰€é˜»å¡æ—¶ï¼Œå®ƒä¼šè¢«æ”¾è¿›é˜Ÿåˆ—ä¸­ï¼Œæ­¤æ—¶ M å°†ä¼šå¯»æ‰¾å¦ä¸€ä¸ªå¯è¿è¡Œçš„ G ã€‚å¦‚æœæ²¡æœ‰å¯è¿è¡Œçš„ G ï¼Œè¿™ä¸ª M å°±ä¼šé‡Šæ”¾ P ç„¶åè¿›å…¥ä¼‘çœ ã€‚</p>
<p>å½“ä¸€ä¸ª G è¢«ç³»ç»Ÿè°ƒç”¨ä¹‹ç±»çš„ä¸œè¥¿æ‰€é˜»å¡æ—¶ï¼Œå®ƒä¼šé‡Šæ”¾ P ä¸”ç»§ç»­åœ¨ M ä¸Šè¿è¡Œã€‚æœ‰ä¸€ä¸ªç³»ç»Ÿç›‘è§†å™¨çº¿ç¨‹ï¼Œæ¯éš”ä¸€æ®µæ—¶é—´ï¼ˆ20us åˆ° 10ms ä¹‹é—´ï¼‰å°±ä¼šå”¤é†’ä¸€æ¬¡ã€‚å¦‚æœç³»ç»Ÿç›‘è§†å™¨çº¿ç¨‹å‘ç°æœ‰å¯è¿è¡Œçš„ G å’Œå¯ç”¨çš„ P ï¼Œå®ƒå°±ä¼šå”¤é†’ä¸€ä¸ªæ­£åœ¨ä¼‘çœ çš„ M ï¼Œæˆ–è€…æ²¡æœ‰ä¼‘çœ çš„ M å°±å¯åŠ¨ä¸€ä¸ªæ–°çš„ã€‚é‚£ä¸ª M å°†è·å¾— P å¹¶æ¡èµ·ä¸€ä¸ªå¯è¿è¡Œçš„ G ã€‚</p>
<p>å½“ä¸€ä¸ª G å®Œæˆä¸€æ¬¡ç³»ç»Ÿè°ƒç”¨æ—¶ï¼Œå®ƒå¿…é¡»é‡æ–°è·å– P ã€‚å¦‚æœæ²¡æœ‰å¯ç”¨çš„ P ï¼Œå®ƒå°†è¢«æ ‡è®°ä¸ºå¯è¿è¡Œæ¥ç€ M å°±ä¼šä¼‘çœ ã€‚</p>
<p>å½“ä¸€ä¸ª channel æ“ä½œæˆåŠŸæ—¶ï¼Œå®ƒå°†å”¤é†’å¦ä¸€ä¸ª goroutine ï¼ŒæŠŠå®ƒæ ‡è®°ä¸ºå¯è¿è¡Œï¼Œå¹¶ä¸”å¦‚æœæœ‰å¯ç”¨çš„ P ï¼Œå”¤é†’ä¸€ä¸ª M å»è¿è¡Œå®ƒã€‚</p>
<p>è™½ç„¶åƒåœ¾å›æ”¶å™¨å¤šæ•°æƒ…å†µä¸‹æ—¶å¹¶å‘çš„ï¼Œä½†è¿˜æ˜¯æœ‰éƒ¨åˆ†æƒ…å†µéœ€è¦çŸ­æš‚åœæ­¢æ‰€æœ‰çº¿ç¨‹æ‰èƒ½å®‰å…¨åœ°è½¬ç§»åˆ°å›æ”¶åœ°ä¸‹ä¸€ä¸ªé˜¶æ®µã€‚å®ƒé€šè¿‡å°†æ‰€æœ‰æ­£åœ¨è¿è¡Œçš„ goroutine æ ‡è®°ä¸ºé¢„æŠ¢å æ¥å®ç°æ­¤ç›®çš„ã€‚å½“å®ƒä»¬åˆ°è¾¾å®‰å…¨åœ°ç‚¹æ—¶ï¼Œ G å’Œ M å°†ä¼šä¼‘çœ ã€‚å½“åƒåœ¾å›æ”¶å™¨æ—¶å”¯ä¸€å‰©ä¸‹çš„æ­£åœ¨è¿è¡Œçš„ G æ—¶ï¼Œå®ƒå°†è¿›å…¥ä¸‹ä¸€é˜¶æ®µï¼Œæ¥ç€å”¤é†’ GOMAXPROCS <a href="#note1"><sup>1</sup></a> æ•°é‡çš„ M ï¼Œå®ƒä»¬å°†å„è‡ªæ‰¾åˆ°å¯è¿è¡Œçš„ G å¹¶ç»§ç»­ä¸‹å»ã€‚</p>
<p>runtime.Gosched å‡½æ•°ä¿ƒä½¿ M å°†å½“å‰çš„ G æ”¾åˆ°å¯è¿è¡Œ goroutine åˆ—è¡¨ä¸­ï¼Œå¹¶ä»é‚£ä¸ªåˆ—è¡¨ä¸­é€‰å–ä¸€ä¸ªæ–°çš„ G å¼€å§‹è¿è¡Œã€‚</p>
<h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><ul>
<li><a href="https://www.quora.com/How-does-the-golang-scheduler-work/answer/Ian-Lance-Taylor" target="_blank" rel="noopener">How does the golang scheduler work?</a></li>
<li><a href="https://studygolang.com/articles/12326" target="_blank" rel="noopener">Go è°ƒåº¦å·¥ä½œæœºåˆ¶</a></li>
</ul>
<h2 id="æ³¨"><a href="#æ³¨" class="headerlink" title="æ³¨"></a>æ³¨</h2><div id="note1"></div>

<ul>
<li>[1] åŸå›ç­”ä¸­åº”è¯¥æ˜¯å°‘äº†ä¸ª <code>S</code> ã€‚</li>
</ul>
]]></content>
      <tags>
        <tag>Go</tag>
      </tags>
  </entry>
  <entry>
    <title>Try faceswap with Arch Linux</title>
    <url>/2019/04/01/try-faceswap-on-archlinux/</url>
    <content><![CDATA[<h2 id="What-is-faceswap"><a href="#What-is-faceswap" class="headerlink" title="What is faceswap"></a>What is faceswap</h2><p>See <a href="https://github.com/deepfakes/faceswap" target="_blank" rel="noopener">deepfakes/faceswap</a></p>
<p>Seems a little bit difficult to use it.</p>
<p>But worth to give it a try.</p>
<a id="more"></a>
<h2 id="Make-it-work"><a href="#Make-it-work" class="headerlink" title="Make it work"></a>Make it work</h2><h3 id="Install-anaconda"><a href="#Install-anaconda" class="headerlink" title="Install anaconda"></a>Install anaconda</h3><blockquote>
<p>If you donâ€™t have <code>yay</code>, check <a href="http://www.findshank.com/2018/06/18/Install-yaourt-on-Arch-Linux/">this</a> post.</p>
</blockquote>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">yay -S anaconda</span><br></pre></td></tr></table></figure>
<h3 id="Create-a-conda-virtual-environment"><a href="#Create-a-conda-virtual-environment" class="headerlink" title="Create a conda virtual environment"></a>Create a conda virtual environment</h3><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">conda create -n faceswap python=3.6</span><br></pre></td></tr></table></figure>
<blockquote>
<p>python3.6 is recommended here.</p>
</blockquote>
<h3 id="Install-Nvidia-driver-and-cuda-support"><a href="#Install-Nvidia-driver-and-cuda-support" class="headerlink" title="Install Nvidia driver and cuda support"></a>Install Nvidia driver and cuda support</h3><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">yay -S nvidia nvidia-utils cuda</span><br></pre></td></tr></table></figure>
<blockquote>
<p>We need cuda-10.0 here! If not match this version. try <code>downgrade</code></p>
</blockquote>
<details><br><br><summary>How to downgrade?</summary><br><br><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">yay -S downgrade</span><br><span class="line">downgrade cudnn</span><br></pre></td></tr></table></figure><br><br></details>

<h3 id="Add-cudnn-to-cuda"><a href="#Add-cudnn-to-cuda" class="headerlink" title="Add cudnn to cuda"></a>Add cudnn to cuda</h3><p>Download cuDNN-7.5 for cuda-10.0 on <a href="https://developer.nvidia.com/cudnn" target="_blank" rel="noopener">official site</a>.</p>
<blockquote>
<p>You neet to register and login first.</p>
</blockquote>
<p>Then unzip the <code>cudnn-10.0-linux-x64-v7.5.0.56.tgz</code> file to <code>/opt/cuda</code>.</p>
<h3 id="Get-faceswap-source-code-and-install-it"><a href="#Get-faceswap-source-code-and-install-it" class="headerlink" title="Get faceswap source code and install it"></a>Get faceswap source code and install it</h3><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">git <span class="built_in">clone</span> https://github.com/deepfakes/faceswap.git</span><br><span class="line"><span class="built_in">cd</span> faceswap</span><br><span class="line"></span><br><span class="line"><span class="comment"># active conda virtual environment</span></span><br><span class="line"><span class="built_in">source</span> activate faceswap</span><br><span class="line"></span><br><span class="line"><span class="comment"># install</span></span><br><span class="line">python setup.py</span><br></pre></td></tr></table></figure>
<details><br><br><summary>dlib problem?</summary><br><br>You may got <code>dlib</code> problem when you run faceswap.<br><br><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># replace blas with openblas</span></span><br><span class="line">sudo pacman -S openblas</span><br><span class="line"></span><br><span class="line"><span class="comment"># get dlib source code</span></span><br><span class="line">git <span class="built_in">clone</span> https://github.com/davisking/dlib.git</span><br><span class="line"><span class="built_in">cd</span> dlib</span><br><span class="line"></span><br><span class="line"><span class="comment"># active conda virtual environment</span></span><br><span class="line"><span class="built_in">source</span> activate faceswap</span><br><span class="line"></span><br><span class="line">python setup.py install</span><br></pre></td></tr></table></figure><br><br></details>

<h3 id="play-with-faceswap"><a href="#play-with-faceswap" class="headerlink" title="play with faceswap"></a>play with faceswap</h3><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># try gui</span></span><br><span class="line">python faceswap.py gui</span><br></pre></td></tr></table></figure>
<p><img src="Screenshot.png" alt="screenshot"></p>
<h2 id="Ref"><a href="#Ref" class="headerlink" title="Ref"></a>Ref</h2><ul>
<li><a href="https://github.com/deepfakes/faceswap/blob/master/INSTALL.md" target="_blank" rel="noopener">INSTALL.md</a></li>
<li><a href="https://uoa-eresearch.github.io/eresearch-cookbook/recipe/2014/11/20/conda/" target="_blank" rel="noopener">Create virtual environments for python with conda</a></li>
<li><a href="https://medium.com/@mimoralea/getting-started-with-nvidia-gpu-anaconda-tensorflow-and-keras-on-arch-linux-8f5f2868a455" target="_blank" rel="noopener">Getting Started With NVIDIA GPU, Anaconda, TensorFlow and Keras on Arch Linux</a></li>
<li><a href="https://www.ostechnix.com/downgrade-package-arch-linux/" target="_blank" rel="noopener">How To Downgrade A Package In Arch Linux</a></li>
</ul>
]]></content>
      <tags>
        <tag>Linux</tag>
        <tag>Arch</tag>
        <tag>faceswap</tag>
      </tags>
  </entry>
  <entry>
    <title>Install Arch Linux again</title>
    <url>/2019/03/31/Install-Arch-Linux-again/</url>
    <content><![CDATA[<h1 id="What"><a href="#What" class="headerlink" title="What"></a>What</h1><p>Got a new 256G nvme ssd hard drive.</p>
<p>Install Arch Linux again.</p>
<a id="more"></a>
<h1 id="Prepare"><a href="#Prepare" class="headerlink" title="Prepare"></a>Prepare</h1><p>Download latest ISO file <a href="https://www.archlinux.org/download/" target="_blank" rel="noopener">here</a>.</p>
<p>Check md5 with tools. e.g. <code>md5sum</code>  on linux.</p>
<p>Write ISO file in your usb driver.</p>
<blockquote>
<p>select <code>GPT</code> for EFI only</p>
</blockquote>
<p>Plug in you usb drive and reboot into it.</p>
<h1 id="partition"><a href="#partition" class="headerlink" title="partition"></a>partition</h1><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># list all disks and partitions</span></span><br><span class="line">fdisk -l</span><br><span class="line"></span><br><span class="line"><span class="comment"># my new ssd is `nvme0n1`</span></span><br><span class="line"><span class="comment"># make partition table with `cfdisk`</span></span><br><span class="line">cfisk /dev/nvme0n1</span><br><span class="line"></span><br><span class="line"><span class="comment"># 512M EFI file system --&gt; nvme0n1p1</span></span><br><span class="line"><span class="comment"># 218G Linux file system --&gt; nvme0n1p2</span></span><br><span class="line"><span class="comment"># 20G swap space --&gt; nvme0n1p3</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># write then quit</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># format new partitions</span></span><br><span class="line">mkfs.fat -F32 /dev/nvme0n1p1</span><br><span class="line">mkfs.ext4 /dev/nvme0n1p2</span><br><span class="line">mkswap /dev/nvme0n1p3</span><br><span class="line">swapon /dev/nvme0n1p3</span><br><span class="line"></span><br><span class="line"><span class="comment"># mount to /mnt</span></span><br><span class="line">mount /dev/nvme0n1p2 /mnt</span><br><span class="line">mkdir -p /mnt/boot</span><br><span class="line">mount /dev/nvme0n1p1 /mnt/boot</span><br></pre></td></tr></table></figure>
<h1 id="Install"><a href="#Install" class="headerlink" title="Install"></a>Install</h1><p>If your network special as China, I recommended you change pacman mirror first.</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="built_in">cd</span> /etc/pacman.d</span><br><span class="line">mv ./mirrorlist ./mirrorlist.bak</span><br><span class="line"><span class="built_in">echo</span> <span class="string">'Server = http://mirrors.163.com/archlinux/$repo/os/$arch'</span> &gt; ./mirrorlist</span><br></pre></td></tr></table></figure>
<p>Then follow the pase.</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Update you pacman database</span></span><br><span class="line">pacman -Syy</span><br><span class="line"><span class="comment"># Install base and dev-base</span></span><br><span class="line">pacstrap -i /mnt base base-devel</span><br><span class="line"><span class="comment"># Type enter enter enter ...</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Generate fstab</span></span><br><span class="line">genfstab -U /mnt &gt;&gt; /mnt/etc/fstab</span><br><span class="line"></span><br><span class="line"><span class="comment"># Change root</span></span><br><span class="line">arch-chroot /mnt</span><br><span class="line"></span><br><span class="line"><span class="comment"># set timezone, I live in China, so I use this timezone.</span></span><br><span class="line">ln -sf /usr/share/zoneinfo/Asia/Shanghai /etc/localtime</span><br><span class="line"></span><br><span class="line"><span class="comment"># set localtime instead of UTC time, I want my windows have same time set.</span></span><br><span class="line">hwclock --systohc -l</span><br><span class="line"></span><br><span class="line"><span class="comment"># Install vim first</span></span><br><span class="line">pacman -S vim</span><br><span class="line"></span><br><span class="line"><span class="comment"># Localization</span></span><br><span class="line">vim /etc/locale.gen</span><br><span class="line"><span class="comment"># uncommit follow lines and save</span></span><br><span class="line"><span class="comment">#en_US.UTF-8 UTF-8</span></span><br><span class="line"><span class="comment">#zh_CN.GBK GBK</span></span><br><span class="line"><span class="comment">#zh_CN.UTF-8 UTF-8</span></span><br><span class="line"><span class="comment">#zh_CN.GB2312</span></span><br><span class="line">locale-gen</span><br><span class="line"><span class="comment"># set default locale</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">'LANG=en_US.UTF-8'</span> &gt; /etc/locale.conf</span><br><span class="line"></span><br><span class="line"><span class="comment"># Network</span></span><br><span class="line"><span class="built_in">echo</span> HOSTNAME &gt; /etc/hostname</span><br><span class="line"><span class="built_in">echo</span> <span class="string">'127.0.0.1 localhost'</span> &gt;&gt; /etc/hosts</span><br><span class="line"><span class="built_in">echo</span> <span class="string">'::1       localhost'</span> &gt;&gt; /etc/hosts</span><br><span class="line"><span class="built_in">echo</span> <span class="string">'127.0.1.1 HOSTNAME.localdomain    HOSTNAME'</span>  &gt;&gt;/etc/hosts</span><br><span class="line"></span><br><span class="line"><span class="comment"># dhcpcd enable</span></span><br><span class="line">systemctl <span class="built_in">enable</span> dhcpcd</span><br><span class="line"></span><br><span class="line"><span class="comment"># Initramfs</span></span><br><span class="line">mkinitcpio -p linux</span><br><span class="line"></span><br><span class="line"><span class="comment"># set root password</span></span><br><span class="line">passwd</span><br><span class="line"></span><br><span class="line"><span class="comment"># Boot loader install intel mocro-code</span></span><br><span class="line">pacman -S intel-ucode</span><br><span class="line"></span><br><span class="line"><span class="comment"># use grub for boot manage</span></span><br><span class="line">pacman -S grub efibootmgr os-prober</span><br><span class="line">grub-install --efi-directory=/boot --bootloader-id=ArchLinux --recheck</span><br><span class="line"></span><br><span class="line"><span class="comment"># If your windows boot loader in other EFI partition, you can mount the partition,</span></span><br><span class="line"><span class="comment"># and copy `Boot` and `Microsoft` to your /boot/EFI/, otherwise, grub can not</span></span><br><span class="line"><span class="comment"># find your windows boot loader.</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># set default boot on last saved one</span></span><br><span class="line">vim /etc/default/grub</span><br><span class="line"><span class="comment"># GRUB_DEFAULT=saved</span></span><br><span class="line"><span class="comment"># GRUB_SAVEDEFAULT="true"</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># generate grub.cfg</span></span><br><span class="line">grub-mkconfig -o /boot/grub/grub.cfg</span><br><span class="line"></span><br><span class="line"><span class="comment"># install more apps</span></span><br><span class="line">pacman -S iw wpa_supplicant dialog <span class="comment"># wifi support</span></span><br><span class="line">pacman -S ttf-dejavu wqy-microhei wqy-zenhei <span class="comment"># font support</span></span><br><span class="line">pacman -S alsa-utils <span class="comment"># sound</span></span><br><span class="line">pacman -S dosfstools <span class="comment"># support NTFS usb driver</span></span><br><span class="line">pacman -S zsh openssh</span><br><span class="line"></span><br><span class="line"><span class="comment"># exit, unmount and reboot</span></span><br><span class="line"><span class="built_in">exit</span></span><br><span class="line">umount -R /mnt</span><br><span class="line">reboot</span><br></pre></td></tr></table></figure>
<h1 id="After-Install"><a href="#After-Install" class="headerlink" title="After Install"></a>After Install</h1><h2 id="check-network"><a href="#check-network" class="headerlink" title="check network"></a>check network</h2><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># check if your network interfaces</span></span><br><span class="line">ip link</span><br><span class="line"><span class="comment"># if state is DOWN, maybe you dhcpcd not run</span></span><br><span class="line">systemctl start dhcpcd &amp;&amp; systemctl <span class="built_in">enable</span> dhcpcd</span><br></pre></td></tr></table></figure>
<h2 id="new-sudo-user"><a href="#new-sudo-user" class="headerlink" title="new sudo user"></a>new sudo user</h2><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># then add a new user, my username is shank</span></span><br><span class="line">useradd -m -g users -s /bin/zsh shank</span><br><span class="line"><span class="comment"># new passord for new user</span></span><br><span class="line">passwd shank</span><br><span class="line"><span class="comment"># set new user in sudo</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">'shank ALL=(ALL) ALL'</span> &gt; /etc/sudoers.d/shank</span><br></pre></td></tr></table></figure>
<h2 id="dual-video-card-driver"><a href="#dual-video-card-driver" class="headerlink" title="dual video card driver"></a>dual video card driver</h2><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># check you video card</span></span><br><span class="line">lspci | grep VGA</span><br><span class="line"><span class="comment"># found my NVIDIA GTX 1060 here</span></span><br><span class="line"><span class="comment"># install driver for video card</span></span><br><span class="line">pacman -S mesa vulkan-intel</span><br><span class="line"><span class="comment"># pacman -S xf86-video-intel # often not recommended</span></span><br><span class="line">pacman -S nvidia</span><br><span class="line">pacman -S nvidia-libgl</span><br><span class="line">pacman -S xorg-xrandr</span><br><span class="line">nvidia-xconfig</span><br></pre></td></tr></table></figure>
<h2 id="desktop-environment"><a href="#desktop-environment" class="headerlink" title="desktop environment"></a>desktop environment</h2><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Install an desktop manager</span></span><br><span class="line">sudo pacman -S sddm</span><br><span class="line"></span><br><span class="line"><span class="comment"># Install an desktop environment</span></span><br><span class="line">sudo pacman -S gnome</span><br><span class="line"></span><br><span class="line"><span class="comment"># enable the desktop manager</span></span><br><span class="line">sudo systemctl <span class="built_in">enable</span> sddm</span><br><span class="line"></span><br><span class="line"><span class="comment"># Install NetworkManager</span></span><br><span class="line">sudo pacman -S networkmanager</span><br><span class="line"></span><br><span class="line"><span class="comment"># enable the NetworkManager</span></span><br><span class="line">sudo systemctl <span class="built_in">enable</span> NetworkManager</span><br><span class="line"></span><br><span class="line"><span class="comment"># then reboot</span></span><br><span class="line">sudo reboot</span><br></pre></td></tr></table></figure>
<h2 id="install-yay"><a href="#install-yay" class="headerlink" title="install yay"></a>install yay</h2><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">sudo pacman -S git</span><br><span class="line">git <span class="built_in">clone</span> https://aur.archlinux.org/yay.git</span><br><span class="line"><span class="built_in">cd</span> yay</span><br><span class="line">makepkg -si</span><br></pre></td></tr></table></figure>
<h2 id="more-apps"><a href="#more-apps" class="headerlink" title="more apps"></a>more apps</h2><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">sudo pacman -S \</span><br><span class="line">ibus ibus-qt ibus-rime \</span><br><span class="line">ttf-inconsolata noto-fonts-cjk \</span><br><span class="line">powerline-fonts ttf-font-awesome \</span><br><span class="line">net-tools dnsutils inetutils iproute2 \</span><br><span class="line">zsh terminator thunar \</span><br><span class="line">vlc alsa-utils deadbeef cmus telegram-desktop \</span><br><span class="line">goldendict mplayer \</span><br><span class="line">go git wget openssh unzip unrar \</span><br><span class="line">ntfs-3g deluge shadowsocks shadowsocks-qt5 \</span><br><span class="line">gnome gnome-tweaks \</span><br><span class="line">numix-gtk-theme</span><br><span class="line"></span><br><span class="line">yay -S numix-circle-icon-theme-git \</span><br><span class="line">capitaine-cursors \</span><br><span class="line">google-chrome \</span><br><span class="line">visual-studio-code-bin \</span><br><span class="line">foxitreader \</span><br><span class="line">anaconda</span><br></pre></td></tr></table></figure>
<h2 id="more-operations"><a href="#more-operations" class="headerlink" title="more operations"></a>more operations</h2><h3 id="set-oh-my-zsh"><a href="#set-oh-my-zsh" class="headerlink" title="set oh-my-zsh"></a>set oh-my-zsh</h3><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">sh -c <span class="string">"<span class="variable">$(curl -fsSL https://raw.githubusercontent.com/robbyrussell/oh-my-zsh/master/tools/install.sh)</span>"</span></span><br></pre></td></tr></table></figure>
<h3 id="set-anaconda"><a href="#set-anaconda" class="headerlink" title="set anaconda"></a>set anaconda</h3><p>Donâ€™t set anaconda in your path, will occur many problems!<br>So we just set <code>alias</code> to make it easy for activate conda environment.</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># vim ~/.zshrc</span></span><br><span class="line"><span class="built_in">alias</span> activate-env=<span class="string">"source /opt/anaconda/bin/activate"</span></span><br><span class="line"><span class="built_in">alias</span> deactivate-env=<span class="string">"source /opt/anaconda/bin/deactivate"</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ease access to conda</span></span><br><span class="line">sudo ln /opt/anaconda/bin/conda /usr/bin/conda</span><br></pre></td></tr></table></figure>
<h1 id="Ref"><a href="#Ref" class="headerlink" title="Ref"></a>Ref</h1><ul>
<li><a href="https://wiki.archlinux.org/index.php/EFI_system_partition" target="_blank" rel="noopener">Installation guide</a></li>
</ul>
]]></content>
      <tags>
        <tag>Linux</tag>
        <tag>Arch</tag>
      </tags>
  </entry>
  <entry>
    <title>Install PostgreSQL on CentOS7</title>
    <url>/2019/03/14/install-postgresql-on-centos7/</url>
    <content><![CDATA[<h1 id="Installation"><a href="#Installation" class="headerlink" title="Installation"></a>Installation</h1><blockquote>
<p>if you want install latest version check <a href="https://www.postgresql.org/download/" target="_blank" rel="noopener">official site</a></p>
</blockquote>
<p>I will install postgres9.6 for CentOS7.</p>
<blockquote>
<p>default version of postgres in CentOS7 rpm is not recommanded, I need some new features in postgres9.5+.</p>
</blockquote>
<a id="more"></a>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">sudo yum install https://download.postgresql.org/pub/repos/yum/9.6/redhat/rhel-7-x86_64/pgdg-redhat96-9.6-3.noarch.rpm</span><br><span class="line">sudo yum install postgresql96-server postgresql96-contrib</span><br><span class="line"></span><br><span class="line"><span class="comment"># initialize the database</span></span><br><span class="line">sudo postgresql96-setup initdb</span><br></pre></td></tr></table></figure>
<h1 id="Config-for-remote-access"><a href="#Config-for-remote-access" class="headerlink" title="Config for remote access"></a>Config for remote access</h1><p>Set listen port to wildcard</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># sudo vim /var/lib/pgsql/9.6/data/postgresql.conf</span><br><span class="line">listen_addresses = &apos;*&apos;</span><br></pre></td></tr></table></figure>
<p>Change HBA (host-based authentication) configuration</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># sudo vim /var/lib/pgsql/9.6/data/pg_hba.conf</span><br><span class="line">host    all             all             0.0.0.0/0            md5</span><br></pre></td></tr></table></figure>
<h1 id="Start-server"><a href="#Start-server" class="headerlink" title="Start server"></a>Start server</h1><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">sudo systemctl <span class="built_in">enable</span> postgresql-9.6</span><br><span class="line">sudo systemctl start postgresql-9.6</span><br><span class="line"></span><br><span class="line"><span class="comment"># check listen port</span></span><br><span class="line">ss -ant | grep 5432</span><br></pre></td></tr></table></figure>
<h1 id="Login-default-role"><a href="#Login-default-role" class="headerlink" title="Login default role"></a>Login default role</h1><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">sudo -i -u postgres</span><br><span class="line"><span class="comment"># to access PostgreSQL prompt</span></span><br><span class="line">psql</span><br><span class="line"><span class="comment"># for quit PostgreSQL prompt</span></span><br><span class="line">\q</span><br></pre></td></tr></table></figure>
<h1 id="Create-a-new-role"><a href="#Create-a-new-role" class="headerlink" title="Create a new role"></a>Create a new role</h1><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">createuser --interactive</span><br></pre></td></tr></table></figure>
<blockquote>
<p>My new role is <code>rwuser</code></p>
</blockquote>
<h1 id="Create-a-new-database"><a href="#Create-a-new-database" class="headerlink" title="Create a new database"></a>Create a new database</h1><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">createdb test1</span><br></pre></td></tr></table></figure>
<h1 id="Login-new-role"><a href="#Login-new-role" class="headerlink" title="Login new role"></a>Login new role</h1><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># access PostgreSQL prompt with new role</span></span><br><span class="line">sudo su -c <span class="string">"psql -d test1"</span> - rwuser</span><br><span class="line"><span class="comment"># type following command in  PostgreSQL prompt</span></span><br><span class="line">\password</span><br><span class="line"><span class="comment"># then set your new password</span></span><br></pre></td></tr></table></figure>
<p>You can use navicat to connect pgsql later.</p>
<h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><ul>
<li><a href="https://www.digitalocean.com/community/tutorials/how-to-install-and-use-postgresql-on-centos-7#create-a-new-role" target="_blank" rel="noopener">How To Install and Use PostgreSQL on CentOS 7</a></li>
<li><a href="https://www.liquidweb.com/kb/change-a-password-for-postgresql-on-linux-via-command-line/" target="_blank" rel="noopener">Change a Password for PostgreSQL on Linux via Command Line</a></li>
<li><a href="https://www.postgresql.org/download/linux/redhat/" target="_blank" rel="noopener">Official install guide</a></li>
</ul>
]]></content>
      <tags>
        <tag>Linux</tag>
        <tag>CentOS7</tag>
        <tag>PostgreSQL</tag>
      </tags>
  </entry>
  <entry>
    <title>For-Select loop in Go</title>
    <url>/2019/03/14/for-select-in-go/</url>
    <content><![CDATA[<p>Simple <code>break</code> in for-select loop, will not break out of <code>for</code> loop. You should use <code>break label</code>.</p>
<a id="more"></a>
<h1 id="demo"><a href="#demo" class="headerlink" title="demo"></a>demo</h1><figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">    <span class="string">"fmt"</span></span><br><span class="line">    <span class="string">"time"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line"></span><br><span class="line">    one := time.After(time.Second * <span class="number">2</span>)</span><br><span class="line">    two := time.After(time.Second * <span class="number">4</span>)</span><br><span class="line">    three := time.After(time.Second * <span class="number">6</span>)</span><br><span class="line"></span><br><span class="line">out:</span><br><span class="line">    <span class="comment">//fmt.Println("out of for") // anything here will invoke error</span></span><br><span class="line">    <span class="keyword">for</span> &#123;</span><br><span class="line">        fmt.Println(<span class="string">"head"</span>)</span><br><span class="line">        <span class="keyword">select</span> &#123;</span><br><span class="line">        <span class="keyword">case</span> &lt;-one:</span><br><span class="line">            fmt.Println(<span class="string">"one"</span>)</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">case</span> &lt;-two:</span><br><span class="line">            fmt.Println(<span class="string">"two"</span>)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">case</span> &lt;-three:</span><br><span class="line">            fmt.Println(<span class="string">"three"</span>)</span><br><span class="line">            <span class="keyword">break</span> out</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">        fmt.Println(<span class="string">"tail"</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//out: // break label must define before for loop</span></span><br><span class="line">    fmt.Println(<span class="string">"in the end"</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><a href="https://play.golang.org/p/vz_uQb4nhPz" target="_blank" rel="noopener">Playground</a></p>
<h1 id="more"><a href="#more" class="headerlink" title="more"></a>more</h1><p><a href="https://golang.org/ref/spec#Break_statements" target="_blank" rel="noopener">Break statement</a></p>
]]></content>
      <tags>
        <tag>Go</tag>
      </tags>
  </entry>
  <entry>
    <title>Solve ridiculous problem in Golang</title>
    <url>/2018/10/30/Solve-ridiculous-problem-in-Golang/</url>
    <content><![CDATA[<h1 id="problem"><a href="#problem" class="headerlink" title="problem"></a>problem</h1><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">panic: runtime error: invalid memory address or nil pointer dereference</span><br><span class="line">[signal SIGSEGV: segmentation violation code=0x1 addr=0x10 pc=0x6e2bea]</span><br><span class="line"></span><br><span class="line">goroutine 10233 [running]:</span><br><span class="line">.../backend.(*ActionBackend).ReceiveTXPacket(0xc42968f940)</span><br><span class="line">        /.../backend/actionbackend.go:102 +0x2a</span><br><span class="line">.../backend.NewActionBackend.func1(0xc42968f940)</span><br><span class="line">        /.../backend/actionbackend.go:45 +0x2b</span><br><span class="line">created by .../backend.NewActionBackend</span><br><span class="line">        /.../backend/actionbackend.go:44 +0x89</span><br></pre></td></tr></table></figure>
<a id="more"></a>
<h1 id="solve"><a href="#solve" class="headerlink" title="solve"></a>solve</h1><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="built_in">ulimit</span> -n 65536</span><br></pre></td></tr></table></figure>
<h1 id="why"><a href="#why" class="headerlink" title="why"></a>why</h1><p>First, I try to find some logic problem in panic lines. But nothing should be modified.</p>
<p>Then I reconigized my program need to create 3000 connection. (Itâ€™s a stress test program.)</p>
<p>While I type this <code>ulimit -n</code>, it shows the file-size writing limit is <code>1024</code>. So â€¦ boooom!</p>
]]></content>
      <tags>
        <tag>Linux</tag>
        <tag>Go</tag>
      </tags>
  </entry>
  <entry>
    <title>Install mysql on wsl</title>
    <url>/2018/09/15/Install-mysql-on-wsl/</url>
    <content><![CDATA[<h1 id="How"><a href="#How" class="headerlink" title="How"></a>How</h1><ol>
<li><p>Install a distro in windows store.</p>
<blockquote>
<p>I got ubuntu18.04LTS here.</p>
</blockquote>
</li>
<li><p>Change sources.list</p>
<p> backup first.</p>
 <a id="more"></a>
 <figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">sudo cp /etc/apt/sources.list /etc/apt/sources.list.bak</span><br><span class="line">sudo vi /etc/apt/sources.list</span><br></pre></td></tr></table></figure>
<p> run these commands in vi to replace url.</p>
 <figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">:%s/archive.ubuntu.com/mirrors.163.com</span><br><span class="line">:%s/security.ubuntu.com/mirrors.163.com</span><br></pre></td></tr></table></figure>
</li>
<li><p>Install mysql</p>
<blockquote>
<p>meet some problem when install mariadb, so I change to mysql.</p>
 <figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">sudo apt install mysql-server</span><br><span class="line">sudo service mysql start</span><br><span class="line">sudo mysql_secure_installation</span><br></pre></td></tr></table></figure>
</blockquote>
</li>
<li><p>Adjusting User Authentication and Privileges</p>
 <figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">sudo mysql</span><br><span class="line"><span class="comment"># after enter mysql, check which authentication method each of your MySQL user accounts use with the following command</span></span><br><span class="line"><span class="comment"># SELECT user,authentication_string,plugin,host FROM mysql.user;</span></span><br><span class="line">ALTER USER <span class="string">'root'</span>@<span class="string">'localhost'</span> IDENTIFIED WITH mysql_native_password BY <span class="string">'YourPassword'</span>;</span><br><span class="line">FLUSH PRIVILEGES;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h2 id="Ref"><a href="#Ref" class="headerlink" title="Ref"></a>Ref</h2><p><a href="https://www.digitalocean.com/community/tutorials/how-to-install-mysql-on-ubuntu-18-04" target="_blank" rel="noopener">How To Install MySQL on Ubuntu 18.04</a></p>
]]></content>
      <categories>
        <category>WSL</category>
      </categories>
      <tags>
        <tag>MySQL</tag>
        <tag>WSL</tag>
      </tags>
  </entry>
  <entry>
    <title>How to revert Singly Linked List</title>
    <url>/2018/08/17/How-to-revert-Linked-List/</url>
    <content><![CDATA[<p>Here is the struct of Singly Linked List and Print method:</p>
<a id="more"></a>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Link</span> &#123;</span></span><br><span class="line">  Link* next;</span><br><span class="line">  DType data;</span><br><span class="line">  Link(DType data) &#123; <span class="keyword">this</span>-&gt;data = data; &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Print</span><span class="params">(Link* head)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">while</span> (head != <span class="literal">NULL</span>) &#123;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; head-&gt;data &lt;&lt; <span class="string">' '</span>;</span><br><span class="line">    head = head-&gt;next;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">cout</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Two ways to revert the Singly Linked List.</p>
<ul>
<li>Non-Recursion version</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function">Link* <span class="title">Reverse</span><span class="params">(Link* head)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (head == <span class="literal">NULL</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">NULL</span>;</span><br><span class="line">  Link *r, *p, *q;</span><br><span class="line">  p = head;</span><br><span class="line">  q = head-&gt;next;</span><br><span class="line">  head-&gt;next = <span class="literal">NULL</span>;</span><br><span class="line">  <span class="keyword">while</span> (q != <span class="literal">NULL</span>) &#123;</span><br><span class="line">    r = q-&gt;next;</span><br><span class="line">    q-&gt;next = p;</span><br><span class="line">    p = q;</span><br><span class="line">    q = r;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> p;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>Recursion version</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function">Link* <span class="title">Reverse2</span><span class="params">(Link* head, Link*&amp; nhead)</span> </span>&#123;</span><br><span class="line">  nhead = <span class="literal">NULL</span>;</span><br><span class="line">  <span class="keyword">if</span> (head == <span class="literal">NULL</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">NULL</span>;</span><br><span class="line">  <span class="keyword">if</span> (head-&gt;next == <span class="literal">NULL</span>) &#123;</span><br><span class="line">    nhead = head;</span><br><span class="line">    <span class="keyword">return</span> head;</span><br><span class="line">  &#125;</span><br><span class="line">  Link* tail = Reverse2(head-&gt;next, nhead);</span><br><span class="line">  tail-&gt;next = head;</span><br><span class="line">  head-&gt;next = <span class="literal">NULL</span>;</span><br><span class="line">  <span class="keyword">return</span> head;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>main function &amp; result:</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  Link *root, *p;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;</span><br><span class="line">    <span class="keyword">if</span> (i == <span class="number">0</span>) &#123;</span><br><span class="line">      root = p = <span class="keyword">new</span> Link(i);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      p-&gt;next = <span class="keyword">new</span> Link(i);</span><br><span class="line">      p = p-&gt;next;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  Print(root);</span><br><span class="line">  <span class="comment">// 0 1 2 3 4 5 6 7 8 9</span></span><br><span class="line"></span><br><span class="line">  root = Reverse(root);</span><br><span class="line">  Print(root);</span><br><span class="line">  <span class="comment">// 9 8 7 6 5 4 3 2 1 0</span></span><br><span class="line"></span><br><span class="line">  Link* nroot;</span><br><span class="line">  Reverse2(root, nroot);</span><br><span class="line">  Print(nroot);</span><br><span class="line">  <span class="comment">// 0 1 2 3 4 5 6 7 8 9</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>algorithm</category>
      </categories>
      <tags>
        <tag>C++</tag>
        <tag>LinkdList</tag>
      </tags>
  </entry>
  <entry>
    <title>Use VirtualBox to access OS on hard drive</title>
    <url>/2018/08/15/Use-VirtualBox-to-access-OS-on-hard-drive/</url>
    <content><![CDATA[<h1 id="What"><a href="#What" class="headerlink" title="What"></a>What</h1><p>è™½ç„¶å·²ç»ä¸»è¦åœ¨ç”¨Archäº†ï¼Œä½†æ˜¯æœ€è¿‘æœ‰æœ‹å‹è®©æˆ‘å¸®ä»–æ”¹æ”¹cppä»£ç ã€‚<del>ä»£ç æ‹¿è¿‡æ¥ä¸€çœ‹ï¼Œå¥½å®¶ä¼™ï¼Œæµ“æµ“çš„windowsæ°”æ¯ï¼Œæ²¡åŠæ³•äººå®¶å…¬å¸å°±æ˜¯åšwindowsæ¡Œé¢åº”ç”¨çš„ã€‚</del></p>
<p>é‚£ä¹ˆé—®é¢˜æ¥äº†ï¼Œæˆ‘ä¸æƒ³é‡å¯ç”µè„‘åˆ‡æ¢ç³»ç»Ÿï¼Œè¿˜è¦ç”¨windowsç»™ä»–è°ƒä»£ç ï¼Œæ€ä¹ˆåŠï¼Ÿ</p>
<p>ç”¨è™šæ‹Ÿæœºå§ï¼Œä¼ ç»Ÿæµç¨‹ï¼šæ–°å»ºä¸€ä¸ªè™šæ‹Ÿæœº-&gt;è£…ç³»ç»Ÿ-&gt;æ­å¼€å‘ç¯å¢ƒ-&gt;è°ƒä»£ç (-&gt;åˆ é™¤è™šæ‹Ÿæœº)ã€‚<strong>éº»çƒ¦</strong></p>
<a id="more"></a>
<h1 id="How"><a href="#How" class="headerlink" title="How"></a>How</h1><p>æ—¢ç„¶è™šæ‹Ÿæœºä¹Ÿè¦ç”¨è™šæ‹Ÿç¡¬ç›˜æ–‡ä»¶è£…ç³»ç»Ÿï¼Œä½•ä¸æŒ‚è½½è£…æœ‰ç³»ç»Ÿçš„ç¡¬ç›˜ç›´æ¥ç”¨å‘¢ï¼Ÿ Googleä¸€ä¸‹ï¼Œè¿™æ˜¯å¯ä»¥çš„ã€‚</p>
<blockquote>
<p>æ³¨æ„ï¼šè¿è¡Œè™šæ‹Ÿæœºçš„ç¡¬ç›˜æœ€å¥½ä¸è™šæ‹ŸæœºæŒ‚è½½ç³»ç»Ÿçš„ç¡¬ç›˜åˆ†å¼€ï¼Œé˜²æ­¢æœªçŸ¥é”™è¯¯ï¼›é‡è¦æ•°æ®æœ€å¥½å¤‡ä»½ä¸‹ã€‚</p>
</blockquote>
<p>ä¸‹é¢ä¸»è¦æŒ‰ç…§æˆ‘çš„å®é™…æƒ…å†µè®²ï¼Œæˆ‘ç”µè„‘é‡ŒåŒç³»ç»Ÿåˆ†åœ¨ä¸¤å—ç¡¬ç›˜ä¸Šï¼Œwin åœ¨ /dev/sdaï¼Œlinux åœ¨ /dev/sdbï¼Œè¿™æ˜¯æœ€ç†æƒ³çš„ï¼Œäº’ä¸å¹²æ‰°ã€‚</p>
<ol>
<li><p>root æƒé™ä¸‹è¿è¡Œ VirtualBox</p>
</li>
<li><p>æ–°å»ºä¸€ä¸ªwindowsè™šæ‹Ÿæœºï¼Œæ·»åŠ è™šæ‹Ÿç¡¬ç›˜æ—¶é€‰æ‹©<code>Do not add a virtual hard drive</code>(ä¸æ·»åŠ è™šæ‹Ÿç¡¬ç›˜)ï¼Œå…¶ä»–é…ç½®ç…§å¸¸ï¼Œç„¶åä¿å­˜ã€‚</p>
</li>
<li><p>è¾“å…¥ä»¥ä¸‹å‘½ä»¤åˆ›å»ºæ˜ å°„çœŸå®ç¡¬ç›˜çš„è™šæ‹Ÿç¡¬ç›˜æ–‡ä»¶ï¼š</p>
 <figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">sudo VBoxManage internalcommands createrawvmdk -filename <span class="string">"&lt;/path/to/file&gt;.vmdk"</span> -rawdisk /dev/sda</span><br></pre></td></tr></table></figure>
<blockquote>
<p><code>&lt;/path/to/file&gt;.vmdk</code>æ¢æˆä½ è¦ä¿å­˜è™šæ‹Ÿç¡¬ç›˜çš„æ–‡ä»¶ä½ç½®ï¼Œä¾‹å¦‚ <code>~/vbox/win.vmdk</code>ã€‚<br><code>/dev/sda</code>æ˜¯æˆ‘winçš„å®‰è£…ç›˜ï¼Œä½ å¯ä»¥ç”¨<code>sudo fdisk -l</code>æŸ¥çœ‹ä½ çš„ç³»ç»Ÿæ‰€åœ¨ä½ç½®ã€‚<br>ä»¥ä¸Šå‘½ä»¤æ˜¯å¯ä»¥æŒ‡å®šåªæ˜ å°„æŸå‡ ä¸ªåˆ†åŒºçš„ï¼Œå…·ä½“å‘½ä»¤è‡ªå·±Googleã€‚</p>
</blockquote>
</li>
<li><p>è®¾ç½®windowsè™šæ‹Ÿæœºçš„å­˜å‚¨è®¾å¤‡ï¼ˆSettings-&gt;Storage-&gt;Add Hard Disk-&gt;Choose existing diskï¼‰ï¼Œæ‰¾åˆ°ä¸Šä¸€æ­¥ç”Ÿæˆçš„vmdkæ–‡ä»¶æ·»åŠ å³å¯ã€‚</p>
</li>
<li><p>å› ä¸ºæˆ‘çš„windowså¯åŠ¨æ–¹å¼æ˜¯EFIï¼Œæ‰€ä»¥åœ¨Settings-&gt;Systemä¸­å‹¾ä¸Š<code>Enable EFI(special OSes only)</code>ã€‚</p>
</li>
</ol>
<p>è‡³æ­¤ï¼Œå¯ä»¥å¯åŠ¨äº†ã€‚</p>
<p><img src="result.gif" alt="result"></p>
<blockquote>
<p>é¡ºä¾¿ä½¿ç”¨ä¸‹Linuxä¸‹çš„gifåˆ¶ä½œå™¨ <code>peek</code></p>
</blockquote>
<h1 id="Refs"><a href="#Refs" class="headerlink" title="Refs"></a>Refs</h1><p>[Using a Physical Hard Drive with a VirtualBox VM]<a href="https://www.serverwatch.com/server-tutorials/using-a-physical-hard-drive-with-a-virtualbox-vm.html" target="_blank" rel="noopener">https://www.serverwatch.com/server-tutorials/using-a-physical-hard-drive-with-a-virtualbox-vm.html</a></p>
]]></content>
      <tags>
        <tag>VirtualBox</tag>
      </tags>
  </entry>
  <entry>
    <title>Downgrade vscode to 1.25.1-3</title>
    <url>/2018/08/15/Downgrade-vscode-to-1-25-1-3/</url>
    <content><![CDATA[<h1 id="Sunny-day"><a href="#Sunny-day" class="headerlink" title="Sunny day"></a>Sunny day</h1><p>Happy to update vscode to 1.26.0-2 this morning.</p>
<a id="more"></a>
<blockquote>
<p>How to update?</p>
</blockquote>
<p>Just type</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">sudo pacman -S visual-studio-code-bin</span><br></pre></td></tr></table></figure>
<h1 id="Awful-user-experience"><a href="#Awful-user-experience" class="headerlink" title="Awful user experience"></a>Awful user experience</h1><p>This new <a href="https://code.visualstudio.com/updates/v1_26#_custom-title-bar-and-menus-for-windowslinux" target="_blank" rel="noopener">feature</a> driven me upgrade to this version.</p>
<p>But I would say itâ€™s a bad idea.</p>
<ol>
<li>Title bar is more wide on linux. (ugly)</li>
<li>Title text not align center on top. (too ugly)</li>
</ol>
<p>The feature on UI I can choose to ignore it. Because itâ€™s disabled in default settings.</p>
<p><strong>BUT</strong> I canâ€™t tolerate the new bug. If I try to <code>Open Folder...[Ctrl+K Ctrl+O]</code>, the editor will crash.(OS: Arch Linux x86_64, Kernel: 4.17.14-arch1-1-ARCH, WM: i3)</p>
<p>so I need to downgrade.</p>
<h1 id="How-to-downgrade"><a href="#How-to-downgrade" class="headerlink" title="How to downgrade"></a>How to downgrade</h1><p>I installed vscode via <code>yaourt</code>, but itâ€™s not support downgrade option. So I google this problem.</p>
<p>Someone said <code>Old packages are normally kept in: /var/cache/pacman/pkg/</code></p>
<p>So check the directoy by <code>ls -l /var/cache/pacman/pkg/visual-studio-code-*</code>, I got this</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">-rw-r--r-- 1 root root 47360116 Jul 13 18:20 /var/cache/pacman/pkg/visual-studio-code-bin-1.25.1-1-x86_64.pkg.tar.xz</span><br><span class="line">-rw-r--r-- 1 root root 47352676 Aug  5 02:39 /var/cache/pacman/pkg/visual-studio-code-bin-1.25.1-3-x86_64.pkg.tar.xz</span><br><span class="line">-rw-r--r-- 1 root root 56026160 Aug 14 18:36 /var/cache/pacman/pkg/visual-studio-code-bin-1.26.0-2-x86_64.pkg.tar.xz</span><br></pre></td></tr></table></figure>
<p>Soooo lucky!</p>
<p>Just use pacman to reinstall the pkg</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">sudo pacman -U /var/cache/pacman/pkg/visual-studio-code-bin-1.25.1-3-x86_64.pkg.tar.xz</span><br></pre></td></tr></table></figure>
<p><em>Awsome <code>pacman</code>, save my life!</em></p>
<h1 id="Refs"><a href="#Refs" class="headerlink" title="Refs"></a>Refs</h1><p><a href="https://bbs.archlinux.org/viewtopic.php?id=95959" target="_blank" rel="noopener">how to downgrade via yaourt</a></p>
]]></content>
      <categories>
        <category>Linux</category>
      </categories>
      <tags>
        <tag>VS Code</tag>
        <tag>Linux</tag>
      </tags>
  </entry>
  <entry>
    <title>screen: Cannot open your terminal &#39;/dev/pts/1&#39;</title>
    <url>/2018/07/25/screen-Cannot-open-your-terminal-dev-pts-1/</url>
    <content><![CDATA[<h1 id="What-happened"><a href="#What-happened" class="headerlink" title="What happened"></a>What happened</h1><p>I bought a Tencent Cloud CVM to hold my DST server few days ago.</p>
<a id="more"></a>
<p>Use screen to run <code>server.sh</code> is perfect. I login <code>UserA</code> to run screen session. Then, use another device to login <code>UserB</code>. When I use <code>UserB</code> to login <code>UserA</code> and run <code>screen -r</code> to continue my screen session, following error occur:</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">Cannot open your terminal <span class="string">'/dev/pts/1'</span> - please check.</span><br></pre></td></tr></table></figure>
<h1 id="How-to-Fix"><a href="#How-to-Fix" class="headerlink" title="How to Fix"></a>How to Fix</h1><p>After login in <code>UserB</code>, run this to get a new <code>tty</code></p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">script /dev/null</span><br></pre></td></tr></table></figure>
<h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><p><a href="http://blog.sina.com.cn/s/blog_704836f401010osn.html" target="_blank" rel="noopener">polygun2000â€™s blog</a></p>
]]></content>
      <categories>
        <category>Linux</category>
      </categories>
      <tags>
        <tag>Linux</tag>
        <tag>Screen</tag>
      </tags>
  </entry>
  <entry>
    <title>Failed to delete using Trash in vscode</title>
    <url>/2018/06/18/Failed-to-delete-using-Trash-in-vscode/</url>
    <content><![CDATA[<h1 id="Update-on-2018-07-25"><a href="#Update-on-2018-07-25" class="headerlink" title="Update on 2018-07-25"></a>Update on 2018-07-25</h1><h2 id="Environment"><a href="#Environment" class="headerlink" title="Environment"></a>Environment</h2><p>OS: Arch linux<br>Desktop: i3 4.15.0.1<br>VScode version: 1.25.1</p>
<a id="more"></a>
<h2 id="Problem"><a href="#Problem" class="headerlink" title="Problem"></a>Problem</h2><p>VScode base on electron, electron will call <code>gvfs-trash</code> to move file to trash.</p>
<p>If you type <code>gvfs-trash</code> in commandline , you may got this problem:</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">This tool has been deprecated, use <span class="string">'gio trash'</span> instead.</span><br><span class="line">See <span class="string">'gio help trash'</span> <span class="keyword">for</span> more info.</span><br></pre></td></tr></table></figure>
<h2 id="Solve"><a href="#Solve" class="headerlink" title="Solve"></a>Solve</h2><p>add this to you environment:</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="built_in">export</span> ELECTRON_TRASH=gio</span><br></pre></td></tr></table></figure>
<h2 id="Refs"><a href="#Refs" class="headerlink" title="Refs"></a>Refs</h2><p><a href="https://github.com/Microsoft/vscode/issues/13189" target="_blank" rel="noopener">Linux: Unable to move file to trash upon delete (#13189)</a></p>
<hr>
<h1 id="Old-record"><a href="#Old-record" class="headerlink" title="Old record"></a>Old record</h1><blockquote>
<p>Following method not work in i3</p>
</blockquote>
<h2 id="Environment-1"><a href="#Environment-1" class="headerlink" title="Environment"></a>Environment</h2><p>Desktop :Gnome 3.28.2<br>VScode version: 1.24.1</p>
<h2 id="Problem-1"><a href="#Problem-1" class="headerlink" title="Problem"></a>Problem</h2><p>When I want to delete file from explorer in vscode, following Error occurs:</p>
<p><code>Failed to delete using the Trash. Do you want to permanently delete instead?</code></p>
<h2 id="Solve-1"><a href="#Solve-1" class="headerlink" title="Solve"></a>Solve</h2><p>Maybe <code>gvfs-trash</code> not work properly. It has been deprecated in this gnome version.<br>So open shell, install another tool for help.</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment">## need python installed</span></span><br><span class="line">sudo easy_install trash-cli</span><br></pre></td></tr></table></figure>
<h2 id="Refs-1"><a href="#Refs-1" class="headerlink" title="Refs"></a>Refs</h2><p><a href="https://github.com/Microsoft/vscode/issues/49675" target="_blank" rel="noopener">Failed to delete using Trash in Ubuntu 18.04 (#49675)</a><br><a href="https://github.com/Microsoft/vscode/issues/22820#issuecomment-288239512" target="_blank" rel="noopener">Moving files to trash always fails in Kubuntu 16.04 (#22820)</a></p>
]]></content>
      <categories>
        <category>Linux</category>
      </categories>
      <tags>
        <tag>VS Code</tag>
        <tag>Linux</tag>
      </tags>
  </entry>
  <entry>
    <title>Install vscode on Arch Linux</title>
    <url>/2018/06/17/Install-vscode-on-Arch-Linux/</url>
    <content><![CDATA[<h1 id="Method-1-official-binary-version-recommend"><a href="#Method-1-official-binary-version-recommend" class="headerlink" title="Method 1: official binary version (recommend)"></a>Method 1: official binary version (recommend)</h1><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">yaourt -S visual-studio-code-bin</span><br></pre></td></tr></table></figure>
<a id="more"></a>
<h1 id="Method-2-open-source-build"><a href="#Method-2-open-source-build" class="headerlink" title="Method 2: open source build"></a>Method 2: open source build</h1><p>first should modify open file limit on your device.</p>
<p>edit <code>/etc/security/limits.conf</code></p>
<p>Add following lines to the end of file</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">*         hard    nofile      500000</span><br><span class="line">*         soft    nofile      500000</span><br><span class="line">root      hard    nofile      500000</span><br><span class="line">root      soft    nofile      500000</span><br></pre></td></tr></table></figure>
<p>Reboot (or log out and back in)</p>
<p>switch to root user <code>sudo su</code></p>
<p>use <code>limit -n</code> to ensure the value is 500000</p>
<p>Then switch back to your user</p>
<p>Just like <code>su - shank</code></p>
<p>Then run</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">sudo yaourt vscode</span><br></pre></td></tr></table></figure>
<p>Then Type <code>4</code> to choose this one</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">4 aur/code 1.24.1-1 (143) (16.35)</span><br><span class="line">    Microsoft Code -- The Open Source build of Visual Studio Code (vscode)</span><br></pre></td></tr></table></figure>
<h1 id="reference"><a href="#reference" class="headerlink" title="reference"></a>reference</h1><ul>
<li><a href="https://easyengine.io/tutorials/linux/increase-open-files-limit/" target="_blank" rel="noopener">Increase â€œOpen Files Limitâ€</a></li>
</ul>
]]></content>
      <categories>
        <category>Linux</category>
      </categories>
      <tags>
        <tag>VS Code</tag>
        <tag>Linux</tag>
        <tag>Arch</tag>
      </tags>
  </entry>
  <entry>
    <title>Install yay (or yaourt) on Arch Linux</title>
    <url>/2018/06/17/Install-yaourt-on-Arch-Linux/</url>
    <content><![CDATA[<h1 id="How-to-install-yay-another-great-AUR-helper"><a href="#How-to-install-yay-another-great-AUR-helper" class="headerlink" title="How to install yay (another great AUR helper)"></a>How to install <a href="https://github.com/Jguer/yay" target="_blank" rel="noopener">yay</a> (another great AUR helper)</h1><blockquote>
<p>Update on 2018/10/16</p>
</blockquote>
<h2 id="Recommended-Use-yay-to-replace-yaourt"><a href="#Recommended-Use-yay-to-replace-yaourt" class="headerlink" title="[Recommended] Use yay to replace yaourt"></a><strong>[Recommended]</strong> Use <code>yay</code> to replace <code>yaourt</code></h2><p>If you already got <code>yaourt</code> just type:</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">yaourt -S yay</span><br></pre></td></tr></table></figure>
<a id="more"></a>
<p>Otherwise, you can also install by <code>makepkg</code></p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">git <span class="built_in">clone</span> https://aur.archlinux.org/yay.git</span><br><span class="line"><span class="built_in">cd</span> yay</span><br><span class="line">makepkg -si</span><br></pre></td></tr></table></figure>
<h2 id="Deprecated-Install-yaourt"><a href="#Deprecated-Install-yaourt" class="headerlink" title="[Deprecated]Install yaourt"></a><strong>[Deprecated]</strong><del>Install <code>yaourt</code></del></h2><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">sudo vim /etc/pacman.conf</span><br></pre></td></tr></table></figure>
<p>Then, add following lines to the end.</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">[archlinuxcn]</span><br><span class="line">Server = http://repo.archlinuxcn.org/<span class="variable">$arch</span></span><br></pre></td></tr></table></figure>
<p>Install the GPG key.</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">sudo pacman -S archlinuxcn-keyring</span><br></pre></td></tr></table></figure>
<p>Finally, update and install yaourt.</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">sudo pacman -Sy yaourt</span><br></pre></td></tr></table></figure>
<p>Done!</p>
<p><a href="https://www.archlinuxcn.org/archlinux-cn-repo-and-mirror/" target="_blank" rel="noopener">reference</a></p>
]]></content>
      <categories>
        <category>Linux</category>
      </categories>
      <tags>
        <tag>Linux</tag>
        <tag>Arch</tag>
      </tags>
  </entry>
  <entry>
    <title>Rimeé»˜è®¤ç®€ä½“ä¸­æ–‡é…ç½®</title>
    <url>/2018/06/09/Rime%E9%BB%98%E8%AE%A4%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87%E9%85%8D%E7%BD%AE/</url>
    <content><![CDATA[<p><a href="https://rime.im/" target="_blank" rel="noopener">Rime</a>è¿™ä¸ªè¾“å…¥æ³•æ˜¯å¾ˆå¼ºå¤§ã€‚</p>
<p>ä½†æ˜¯æˆ‘å¯¹è¾“å…¥æ³•çš„è¦æ±‚ä¸é«˜: èƒ½è¾“å…¥ä¸­æ–‡ï¼›ç•Œé¢ç®€æ´ï¼›è¯æ±‡è”æƒ³åˆ«å¤ªâ€ç¿æ™ºâ€ã€‚</p>
<a id="more"></a>
<p>æ°å¥½è¿™äº›éœ€æ±‚Rimeéƒ½å¾ˆè½»æ¾çš„æ»¡è¶³äº†ï¼Œä½†æ˜¯å”¯ä¸€ä¸çˆ½çš„æ˜¯æ¯æ¬¡åˆ‡æ¢åˆ°Rimeéƒ½é»˜è®¤è¾“å…¥ç¹ä¸­ï¼Œå†F4åˆ‡æ¢ç®€ä¸­å°±å¾ˆä¸æ–¹ä¾¿ã€‚</p>
<p>è™½ç„¶è¿™æ˜¯ä½œè€…çš„å–œå¥½ï¼Œä½†æ˜¯æˆ‘ä¸ä¹ æƒ¯ï¼Œè¿˜å¥½æ–‡æ¡£æä¾›äº†é»˜è®¤ä½¿ç”¨ç®€ä¸­çš„é…ç½®æ–¹æ¡ˆã€‚</p>
<p>è§£å†³æ–¹æ¡ˆï¼š<code>vim ~/.config/ibus/rime/luna_pinyin.custom.yaml</code></p>
<blockquote>
<p>è¿™æ˜¯linuxä¸­çš„ç”¨æˆ·é…ç½®ä½ç½®ï¼Œå…¶ä»–ç³»ç»ŸæŸ¥çœ‹<a href="https://github.com/rime/home/wiki/RimeWithSchemata#rime-%E4%B8%AD%E7%9A%84%E6%95%B8%E6%93%9A%E6%96%87%E4%BB%B6%E5%88%86%E4%BD%88%E5%8F%8A%E4%BD%9C%E7%94%A8" target="_blank" rel="noopener">è¿™é‡Œ</a></p>
</blockquote>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># luna_pinyin.custom.yaml</span></span><br><span class="line"></span><br><span class="line"><span class="attr">patch:</span></span><br><span class="line">  <span class="attr">switches:</span>                   <span class="comment"># æ³¨æ„ç¼©è¿›</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">ascii_mode</span></span><br><span class="line">      <span class="attr">reset:</span> <span class="number">0</span>                <span class="comment"># reset 0 çš„ä½œç”¨æ˜¯å½“ä»å…¶ä»–è¾“å…¥æ³•åˆ‡æ¢åˆ°æœ¬è¾“å…¥æ³•é‡è®¾ä¸ºæŒ‡å®šçŠ¶æ€</span></span><br><span class="line">      <span class="attr">states:</span> <span class="string">[</span> <span class="string">ä¸­æ–‡,</span> <span class="string">è¥¿æ–‡</span> <span class="string">]</span>   <span class="comment"># é€‰æ‹©è¾“å…¥æ–¹æ¡ˆåé€šå¸¸éœ€è¦ç«‹å³è¾“å…¥ä¸­æ–‡ï¼Œæ•…é‡è®¾ ascii_mode = 0</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">full_shape</span></span><br><span class="line">      <span class="attr">states:</span> <span class="string">[</span> <span class="string">åŠè§’,</span> <span class="string">å…¨è§’</span> <span class="string">]</span>   <span class="comment"># è€Œå…¨ï¼åŠè§’åˆ™å¯æ²¿ç”¨ä¹‹å‰æ–¹æ¡ˆçš„ç”¨æ³•ã€‚</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">simplification</span></span><br><span class="line">      <span class="attr">reset:</span> <span class="number">1</span>                <span class="comment"># å¢åŠ è¿™ä¸€è¡Œï¼šé»˜è®¤å¯ç”¨ã€Œç¹â†’ç°¡ã€è½¬æ¢ã€‚</span></span><br><span class="line">      <span class="attr">states:</span> <span class="string">[</span> <span class="string">æ¼¢å­—,</span> <span class="string">æ±‰å­—</span> <span class="string">]</span></span><br></pre></td></tr></table></figure>
<p>å‚è€ƒ <a href="https://github.com/rime/home/wiki/CustomizationG" target="_blank" rel="noopener">Rime å®šåˆ¶æŒ‡å—</a></p>
]]></content>
      <categories>
        <category>Linux</category>
      </categories>
      <tags>
        <tag>Linux</tag>
        <tag>Rime</tag>
      </tags>
  </entry>
  <entry>
    <title>ArchLinuxå®‰è£…è®°å½•</title>
    <url>/2018/06/03/ArchLinux%E5%AE%89%E8%A3%85%E8%AE%B0%E5%BD%95/</url>
    <content><![CDATA[<blockquote>
<p>æœ¬æ•™ç¨‹åœ¨EFIå¯åŠ¨çš„Windows10å°å¼æœºä¸Šå®Œæˆã€‚</p>
</blockquote>
<ol>
<li>Arch Linux 2018.06.01 isoï¼Œ<a href="https://www.archlinux.org/download/" target="_blank" rel="noopener">å®˜ç½‘ä¸‹è½½</a></li>
<li>USB Driver &gt; 1G</li>
<li>Etcher <a href="https://etcher.io/" target="_blank" rel="noopener">å®˜ç½‘ä¸‹è½½</a></li>
</ol>
<a id="more"></a>
<h2 id="ç³»ç»Ÿå®‰è£…"><a href="#ç³»ç»Ÿå®‰è£…" class="headerlink" title="ç³»ç»Ÿå®‰è£…"></a>ç³»ç»Ÿå®‰è£…</h2><h3 id="é¢„ç•™ç©ºé—´"><a href="#é¢„ç•™ç©ºé—´" class="headerlink" title="é¢„ç•™ç©ºé—´"></a>é¢„ç•™ç©ºé—´</h3><p>ä½¿ç”¨ Windows çš„ç£ç›˜ç®¡ç†å·¥å…·å‹ç¼©åˆ†åŒºå·ï¼Œä¸è¦æ ¼å¼åŒ–ã€‚(æˆ‘é¢„ç•™çš„ç©ºé—´ä¸º60Gã€‚)</p>
<h3 id="Uç›˜å¯åŠ¨"><a href="#Uç›˜å¯åŠ¨" class="headerlink" title="Uç›˜å¯åŠ¨"></a>Uç›˜å¯åŠ¨</h3><ol>
<li>ä½¿ç”¨Etcherå°†Archå®‰è£…ç›˜å†™å…¥Uç›˜</li>
<li>é‡å¯ç”µè„‘å¯åŠ¨åˆ°Uç›˜ç³»ç»Ÿ</li>
<li>ä½ å°†çœ‹åˆ° <code>root@archiso ~ #</code></li>
</ol>
<h3 id="åˆ†åŒº"><a href="#åˆ†åŒº" class="headerlink" title="åˆ†åŒº"></a>åˆ†åŒº</h3><p>æŸ¥çœ‹åˆ†åŒºè¡¨ã€‚</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">fdisk -l</span><br></pre></td></tr></table></figure>
<p>è®°å½•ä»¥ä¸‹åˆ†åŒºæ ‡è¯†ã€‚</p>
<ol>
<li><code>EFI System</code> åˆ†åŒºï¼Œæ­¤å¤„ä»¥ <code>/dev/sda1</code> ä¸ºä¾‹ã€‚</li>
<li>å°†è¦å®‰è£… Arch Linux çš„ç¡¬ç›˜ï¼Œæ­¤å¤„ä»¥ <code>/dev/sdb</code> ä¸ºä¾‹ã€‚</li>
<li>æ‰¾åˆ°ä¹‹å‰é¢„ç•™çš„ç©ºé—´ï¼Œæ­¤å¤„ä»¥ <code>/dev/sdb2</code> ä¸ºä¾‹ã€‚</li>
</ol>
<p>ä½¿ç”¨æ–°æ‰‹åˆ†åŒºå·¥å…· <code>cfdisk</code>ã€‚</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">cfdisk /dev/sdb</span><br></pre></td></tr></table></figure>
<p>ä¸Šä¸‹ç§»åŠ¨é€‰æ‹©åˆ° <code>Free Space</code>ï¼Œå·¦å³ç§»åŠ¨é€‰æ‹©åˆ° <code>New</code>ï¼Œåˆ†é…ä¸å†…å­˜ç­‰å¤§å°çš„Swapåˆ†åŒºï¼Œæ­¤å¤„è¾“å…¥ <code>8G</code>ï¼Œç„¶åå›è½¦ç¡®è®¤ã€‚å†é€‰æ‹© <code>Type</code>ï¼Œåˆ†åŒºç±»å‹æ±‚æ”¹ä¸º <code>Linux swap</code>ã€‚ï¼ˆå½“ç„¶ä¹Ÿå¯ä»¥ä¸åˆ†äº¤æ¢åˆ†åŒºï¼‰</p>
<p>å†æ¬¡é€‰æ‹©å‰©ä½™çš„ <code>Free Space</code>ï¼Œåˆ†å‡º <code>/</code>å’Œ<code>/home</code>ã€‚ï¼ˆå› äººè€Œå¼‚ï¼Œä¸ºäº†æ–¹ä¾¿ï¼Œæˆ‘å‰©ä¸‹çš„åªåˆ†ä¸€ä¸ªåŒºï¼Œç±»å‹ä¸º <code>Linux filesystem</code>ï¼‰</p>
<p>æœ€åé€‰æ‹© <code>Write</code>ï¼Œè¾“å…¥ <code>yes</code>ï¼Œå†é€‰æ‹© <code>Quit</code>ï¼Œé€€å‡ºåˆ†åŒºå·¥å…·ã€‚</p>
<p>å†æ¬¡ <code>fdisk -l</code> æŸ¥çœ‹æ–°çš„åˆ†åŒºè¡¨ï¼Œè®°å½•æ–°åˆ›å»ºçš„åˆ†åŒºæ ‡è¯†ã€‚</p>
<p>æ­¤å¤„ä»¥ 8Gçš„ <code>/dev/sdb2</code> å’Œ 52Gçš„ <code>/dev/sdb4</code> ä¸ºä¾‹ã€‚</p>
<p>ä¹Ÿå¯ä»¥ä½¿ç”¨ä¸‹é¢å‘½ä»¤å°†æ–°åˆ†åŒºæ ¼å¼åŒ–ã€‚</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">mkfs.ext4 /dev/sdb4</span><br><span class="line">mkswap /dev/sdb2</span><br></pre></td></tr></table></figure>
<h2 id="å®‰è£…ç³»ç»Ÿ"><a href="#å®‰è£…ç³»ç»Ÿ" class="headerlink" title="å®‰è£…ç³»ç»Ÿ"></a>å®‰è£…ç³»ç»Ÿ</h2><h3 id="æŒ‚è½½åˆ†åŒº"><a href="#æŒ‚è½½åˆ†åŒº" class="headerlink" title="æŒ‚è½½åˆ†åŒº"></a>æŒ‚è½½åˆ†åŒº</h3><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Linux filesystem</span></span><br><span class="line">mount /dev/sdb4 /mnt</span><br><span class="line"><span class="comment"># EFI system</span></span><br><span class="line">mkdir -p /mnt/boot/efi</span><br><span class="line">mount /dev/sda1 /mnt/boot/efi</span><br><span class="line"><span class="comment"># Linux swap</span></span><br><span class="line">swapon /dev/sdb2</span><br></pre></td></tr></table></figure>
<h3 id="é…ç½®é•œåƒæº"><a href="#é…ç½®é•œåƒæº" class="headerlink" title="é…ç½®é•œåƒæº"></a>é…ç½®é•œåƒæº</h3><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="built_in">cd</span> /etc/pacman.d</span><br><span class="line">mv ./mirrorlist ./mirrorlist.bak</span><br><span class="line">touch mirrorlist</span><br><span class="line"><span class="built_in">echo</span> <span class="string">'Server = http://mirrors.163.com/archlinux/$repo/os/$arch'</span> &gt; ./mirrorlist</span><br></pre></td></tr></table></figure>
<h3 id="è”ç½‘"><a href="#è”ç½‘" class="headerlink" title="è”ç½‘"></a>è”ç½‘</h3><p>æœ‰çº¿è¿æ¥å¯è·³è¿‡è¿™æ­¥ï¼Œæ— çº¿è¿æ¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æ‰¾åˆ°ï¼·i-Fiï¼Œæ‰¾åˆ°å¹¶è¾“å…¥å¯†ç å³å¯ã€‚</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">wifi-menu</span><br></pre></td></tr></table></figure>
<h3 id="å¼€å§‹å®‰è£…é…ç½®"><a href="#å¼€å§‹å®‰è£…é…ç½®" class="headerlink" title="å¼€å§‹å®‰è£…é…ç½®"></a>å¼€å§‹å®‰è£…é…ç½®</h3><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># è®¾ç½®ç³»ç»Ÿæ—¶é—´</span></span><br><span class="line">timedatectl <span class="built_in">set</span>-ntp <span class="literal">true</span></span><br><span class="line"><span class="comment"># åˆ·æ–°æœ¬åœ°æ•°æ®åº“</span></span><br><span class="line">pacman -Syy</span><br><span class="line"><span class="comment"># å®‰è£…åŸºç¡€ç³»ç»Ÿ</span></span><br><span class="line">pacstrap -i /mnt base base-devel</span><br><span class="line"></span><br><span class="line"><span class="comment"># å›è½¦ä¸¤æ¬¡ç„¶åè¾“å…¥yä¹‹åç­‰ä¸€ä¼šâ€¦â€¦</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ç”Ÿæˆ fstab æ–‡ä»¶</span></span><br><span class="line">genfstab -U /mnt &gt;&gt; /mnt/etc/fstab</span><br><span class="line"><span class="comment"># åˆ‡æ¢åˆ°å·²å®‰è£…çš„ArchLinux</span></span><br><span class="line">arch-chroot /mnt</span><br><span class="line"><span class="comment"># è®¾ç½®æ—¶åŒº</span></span><br><span class="line">ln -sf /usr/share/zoneinfo/Asia/Shanghai /etc/localtime</span><br><span class="line"><span class="comment"># æ—¶é’Ÿè®¾ç½® ä½¿ç”¨UTCä¼šå¯¼è‡´åŒç³»ç»Ÿæ—¶é—´ä¸åŒ æ­¤å¤„ç”¨å¯ä»¥ç”¨localtime</span></span><br><span class="line">hwclock --systohc -l</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç½‘ç»œ</span></span><br><span class="line">pacman -S iw wpa_supplicant dialog</span><br><span class="line"><span class="comment"># å­—ä½“</span></span><br><span class="line">pacman -S ttf-dejavu wqy-microhei wqy-zenhei</span><br><span class="line"><span class="comment"># éŸ³é¢‘</span></span><br><span class="line">pacman -S alsa-utils</span><br><span class="line"><span class="comment"># vim &amp; ssh</span></span><br><span class="line">pacman -S vim openssh</span><br><span class="line"><span class="comment"># å¼•å¯¼å·¥å…·</span></span><br><span class="line">pacman -S dosfstools grub efibootmgr os-prober</span><br><span class="line">grub-install --efi-directory=/boot/efi --bootloader-id=ArchLinux --recheck</span><br><span class="line">grub-mkconfig -o /boot/grub/grub.cfg</span><br><span class="line"><span class="comment"># P.Så¿½ç•¥æ‰§è¡Œ grub-mkconfig ä¸‹æ–¹çš„é”™è¯¯ï¼Œå‰å‡ è¡ŒåŒ…å« Found XXX.img å°±è¡Œ</span></span><br></pre></td></tr></table></figure>
<h3 id="æœ¬åœ°åŒ–"><a href="#æœ¬åœ°åŒ–" class="headerlink" title="æœ¬åœ°åŒ–"></a>æœ¬åœ°åŒ–</h3><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">vim /etc/locale.gen</span><br></pre></td></tr></table></figure>
<p>åˆ é™¤ä¸‹é¢å››å¥å‰é¢çš„<code>#</code></p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment">#en_US.UTF-8 UTF-8</span></span><br><span class="line"><span class="comment">#zh_CN.GBK GBK</span></span><br><span class="line"><span class="comment">#zh_CN.UTF-8 UTF-8</span></span><br><span class="line"><span class="comment">#zh_CN.GB2312</span></span><br></pre></td></tr></table></figure>
<p>ç„¶åç”Ÿæˆæ›´æ–°</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">locale-gen</span><br><span class="line"><span class="built_in">echo</span> <span class="string">'LANG=en_US.UTF-8'</span> &gt; /etc/locale.conf</span><br></pre></td></tr></table></figure>
<h3 id="è®¾ç½®ä¸»æœºå"><a href="#è®¾ç½®ä¸»æœºå" class="headerlink" title="è®¾ç½®ä¸»æœºå"></a>è®¾ç½®ä¸»æœºå</h3><blockquote>
<p>è‡ªè¡Œæ›¿æ¢ä¸‹é¢çš„ <code>HOSTNAME</code></p>
</blockquote>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="built_in">echo</span> HOSTNAME &gt; /etc/hostname</span><br><span class="line"><span class="built_in">echo</span> <span class="string">'127.0.0.1   localhost.localdomain   localhost'</span> &gt;&gt; /etc/hosts</span><br><span class="line"><span class="built_in">echo</span> <span class="string">'::1         localhost.localdomain   localhost'</span> &gt;&gt; /etc/hosts</span><br><span class="line"><span class="built_in">echo</span> <span class="string">'127.0.1.1   HOSTNAME.localdomain    HOSTNAME'</span>  &gt;&gt;/etc/hosts</span><br></pre></td></tr></table></figure>
<h3 id="é‡å¯"><a href="#é‡å¯" class="headerlink" title="é‡å¯"></a>é‡å¯</h3><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="built_in">exit</span></span><br><span class="line">umount -R /mnt</span><br><span class="line">reboot</span><br></pre></td></tr></table></figure>
<h3 id="ç”¨æˆ·è®¾ç½®"><a href="#ç”¨æˆ·è®¾ç½®" class="headerlink" title="ç”¨æˆ·è®¾ç½®"></a>ç”¨æˆ·è®¾ç½®</h3><p>é‡å¯è¿›å…¥ArchLinuxï¼Œè¾“å…¥<code>root</code>ï¼Œå›è½¦å³å¯ç™»å½•ã€‚</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># ä¸ºrootè®¾ç½®å¯†ç </span></span><br><span class="line">passwd root</span><br><span class="line"><span class="comment"># æ·»åŠ æ™®é€šç”¨æˆ·,ä»¥shankä¸ºä¾‹ã€‚</span></span><br><span class="line">useradd -m -g users -s /bin/bash shank</span><br><span class="line"><span class="comment"># è®¾ç½®æ–°ç”¨æˆ·å¯†ç </span></span><br><span class="line">passwd shank</span><br><span class="line"><span class="comment"># è®¾ç½®sudoæƒé™</span></span><br><span class="line">vim /etc/sudoers</span><br><span class="line"><span class="comment"># åœ¨root ALL=(ALL) ALL ä¸‹ä¸€è¡Œæ·»åŠ  shank ALL=(ALL) ALL</span></span><br><span class="line"><span class="comment"># å»æ‰ #%wheel ALL=(ALL) ALL å‰é¢çš„â€˜#â€™å·</span></span><br></pre></td></tr></table></figure>
<h2 id="æ¡Œé¢ç¯å¢ƒ"><a href="#æ¡Œé¢ç¯å¢ƒ" class="headerlink" title="æ¡Œé¢ç¯å¢ƒ"></a>æ¡Œé¢ç¯å¢ƒ</h2><h3 id="å®‰è£…æ˜¾å¡é©±åŠ¨"><a href="#å®‰è£…æ˜¾å¡é©±åŠ¨" class="headerlink" title="å®‰è£…æ˜¾å¡é©±åŠ¨"></a>å®‰è£…æ˜¾å¡é©±åŠ¨</h3><p>è¿è¡Œä¸‹é¢çš„å‘½ä»¤ï¼Œå…ˆç¡®å®šæ˜¾å¡å‹å·ï¼Œè®°ä¸‹ <code>BusID</code>ï¼Œç±»ä¼¼ <code>00:02.0 VGA ...</code></p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">lspci | grep VGA</span><br></pre></td></tr></table></figure>
<p>åŒæ˜¾å¡ä¼šæœ‰äº›éº»çƒ¦ï¼Œå‚è€ƒå®˜æ–¹æ–‡æ¡£<a href="https://wiki.archlinux.org/index.php/NVIDIA_Optimus" target="_blank" rel="noopener">NVIDIA_Optimus</a></p>
<p>ä¾æ¬¡è¿è¡Œä»¥ä¸‹å‘½ä»¤ã€‚</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># å¦‚æœæ²¡æœ‰è”ç½‘ï¼Œä½ éœ€è¦å…ˆè”ç½‘</span></span><br><span class="line">wifi-menu</span><br><span class="line"><span class="comment"># intelæ˜¾å¡</span></span><br><span class="line">pacman -S xf86-video-intel</span><br><span class="line"><span class="comment"># nvidiaæ˜¾å¡</span></span><br><span class="line">pacman -S nvidia nvidia-libgl</span><br><span class="line"><span class="comment"># æ˜¾ç¤ºè¾“å‡º</span></span><br><span class="line">pacman -S xorg-xrandr</span><br><span class="line"><span class="comment"># ç”Ÿæˆé…ç½®ï¼Œå°†ä½äº /etc/X11/xorg.conf</span></span><br><span class="line">nvidia-xconfig</span><br></pre></td></tr></table></figure>
<h3 id="åŒæ˜¾å¡çš„é…ç½®"><a href="#åŒæ˜¾å¡çš„é…ç½®" class="headerlink" title="åŒæ˜¾å¡çš„é…ç½®"></a>åŒæ˜¾å¡çš„é…ç½®</h3><p>å…ˆé…ç½®xorg.conf</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">vim /etc/X11/xorg.conf</span><br></pre></td></tr></table></figure>
<p>å‚ç…§ä¸‹é¢å†…å®¹é…ç½®Nå¡ï¼Œ<code>BusID</code>é‚£é‡ŒNå¡ä¸€èˆ¬æ˜¯<code>PCI:1:0:0</code>,ä¹‹å‰æŸ¥åˆ°çš„BusIDä¸º<code>00:02.0</code>åˆ™è¿™é‡Œå¡«<code>PCI:0:2:0</code>ã€‚</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Section &quot;Module&quot;</span><br><span class="line">    Load &quot;modesetting&quot;</span><br><span class="line">EndSection</span><br><span class="line"></span><br><span class="line">Section &quot;Device&quot;</span><br><span class="line">    Identifier &quot;nvidia&quot;</span><br><span class="line">    Driver &quot;nvidia&quot;</span><br><span class="line">    BusID &quot;PCI:1:0:0&quot;</span><br><span class="line">    Option &quot;AllowEmptyInitialConfiguration&quot;</span><br><span class="line">EndSection</span><br></pre></td></tr></table></figure>
<p>ä¿å­˜åï¼Œåœ¨ç¼–è¾‘Intel.conf</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">vim /etc/X11/xorg.conf.d/20-intel.conf</span><br></pre></td></tr></table></figure>
<p>æ‰¾ä¸‹é¢å†…å®¹ä¿®æ”¹ï¼Œæ³¨æ„BusIDæŒ‰å®é™…å¡«å†™ã€‚</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">Section <span class="string">"Device"</span></span><br><span class="line">    Identifier <span class="string">"intel"</span></span><br><span class="line">    Driver <span class="string">"modesetting"</span></span><br><span class="line">    BusID <span class="string">"PCI:0:2:0"</span></span><br><span class="line">EndSection</span><br></pre></td></tr></table></figure>
<h3 id="å®‰è£…KDEæ¡Œé¢ç¯å¢ƒ"><a href="#å®‰è£…KDEæ¡Œé¢ç¯å¢ƒ" class="headerlink" title="å®‰è£…KDEæ¡Œé¢ç¯å¢ƒ"></a>å®‰è£…KDEæ¡Œé¢ç¯å¢ƒ</h3><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">pacman -S plasma kdebase kde-l10n-zh_cn</span><br><span class="line">pacman -S xf86-input-synaptics</span><br></pre></td></tr></table></figure>
<p>ä¿®æ”¹ <a href="https://wiki.archlinux.org/index.php/NVIDIA_Optimus#Display_Managers" target="_blank" rel="noopener">Display Manager</a></p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="string">'xrandr --setprovideroutputsource modesetting NVIDIA-0'</span> &gt;&gt; /usr/share/sddm/scripts/Xsetup</span><br><span class="line"><span class="built_in">echo</span> <span class="string">'xrandr --auto'</span> &gt;&gt; /usr/share/sddm/scripts/Xsetup</span><br></pre></td></tr></table></figure>
<p>æµ‹è¯•æ˜¯å¦å¯ä»¥è¿›å…¥æ¡Œé¢</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">systemctl start sddm</span><br></pre></td></tr></table></figure>
<h3 id="æ¡Œé¢æ­£å¸¸å¯åŠ¨å"><a href="#æ¡Œé¢æ­£å¸¸å¯åŠ¨å" class="headerlink" title="æ¡Œé¢æ­£å¸¸å¯åŠ¨å"></a>æ¡Œé¢æ­£å¸¸å¯åŠ¨å</h3><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># è®¾ç½®æ¡Œé¢è‡ªå¯åŠ¨</span></span><br><span class="line">sudo systemctl <span class="built_in">enable</span> sddm</span><br><span class="line"><span class="comment"># å¼€å¯æ¡Œé¢ï¼·iFié…ç½®</span></span><br><span class="line">sudo systemctl <span class="built_in">enable</span> NetworkManager</span><br><span class="line"><span class="comment"># å¯åŠ¨èœå•æ·»åŠ ç¼ºå¤±çš„windowså¯åŠ¨é¡¹ï¼ˆå¯é€‰ï¼‰</span></span><br><span class="line">sudo grub-mkconfig -o /boot/grub/grub.cfg</span><br></pre></td></tr></table></figure>
<h2 id="é…ç½®æ¢¯å­"><a href="#é…ç½®æ¢¯å­" class="headerlink" title="é…ç½®æ¢¯å­"></a>é…ç½®æ¢¯å­</h2><h3 id="å®‰è£…å·¥å…·"><a href="#å®‰è£…å·¥å…·" class="headerlink" title="å®‰è£…å·¥å…·"></a>å®‰è£…å·¥å…·</h3><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">sudo pacman -S shadowsocks privoxy</span><br></pre></td></tr></table></figure>
<h3 id="ssé…ç½®æ–‡ä»¶"><a href="#ssé…ç½®æ–‡ä»¶" class="headerlink" title="ssé…ç½®æ–‡ä»¶"></a>ssé…ç½®æ–‡ä»¶</h3><p>ç¼–è¾‘é…ç½®æ–‡ä»¶ã€‚</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">vim ~/ss-local.json</span><br></pre></td></tr></table></figure>
<p>æ ¼å¼å¦‚ä¸‹:</p>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">"server"</span>: <span class="string">"0.0.0.0"</span>,</span><br><span class="line">    <span class="attr">"server_port"</span>: <span class="number">0000</span>,</span><br><span class="line">    <span class="attr">"password"</span>: <span class="string">"0000"</span>,</span><br><span class="line">    <span class="attr">"method"</span>: <span class="string">"aes-256-cfb"</span>,</span><br><span class="line">    <span class="attr">"local_address"</span>: <span class="string">"127.0.0.1"</span>,</span><br><span class="line">    <span class="attr">"local_port"</span>: <span class="number">1080</span>,</span><br><span class="line">    <span class="attr">"fast_open"</span>: <span class="literal">false</span>,</span><br><span class="line">    <span class="attr">"workers"</span>: <span class="number">2</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç§»åŠ¨åˆ° <code>/etc</code>ã€‚</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">sudo mv ~/ss-local.json /etc/ss-local.json</span><br></pre></td></tr></table></figure>
<h3 id="æµ‹è¯•ssè¿æ¥"><a href="#æµ‹è¯•ssè¿æ¥" class="headerlink" title="æµ‹è¯•ssè¿æ¥"></a>æµ‹è¯•ssè¿æ¥</h3><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># å¯åŠ¨sslocal</span></span><br><span class="line">sudo su</span><br><span class="line">nohup sslocal -c /etc/ss-local.json &lt; /dev/null &amp;&gt;&gt; /var/<span class="built_in">log</span>/ss-local.log &amp;</span><br><span class="line"><span class="comment"># è®¾ç½®ä¸´æ—¶å…¨å±€ä»£ç†</span></span><br><span class="line"><span class="built_in">export</span> http_proxy=<span class="string">"socks5://127.0.0.1:1080"</span>;<span class="built_in">export</span> https_proxy=<span class="variable">$http_proxy</span></span><br><span class="line"><span class="comment"># ç„¶åè®¿é—®ä¸‹Googleï¼Œæœ‰è¿”å›htmlå°±æˆäº†ã€‚</span></span><br><span class="line">curl -skL www.google.com</span><br></pre></td></tr></table></figure>
<h3 id="ä½¿ç”¨gfwlisté€‰æ‹©ä»£ç†"><a href="#ä½¿ç”¨gfwlisté€‰æ‹©ä»£ç†" class="headerlink" title="ä½¿ç”¨gfwlisté€‰æ‹©ä»£ç†"></a>ä½¿ç”¨gfwlisté€‰æ‹©ä»£ç†</h3><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># è·å– gfwlist2privoxy è„šæœ¬</span></span><br><span class="line">curl -skL https://raw.github.com/zfl9/gfwlist2privoxy/master/gfwlist2privoxy -o gfwlist2privoxy</span><br><span class="line"><span class="comment"># ç”Ÿæˆ gfwlist.action æ–‡ä»¶</span></span><br><span class="line">bash gfwlist2privoxy <span class="string">'127.0.0.1:1080'</span></span><br><span class="line"><span class="comment"># æ‹·è´è‡³ privoxy é…ç½®ç›®å½•</span></span><br><span class="line">cp -af gfwlist.action /etc/privoxy/</span><br><span class="line"><span class="comment"># åŠ è½½ gfwlist.action æ–‡ä»¶</span></span><br><span class="line">sudo su</span><br><span class="line"><span class="built_in">echo</span> <span class="string">'actionsfile gfwlist.action'</span> &gt;&gt; /etc/privoxy/config</span><br><span class="line"><span class="comment"># å¯åŠ¨ privoxy.service æœåŠ¡</span></span><br><span class="line">systemctl start privoxy.service</span><br></pre></td></tr></table></figure>
<h3 id="éªŒè¯ä»£ç†åˆ‡æ¢"><a href="#éªŒè¯ä»£ç†åˆ‡æ¢" class="headerlink" title="éªŒè¯ä»£ç†åˆ‡æ¢"></a>éªŒè¯ä»£ç†åˆ‡æ¢</h3><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="built_in">unset</span> http_proxy https_proxy no_proxy</span><br><span class="line"><span class="comment"># è®¾ç½®ä¸´æ—¶å˜é‡ï¼Œprivoxy é»˜è®¤ç›‘å¬ç«¯å£ä¸º 8118</span></span><br><span class="line"><span class="built_in">export</span> proxy=http://127.0.0.1:8118; <span class="built_in">export</span> http_proxy=<span class="variable">$proxy</span> https_proxy=<span class="variable">$proxy</span> no_proxy=<span class="string">"localhost, 127.0.0.1, ::1"</span></span><br><span class="line"><span class="comment"># å¯ä»¥çœ‹åˆ°è¿”å›å€¼ï¼Œè¯´æ˜ä»£ç†æˆåŠŸ</span></span><br><span class="line">curl -skL www.google.com</span><br><span class="line"><span class="comment"># æŸ¥çœ‹å½“å‰IPï¼Œè‹¥æ˜¯å¢™å†…IPè¯´æ˜gfwlisté…ç½®æˆåŠŸ</span></span><br><span class="line">curl -4skL http://ip.chinaz.com/getip.aspx</span><br></pre></td></tr></table></figure>
<h3 id="shellè„šæœ¬çš„æ–¹å¼"><a href="#shellè„šæœ¬çš„æ–¹å¼" class="headerlink" title="shellè„šæœ¬çš„æ–¹å¼"></a>shellè„šæœ¬çš„æ–¹å¼</h3><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># æ–°å»ºæ–‡ä»¶</span></span><br><span class="line">touch ss-privoxy</span><br><span class="line"><span class="comment"># èµ‹äºˆæ‰§è¡Œæƒé™</span></span><br><span class="line">sudo chmod +x ss-privoxy</span><br><span class="line"><span class="comment"># ç§»åˆ°PATHè·¯å¾„</span></span><br><span class="line">mv -af ss-privoxy /usr/<span class="built_in">local</span>/bin/</span><br><span class="line"><span class="comment"># ç¼–è¾‘</span></span><br><span class="line">sudo vim /usr/<span class="built_in">local</span>/bin/ss-privoxy</span><br></pre></td></tr></table></figure>
<p>è„šæœ¬å†…å®¹å¦‚ä¸‹ï¼š</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="keyword">case</span> <span class="variable">$1</span> <span class="keyword">in</span></span><br><span class="line">start)</span><br><span class="line">    nohup sslocal -c /etc/ss-local.json &lt; /dev/null &amp;&gt;&gt; /var/<span class="built_in">log</span>/ss-local.log &amp;</span><br><span class="line">    systemctl start privoxy</span><br><span class="line">    proxy=<span class="string">"http://127.0.0.1:8118"</span></span><br><span class="line">    <span class="built_in">export</span> http_proxy=<span class="variable">$proxy</span></span><br><span class="line">    <span class="built_in">export</span> https_proxy=<span class="variable">$proxy</span></span><br><span class="line">    <span class="built_in">export</span> no_proxy=<span class="string">"localhost, 127.0.0.1, ::1"</span></span><br><span class="line">    ;;</span><br><span class="line">stop)</span><br><span class="line">    <span class="built_in">unset</span> http_proxy https_proxy no_proxy</span><br><span class="line">    systemctl stop privoxy</span><br><span class="line">    pkill sslocal</span><br><span class="line">    ;;</span><br><span class="line">reload)</span><br><span class="line">    pkill sslocal</span><br><span class="line">    nohup sslocal -c /etc/ss-local.json &lt; /dev/null &amp;&gt;&gt; /var/<span class="built_in">log</span>/ss-local.log &amp;</span><br><span class="line">    ;;</span><br><span class="line"><span class="built_in">set</span>)</span><br><span class="line">    proxy=<span class="string">"http://127.0.0.1:8118"</span></span><br><span class="line">    <span class="built_in">export</span> http_proxy=<span class="variable">$proxy</span></span><br><span class="line">    <span class="built_in">export</span> https_proxy=<span class="variable">$proxy</span></span><br><span class="line">    <span class="built_in">export</span> no_proxy=<span class="string">"localhost, 127.0.0.1, ::1"</span></span><br><span class="line">    ;;</span><br><span class="line"><span class="built_in">unset</span>)</span><br><span class="line">    <span class="built_in">unset</span> http_proxy https_proxy no_proxy</span><br><span class="line">    ;;</span><br><span class="line">*)</span><br><span class="line">    <span class="built_in">echo</span> <span class="string">"usage: source <span class="variable">$0</span> start|stop|reload|set|unset"</span></span><br><span class="line">    <span class="built_in">exit</span> 1</span><br><span class="line">    ;;</span><br><span class="line"><span class="keyword">esac</span></span><br></pre></td></tr></table></figure>
<p>é…ç½®å‘½ä»¤åˆ«åï¼š <code>sudo vim /etc/profile.d/ss-privoxy.sh</code></p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="built_in">alias</span> ss.start=<span class="string">'. ss-privoxy start'</span></span><br><span class="line"><span class="built_in">alias</span> ss.stop=<span class="string">'. ss-privoxy stop'</span></span><br><span class="line"><span class="built_in">alias</span> ss.reload=<span class="string">'. ss-privoxy reload'</span></span><br><span class="line"><span class="built_in">alias</span> ss.set=<span class="string">'. ss-privoxy set'</span></span><br><span class="line"><span class="built_in">alias</span> ss.unset=<span class="string">'. ss-privoxy unset'</span></span><br></pre></td></tr></table></figure>
<p>ä½¿ç”¨è¯´æ˜ï¼š</p>
<ul>
<li>ss.startï¼šå¯åŠ¨ ss-local+privoxy ä»£ç†</li>
<li>ss.stopï¼šåœç”¨ ss-local+privoxy ä»£ç†</li>
<li>ss.reloadï¼šé‡è½½ ss-local.json é…ç½®æ–‡ä»¶</li>
<li>ss.setï¼šè®¾ç½® shell_proxy ç¯å¢ƒå˜é‡</li>
<li>ss.unsetï¼šåˆ é™¤ shell_proxy ç¯å¢ƒå˜é‡</li>
</ul>
<h2 id="è½¯ä»¶å®‰è£…"><a href="#è½¯ä»¶å®‰è£…" class="headerlink" title="è½¯ä»¶å®‰è£…"></a>è½¯ä»¶å®‰è£…</h2><h3 id="åˆ†å‘ä»“åº“é‡Œå¯ä»¥æ‰¾åˆ°çš„"><a href="#åˆ†å‘ä»“åº“é‡Œå¯ä»¥æ‰¾åˆ°çš„" class="headerlink" title="åˆ†å‘ä»“åº“é‡Œå¯ä»¥æ‰¾åˆ°çš„"></a>åˆ†å‘ä»“åº“é‡Œå¯ä»¥æ‰¾åˆ°çš„</h3><p>å®‰è£…å‰å…ˆæŸ¥æ‰¾è½¯ä»¶åŒ…æ˜¯å¦å­˜åœ¨ï¼Œä»¥<code>ibus</code>ä¸ºä¾‹ï¼š</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># æŸ¥æ‰¾ä¸ibusç›¸å…³çš„åŒ…</span></span><br><span class="line">pacman -Ss ibus</span><br><span class="line"><span class="comment"># è¿™é‡Œæ”¯æŒæ­£åˆ™åŒ¹é…çš„ï¼Œè¿˜å¯ä»¥è¿™ä¹ˆå†™ï¼Œæ›´å¤šæŸ¥çœ‹ man pacman</span></span><br><span class="line">pacman -Ss <span class="string">'^ibus-*'</span></span><br></pre></td></tr></table></figure>
<p>è¿™é‡Œæˆ‘é€‰æ‹©å®‰è£…ibus-rimeè¾“å…¥æ³•</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">sudo pacman -S ibus-rime</span><br></pre></td></tr></table></figure>
<h3 id="AURä¸­å¯ä»¥æ‰¾åˆ°çš„"><a href="#AURä¸­å¯ä»¥æ‰¾åˆ°çš„" class="headerlink" title="AURä¸­å¯ä»¥æ‰¾åˆ°çš„"></a><a href="https://aur.archlinux.org/" target="_blank" rel="noopener">AUR</a>ä¸­å¯ä»¥æ‰¾åˆ°çš„</h3><p>ä»¥å®‰è£…VScodeä¸ºä¾‹ï¼Œè¯¥packageæè¿°é¡µåœ¨<a href="https://aur.archlinux.org/packages/visual-studio-code-bin/" target="_blank" rel="noopener">è¿™é‡Œ</a></p>
<p>ä½ å¯ä»¥å¤åˆ¶<code>Git Clone URL</code>ï¼Œç„¶åæŒ‰ä¸‹é¢æ­¥éª¤å®‰è£…ã€‚</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># å…ˆå®‰è£…Git</span></span><br><span class="line">sudo pacman -S git</span><br><span class="line"><span class="comment"># å°†ä»“åº“cloneä¸‹æ¥</span></span><br><span class="line">git <span class="built_in">clone</span> https://aur.archlinux.org/visual-studio-code-bin.git</span><br><span class="line"><span class="comment"># è¿›å…¥gitç›®å½•</span></span><br><span class="line"><span class="built_in">cd</span> visual-studio-code-bin</span><br><span class="line"><span class="comment"># ç¼–è¯‘å‹ç¼©æˆå®‰è£…åŒ…</span></span><br><span class="line">makepkg -si</span><br><span class="line"><span class="comment"># pacmanå®‰è£… (P.S XXXXXX ä¸ºç‰ˆæœ¬å·)</span></span><br><span class="line">sudo pacman -U visual-studio-code-bin-XXXXXX.pkg.tar.xz</span><br></pre></td></tr></table></figure>
<h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h2><ul>
<li><a href="https://wiki.archlinux.org/index.php/Installation_guide" target="_blank" rel="noopener">Installation guide</a></li>
<li><a href="https://blog.csdn.net/maxsky/article/details/56839855" target="_blank" rel="noopener">ç¬”è®°æœ¬åŒæ˜¾å¡ EFI å¯åŠ¨å®‰è£… ArchLinux</a></li>
<li><a href="https://www.zfl9.com/ss-local.html" target="_blank" rel="noopener">ss-local + privoxy ä»£ç†</a></li>
<li><a href="https://wiki.archlinux.org/index.php/IBus" target="_blank" rel="noopener">IBus</a></li>
</ul>
]]></content>
      <categories>
        <category>Linux</category>
      </categories>
      <tags>
        <tag>Linux</tag>
        <tag>Arch</tag>
      </tags>
  </entry>
  <entry>
    <title>DST Server on Ubuntu16.04 (é¥¥è’æœåŠ¡æ­å»ºæŒ‡å—)</title>
    <url>/2018/05/29/DST-Server-on-Ubuntu16-04/</url>
    <content><![CDATA[<p>ä¸æœ‹å‹ç©DST(é¥¥è’)ï¼Œå¼€ä¸ª5äººå±€ï¼Œå¡åˆ°æ²¡æ³•ç©ï¼Œæ‰€ä»¥æƒ³åŠæ³•æ­ç§æœã€‚</p>
<p>é¦–å…ˆæ„Ÿè°¢<a href="https://www.bilibili.com/video/av12666273/" target="_blank" rel="noopener">è·¯å”çš„è§†é¢‘</a>ä»¥åŠ<a href="https://tieba.baidu.com/p/4159392559" target="_blank" rel="noopener">è¿™ä¸ªå¸–å­</a></p>
<ul>
<li>å¤åˆ¶ç²˜è´´ä»¥ä¸‹è„šæœ¬ä¿å­˜ä¸º <code>install.sh</code></li>
</ul>
<blockquote>
<p>update <code>install.sh</code> at 2018-12-15</p>
</blockquote>
<a id="more"></a>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"></span><br><span class="line">dividing=<span class="string">"================================================================================"</span></span><br><span class="line">commandPath=<span class="string">"steamcmd"</span></span><br><span class="line">commandFile=<span class="string">"./steamcmd.sh"</span></span><br><span class="line"></span><br><span class="line">gamesPath=<span class="string">"Steam/steamapps/common/Don't Starve Together Dedicated Server/bin"</span></span><br><span class="line">gamesFile=<span class="string">"./dontstarve_dedicated_server_nullrenderer"</span></span><br><span class="line"></span><br><span class="line">dataPath=$(<span class="built_in">pwd</span>)/.klei</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> FilesDelete()</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">echo</span> -e <span class="string">"\033[32m[info] Choose File To Delete [1-5]\033[0m"</span></span><br><span class="line">    <span class="built_in">read</span> input_filedelete</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> [ -d <span class="variable">$dataPath</span> ]; <span class="keyword">then</span></span><br><span class="line">        <span class="built_in">cd</span> <span class="variable">$dataPath</span></span><br><span class="line">        <span class="keyword">if</span> [ -d <span class="string">"DoNotStarveServer_<span class="variable">$input_filedelete</span>"</span> ]; <span class="keyword">then</span></span><br><span class="line">            rm -r DoNotStarveServer_<span class="variable">$input_filedelete</span>/save</span><br><span class="line">            <span class="built_in">echo</span> -e <span class="string">"\033[33m[info] File DoNotStarveServer_<span class="variable">$input_filedelete</span> Is Deleted\033[0m"</span></span><br><span class="line">        <span class="keyword">fi</span></span><br><span class="line">        <span class="keyword">if</span> [ -d <span class="string">"DoNotStarveCaves_<span class="variable">$input_filedelete</span>"</span> ]; <span class="keyword">then</span></span><br><span class="line">            rm -r DoNotStarveCaves_<span class="variable">$input_filedelete</span>/save</span><br><span class="line">            <span class="built_in">echo</span> -e <span class="string">"\033[33m[info] File DoNotStarveCaves_<span class="variable">$input_filedelete</span> Is Deleted\033[0m"</span></span><br><span class="line">        <span class="keyword">fi</span></span><br><span class="line">        <span class="built_in">cd</span> <span class="string">"../"</span></span><br><span class="line">    <span class="keyword">fi</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> FilesBackup()</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">echo</span> -e <span class="string">"\033[32m[info] Choose File To Backup [1-5]\033[0m"</span></span><br><span class="line">    <span class="built_in">read</span> input_filebackup</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> [ -d <span class="variable">$dataPath</span> ]; <span class="keyword">then</span></span><br><span class="line">        <span class="built_in">cd</span> <span class="variable">$dataPath</span></span><br><span class="line">        <span class="keyword">if</span> [ -d <span class="string">"DoNotStarveServer_<span class="variable">$input_filebackup</span>"</span> ]; <span class="keyword">then</span></span><br><span class="line">            tar -zcf DoNotStarveServer_<span class="variable">$input_filebackup</span>.tar.gz DoNotStarveServer_<span class="variable">$input_filebackup</span></span><br><span class="line">            <span class="built_in">echo</span> -e <span class="string">"\033[33m[info] File DoNotStarveServer_<span class="variable">$input_filebackup</span> Is Backuped\033[0m"</span></span><br><span class="line">        <span class="keyword">fi</span></span><br><span class="line">        <span class="keyword">if</span> [ -d <span class="string">"DoNotStarveCaves_<span class="variable">$input_filebackup</span>"</span> ]; <span class="keyword">then</span></span><br><span class="line">            tar -zcf DoNotStarveCaves_<span class="variable">$input_filebackup</span>.tar.gz DoNotStarveCaves_<span class="variable">$input_filebackup</span></span><br><span class="line">            <span class="built_in">echo</span> -e <span class="string">"\033[33m[info] File DoNotStarveCaves_<span class="variable">$input_filebackup</span> Is Backuped\033[0m"</span></span><br><span class="line">        <span class="keyword">fi</span></span><br><span class="line">        <span class="built_in">cd</span> <span class="string">"../"</span></span><br><span class="line">    <span class="keyword">fi</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> FilesRecovery()</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">echo</span> -e <span class="string">"\033[32m[info] Choose File To Recovery [1-5]\033[0m"</span></span><br><span class="line">    <span class="built_in">read</span> input_filerecovery</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> [ -d <span class="variable">$dataPath</span> ]; <span class="keyword">then</span></span><br><span class="line">        <span class="built_in">cd</span> <span class="variable">$dataPath</span></span><br><span class="line">        <span class="keyword">if</span> [ -f <span class="string">"DoNotStarveServer_<span class="variable">$input_filerecovery</span>.tar.gz"</span> ]; <span class="keyword">then</span></span><br><span class="line">            <span class="keyword">if</span> [ -d <span class="string">"DoNotStarveServer_<span class="variable">$input_filerecovery</span>"</span> ]; <span class="keyword">then</span></span><br><span class="line">                rm -r DoNotStarveServer_<span class="variable">$input_filerecovery</span></span><br><span class="line">            <span class="keyword">fi</span></span><br><span class="line">            tar -zxf DoNotStarveServer_<span class="variable">$input_filerecovery</span>.tar.gz DoNotStarveServer_<span class="variable">$input_filerecovery</span></span><br><span class="line">            <span class="built_in">echo</span> -e <span class="string">"\033[33m[info] File DoNotStarveServer_<span class="variable">$input_filerecovery</span> Is Recovered\033[0m"</span></span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            <span class="built_in">echo</span> -e <span class="string">"\033[31m[warn] Backup File For DoNotStarveServer_<span class="variable">$input_filerecovery</span> Not Found\033[0m"</span></span><br><span class="line">        <span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> [ -f <span class="string">"DoNotStarveCaves_<span class="variable">$input_filerecovery</span>.tar.gz"</span> ]; <span class="keyword">then</span></span><br><span class="line">            <span class="keyword">if</span> [ -d <span class="string">"DoNotStarveCaves_<span class="variable">$input_filerecovery</span>"</span> ]; <span class="keyword">then</span></span><br><span class="line">                rm -r DoNotStarveCaves_<span class="variable">$input_filerecovery</span></span><br><span class="line">            <span class="keyword">fi</span></span><br><span class="line">            tar -zxf DoNotStarveCaves_<span class="variable">$input_filerecovery</span>.tar.gz DoNotStarveCaves_<span class="variable">$input_filerecovery</span></span><br><span class="line">            <span class="built_in">echo</span> -e <span class="string">"\033[33m[info] File DoNotStarveCaves_<span class="variable">$input_filerecovery</span> Is Recovered\033[0m"</span></span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            <span class="built_in">echo</span> -e <span class="string">"\033[31m[warn] Backup File For DoNotStarveCaves_<span class="variable">$input_filerecovery</span> Not Found\033[0m"</span></span><br><span class="line">        <span class="keyword">fi</span></span><br><span class="line">        <span class="built_in">cd</span> <span class="string">"../"</span></span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        <span class="built_in">echo</span> -e <span class="string">"\033[31m[warn] Main Archive Folder Not Found\033[0m"</span></span><br><span class="line">    <span class="keyword">fi</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> SystemPrepsDetail()</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">echo</span> -e <span class="string">"\033[33m[info] System Library Install\033[0m"</span></span><br><span class="line">    sudo apt-get update</span><br><span class="line">    sudo apt-get install screen</span><br><span class="line">    sudo apt-get install lib32gcc1</span><br><span class="line">    sudo apt-get install lib32stdc++6</span><br><span class="line">    sudo apt-get install libcurl4-gnutls-dev:i386</span><br><span class="line">    <span class="built_in">echo</span> -e <span class="string">"\033[33m[info] System Library Install Finished\033[0m"</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">"<span class="variable">$dividing</span>"</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> SystemPreps()</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">echo</span> -e <span class="string">"\033[33m[info] System Library Preparing\033[0m"</span></span><br><span class="line">    sudo apt-get update                                                         1&gt;/dev/null</span><br><span class="line">    sudo apt-get install screen                                                 1&gt;/dev/null</span><br><span class="line">    sudo apt-get install lib32gcc1                                              1&gt;/dev/null</span><br><span class="line">    sudo apt-get install lib32stdc++6                                           1&gt;/dev/null</span><br><span class="line">    sudo apt-get install libcurl4-gnutls-dev:i386                               1&gt;/dev/null</span><br><span class="line">    <span class="built_in">echo</span> -e <span class="string">"\033[33m[info] System Library Prepare Finished\033[0m"</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">"<span class="variable">$dividing</span>"</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> CommandPreps()</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">echo</span> -e <span class="string">"\033[33m[info] Steam Command Line Files Preparing\033[0m"</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> [ ! -d <span class="string">"<span class="variable">$commandPath</span>"</span> ]; <span class="keyword">then</span></span><br><span class="line">        mkdir <span class="string">"<span class="variable">$commandPath</span>"</span></span><br><span class="line">    <span class="keyword">fi</span></span><br><span class="line">    <span class="built_in">cd</span> <span class="string">"<span class="variable">$commandPath</span>"</span></span><br><span class="line"></span><br><span class="line">    wget https://steamcdn-a.akamaihd.net/client/installer/steamcmd_linux.tar.gz 1&gt;/dev/null</span><br><span class="line">    tar -xvzf steamcmd_linux.tar.gz                                             1&gt;/dev/null</span><br><span class="line">    rm -f steamcmd_linux.tar.gz                                                 1&gt;/dev/null</span><br><span class="line"></span><br><span class="line">    <span class="built_in">echo</span> -e <span class="string">"\033[33m[info] Steam Command Line Files Prepare Finished\033[0m"</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">"<span class="variable">$dividing</span>"</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> ServerStart()</span><br><span class="line">&#123;  </span><br><span class="line">    <span class="built_in">echo</span> -e <span class="string">"\033[32m[info] Choose Game Mode [1.noraml] [2.caves]\033[0m"</span></span><br><span class="line">    <span class="built_in">read</span> input_mode</span><br><span class="line">    <span class="built_in">echo</span> -e <span class="string">"\033[32m[info] Choose Save File [1-5]\033[0m"</span></span><br><span class="line">    <span class="built_in">read</span> input_save</span><br><span class="line"></span><br><span class="line">    <span class="built_in">cd</span> <span class="string">"<span class="variable">$gamesPath</span>"</span></span><br><span class="line">    <span class="keyword">case</span> <span class="variable">$input_mode</span> <span class="keyword">in</span></span><br><span class="line">        1)</span><br><span class="line">            screen -dm -S <span class="string">"DST Server"</span> <span class="string">"<span class="variable">$gamesFile</span>"</span> -conf_dir DoNotStarveServer_<span class="string">"<span class="variable">$input_save</span>"</span>;;</span><br><span class="line">        2)</span><br><span class="line">            screen -dm -S <span class="string">"DST Server"</span> <span class="string">"<span class="variable">$gamesFile</span>"</span> -conf_dir DoNotStarveCaves_<span class="string">"<span class="variable">$input_save</span>"</span>;;</span><br><span class="line">        *)</span><br><span class="line">            <span class="built_in">echo</span> -e <span class="string">"\033[31m[warn] Illegal Command,Please Check\033[0m"</span> ;;</span><br><span class="line">    <span class="keyword">esac</span></span><br><span class="line">    screen -r <span class="string">"DST Server"</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">"<span class="variable">$dividing</span>"</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> ServerPreps()</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">echo</span> -e <span class="string">"\033[33m[info] Preparing Server Files\033[0m"</span></span><br><span class="line">    <span class="keyword">if</span> [ ! -d <span class="string">"<span class="variable">$commandPath</span>"</span> ]; <span class="keyword">then</span></span><br><span class="line">        <span class="built_in">echo</span> -e <span class="string">"\033[31m[warn] Steam Command Line Not Found\033[0m"</span></span><br><span class="line">        CommandPreps</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        <span class="built_in">echo</span> -e <span class="string">"\033[33m[info] Steam Command Line Found\033[0m"</span></span><br><span class="line">        <span class="built_in">cd</span> <span class="string">"<span class="variable">$commandPath</span>"</span></span><br><span class="line">    <span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">echo</span> -e <span class="string">"\033[32m[info] Choose Game Update Mode [1.noraml] [2.caves]\033[0m"</span></span><br><span class="line">    <span class="built_in">read</span> input_game</span><br><span class="line"></span><br><span class="line">    <span class="keyword">case</span> <span class="variable">$input_game</span> <span class="keyword">in</span></span><br><span class="line">        1)</span><br><span class="line">            <span class="string">"<span class="variable">$commandFile</span>"</span> +login anonymous +app_update 343050 validate +quit;;</span><br><span class="line">        2)</span><br><span class="line">            <span class="string">"<span class="variable">$commandFile</span>"</span> +login anonymous +app_update 343050 -beta cavesbeta validate +quit;;</span><br><span class="line">        *)</span><br><span class="line">            <span class="built_in">echo</span> -e <span class="string">"\033[31m[warn] Illegal Command,Please Check\033[0m"</span> ;;</span><br><span class="line">    <span class="keyword">esac</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">cd</span> <span class="string">"../"</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">"<span class="variable">$dividing</span>"</span></span><br><span class="line">    ServerStart</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">clear</span><br><span class="line"><span class="built_in">echo</span> <span class="string">"<span class="variable">$dividing</span>"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> [ ! -d <span class="string">"<span class="variable">$gamesPath</span>"</span> ]; <span class="keyword">then</span></span><br><span class="line">    <span class="built_in">echo</span> -e <span class="string">"\033[31m[warn] Server Files Not Found\033[0m"</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">"<span class="variable">$dividing</span>"</span></span><br><span class="line">    SystemPrepsDetail</span><br><span class="line">    ServerPreps</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">    <span class="built_in">echo</span> -e <span class="string">"\033[32m[info] Server Files Found\033[0m"</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">"<span class="variable">$dividing</span>"</span></span><br><span class="line">    <span class="built_in">echo</span> -e <span class="string">"\033[33m[info] Choose An Action To Perform\033[0m"</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">echo</span> -e <span class="string">"\033[32m[info] System Library Files [0.Prepare]\033[0m"</span></span><br><span class="line">    <span class="built_in">echo</span> -e <span class="string">"\033[32m[info] Game Server [1.start]  [2.update]  [3.process kill]\033[0m"</span></span><br><span class="line">    <span class="built_in">echo</span> -e <span class="string">"\033[32m[info] Save Files  [7.backup] [8.recovery][9.delete]\033[0m"</span></span><br><span class="line">    <span class="built_in">read</span> input_update</span><br><span class="line"></span><br><span class="line">    <span class="keyword">case</span> <span class="variable">$input_update</span> <span class="keyword">in</span></span><br><span class="line">        0)</span><br><span class="line">            SystemPreps</span><br><span class="line">            ;;</span><br><span class="line">        1)</span><br><span class="line">            ServerStart</span><br><span class="line">            ;;</span><br><span class="line">        2)</span><br><span class="line">            ServerPreps</span><br><span class="line">            ;;</span><br><span class="line">        3)</span><br><span class="line">            screen -X -S <span class="string">"DST Server"</span> quit</span><br><span class="line">            ;;</span><br><span class="line">        7)</span><br><span class="line">            FilesBackup</span><br><span class="line">            ;;</span><br><span class="line">        8)</span><br><span class="line">            FilesRecovery</span><br><span class="line">            ;;</span><br><span class="line">        9)</span><br><span class="line">            FilesDelete</span><br><span class="line">            ;;</span><br><span class="line">    <span class="keyword">esac</span></span><br><span class="line"><span class="keyword">fi</span></span><br></pre></td></tr></table></figure>
<ul>
<li>æ·»åŠ è¿è¡Œæƒé™</li>
</ul>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">sudo chmod u+x install.sh</span><br></pre></td></tr></table></figure>
<ul>
<li>è¿è¡Œè„šæœ¬</li>
</ul>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">sh install.sh</span><br><span class="line"><span class="comment"># æŒ‰ä¸‹é¢çš„è¾“å…¥æ•°å­—é€‰æ‹©ï¼š</span></span><br><span class="line"><span class="comment"># Game Mode: 1</span></span><br><span class="line"><span class="comment"># Save File: 1</span></span><br><span class="line"><span class="comment"># Ctrl+c ä¸­æ–­è¿›ç¨‹</span></span><br></pre></td></tr></table></figure>
<ul>
<li>è·å¾— <code>Token</code></li>
</ul>
<p>å¦‚ä½•è·å¾—å‚è€ƒ<a href="http://blog.ttionya.com/article-1235.html" target="_blank" rel="noopener">è¿™é‡Œ</a>ï¼š</p>
<p>æ¸¸æˆä¸»ç•Œé¢å³ä¸‹è§’ <code>Account</code> -&gt; <code>Generate Server Token</code> -&gt; å¤åˆ¶ç²˜è´´ä¿å­˜åˆ° <code>cluster_token.txt</code>ã€‚</p>
<ul>
<li>æœ¬åœ°æ‰“å¼€DSTï¼Œåˆ›å»ºä¸€ä¸ªåœ¨çº¿ä¸–ç•Œï¼ŒMod ä»€ä¹ˆéƒ½è®¾ç½®å¥½ï¼Œç‚¹å‡»å¼€å§‹è¿›æ¸¸æˆï¼Œç„¶åå…³é—­ä¿å­˜æ¸¸æˆã€‚</li>
</ul>
<p>æ‰¾åˆ°å­˜æ¡£ Linuxå­˜æ¡£ä½ç½®ï¼š<code>~/.klei/DoNotStarveTogether</code> Windowså­˜æ¡£ä½ç½®ï¼š<code>%HOMEPATH%\Klei\DoNotStarveTogether\</code>ã€‚</p>
<p>å°†å¯¹åº”çš„ <code>Cluster_X</code> ç›®å½•è¦†ç›–åˆ°äº‘ä¸»æœºçš„ä¸‹é¢ç›®å½•ï¼š<code>~/.klei/DoNotStarveserver_1/</code>ã€‚</p>
<blockquote>
<p>è¿™é‡Œæˆ‘çš„å­˜æ¡£ä¸º <code>Cluster_1</code>ã€‚</p>
</blockquote>
<p><del>å°†ä¸Šä¸€æ­¥è·å¾—çš„ <code>cluster_token.txt</code> æ”¾åˆ° <code>Cluster_X</code> ç›®å½•ä¸‹</del> å­˜æ¡£ç›®å½•ä¸‹å·²å­˜åœ¨è¯¥æ–‡ä»¶å¯ä»¥ä¸ç”¨æ›¿æ¢ã€‚</p>
<ul>
<li>è®°å½•Modç¼–å·</li>
</ul>
<p>æ‰“å¼€å­˜æ¡£ç›®å½•ä¸‹çš„ <code>Master/modoverrides.lua</code> æ–‡ä»¶ï¼Œè®°å½•æ‰€æœ‰çš„ <code>workshop-XXXXXXXXX</code> ä¸­çš„æ•°å­—ç¼–å·ã€‚</p>
<p>æ‰“å¼€ <code>~/Steam/steamapps/common/Don&#39;t Starve Together Dedicated Server/mods/dedocated_server_mods_setup.lua</code> å°†ModæŒ‰ <code>ServerModSetup(&quot;XXXXXXXXX&quot;)</code> çš„æ ¼å¼ä¸€è¡Œä¸€è¡Œå†™è¿›å»å¹¶ä¿å­˜ã€‚</p>
<ul>
<li>å†æ¬¡è¿è¡Œ <code>install.sh</code>ï¼Œé€‰æ‹© <code>1.start</code>ã€‚</li>
</ul>
<p>å‡ åˆ†é’Ÿåå³å¯åœ¨ DST çš„ online åˆ—è¡¨ä¸­æœåˆ°ä½ çš„æœåŠ¡å™¨ã€‚</p>
<blockquote>
<p>æˆ‘ä¸Šé¢å†™çš„æ•™ç¨‹æ²¡å¼€ Caveï¼Œä½ å¯ä»¥é€šè¿‡çœ‹è§†é¢‘æŠŠ Cave æœåŠ¡æ‰“å¼€ï¼Œè¿‡ç¨‹ç±»ä¼¼ã€‚</p>
</blockquote>
]]></content>
      <categories>
        <category>Linux</category>
      </categories>
      <tags>
        <tag>Linux</tag>
        <tag>DST</tag>
      </tags>
  </entry>
  <entry>
    <title>Ubuntu16.04ä¸ŠDockerå…sudoä½¿ç”¨çš„è§£å†³æ–¹å¼</title>
    <url>/2018/04/15/Ubuntu16-04%E4%B8%8ADocker%E5%85%8Dsudo%E4%BD%BF%E7%94%A8%E7%9A%84%E8%A7%A3%E5%86%B3%E6%96%B9%E5%BC%8F/</url>
    <content><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>åœ¨Ubuntu16.04ä¸Šå®‰è£…Docker-ceåï¼Œå‘ç°<code>docker run</code>ä¸éœ€è¦åœ¨<code>sudo</code>ä¸‹è¿è¡Œï¼Œè¿™å°±å¯¼è‡´äº†ä¸€ä¸ªé—®é¢˜VScodeå’ŒPyCharméƒ½è¿ä¸ä¸ŠDockerï¼Œéƒ½æ˜¯å› ä¸ºå»è®¿é—®æƒé™çš„é—®é¢˜ï¼Œå› ä¸ºä¸å»ºè®®ç”¨rootæƒé™ï¼Œæ‰€ä»¥å°±è¦æ‰¾è§£å†³åŠæ³•ã€‚</p>
<a id="more"></a>
<h1 id="è§£å†³"><a href="#è§£å†³" class="headerlink" title="è§£å†³"></a>è§£å†³</h1><ol>
<li><p>ä¿®æ”¹æœåŠ¡æ–‡ä»¶</p>
<p> ä¿®æ”¹ <code>/lib/systemd/system/docker.service</code></p>
 <figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">sudo vim /lib/systemd/system/docker.service</span><br></pre></td></tr></table></figure>
<p> æ‰¾åˆ°è¿™ä¸€è¡Œ<code>ExecStart=/usr/bin/dockerd fd://</code>ï¼Œæ›¿æ¢ä¸º</p>
 <figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment">## å¤§æ¦‚æ˜¯å¼€å¯äº†dockerçš„tcpè®¿é—®å’Œunixè®¿é—®</span></span><br><span class="line">ExecStart=/usr/bin/dockerd -H tcp://0.0.0.0:2375 -H unix:///var/run/docker.sock</span><br></pre></td></tr></table></figure>
<p> æ¥ç€ä¿®æ”¹ <code>/etc/init.d/docker</code></p>
 <figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">sudo vim /etc/init.d/docker</span><br></pre></td></tr></table></figure>
<p> æ‰¾åˆ°è¿™ä¸€è¡Œ <code>DOCKER_OPTS=</code>ï¼Œåšç±»ä¼¼çš„ä¿®æ”¹</p>
 <figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">DOCKER_OPTS=<span class="string">"-H tcp://0.0.0.0:2375 -H unix:///var/run/docker.sock"</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>æ·»åŠ ç”¨æˆ·åˆ°dockerç»„</p>
 <figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">sudo usermod -aG docker <span class="variable">$USER</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>æœ€åé‡å¯ä½ çš„ç³»ç»Ÿ</p>
 <figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">sudo reboot</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h1 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h1><p><a href="https://forums.docker.com/t/cannot-connect-to-the-docker-daemon-is-the-docker-daemon-running-on-this-host/8925/15" target="_blank" rel="noopener">cannot-connect-to-the-docker-daemon-is-the-docker-daemon-running-on-this-host</a></p>
]]></content>
      <categories>
        <category>Linux</category>
      </categories>
      <tags>
        <tag>Ubuntu</tag>
        <tag>docker</tag>
      </tags>
  </entry>
  <entry>
    <title>Linuxä¸‹ä½¿ç”¨SSæœ¬åœ°ä»£ç†</title>
    <url>/2018/04/15/Linux%E4%B8%8B%E4%BD%BF%E7%94%A8SS%E6%9C%AC%E5%9C%B0%E4%BB%A3%E7%90%86/</url>
    <content><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>å‡¡æ˜¯è¦Codingï¼Œå…ä¸äº†ä¸ŠGoogleï¼Œä¸å¾—ä¸è¯´SSçš„Windowsç‰ˆä½“éªŒæ›´å¥½ã€‚</p>
<p>Linuxç‰ˆæˆ‘æ€»æ˜¯æŒ‚å…¨å±€ä»£ç†ï¼Œå›½å¤–IPä¸èƒ½çœ‹Bç«™æ­£ç‰ˆç•ªå°±å¾ˆéš¾å—ã€‚</p>
<p>å› ä¸ºæ‡’ä¸€ç›´æ²¡æŠ˜è…¾ï¼Œè¿™æ¬¡ä¸ºäº†æ›´å¥½çš„ä½“éªŒï¼Œæˆ‘å†³å®šèŠ±ç‚¹æ—¶é—´ã€‚</p>
<a id="more"></a>
<h1 id="å®‰è£…-ss-å®¢æˆ·ç«¯"><a href="#å®‰è£…-ss-å®¢æˆ·ç«¯" class="headerlink" title="å®‰è£… ss å®¢æˆ·ç«¯"></a>å®‰è£… ss å®¢æˆ·ç«¯</h1><p>æœ¬æ¥ python ç‰ˆçš„ shadowsocks å¸¦æœ‰ sslocal å¯ä»¥åšæœ¬åœ°ä»£ç†çš„ï¼Œä½†æ˜¯æˆ‘ç”¨å›¾å½¢ç•Œé¢ï¼Œè§‰å¾— qt ç‰ˆä½“éªŒè¦å¥½äº›ã€‚</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># ArchLinux</span></span><br><span class="line">sudo pacman -S shadowsocks-qt5</span><br><span class="line"></span><br><span class="line"><span class="comment"># Ubuntu</span></span><br><span class="line">sudo add-apt-repository ppa:hzwhuang/ss-qt5</span><br><span class="line">sudo apt-get update</span><br><span class="line">sudo apt-get install shadowsocks-qt5</span><br></pre></td></tr></table></figure>
<p>å®‰è£…å®Œæˆåï¼Œæ‰“å¼€é…ç½®å¥½ä½ çš„ ss æœåŠ¡ï¼Œæœ¬åœ°åœ°å€ï¼š<code>127.0.0.1</code>ï¼Œç«¯å£ï¼š<code>1080</code>ï¼Œæœ¬åœ°æœåŠ¡å™¨ç±»å‹ï¼š<code>HTTP(S)</code>ã€‚</p>
<h2 id="éªŒè¯æœ¬åœ°ä»£ç†"><a href="#éªŒè¯æœ¬åœ°ä»£ç†" class="headerlink" title="éªŒè¯æœ¬åœ°ä»£ç†"></a>éªŒè¯æœ¬åœ°ä»£ç†</h2><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># è®¾ç½®ä¸´æ—¶å…¨å±€ä»£ç†</span></span><br><span class="line"><span class="built_in">export</span> proxy=http://127.0.0.1:1080; <span class="built_in">export</span> http_proxy=<span class="variable">$proxy</span> https_proxy=<span class="variable">$proxy</span> no_proxy=<span class="string">"localhost, 127.0.0.1, ::1"</span></span><br><span class="line"><span class="comment"># ç„¶åè®¿é—®ä¸‹Googleï¼Œæœ‰è¿”å›htmlå°±æˆäº†ã€‚</span></span><br><span class="line">curl -skL www.google.com</span><br></pre></td></tr></table></figure>
<h1 id="å®‰è£…-privoxy"><a href="#å®‰è£…-privoxy" class="headerlink" title="å®‰è£… privoxy"></a>å®‰è£… privoxy</h1><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># ArchLinux</span></span><br><span class="line">sudo pacman -S privoxy</span><br><span class="line"></span><br><span class="line"><span class="comment"># Ubuntu</span></span><br><span class="line">sudo apt install privoxy</span><br></pre></td></tr></table></figure>
<h2 id="é…ç½®-gfwlist"><a href="#é…ç½®-gfwlist" class="headerlink" title="é…ç½® gfwlist"></a>é…ç½® gfwlist</h2><p>å…¨å±€ä»£ç†ä½“éªŒä¸ä½³ï¼Œè¿™é‡Œè¦åˆ©ç”¨ gfwlist ï¼Œé…ç½® privoxy</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># å…ˆè·å–ä¸€æ®µæ ¼å¼è½¬æ¢è„šæœ¬</span></span><br><span class="line">curl -skL https://raw.github.com/zfl9/gfwlist2privoxy/master/gfwlist2privoxy -o gfwlist2privoxy</span><br><span class="line"><span class="comment"># ç”Ÿæˆ gfwlist.action æ–‡ä»¶</span></span><br><span class="line">bash gfwlist2privoxy <span class="string">'127.0.0.1:1080'</span></span><br><span class="line"><span class="comment"># æ‹·è´è‡³ privoxy é…ç½®ç›®å½•</span></span><br><span class="line">sudo cp -af gfwlist.action /etc/privoxy/</span><br><span class="line"><span class="comment"># åŠ è½½ gfwlist.action æ–‡ä»¶</span></span><br><span class="line">sudo <span class="built_in">echo</span> <span class="string">'actionsfile gfwlist.action'</span> &gt;&gt; /etc/privoxy/config</span><br><span class="line"><span class="comment"># å¯åŠ¨ privoxy.service æœåŠ¡</span></span><br><span class="line">sudo systemctl start privoxy.service</span><br></pre></td></tr></table></figure>
<h2 id="éªŒè¯ä»£ç†åˆ‡æ¢"><a href="#éªŒè¯ä»£ç†åˆ‡æ¢" class="headerlink" title="éªŒè¯ä»£ç†åˆ‡æ¢"></a>éªŒè¯ä»£ç†åˆ‡æ¢</h2><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># è®¾ç½®ä¸´æ—¶å˜é‡ï¼Œprivoxy é»˜è®¤ç›‘å¬ç«¯å£ä¸º 8118</span></span><br><span class="line"><span class="built_in">export</span> proxy=http://127.0.0.1:8118; <span class="built_in">export</span> http_proxy=<span class="variable">$proxy</span> https_proxy=<span class="variable">$proxy</span> no_proxy=<span class="string">"localhost, 127.0.0.1, ::1"</span></span><br><span class="line"><span class="comment"># å¯ä»¥çœ‹åˆ°è¿”å›å€¼ï¼Œè¯´æ˜ä»£ç†æˆåŠŸ</span></span><br><span class="line">curl -skL www.google.com</span><br><span class="line"><span class="comment"># æŸ¥çœ‹å½“å‰IPï¼Œè‹¥æ˜¯å¢™å†…IPè¯´æ˜gfwlisté…ç½®æˆåŠŸ</span></span><br><span class="line">curl -4skL http://ip.chinaz.com/getip.aspx</span><br></pre></td></tr></table></figure>
<h1 id="è®¾ç½®ç¯å¢ƒå˜é‡"><a href="#è®¾ç½®ç¯å¢ƒå˜é‡" class="headerlink" title="è®¾ç½®ç¯å¢ƒå˜é‡"></a>è®¾ç½®ç¯å¢ƒå˜é‡</h1><p>å¯ä»¥å°†ç¯å¢ƒå˜é‡åŠ å…¥ <code>.profile</code> æˆ– <code>.bashrc</code> æˆ–å…¶ä»–é…ç½®æ–‡ä»¶ä¸­</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># vim ~/.profile æˆ–è€… sudo vim /etc/profile</span></span><br><span class="line"><span class="comment"># è®¾ç½®ä¸´æ—¶å˜é‡ï¼Œprivoxy é»˜è®¤ç›‘å¬ç«¯å£ä¸º 8118</span></span><br><span class="line">proxy=http://127.0.0.1:8118</span><br><span class="line"><span class="built_in">export</span> http_proxy=<span class="variable">$proxy</span></span><br><span class="line"><span class="built_in">export</span> https_proxy=<span class="variable">$proxy</span></span><br><span class="line"><span class="built_in">export</span> no_proxy=<span class="string">"localhost, 127.0.0.1, ::1"</span></span><br></pre></td></tr></table></figure>
<h1 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h1><p><a href="https://www.zfl9.com/ss-local.html" target="_blank" rel="noopener">ss-local + privoxy ä»£ç†</a><br><a href="https://www.privoxy.org/user-manual/actions-file.html" target="_blank" rel="noopener">Proivoxyç”¨æˆ·æ‰‹å†Œ</a></p>
]]></content>
      <categories>
        <category>Linux</category>
      </categories>
      <tags>
        <tag>Linux</tag>
        <tag>Shadowsocks</tag>
        <tag>Privoxy</tag>
      </tags>
  </entry>
  <entry>
    <title>Ubuntu16.04å®‰è£…Node.js&amp;npm</title>
    <url>/2018/04/15/Ubuntu16-04%E5%AE%89%E8%A3%85Node-js-npm/</url>
    <content><![CDATA[<h1 id="ä¸‹è½½"><a href="#ä¸‹è½½" class="headerlink" title="ä¸‹è½½"></a>ä¸‹è½½</h1><p>Ubuntu16.04 å®˜æ–¹ä»“åº“æä¾›çš„Node.jsç‰ˆæœ¬æ˜¯4.xï¼Œä¸æ¨èä½¿ç”¨aptå®‰è£…ã€‚</p>
<p>æˆ‘ä»¬éœ€è¦ä»<a href="https://nodejs.org/zh-cn/" target="_blank" rel="noopener">å®˜ç½‘</a>è·å¾—æ›´æ–°çš„ç‰ˆæœ¬ã€‚</p>
<a id="more"></a>
<p>è¿™é‡Œç›´æ¥wgetè·å¾—</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">wget http://nodejs.org/dist/v8.1.1/node-v8.1.1-linux-x64.tar.gz</span><br></pre></td></tr></table></figure>
<h1 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h1><p>æ‰¾åˆ°ä¸‹è½½çš„å‹ç¼©æ–‡ä»¶ï¼Œè§£å‹ç³»ç»Ÿåº”ç”¨ç›®å½•</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">sudo tar -C /usr/<span class="built_in">local</span> --strip-components 1 -xzf node-v8.1.1-linux-x64.tar.gz</span><br></pre></td></tr></table></figure>
<h1 id="éªŒè¯"><a href="#éªŒè¯" class="headerlink" title="éªŒè¯"></a>éªŒè¯</h1><p>æŸ¥çœ‹æ˜¯å¦å®‰è£…åˆ°äº†æ­£ç¡®çš„ç›®å½•</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">ls -l /usr/<span class="built_in">local</span>/bin/node</span><br><span class="line">ls -l /usr/<span class="built_in">local</span>/bin/npm</span><br><span class="line">node -v</span><br><span class="line">npm -v</span><br></pre></td></tr></table></figure>
<h1 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h1><p><a href="https://stackoverflow.com/questions/33033538/installing-a-tar-gz-on-linux?utm_medium=organic&amp;utm_source=google_rich_qa&amp;utm_campaign=google_rich_qa" target="_blank" rel="noopener">Installing a tar.gz on linux</a></p>
<p><a href="http://www.findshank.com/2017/08/06/%E4%B8%80%E4%BA%9B%E8%8A%82%E7%BA%A6%E7%94%9F%E5%91%BD%E7%9A%84%E6%93%8D%E4%BD%9C/#more">æˆ‘çš„å¦ä¸€ç¯‡æ–‡ç« ï¼Œæœ‰å…³npmåŠ é€Ÿ</a></p>
]]></content>
      <categories>
        <category>Linux</category>
      </categories>
      <tags>
        <tag>Linux</tag>
        <tag>Ubuntu</tag>
        <tag>Nodejs</tag>
        <tag>npm</tag>
      </tags>
  </entry>
  <entry>
    <title>Windowsä¸‹zipå®‰è£…MySQLæ€»ç»“</title>
    <url>/2018/04/01/Windows%E4%B8%8Bzip%E5%AE%89%E8%A3%85MySQL%E6%80%BB%E7%BB%93/</url>
    <content><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>å®‰è£…MySQLä¸æƒ³ç”¨å®˜æ–¹å®‰è£…å·¥å…·ï¼Œå› ä¸ºå®ƒä¼šæ·»åŠ å¼€æœºè®¡åˆ’ä»»åŠ¡ï¼Œè‡ªåŠ¨å¯åŠ¨ä¸è¯´è¿˜ä¼šæ—¶ä¸æ—¶æ›´æ–°ï¼Œå°±å¾ˆçƒ¦ã€‚æˆ‘å¸Œæœ›éšç”¨éšå¯åŠ¨ï¼Œæ‰€ä»¥è¦é€‰æ‹©zipå®‰è£…ï¼Œè¿™æ ·æ–¹ä¾¿å¯æ§ã€‚<br>ç”±äºè®°æ€§ä¸å¥½ï¼Œæ¯æ¬¡è¿™ä¹ˆè£…éƒ½è¦æŸ¥èµ„æ–™ï¼Œçœ‹åˆ°ç½‘ä¸Šå„ç§æ‹™åŠ£çš„æ•™ç¨‹å°±å¾ˆæ— è¯­ï¼Œæ‰€ä»¥å†³å®šæŠ½ç©ºè‡ªå·±æ€»ç»“ä¸‹ã€‚</p>
<a id="more"></a>
<h1 id="ä¸‹è½½-amp-è§£å‹"><a href="#ä¸‹è½½-amp-è§£å‹" class="headerlink" title="ä¸‹è½½&amp;è§£å‹"></a>ä¸‹è½½&amp;è§£å‹</h1><ul>
<li><a href="https://dev.mysql.com/downloads/mysql/" target="_blank" rel="noopener">å®˜ç½‘</a>ä¸‹è½½zipå®‰è£…åŒ…ï¼Œæˆ‘é€‰æ‹©çš„æ˜¯MySQL Community Serverã€‚<blockquote>
<p>zipå®‰è£…åŒ…åœ¨<code>Other Downloads</code>ä¸­ï¼Œæˆ‘ä¸‹è½½çš„æ˜¯mysql-5.7.18-win32.zip</p>
</blockquote>
</li>
<li>è§£å‹åˆ°ä»»æ„ç›®å½•<blockquote>
<p>ä»¥ä¸‹ä»¥è§£å‹åˆ°<code>D:\mysql-5.7.18-win32</code>ä¸ºä¾‹ã€‚</p>
</blockquote>
</li>
</ul>
<h1 id="ç¯å¢ƒå˜é‡"><a href="#ç¯å¢ƒå˜é‡" class="headerlink" title="ç¯å¢ƒå˜é‡"></a>ç¯å¢ƒå˜é‡</h1><ul>
<li>æ·»åŠ ç³»ç»Ÿå˜é‡</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">å˜é‡åï¼š MYSQL_HOME</span><br><span class="line">å˜é‡å€¼ï¼š D:\mysql-5.7.18-win32</span><br></pre></td></tr></table></figure>
<ul>
<li>Pathä¸­æ·»åŠ  <code>%MYSQL_HOME%\bin</code></li>
</ul>
<h1 id="é…ç½®æ–‡ä»¶"><a href="#é…ç½®æ–‡ä»¶" class="headerlink" title="é…ç½®æ–‡ä»¶"></a>é…ç½®æ–‡ä»¶</h1><p>MySQLç›®å½•ä¸‹æ·»åŠ <code>my.ini</code>æ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹ï¼š</p>
<figure class="highlight ini"><table><tr><td class="code"><pre><span class="line"><span class="section">[client]</span></span><br><span class="line"><span class="comment"># é»˜è®¤ç¼–ç </span></span><br><span class="line"><span class="attr">default-character-set</span>=utf8</span><br><span class="line"><span class="section">[mysqld]</span></span><br><span class="line"><span class="comment"># é»˜è®¤ç¼–ç </span></span><br><span class="line"><span class="attr">character-set-server</span>=utf8</span><br><span class="line"><span class="comment"># è®¾ç½®mysqlçš„å®‰è£…ç›®å½•</span></span><br><span class="line"><span class="attr">basedir</span>=D:\mysql-<span class="number">5.7</span>.<span class="number">18</span>-win32</span><br><span class="line"><span class="comment"># è®¾ç½®mysqlæ•°æ®åº“çš„æ•°æ®çš„å­˜æ”¾ç›®å½•</span></span><br><span class="line"><span class="attr">datadir</span>=D:\mysql-<span class="number">5.7</span>.<span class="number">18</span>-win32\data</span><br><span class="line"><span class="comment"># é»˜è®¤å­˜å‚¨å¼•æ“</span></span><br><span class="line"><span class="attr">default-storage-engine</span>=InnoDB</span><br></pre></td></tr></table></figure>
<h1 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h1><ol>
<li>è‹¥MySQLç›®å½•ä¸‹æœ‰dataç›®å½•ï¼Œå…ˆæ¸…ç©ºè¯¥ç›®å½•ã€‚</li>
<li>ç®¡ç†å‘˜æ¨¡å¼å¯åŠ¨cmdï¼Œåˆ‡æ¢åˆ°MySQLç›®å½•ä¸‹çš„binç›®å½•ä¸­ã€‚</li>
<li><p>è¿è¡Œåˆå§‹åŒ–å‘½ä»¤</p>
 <figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">mysqld --initialize-insecure</span><br></pre></td></tr></table></figure>
<p> ç¨ç­‰ä¸€ä¼šï¼Œæ²¡æœ‰è¾“å‡ºå°±æˆåŠŸäº†ã€‚</p>
<blockquote>
<p>è‹¥é‡åˆ°ç¼ºå°‘MSVCP120.dllçš„é—®é¢˜ï¼Œå‰å¾€<a href="https://www.microsoft.com/en-us/download/details.aspx?id=40784" target="_blank" rel="noopener">è¿™é‡Œ</a>ä¸‹è½½å®‰è£…VC++æ”¯æŒ</p>
</blockquote>
</li>
<li><p>è¿è¡Œå®‰è£…å‘½ä»¤</p>
 <figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">mysqld --install</span><br></pre></td></tr></table></figure>
<p> è¾“å‡º<code>service successfully installed</code>è¡¨æ˜å®‰è£…æˆåŠŸã€‚</p>
</li>
<li><p>å¼€å¯æœåŠ¡</p>
 <figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">net start mysql</span><br></pre></td></tr></table></figure>
</li>
<li><p>ç™»å½•MySQL</p>
 <figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">mysql -u root -p</span><br></pre></td></tr></table></figure>
<blockquote>
<p>é¦–æ¬¡ç™»å½•æ²¡æœ‰å¯†ç ï¼Œç›´æ¥æŒ‰å›è½¦</p>
</blockquote>
</li>
<li><p>æ›´æ”¹rootå¯†ç </p>
 <figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">SET PASSWORD FOR <span class="string">'root'</span>@<span class="string">'localhost'</span> = PASSWORD(<span class="string">'newpass'</span>);</span><br></pre></td></tr></table></figure>
<blockquote>
<p><code>newpass</code>ä¸ºæ–°çš„å¯†ç </p>
</blockquote>
</li>
</ol>
<h1 id="éªŒè¯ç¼–ç "><a href="#éªŒè¯ç¼–ç " class="headerlink" title="éªŒè¯ç¼–ç "></a>éªŒè¯ç¼–ç </h1><p>rootç™»å½•MySQLï¼Œç„¶åè¾“å…¥ä»¥ä¸‹æŸ¥è¯¢è¯­å¥ï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">show</span> <span class="keyword">variables</span> <span class="keyword">like</span> <span class="string">'character%'</span>;</span><br></pre></td></tr></table></figure>
<p>ä½ ä¼šçš„åˆ°ä»¥ä¸‹ç»“æœï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">+<span class="comment">--------------------------+-------------------------------------------+</span></span><br><span class="line">| Variable_name            | Value                                     |</span><br><span class="line">+<span class="comment">--------------------------+-------------------------------------------+</span></span><br><span class="line">| character_set_client     | utf8                                      |</span><br><span class="line">| character_set_connection | utf8                                      |</span><br><span class="line">| character_set_database   | utf8                                      |</span><br><span class="line">| character_set_filesystem | binary                                    |</span><br><span class="line">| character_set_results    | utf8                                      |</span><br><span class="line">| character_set_server     | utf8                                      |</span><br><span class="line">| character_set_system     | utf8                                      |</span><br><span class="line">| character_sets_dir       | D:\mysql-5.7.18-win32\share\charsets\     |</span><br><span class="line">+<span class="comment">--------------------------+-------------------------------------------+</span></span><br></pre></td></tr></table></figure>
<p>è‡³æ­¤ï¼Œå®‰è£…å®Œæˆã€‚</p>
<h1 id="è¡¥å……"><a href="#è¡¥å……" class="headerlink" title="è¡¥å……"></a>è¡¥å……</h1><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># åœæ­¢MySQLæœåŠ¡</span></span><br><span class="line">net stop mysql</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ é™¤MySQLæœåŠ¡</span></span><br><span class="line">sc delete mysql</span><br><span class="line"></span><br><span class="line"><span class="comment"># è§£é™¤å®‰è£…</span></span><br><span class="line">mysqld remove</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>Database</category>
      </categories>
      <tags>
        <tag>MySQL</tag>
        <tag>Windows</tag>
      </tags>
  </entry>
  <entry>
    <title>å¦‚ä½•åœ¨Windowsä¸Šä½¿ç”¨GLUT</title>
    <url>/2018/03/09/%E5%A6%82%E4%BD%95%E5%9C%A8Windows%E4%B8%8A%E4%BD%BF%E7%94%A8GLUT/</url>
    <content><![CDATA[<p>æœ€è¿‘åœ¨çœ‹è®¡ç®—æœºå›¾å½¢å­¦<br>ä¹¦é‡Œçš„ä»£ç è¦ç”¨åˆ°OpenGLï¼Œç„¶è€Œåœ¨Windowsä¸Šå°‘äº†GLUTï¼Œéœ€è¦è‡ªå·±æ‰‹åŠ¨é…ç½®ã€‚</p>
<a id="more"></a>
<h2 id="å‡†å¤‡"><a href="#å‡†å¤‡" class="headerlink" title="å‡†å¤‡"></a>å‡†å¤‡</h2><ul>
<li>Microsoft Visual Studio 2017 Community ï¼ˆå‹¾é€‰å®‰è£…<code>ä½¿ç”¨C++çš„æ¡Œé¢å¼€å‘</code>é‚£é¡¹ï¼Œç¡®ä¿å®‰è£…MSVCï¼‰</li>
<li><a href="https://www.opengl.org/resources/libraries/glut/glut37.zip" target="_blank" rel="noopener">GLUT for Windows</a></li>
</ul>
<h2 id="é…ç½®"><a href="#é…ç½®" class="headerlink" title="é…ç½®"></a>é…ç½®</h2><ol>
<li>æ‰“å¼€ glut37.zipã€‚</li>
<li><code>glut.dll</code>,<code>glut32.dll</code> è§£å‹åˆ° Windowsç›®å½•ã€‚<blockquote>
<p>æˆ‘æ”¾åˆ°äº†<code>C:\Windows</code>ç›®å½•ä¸‹ï¼Œå½“ç„¶ä½ ä¹Ÿå¯ä»¥æŠŠå®ƒä»¬åˆ†åˆ«æ”¾åˆ°<code>C:\Windows\SysWOW64</code>å’Œ<code>C:\Windows\System32</code>ä¸‹ã€‚</p>
</blockquote>
</li>
<li>æ‰¾åˆ°MSVCçš„ç›®å½•ã€‚<blockquote>
<p>ä¾‹å¦‚ <code>C:\Program Files (x86)\Microsoft Visual Studio\2017\Community\VC\Tools\MSVC\14.??.??????</code>ã€‚ (æ ¹æ®ç‰ˆæœ¬æ–‡ä»¶å¤¹çš„åç§°çš„<code>?</code>ä¼šæœ‰ä¸åŒ)</p>
</blockquote>
</li>
<li>åœ¨<code>include</code>ç›®å½•ä¸‹æ–°å»º<code>GL</code>æ–‡ä»¶å¤¹ï¼Œå°†<code>glut.h</code>å¤åˆ¶è¿›å»ã€‚<blockquote>
<p>ä¾‹å¦‚ <code>C:\Program Files (x86)\Microsoft Visual Studio\2017\Community\VC\Tools\MSVC\14.13.26128\include\GL</code>ã€‚</p>
</blockquote>
</li>
<li>åœ¨<code>lib</code>ç›®å½•ä¸‹ï¼Œå°†<code>glut.lib</code>,<code>glut32.lib</code>å¤åˆ¶è¿›å»ã€‚</li>
</ol>
<h2 id="ç¼–å†™ä¸€ä¸ªç®€å•çš„openglç¨‹åº"><a href="#ç¼–å†™ä¸€ä¸ªç®€å•çš„openglç¨‹åº" class="headerlink" title="ç¼–å†™ä¸€ä¸ªç®€å•çš„openglç¨‹åº"></a>ç¼–å†™ä¸€ä¸ªç®€å•çš„openglç¨‹åº</h2><ol>
<li><p>æ‰“å¼€VS2017ï¼Œä¾æ¬¡ç‚¹å‡» <code>æ–°å»º</code> - <code>é¡¹ç›®</code> - <code>Visual C++</code> - <code>Windows æ§åˆ¶å°åº”ç”¨ç¨‹åº</code> - <code>ç¡®å®š</code>ã€‚</p>
</li>
<li><p>å³é”®ç‚¹å‡»è§£å†³æ–¹æ¡ˆç®¡ç†å™¨ä¸­çš„é¡¹ç›®åç§°(ConsoleApplication?) - å±æ€§ - é“¾æ¥å™¨</p>
<blockquote>
<p>æ³¨æ„ï¼šé…ç½®å¹³å°æ˜¯Win32ã€‚</p>
<ul>
<li>å¸¸è§„ - é™„åŠ åº“ç›®å½• - &lt;ç¼–è¾‘â€¦&gt; - ç²˜è´´ä½ libçš„è·¯å¾„<br>ä¾‹å¦‚ <code>C:\Program Files (x86)\Microsoft Visual Studio\2017\Community\VC\Tools\MSVC\14.13.26128\lib</code>ã€‚</li>
<li>è¾“å…¥ - é™„åŠ ä¾èµ–é¡¹ - &lt;ç¼–è¾‘â€¦&gt; - ç²˜è´´glutçš„lib<br>ä¾‹å¦‚ <code>glut32.lib</code>ã€‚</li>
</ul>
</blockquote>
</li>
<li><p><code>ConsoleApplication1?.cpp</code>ä¸­å†™å…¥ä»¥ä¸‹ä»£ç ï¼š</p>
 <figure class="highlight cxx"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"stdafx.h"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;gl/glut.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    glClearColor(<span class="number">1.0</span>, <span class="number">1.0</span>, <span class="number">1.0</span>, <span class="number">1.0</span>);</span><br><span class="line">    glMatrixMode(GL_PROJECTION);</span><br><span class="line">    gluOrtho2D(<span class="number">0.0</span>, <span class="number">200.0</span>, <span class="number">0.0</span>, <span class="number">250.0</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">lineSegment</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    glClear(GL_COLOR_BUFFER_BIT);</span><br><span class="line"></span><br><span class="line">    glColor3f(<span class="number">0.0</span>, <span class="number">0.4</span>, <span class="number">0.2</span>);</span><br><span class="line">    glBegin(GL_LINES);</span><br><span class="line">    glVertex2i(<span class="number">180</span>, <span class="number">15</span>);</span><br><span class="line">    glVertex2i(<span class="number">10</span>, <span class="number">145</span>);</span><br><span class="line">    glEnd();</span><br><span class="line">    glFlush();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span>** argv)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    glutInit(&amp;argc, argv);</span><br><span class="line">    glutInitDisplayMode(GLUT_SINGLE | GLUT_RGB);</span><br><span class="line">    glutInitWindowPosition(<span class="number">50</span>, <span class="number">100</span>);</span><br><span class="line">    glutInitWindowSize(<span class="number">400</span>, <span class="number">300</span>);</span><br><span class="line">    glutCreateWindow(<span class="string">"An Example OpenGL Program"</span>);</span><br><span class="line"></span><br><span class="line">    init();</span><br><span class="line">    glutDisplayFunc(lineSegment);</span><br><span class="line">    glutMainLoop();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>F5è°ƒè¯•ï¼Œä½ å¯ä»¥çœ‹åˆ°å›¾åƒæ˜¯ä¸€æ¡æ–œçº¿ã€‚</p>
</li>
</ol>
<h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><ul>
<li><p><a href="https://www.cs.csustan.edu/~rsc/SDSU/GLUTinstall.html" target="_blank" rel="noopener">https://www.cs.csustan.edu/~rsc/SDSU/GLUTinstall.html</a></p>
</li>
<li><p><a href="http://blog.csdn.net/qq_19982213/article/details/69970977" target="_blank" rel="noopener">http://blog.csdn.net/qq_19982213/article/details/69970977</a></p>
</li>
</ul>
]]></content>
      <categories>
        <category>å›¾å½¢å­¦</category>
      </categories>
      <tags>
        <tag>Windows</tag>
        <tag>GLUT</tag>
      </tags>
  </entry>
  <entry>
    <title>Protocal Buffer å­¦ä¹  (è¯­è¨€æŒ‡å—)</title>
    <url>/2018/02/23/Protocal%20Buffer%20%E5%AD%A6%E4%B9%A0/</url>
    <content><![CDATA[<h2 id="å®˜æ–¹æŒ‡å—"><a href="#å®˜æ–¹æŒ‡å—" class="headerlink" title="å®˜æ–¹æŒ‡å—"></a>å®˜æ–¹æŒ‡å—</h2><p><a href="https://developers.google.com/protocol-buffers/docs/proto3#simple" target="_blank" rel="noopener">Language Guide (proto3)</a></p>
<h2 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h2><p>è¯¥æ–‡ç« ä¸ºé˜…è¯»å®˜æ–¹æŒ‡å—é¡ºä¾¿ç¿»è¯‘çš„ã€‚</p>
<a id="more"></a>
<h2 id="å®šä¹‰æ¶ˆæ¯ç±»å‹"><a href="#å®šä¹‰æ¶ˆæ¯ç±»å‹" class="headerlink" title="å®šä¹‰æ¶ˆæ¯ç±»å‹"></a>å®šä¹‰æ¶ˆæ¯ç±»å‹</h2><p>çœ‹ä¸€ä¸ªç®€å•çš„ä¾‹å­ã€‚å‡å¦‚ä½ æƒ³å®šä¹‰ä¸€ä¸ªæœç´¢è¯·æ±‚ä¿¡æ¯æ ¼å¼ï¼Œæœç´¢è¯·æ±‚æœ‰ä¸ªè¯¢é—®å­—ç¬¦ä¸²ã€‚ä½ æ„Ÿå…´è¶£çš„ç‰¹å®šé¡µé¢çš„ç»“æœï¼Œä»¥åŠæ¯ä¸ªç»“æœé¡µé¢çš„æ¡ç›®æ•°ã€‚ä¸‹é¢æ˜¯ <code>.proto</code> æ–‡ä»¶ã€‚</p>
<figure class="highlight protobuf"><table><tr><td class="code"><pre><span class="line">syntax = <span class="string">"proto3"</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">message</span> <span class="title">SearchRequest</span> </span>&#123;</span><br><span class="line">    <span class="built_in">string</span> query = <span class="number">1</span>;</span><br><span class="line">    <span class="built_in">int32</span> page_number = <span class="number">2</span>;</span><br><span class="line">    <span class="built_in">int32</span> result_per_page = <span class="number">3</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>ç¬¬ä¸€è¡ŒæŒ‡å®šäº†ä½ ä½¿ç”¨ proto3 è¯­æ³•ï¼šå¦‚æœä½ ä¸è¿™æ ·åšï¼Œprotocal buffer ç¼–è¯‘å™¨å°†é»˜è®¤å‡è®¾ä½ ä½¿ç”¨ proto2 ã€‚è¿™å¥å¿…é¡»åœ¨æ–‡ä»¶çš„ç¬¬ä¸€éç©ºæ— æ³¨é‡Šè¡Œã€‚</li>
<li><code>SearchRequest</code>ä¿¡æ¯å®šä¹‰æŒ‡å®šäº†ä¸‰ä¸ªå­—æ®µ(å/å€¼ å¯¹)ï¼Œä¸€ä¸ªç”¨äºä½ å¸Œæœ›åŒ…å«åœ¨æ­¤ç±»æ¶ˆæ¯ä¸­çš„æ¯æ¡æ•°æ®ã€‚æ¯ä¸ªå­—æ®µæœ‰ä¸€ä¸ªåç§°å’Œä¸€ä¸ªç±»å‹ã€‚</li>
</ul>
<h3 id="æŒ‡å®šå­—æ®µç±»å‹"><a href="#æŒ‡å®šå­—æ®µç±»å‹" class="headerlink" title="æŒ‡å®šå­—æ®µç±»å‹"></a>æŒ‡å®šå­—æ®µç±»å‹</h3><p>åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œæ‰€æœ‰çš„å­—æ®µéƒ½æ˜¯ scalar (æ ‡é‡)ç±»å‹ï¼šä¸¤ä¸ªæ•´æ•°(<code>page_number</code>å’Œ<code>result_per_page</code>)å’Œä¸€ä¸ªå­—ç¬¦ä¸²(<code>query</code>)ã€‚å½“ç„¶ï¼Œä½ ä¹Ÿå¯ä»¥ä¸ºä½ çš„å­—æ®µæŒ‡å®š composite (å¤åˆ)ç±»å‹ã€‚</p>
<h3 id="åˆ†é…æ ‡ç­¾"><a href="#åˆ†é…æ ‡ç­¾" class="headerlink" title="åˆ†é…æ ‡ç­¾"></a>åˆ†é…æ ‡ç­¾</h3><p>å¦‚ä½ æ‰€è§ï¼Œä¿¡æ¯å®šä¹‰ä¸­çš„æ¯ä¸ªå­—æ®µæœ‰ä¸€ä¸ªç‹¬ç‰¹çš„æ•°å­—æ ‡ç­¾ã€‚è¿™äº›æ ‡ç­¾è¢«ç”¨æ¥åœ¨äºŒè¿›åˆ¶ä¿¡æ¯æ ¼å¼ä¸­è¯†åˆ«ä½ çš„å­—æ®µï¼Œå¹¶ä¸”ä¸€æ—¦ä½ çš„ä¿¡æ¯ç±»å‹åœ¨ä½¿ç”¨å°±ä¸è¯¥ä¿®æ”¹è¿™äº›å­—æ®µã€‚è¯·æ³¨æ„ï¼Œå€¼ä¸º1åˆ°15çš„å˜é‡éœ€è¦1å­—èŠ‚ç¼–ç ï¼ŒåŒ…æ‹¬æ ‡ç­¾å·å’Œå­—æ®µç±»å‹(ä½ å¯ä»¥åœ¨ Protocal Buffer Encoding ä¸­äº†è§£æ›´å¤šä¿¡æ¯)ã€‚æ ‡ç­¾åœ¨16åˆ°2047ä¹‹é—´éœ€è¦2å­—èŠ‚ã€‚æ‰€ä»¥ä½ åº”è¯¥ä¸ºé¢‘ç¹å‡ºç°çš„æ¶ˆæ¯å…ƒç´ ä¿ç•™æ ‡ç­¾1è‡³15ã€‚è¯·ç•™æ„ä¸ºå°†æ¥å¯èƒ½æ·»åŠ çš„é¢‘ç¹å‡ºç°çš„å…ƒç´ ç•™å‡ºä¸€äº›ç©ºé—´ã€‚<br>æœ€å°æ ‡ç­¾å·ç ä½ å¯ä»¥æŒ‡å®šä¸º1ï¼Œæœ€å¤§çš„ä¸º$2^{29}-1$ï¼Œæˆ–536,870,911ã€‚ä½ è¿˜ä¸èƒ½ä½¿ç”¨æ•°ç»„19000è‡³19999(<code>FieldDescriptor::kFirstReservedNumber</code>è‡³<code>FieldDescriptor::kLastReservedNumber</code>)ã€‚å› ä¸ºå®ƒä»¬æ˜¯ä¸º Protocal Bufffers æ¥å£å®ç°ä¿ç•™çš„ï¼Œå¦‚æœä½ åœ¨<code>.proto</code>æ–‡ä»¶ä¸­ä½¿ç”¨è¿™äº›ä¿ç•™æ•°å­—ï¼Œprotocal buffer ç¼–è¯‘å™¨ä¼šå‘å‡ºè­¦å‘Šã€‚åŒæ ·çš„ï¼Œä½ ä¸èƒ½ä½¿ç”¨ä»»ä½•ä»¥å‰ä¿ç•™çš„æ ‡ç­¾ã€‚</p>
<h3 id="æŒ‡å®šå­—æ®µè§„åˆ™"><a href="#æŒ‡å®šå­—æ®µè§„åˆ™" class="headerlink" title="æŒ‡å®šå­—æ®µè§„åˆ™"></a>æŒ‡å®šå­—æ®µè§„åˆ™</h3><p>ä¿¡æ¯å­—æ®µå¯ä»¥æ˜¯ä¸‹åˆ—ä¸­ä¸€ç§ï¼š</p>
<ul>
<li><code>singular</code> ï¼šä¸€ç§æ ¼å¼æ­£ç¡®çš„æ¶ˆæ¯å¯ä»¥æœ‰0æˆ–1ä¸ªè¿™ä¸ªå­—æ®µ(ä½†ä¸è¶…è¿‡1ä¸ª)ã€‚</li>
<li><code>repeated</code> ï¼šè¿™ä¸ªå­—æ®µå¯ä»¥åœ¨æ ¼å¼æ­£ç¡®çš„æ¶ˆæ¯ä¸­è¢«é‡å¤ä»»æ„æ¬¡ã€‚é‡å¤å€¼çš„é¡ºåºä¼šè¢«ä¿ç•™ã€‚</li>
</ul>
<p>åœ¨ proto3 ä¸­ï¼Œ <code>repeated</code> çš„ scalar æ•°å­—ç±»å‹é»˜è®¤ä½¿ç”¨ <code>packed</code> ç¼–ç ã€‚<br>ä½ å¯ä»¥åœ¨ Protocal Buffer Encoding ä¸­äº†è§£æœ‰å…³ <code>packed</code> çš„ä¿¡æ¯ã€‚</p>
<h3 id="æ·»åŠ æ›´å¤šä¿¡æ¯ç±»å‹"><a href="#æ·»åŠ æ›´å¤šä¿¡æ¯ç±»å‹" class="headerlink" title="æ·»åŠ æ›´å¤šä¿¡æ¯ç±»å‹"></a>æ·»åŠ æ›´å¤šä¿¡æ¯ç±»å‹</h3><p>å•ä¸ª<code>.proto</code>æ–‡ä»¶ä¸­å¯ä»¥å®šä¹‰å¤šç§ä¿¡æ¯ç±»å‹ã€‚è¿™ä¾¿äºä½ å®šä¹‰å¤šç§ç›¸å…³çš„ä¿¡æ¯ã€‚å› æ­¤ï¼Œä¸¾ä¸ªä¾‹å­ï¼Œå¦‚æœä½ æƒ³çš„å®šä¹‰å›å¤ä¿¡æ¯æ ¼å¼æ¥ç›¸åº”ä½ çš„<code>SearchResponse</code>ä¿¡æ¯ç±»å‹ï¼Œä½ å¯ä»¥æ·»åŠ å®ƒåˆ°åŒä¸€<code>.proto</code>æ–‡ä»¶ï¼š</p>
<figure class="highlight protobuf"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">message</span> <span class="title">SearchRequest</span> </span>&#123;</span><br><span class="line">  <span class="built_in">string</span> query = <span class="number">1</span>;</span><br><span class="line">  <span class="built_in">int32</span> page_number = <span class="number">2</span>;</span><br><span class="line">  <span class="built_in">int32</span> result_per_page = <span class="number">3</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">message</span> <span class="title">SearchResponse</span> </span>&#123;</span><br><span class="line"> ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="æ·»åŠ æ³¨é‡Š"><a href="#æ·»åŠ æ³¨é‡Š" class="headerlink" title="æ·»åŠ æ³¨é‡Š"></a>æ·»åŠ æ³¨é‡Š</h3><p>æ¬²æ·»åŠ æ³¨é‡Šåˆ°ä½ çš„<code>.proto</code>æ–‡ä»¶ï¼Œä½¿ç”¨C/C++æ ·å¼çš„<code>//</code>å’Œ<code>/* ... */</code>è¯­æ³•ã€‚</p>
<figure class="highlight protobuf"><table><tr><td class="code"><pre><span class="line">/* SearchRequest represents a search query, with pagination options to</span><br><span class="line"> * indicate which results to include in the response. */</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">message</span> <span class="title">SearchRequest</span> </span>&#123;</span><br><span class="line">  <span class="built_in">string</span> query = <span class="number">1</span>;</span><br><span class="line">  <span class="built_in">int32</span> page_number = <span class="number">2</span>;  <span class="comment">// Which page number do we want?</span></span><br><span class="line">  <span class="built_in">int32</span> result_per_page = <span class="number">3</span>;  <span class="comment">// Number of results to return per page.</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="ä¿ç•™å­—æ®µ"><a href="#ä¿ç•™å­—æ®µ" class="headerlink" title="ä¿ç•™å­—æ®µ"></a>ä¿ç•™å­—æ®µ</h3><p>å¦‚æœä½ é€šè¿‡åˆ é™¤æ•´ä¸ªå­—æ®µæˆ–è€…å°†å®ƒæ³¨é‡Šæ‰æ¥æ›´æ–°ä¸€ç§æ¶ˆæ¯ç±»å‹ï¼Œæœªæ¥çš„ç”¨æˆ·å¯ä»¥åœ¨æ›´æ–°ç±»å‹æ—¶é‡ç”¨è¯¥æ ‡ç­¾å·ç ã€‚å¦‚æœä»–ä»¬ç¨ååŠ è½½åŒæ ·çš„<code>.proto</code>æ—§ç‰ˆæœ¬ï¼Œå¯èƒ½ä¼šå¯¼è‡´ä¸¥é‡çš„é—®é¢˜ï¼ŒåŒ…æ‹¬æ•°æ®æŸåï¼Œéšç§é”™è¯¯ï¼Œè¯¸å¦‚æ­¤ç±»ã€‚ç¡®ä¿è¿™ç§æƒ…å†µä¸ä¼šå‘ç”Ÿçš„ä¸€ç§æ–¹æ³•æ˜¯æŒ‡å®šå·²åˆ é™¤å­—æ®µçš„å­—æ®µæ ‡è®°(å’Œ/æˆ–è€…åç§°)è¢«ä¿ç•™(è¿™å¯èƒ½ä¼šå¯¼è‡´JSONåºåˆ—åŒ–é—®é¢˜)ã€‚å¦‚æœå°†æ¥çš„ä»»ä½•ç”¨æˆ·è¯•å›¾ä½¿ç”¨è¿™äº›æ ‡è¯†ç¬¦ï¼Œprotocal buffer ç¼–è¯‘å™¨å°†æŠ¥é”™ã€‚</p>
<figure class="highlight protobuf"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">message</span> <span class="title">Foo</span> </span>&#123;</span><br><span class="line">  reserved <span class="number">2</span>, <span class="number">15</span>, <span class="number">9</span> to <span class="number">11</span>;</span><br><span class="line">  reserved <span class="string">"foo"</span>, <span class="string">"bar"</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¯·æ³¨æ„ï¼Œä½ ä¸èƒ½åœ¨åŒä¸€<code>reserved</code>è¯­å¥ä¸­æ··åˆå­—æ®µåç§°å’Œæ ‡ç­¾å·ç ã€‚</p>
<h3 id="ä½ çš„-protoå¯ä»¥ç”Ÿæˆä»€ä¹ˆï¼Ÿ"><a href="#ä½ çš„-protoå¯ä»¥ç”Ÿæˆä»€ä¹ˆï¼Ÿ" class="headerlink" title="ä½ çš„.protoå¯ä»¥ç”Ÿæˆä»€ä¹ˆï¼Ÿ"></a>ä½ çš„<code>.proto</code>å¯ä»¥ç”Ÿæˆä»€ä¹ˆï¼Ÿ</h3><p>å½“ä½ åœ¨protocal buffer ç¼–è¯‘å™¨ä¸­è¿è¡Œä¸€ä¸ª<code>.proto</code>ï¼Œç¼–è¯‘å™¨ä¼šç”Ÿæˆä½ éœ€è¦çš„è¯­è¨€çš„ä»£ç ï¼ŒåŒ…æ‹¬gettingå’Œsettingå­—æ®µçš„å€¼ï¼Œåºåˆ—åŒ–ä½ çš„ä¿¡æ¯åˆ°è¾“å‡ºæµï¼Œä»è¾“å…¥æµè§£æä½ çš„ä¿¡æ¯ã€‚</p>
<ul>
<li>å¯¹äº<strong>C++</strong>ï¼Œç¼–è¯‘å™¨ä¸ºæ¯ä¸ª<code>.proto</code>ç”Ÿæˆä¸€ä¸ª<code>.h</code>å’Œ<code>.cc</code>æ–‡ä»¶ï¼Œæ¯ä¸ªä¿¡æ¯ç±»å‹ç”¨ä¸€ä¸ªç±»å®šä¹‰ã€‚</li>
<li>å¯¹äº<strong>Java</strong>ï¼Œç¼–è¯‘å™¨ä¼šä¸ºæ¯ä¸ªæ¶ˆæ¯æ¥è¡Œç”Ÿæˆä¸€ä¸ªå¸¦æœ‰ç±»çš„<code>.java</code>æ–‡ä»¶ï¼Œä»¥åŠç”¨äºåˆ›å»ºæ¶ˆæ¯ç±»å®åŠ›çš„ç‰¹æ®Š<code>Builder</code>ç±»ã€‚</li>
<li><strong>Python</strong>æœ‰ä¸€äº›ä¸åŒâ€”â€”Pythonç¼–è¯‘å™¨ä¼šåœ¨<code>.proto</code>ä¸­ä¸ºæ¯ä¸ªæ¶ˆæ¯ç±»å‹ç”Ÿæˆä¸€ä¸ªé™æ€æè¿°ç¬¦ï¼Œç„¶åä¸<code>metaclass</code>ä¸€èµ·ä½¿ç”¨ï¼Œä»¥åœ¨è¿è¡Œæ—¶åˆ›å»ºå¿…è¦çš„Pythonæ•°æ®è®¿é—®ç±»ã€‚</li>
<li>å¯¹äº<strong>Go</strong>ï¼Œç¼–è¯‘å™¨ä¸ºæ¯ç§æ¶ˆæ¯ç±»å‹ç”Ÿæˆä¸€ä¸ª<code>.pb.go</code>æ–‡ä»¶ã€‚</li>
<li>å¯¹äº<strong>Ruby</strong>ï¼Œç¼–è¯‘å™¨ä½¿ç”¨åŒ…å«æ¶ˆæ¯ç±»å‹çš„Rubyæ¨¡å—ç”Ÿæˆä¸€ä¸ª<code>.rb</code>æ–‡ä»¶ã€‚</li>
<li>å¯¹äº<strong>JavaNano</strong>ï¼Œç¼–è¯‘å™¨è¾“å‡ºä¸Javaç›¸ä¼¼ï¼Œä½†æ²¡æœ‰<code>Builder</code>ç±»ã€‚</li>
<li>å¯¹äº<strong>Object-C</strong>ï¼Œç¼–è¯‘å™¨ä¼šä»æ¯ä¸ª<code>.proto</code>ç”Ÿæˆä¸€ä¸ª<code>pbobjc.h</code>å’Œ<code>pbobjc.m</code>æ–‡ä»¶ï¼Œå¹¶ä¸ºä½ çš„æ–‡ä»¶ä¸­æè¿°çš„æ¯ç§æ¶ˆæ¯ç±»å‹ç”Ÿæˆä¸€ä¸ªç±»ã€‚</li>
<li>å¯¹äº<strong>C#</strong>ï¼Œç¼–è¯‘å™¨ä¼šä»æ¯ä¸ª<code>.proto</code>ç”Ÿæˆä¸€ä¸ª<code>.cs</code>æ–‡ä»¶ï¼Œå¹¶ä¸ºä½ çš„æ–‡ä»¶ä¸­æè¿°çš„æ¯ç§æ¶ˆæ¯ç±»å‹ç”Ÿæˆä¸€ä¸ªç±»ã€‚</li>
</ul>
<p>ä½ å¯ä»¥æŒ‰ç…§æ‰€é€‰è¯­è¨€çš„æ•™ç¨‹(å³å°†æ¨å‡ºproto3ç‰ˆæœ¬)äº†è§£æ›´å¤šå…³äºä½¿ç”¨æ¯ç§è¯­è¨€çš„APIçš„ä¿¡æ¯ã€‚æœ‰å…³æ›´å¤šAPIçš„è¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜…ç›¸å…³<a href="https://developers.google.com/protocol-buffers/docs/reference/overview" target="_blank" rel="noopener">APIå‚è€ƒ</a>(å³å°†æ¨å‡ºproto3ç‰ˆæœ¬)ã€‚</p>
<h2 id="Scalar-å€¼ç±»å‹"><a href="#Scalar-å€¼ç±»å‹" class="headerlink" title="Scalar å€¼ç±»å‹"></a>Scalar å€¼ç±»å‹</h2><p>æ ‡é‡æ¶ˆæ¯å­—æ®µå¯ä»¥å…·æœ‰ä»¥ä¸‹ç±»å‹ä¹‹ä¸€â€”â€”è¯¥è¡¨æ˜¾ç¤º.protoæ–‡ä»¶ä¸­æŒ‡å®šçš„ç±»å‹ä»¥åŠè‡ªåŠ¨ç”Ÿæˆçš„ç±»ä¸­çš„ç›¸åº”ç±»å‹ï¼š</p>
<table>
<thead>
<tr>
<th>.proto Type</th>
<th>Notes</th>
<th>C++ Type</th>
<th>Java Type</th>
<th>Python Type<sup>[2]</sup></th>
<th>Go Type</th>
<th>Ruby Type</th>
<th>C# Type</th>
<th>PHP Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>double</td>
<td></td>
<td>double</td>
<td>double</td>
<td>float</td>
<td>float64</td>
<td>Float</td>
<td>double</td>
<td>float</td>
</tr>
<tr>
<td>float</td>
<td></td>
<td>float</td>
<td>float</td>
<td>float</td>
<td>float32</td>
<td>Float</td>
<td>float</td>
<td>float</td>
</tr>
<tr>
<td>int32</td>
<td>ä½¿ç”¨å¯å˜é•¿åº¦ç¼–ç ã€‚è´Ÿæ•°æ˜¯æ— æ•ˆç¼–ç â€”â€”å¦‚æœä½ çš„å­—æ®µå¯èƒ½å«æœ‰è´Ÿæ•°ï¼Œè¯·æ”¹ç”¨sint32</td>
<td>int32</td>
<td>int</td>
<td>int</td>
<td>int32</td>
<td>Fixnum or Bignum (as required)</td>
<td>int</td>
<td>integer</td>
</tr>
<tr>
<td>int64</td>
<td>ä½¿ç”¨å¯å˜é•¿åº¦ç¼–ç ã€‚è´Ÿæ•°æ˜¯æ— æ•ˆç¼–ç â€”â€”å¦‚æœä½ çš„å­—æ®µå¯èƒ½å…·æœ‰è´Ÿå€¼ï¼Œè¯·æ”¹ç”¨sint64ã€‚</td>
<td>int64</td>
<td>long</td>
<td>int/long<sup>[3]</sup></td>
<td>int64</td>
<td>Bignum</td>
<td>long</td>
<td>integer/string<sup>[5]</sup></td>
</tr>
<tr>
<td>uint32</td>
<td>ä½¿ç”¨å¯å˜é•¿åº¦ç¼–ç ã€‚</td>
<td>uint32</td>
<td>int<sup>[1]</sup></td>
<td>int/long<sup>[3]</sup></td>
<td>uint32</td>
<td>Fixnum or Bignum (as required)</td>
<td>uint</td>
<td>integer</td>
</tr>
<tr>
<td>uint64</td>
<td>ä½¿ç”¨å¯å˜é•¿åº¦ç¼–ç ã€‚</td>
<td>uint64</td>
<td>long<sup>[1]</sup></td>
<td>int/long<sup>[3]</sup></td>
<td>uint64</td>
<td>Bignum</td>
<td>ulong</td>
<td>integer/string<sup>[5]</sup></td>
</tr>
<tr>
<td>sint32</td>
<td>ä½¿ç”¨å¯å˜é•¿åº¦ç¼–ç ã€‚å¸¦ç¬¦å·çš„intå€¼ã€‚è¿™äº›æ¯”å¸¸è§„çš„int32æ›´æœ‰æ•ˆåœ°ç¼–ç è´Ÿæ•°ã€‚</td>
<td>int32</td>
<td>int</td>
<td>int</td>
<td>int32</td>
<td>Fixnum or Bignum (as required)</td>
<td>int</td>
<td>integer</td>
</tr>
<tr>
<td>sint64</td>
<td>ä½¿ç”¨å¯å˜é•¿åº¦ç¼–ç ã€‚å¸¦ç¬¦å·çš„intå€¼ã€‚è¿™äº›æ¯”å¸¸è§„çš„int64æ›´æœ‰æ•ˆåœ°ç¼–ç è´Ÿæ•°ã€‚</td>
<td>int64</td>
<td>long</td>
<td>int/long<sup>[3]</sup></td>
<td>int64</td>
<td>Bignum</td>
<td>long</td>
<td>integer/string<sup>[5]</sup></td>
</tr>
<tr>
<td>fixed32</td>
<td>æ€»æ˜¯å››ä¸ªå­—èŠ‚ã€‚å¦‚æœå€¼é€šå¸¸å¤§äº$2^{28}$ï¼Œåˆ™æ¯”uint32æ•ˆç‡æ›´é«˜ã€‚</td>
<td>uint32</td>
<td>int<sup>[1]</sup></td>
<td>int</td>
<td>uint32</td>
<td>Fixnum or Bignum (as required)</td>
<td>uint</td>
<td>integer</td>
</tr>
<tr>
<td>fixed64</td>
<td>æ€»æ˜¯å…«ä¸ªå­—èŠ‚ã€‚å¦‚æœå€¼é€šå¸¸å¤§äº$2^{56}$ï¼Œåˆ™ä¼šæ¯”uint64æ›´é«˜æ•ˆã€‚</td>
<td>uint64</td>
<td>long<sup>[1]</sup></td>
<td>int/long<sup>[3]</sup></td>
<td>uint64</td>
<td>Bignum</td>
<td>ulong</td>
<td>integer/string<sup>[5]</sup></td>
</tr>
<tr>
<td>sfixed32</td>
<td>æ€»æ˜¯å››ä¸ªå­—èŠ‚ã€‚</td>
<td>int32</td>
<td>int</td>
<td>int</td>
<td>int32</td>
<td>Fixnum or Bignum (as required)</td>
<td>int</td>
<td>integer</td>
</tr>
<tr>
<td>sfixed64</td>
<td>æ€»æ˜¯å…«ä¸ªå­—èŠ‚ã€‚</td>
<td>int64</td>
<td>long</td>
<td>int/long<sup>[3]</sup></td>
<td>int64</td>
<td>Bignum</td>
<td>long</td>
<td>integer/string<sup>[5]</sup></td>
</tr>
<tr>
<td>bool</td>
<td></td>
<td>bool</td>
<td>boolean</td>
<td>bool</td>
<td>bool</td>
<td>TrueClass/FalseClass</td>
<td>bool</td>
<td>boolean</td>
</tr>
<tr>
<td>string</td>
<td>å­—ç¬¦ä¸²å¿…é¡»å§‹ç»ˆåŒ…å«UTF-8ç¼–ç æˆ–7ä½ASCIIæ–‡æœ¬ã€‚</td>
<td>string</td>
<td>String</td>
<td>str/unicode<sup>[4]</sup></td>
<td>string</td>
<td>String (UTF-8)</td>
<td>string</td>
<td>string</td>
</tr>
<tr>
<td>bytes</td>
<td>å¯èƒ½åŒ…å«ä»»ä½•å­—èŠ‚åºåˆ—ã€‚</td>
<td>string</td>
<td>ByteString</td>
<td>str</td>
<td>[]byte</td>
<td>String (ASCII-8BIT)</td>
<td>ByteString</td>
<td>string</td>
</tr>
</tbody>
</table>
<p>ä½ å¯ä»¥åœ¨ Protocal Buffer Encoding ä¸­äº†è§£æœ‰å…³è¿™äº›ç±»å‹åºåˆ—åŒ–æ¶ˆæ¯å¦‚ä½•ç¼–ç çš„æ›´å¤šä¿¡æ¯ã€‚</p>
<p><sup>[1]</sup> åœ¨Javaä¸­ï¼Œæ— ç¬¦å·çš„32ä½å’Œ64ä½æ•´æ•°ä½¿ç”¨å…¶ç­¾åå¯¹åº”è¡¨ç¤ºï¼Œæœ€é«˜ä½ä»…å­˜å‚¨åœ¨ç¬¦å·ä½ä¸­ã€‚</p>
<p><sup>[2]</sup> åœ¨æ‰€æœ‰æƒ…å†µä¸‹ï¼Œå°†å€¼è®¾ç½®ä¸ºå­—æ®µå°†æ‰§è¡Œç±»å‹æ£€æŸ¥ä»¥ç¡®ä¿å…¶æœ‰æ•ˆã€‚</p>
<p><sup>[3]</sup> 64ä½æˆ–æ— ç¬¦å·32ä½æ•´æ•°åœ¨è§£ç æ—¶æ€»æ˜¯è¡¨ç¤ºä¸ºlongï¼Œä½†å¦‚æœåœ¨è®¾ç½®å­—æ®µæ—¶ç»™å®šæ•´å‹ï¼Œåˆ™å¯ä»¥æ˜¯intã€‚åœ¨æ‰€æœ‰æƒ…å†µä¸‹ï¼Œè¯¥å€¼å¿…é¡»ç¬¦åˆè®¾ç½®æ—¶è¡¨ç¤ºçš„ç±»å‹ã€‚è§<sup>[2]</sup>ã€‚</p>
<p><sup>[4]</sup> Pythonå­—ç¬¦ä¸²åœ¨è§£ç æ—¶è¡¨ç¤ºä¸ºunicodeï¼Œä½†å¦‚æœç»™å‡ºASCIIå­—ç¬¦ä¸²(å¯èƒ½ä¼šæ›´æ”¹)ï¼Œåˆ™å¯ä»¥ä¸ºstrã€‚</p>
<p><sup>[5]</sup> Integerç”¨äº64ä½æœºå™¨ï¼Œå­—ç¬¦ä¸²ç”¨äº32ä½æœºå™¨ã€‚</p>
<h2 id="é»˜è®¤å€¼"><a href="#é»˜è®¤å€¼" class="headerlink" title="é»˜è®¤å€¼"></a>é»˜è®¤å€¼</h2><p>å½“ä¸€æ¡æ¶ˆæ¯è¢«è§£æï¼Œå¦‚æœç¼–ç çš„ä¿¡æ¯ä¸åŒ…å«ç‰¹å®šçš„ singular å…ƒç´ ï¼Œåˆ™è§£æå¯¹è±¡ä¸­çš„å¯¹åº”å­—æ®µå°†è®¾ç½®ä¸ºè¯¥å­—æ®µçš„é»˜è®¤å€¼ã€‚è¿™äº›é»˜è®¤å€¼æ˜¯ç‰¹å®šäºç±»å‹çš„ï¼š</p>
<ul>
<li>å¯¹äº string ç±»å‹ï¼Œé»˜è®¤å€¼ä¸ºç©ºå­—ç¬¦ä¸²ã€‚</li>
<li>å¯¹äº byte ç±»å‹ï¼Œé»˜è®¤å€¼æ˜¯ç©ºå­—èŠ‚ã€‚</li>
<li>å¯¹äº bool ç±»å‹ï¼Œé»˜è®¤å€¼æ˜¯ false ã€‚</li>
<li>å¯¹äº numeric(æ•°å­—) ç±»å‹ï¼Œé»˜è®¤å€¼æ˜¯0ã€‚</li>
<li>å¯¹äº enums ç±»å‹ï¼Œé»˜è®¤å€¼æ˜¯ç¬¬ä¸€ä¸ªå®šä¹‰çš„æšä¸¾å€¼ï¼Œä¸€å®šä¸º0ã€‚</li>
<li>å¯¹äºæ¶ˆæ¯å­—æ®µï¼Œè¯¥å­—æ®µæœªè®¾ç½®ã€‚å®ƒçš„ç¡®åˆ‡å€¼æ˜¯è¯­è¨€ç›¸å…³çš„ã€‚è¯¦æƒ…è¯·å‚é˜…ç”Ÿæˆçš„ä»£ç æŒ‡å—ã€‚</li>
</ul>
<p>é‡å¤(repeated)å­—æ®µçš„é»˜è®¤å€¼ä¸ºç©º(é€šå¸¸æ˜¯ç›¸åº”è¯­è¨€çš„ç©ºåˆ—è¡¨)ã€‚</p>
<p>è¯·æ³¨æ„ï¼Œå¯¹äºæ ‡é‡(scalar)æ¶ˆæ¯å­—æ®µï¼Œä¸€æ—¦è§£æäº†æ¶ˆæ¯ï¼Œå°±æ— æ³•åˆ¤æ–­å­—æ®µæ˜¯å¦è¢«æ˜¾å¼è®¾ç½®ä¸ºé»˜è®¤å€¼(ä¾‹å¦‚å¸ƒå°”å€¼æ˜¯å¦è®¾ç½®ä¸º<code>false</code>)æˆ–è€…æ ¹æœ¬æ²¡æœ‰è®¾ç½®ï¼šåœ¨å®šä¹‰æ¶ˆæ¯ç±»å‹æ—¶åº”è¯¥è®°ä½è¿™ä¸€ç‚¹ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œå¦‚æœä½ ä¸å¸Œæœ›è¯¥è¡Œä¸ºåœ¨é»˜è®¤æƒ…å†µä¸‹å‘ç”Ÿï¼Œè¯·å°†å…¶è®¾ç½®ä¸º<code>false</code>æ—¶åˆ‡æ¢æŸäº›è¡Œä¸ºçš„å¸ƒå°”å€¼ã€‚å¦è¯·æ³¨æ„ï¼Œå¦‚æœæ ‡é‡(scalar)æ¶ˆæ¯å­—æ®µè¢«è®¾ç½®ä¸ºå…¶é»˜è®¤å€¼ï¼Œåˆ™è¯¥å€¼ä¸ä¼šåœ¨è¿çº¿ä¸Šåºåˆ—åŒ–ã€‚æœ‰å…³å¦‚ä½•åœ¨ç”Ÿæˆçš„ä»£ç ä¸­ä½¿ç”¨é»˜è®¤å€¼çš„æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜…æ‰€é€‰è¯­è¨€çš„<a href="https://developers.google.com/protocol-buffers/docs/reference/overview" target="_blank" rel="noopener">ç”Ÿæˆä»£ç æŒ‡å—</a>ã€‚</p>
<h2 id="æšä¸¾"><a href="#æšä¸¾" class="headerlink" title="æšä¸¾"></a>æšä¸¾</h2><p>å½“ä½ å®šä¹‰ä¸€ä¸ªæ¶ˆæ¯ç±»å‹æ—¶ï¼Œä½ å¯èƒ½å¸Œæœ›å®ƒçš„ä¸€ä¸ªå­—æ®µåªæœ‰ä¸€ä¸ªé¢„å®šä¹‰çš„å€¼ã€‚ä¾‹å¦‚ï¼Œå‡è®¾ä½ æƒ³ä¸ºæ¯ä¸ª<code>SearchRequest</code>æ·»åŠ ä¸€ä¸ª<code>corpus</code>(è¯­æ–™åº“)å­—æ®µï¼Œå…¶ä¸­è¯­æ–™åº“å¯ä»¥æ˜¯<code>UNIVERSAL</code>,<code>WEB</code>,<code>IMAGES</code>,<code>LOCAL</code>,<code>NEWS</code>,<code>PRRDUCTS</code>æˆ–<code>VIDEO</code>ã€‚ä½ å¯ä»¥éå¸¸ç®€å•åœ°é€šè¿‡ä¸ºæ¯ä¸ªå¯èƒ½å€¼æ·»åŠ ä¸€ä¸ªå¸¸é‡æ¥ä¸ºæ¶ˆæ¯å®šä¹‰æ·»åŠ æšä¸¾ã€‚<br>ä¸‹é¢çš„ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬æ·»åŠ ä¸€ä¸ªåä¸º<code>Corpus</code>çš„æšä¸¾ï¼Œå…¶ä¸­åŒ…å«æ‰€æœ‰å¯èƒ½çš„å€¼ä»¥åŠä¸€ä¸ªç±»å‹ä¸º<code>Corpus</code>çš„å­—æ®µï¼š</p>
<figure class="highlight protobuf"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">message</span> <span class="title">SearchRequest</span> </span>&#123;</span><br><span class="line">  <span class="built_in">string</span> query = <span class="number">1</span>;</span><br><span class="line">  <span class="built_in">int32</span> page_number = <span class="number">2</span>;</span><br><span class="line">  <span class="built_in">int32</span> result_per_page = <span class="number">3</span>;</span><br><span class="line">  <span class="class"><span class="keyword">enum</span> <span class="title">Corpus</span> </span>&#123;</span><br><span class="line">    UNIVERSAL = <span class="number">0</span>;</span><br><span class="line">    WEB = <span class="number">1</span>;</span><br><span class="line">    IMAGES = <span class="number">2</span>;</span><br><span class="line">    LOCAL = <span class="number">3</span>;</span><br><span class="line">    NEWS = <span class="number">4</span>;</span><br><span class="line">    PRODUCTS = <span class="number">5</span>;</span><br><span class="line">    VIDEO = <span class="number">6</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  Corpus corpus = <span class="number">4</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å¦‚ä½ æ‰€è§ï¼Œ<code>Corpus</code>æšä¸¾çš„ç¬¬ä¸€ä¸ªå¸¸é‡æ˜ å°„ä¸º0ï¼šæ¯ä¸ªæšä¸¾å®šä¹‰éƒ½å¿…é¡»åŒ…å«ä¸€ä¸ªæ˜ å°„ä¸º0çš„å¸¸é‡ä½œä¸ºç¬¬ä¸€ä¸ªå…ƒç´ ã€‚è¿™æ˜¯å› ä¸ºï¼š</p>
<ul>
<li>å¿…é¡»æœ‰ä¸€ä¸ªé›¶å€¼ï¼Œä»¥ä¾¿æˆ‘ä»¬å¯ä»¥ä½¿ç”¨0ä½œä¸ºæ•°å­—çš„é»˜è®¤å€¼ã€‚</li>
<li>é›¶å€¼éœ€è¦æ˜¯ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œä¸ç¬¬ä¸€ä¸ªæšä¸¾å€¼å§‹ç»ˆæ˜¯é»˜è®¤å€¼çš„proto2è¯­ä¹‰å…¼å®¹ã€‚</li>
</ul>
<p>ä½ å¯ä»¥é€šè¿‡å°†ç›¸åŒçš„å€¼åˆ†é…ç»™ä¸åŒçš„æšä¸¾å¸¸é‡æ¥å®šä¹‰åˆ«åã€‚ä¸ºæ­¤ï¼Œä½ éœ€è¦å°†<code>allow_alias</code>é€‰é¡¹è®¾ç½®ä¸º<code>true</code>ï¼Œå¦åˆ™å½“æ‰¾åˆ°åˆ«åæ—¶ï¼Œåè®®ç¼–è¯‘å™¨å°†ç”Ÿæˆé”™è¯¯æ¶ˆæ¯ã€‚</p>
<figure class="highlight protobuf"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">enum</span> <span class="title">EnumAllowingAlias</span> </span>&#123;</span><br><span class="line">  <span class="keyword">option</span> allow_alias = <span class="literal">true</span>;</span><br><span class="line">  UNKNOWN = <span class="number">0</span>;</span><br><span class="line">  STARTED = <span class="number">1</span>;</span><br><span class="line">  RUNNING = <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">enum</span> <span class="title">EnumNotAllowingAlias</span> </span>&#123;</span><br><span class="line">  UNKNOWN = <span class="number">0</span>;</span><br><span class="line">  STARTED = <span class="number">1</span>;</span><br><span class="line">  <span class="comment">// RUNNING = 1;  // Uncommenting this line will cause a compile error inside Google and a warning message outside.</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æšä¸¾å™¨å¸¸é‡å¿…é¡»åœ¨32ä½æ•´æ•°çš„èŒƒå›´å†…ã€‚ç”±äºæšä¸¾å€¼åœ¨çº¿è·¯ä¸Šä½¿ç”¨<code>varint</code>ç¼–ç ï¼Œæ‰€ä»¥è´Ÿå€¼æ•ˆç‡ä¸é«˜ï¼Œå› æ­¤ä¸æ¨èä½¿ç”¨ã€‚ä½ å¯ä»¥åœ¨æ¶ˆæ¯å®šä¹‰ä¸­(å¦‚ä¸Šä¾‹)æˆ–å¤–éƒ¨å®šä¹‰æšä¸¾â€”â€”è¿™äº›æšä¸¾å¯ä»¥åœ¨<code>.proto</code>æ–‡ä»¶ä¸­çš„ä»»ä½•æ¶ˆæ¯å®šä¹‰ä¸­é‡ç”¨ã€‚ä½ è¿˜å¯ä»¥ä½¿ç”¨è¯­æ³•<code>MessageType.EnumType</code>å°†ä¸€ä¸ªæ¶ˆæ¯ä¸­å£°æ˜çš„æšä¸¾ç±»å‹ç”¨ä½œä¸åŒæ¶ˆæ¯ä¸­å­—æ®µçš„ç±»å‹ã€‚</p>
<p>å½“ä½ åœ¨ä½¿ç”¨<code>enum</code>çš„<code>.proto</code>æ–‡ä»¶ä¸Šè¿è¡Œprotocol bufferç¼–è¯‘å™¨ï¼Œç”Ÿæˆçš„ä»£ç å°†ä¸ºJavaæˆ–C++æä¾›ç›¸åº”çš„æšä¸¾å€¼ï¼Œè¿™æ˜¯ä¸€ç§ç‰¹æ®Šçš„<code>EnumDescriptor</code>ç±»ï¼Œç”¨äºåœ¨è¿è¡Œæ—¶ç”Ÿæˆçš„ç±»ä¸­åˆ›å»ºä¸€ç»„å…·æœ‰æ•´æ•°å€¼çš„ç¬¦å·å¸¸é‡ã€‚</p>
<p>åœ¨ååºåˆ—åŒ–è¿‡ç¨‹ä¸­ï¼Œæ— æ³•è¯†åˆ«çš„æšä¸¾å€¼å°†ä¿ç•™åœ¨æ¶ˆæ¯ä¸­ï¼Œä½†æ˜¯å½“æ¶ˆæ¯è¢«ååºåˆ—åŒ–æ—¶å¦‚ä½•è¡¨ç¤ºæ˜¯ä¾èµ–äºè¯­è¨€çš„ã€‚åœ¨æ”¯æŒæŒ‡å®šç¬¦å·èŒƒå›´ä¹‹å¤–çš„å€¼çš„å¼€æ”¾æšä¸¾ç±»å‹çš„è¯­è¨€(å¦‚C++å’ŒGo)ä¸­ï¼ŒæœªçŸ¥æšä¸¾å€¼ä»…ä½œä¸ºå…¶åŸºç¡€æ•´æ•°è¡¨ç¤ºå½¢å¼å­˜å‚¨ã€‚åœ¨å…·æœ‰å°é—­æšä¸¾ç±»å‹çš„è¯­è¨€(å¦‚Java)ä¸­ï¼Œæšä¸¾ä¸­çš„ä¸€ä¸ªç”¨äºè¡¨ç¤ºæ— æ³•è¯†åˆ«çš„å€¼ï¼Œå¹¶ä¸”å¯ä»¥ä½¿ç”¨ç‰¹æ®Šè®¿é—®å™¨è®¿é—®åŸºç¡€æ•´æ•°ã€‚åœ¨ä»»ä½•ä¸€ç§æƒ…å†µä¸‹ï¼Œå¦‚æœæ¶ˆæ¯è¢«åºåˆ—åŒ–ï¼Œåˆ™æ— æ³•è¯†åˆ«çš„å€¼ä»å°†ä¸æ¶ˆæ¯ä¸€èµ·åºåˆ—åŒ–ã€‚æœ‰å…³å¦‚ä½•åœ¨åº”ç”¨ç¨‹åºä¸­ä½¿ç”¨æ¶ˆæ¯æšä¸¾çš„æ›´å¤šä¿¡æ¯ï¼Œè¯·å‚é˜…æ‰€é€‰è¯­è¨€çš„<a href="https://developers.google.com/protocol-buffers/docs/reference/overview" target="_blank" rel="noopener">ç”Ÿæˆä»£ç æŒ‡å—</a>ã€‚</p>
<h3 id="ä¿ç•™å€¼"><a href="#ä¿ç•™å€¼" class="headerlink" title="ä¿ç•™å€¼"></a>ä¿ç•™å€¼</h3><p>å¦‚æœä½ é€šè¿‡å®Œå…¨åˆ é™¤æšä¸¾æ¡ç›®æˆ–å°†å…¶æ³¨é‡Šæ‰æ¥æ›´æ–°æšä¸¾ç±»å‹ï¼Œæœªæ¥çš„ç”¨æˆ·å¯ä»¥åœ¨å¯¹è¯¥ç±»å‹è¿›è¡Œè‡ªå·±çš„æ›´æ–°æ—¶é‡æ–°ä½¿ç”¨æ•°å€¼ã€‚å¦‚æœç¨ååŠ è½½ç›¸åŒçš„<code>.proto</code>çš„æ—§ç‰ˆæœ¬ï¼ŒåŒ…æ‹¬æ•°æ®æŸåï¼Œéšç§é”™è¯¯ç­‰ï¼Œåˆ™å¯èƒ½ä¼šå¯¼è‡´ä¸¥é‡é—®é¢˜ã€‚ç¡®ä¿è¿™ç§æƒ…å†µä¸ä¼šå‘ç”Ÿçš„ä¸€ç§æ–¹æ³•æŒ‡å®šå·²åˆ é™¤æ¡ç›®çš„æ•°å­—å€¼(å’Œ/æˆ–åç§°)è¢«ä¿ç•™(è¿™ä¹Ÿå¯èƒ½ä¼šå¯¼è‡´JSONåºåˆ—åŒ–çš„é—®é¢˜)ã€‚å¦‚æœå°†æ¥çš„ä»»ä½•ç”¨æˆ·è¯•å›¾ä½¿ç”¨è¿™äº›æ ‡è¯†ç¬¦ï¼Œprotocol buffer ç¼–è¯‘å™¨å°†ä¼šæŠ¥é”™ã€‚ä½ å¯ä»¥ä½¿ç”¨<code>max</code>å…³é”®å­—æŒ‡å®šä¿ç•™çš„æ•°å€¼èŒƒå›´ä¸Šå‡åˆ°æœ€å¤§å¯èƒ½å€¼ã€‚</p>
<figure class="highlight protobuf"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">enum</span> <span class="title">Foo</span> </span>&#123;</span><br><span class="line">  reserved <span class="number">2</span>, <span class="number">15</span>, <span class="number">9</span> to <span class="number">11</span>, <span class="number">40</span> to max;</span><br><span class="line">  reserved <span class="string">"FOO"</span>, <span class="string">"BAR"</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¯·æ³¨æ„ï¼Œä½ ä¸èƒ½åœ¨åŒä¸€<code>reserved</code>è¯­å¥ä¸­æ··åˆå­—æ®µåç§°å’Œæ•°å­—å€¼ã€‚</p>
<h3 id="ä½¿ç”¨å…¶ä»–æ¶ˆæ¯ç±»å‹"><a href="#ä½¿ç”¨å…¶ä»–æ¶ˆæ¯ç±»å‹" class="headerlink" title="ä½¿ç”¨å…¶ä»–æ¶ˆæ¯ç±»å‹"></a>ä½¿ç”¨å…¶ä»–æ¶ˆæ¯ç±»å‹</h3><p>ä½ å¯ä»¥ä½¿ç”¨å…¶ä»–æ¶ˆæ¯ç±»å‹ä½œä¸ºå­—æ®µç±»å‹ã€‚ä¾‹å¦‚ï¼Œå‡è®¾ä½ æƒ³åœ¨æ¯ä¸ª<code>SearchResponse</code>æ¶ˆæ¯ä¸­åŒ…å«<code>Result</code>æ¶ˆæ¯â€”â€”ä¸ºæ­¤ï¼Œä½ å¯ä»¥åœ¨åŒä¸€ä¸ª<code>.proto</code>ä¸­å®šä¹‰ä¸€ä¸ª<code>Result</code>æ¶ˆæ¯ç±»å‹ï¼Œç„¶ååœ¨<code>SearchResponse</code>ä¸­æŒ‡å®š<code>Result</code>ç±»å‹çš„å­—æ®µï¼š</p>
<figure class="highlight protobuf"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">message</span> <span class="title">SearchResponse</span> </span>&#123;</span><br><span class="line">  <span class="keyword">repeated</span> Result results = <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">message</span> <span class="title">Result</span> </span>&#123;</span><br><span class="line">  <span class="built_in">string</span> url = <span class="number">1</span>;</span><br><span class="line">  <span class="built_in">string</span> title = <span class="number">2</span>;</span><br><span class="line">  <span class="keyword">repeated</span> <span class="built_in">string</span> snippets = <span class="number">3</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="å¯¼å…¥å®šä¹‰"><a href="#å¯¼å…¥å®šä¹‰" class="headerlink" title="å¯¼å…¥å®šä¹‰"></a>å¯¼å…¥å®šä¹‰</h3><p>åœ¨ä¹‹å‰çš„ä¾‹å­ä¸­ï¼Œ<code>Result</code>æ¶ˆæ¯ç±»å‹ä¸<code>SearchResponse</code>å®šä¹‰åœ¨åŒä¸€æ–‡ä»¶ä¸­â€”â€”å¦‚æœä½ è¦ä½¿ç”¨çš„æ¶ˆæ¯ç±»å‹å·²ç»åœ¨å…¶ä»–<code>.proto</code>æ–‡ä»¶ä¸­å®šä¹‰äº†å‘¢ï¼Ÿ<br>ä½ å¯ä»¥é€šè¿‡å¯¼å…¥æ¥ä½¿ç”¨å…¶ä»–<code>.proto</code>æ–‡ä»¶ä¸­çš„å®šä¹‰ã€‚è¦å¯¼å…¥å¦ä¸€ä¸ª<code>.proto</code>çš„å®šä¹‰ï¼Œå¯ä»¥åœ¨æ–‡ä»¶é¡¶éƒ¨æ·»åŠ ä¸€æ¡å¯¼å…¥è¯­å¥ï¼š</p>
<figure class="highlight protobuf"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="string">"myproject/other_protos.proto"</span>;</span><br></pre></td></tr></table></figure>
<p>é»˜è®¤æƒ…å†µä¸‹ï¼Œä½ åªèƒ½ä½¿ç”¨ç›´æ¥å¯¼å…¥çš„<code>.proto</code>æ–‡ä»¶ä¸­çš„å®šä¹‰ã€‚ä½†æ˜¯ï¼Œæœ‰æ—¶ä½ å¯èƒ½éœ€è¦å°†<code>.proto</code>æ–‡ä»¶ç§»è‡³æ–°ä½ç½®ã€‚ä¸æ˜¯ç›´æ¥ç§»åŠ¨<code>.proto</code>æ–‡ä»¶ï¼Œè€Œæ˜¯åœ¨ä¸€æ¬¡æ›´æ”¹ä¸­æ›´æ–°æ‰€æœ‰è°ƒç”¨ç«™ç‚¹ï¼Œç°åœ¨ä½ å¯ä»¥åœ¨æ—§ä½ç½®æ”¾ç½®ä¸€ä¸ªè™šæ‹Ÿ<code>.proto</code>æ–‡ä»¶ï¼Œä»¥ä½¿ç”¨<code>import public</code>æ¦‚å¿µå°†æ‰€æœ‰å¯¼å…¥è½¬ç§»åˆ°æ–°ä½ç½®ã€‚<code>import public</code>ä¾èµ–å¯ä»¥è¢«è¿‡æ¸¡åˆ°ä»»ä½•åŒ…å«<code>import public</code>è¯­å¥çš„protoä¸­ã€‚ä¾‹å¦‚ï¼š</p>
<figure class="highlight protobuf"><table><tr><td class="code"><pre><span class="line"><span class="comment">// new.proto</span></span><br><span class="line"><span class="comment">// All definitions are moved here</span></span><br></pre></td></tr></table></figure>
<figure class="highlight protobuf"><table><tr><td class="code"><pre><span class="line"><span class="comment">// old.proto</span></span><br><span class="line"><span class="comment">// This is the proto that all clients are importing.</span></span><br><span class="line"><span class="keyword">import</span> public <span class="string">"new.proto"</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">"other.proto"</span>;</span><br></pre></td></tr></table></figure>
<figure class="highlight protobuf"><table><tr><td class="code"><pre><span class="line"><span class="comment">// client.proto</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">"old.proto"</span>;</span><br><span class="line"><span class="comment">// You use definitions from old.proto and new.proto, but not other.proto</span></span><br></pre></td></tr></table></figure>
<p>åè®®ç¼–è¯‘å™¨ä½¿ç”¨<code>-I / --proto_path</code>æ ‡å¿—åœ¨åè®®ç¼–è¯‘å™¨å‘½ä»¤è¡Œä¸­æŒ‡å®šä¸€ç»„ç›®å½•ä¸­æœç´¢å¯¼å…¥çš„æ–‡ä»¶ã€‚<br>å¦‚æœæ²¡æœ‰ç»™æ ‡å¿—ï¼Œå®ƒå°†åœ¨è°ƒç”¨ç¼–è¯‘å™¨çš„ç›®å½•ä¸­æŸ¥æ‰¾ã€‚é€šå¸¸ï¼Œä½ åº”è¯¥å°†<code>--proto_path</code>æ ‡å¿—è®¾ç½®ä¸ºæ ¹ç›®å½•ï¼Œå¹¶ä¸ºæ‰€æœ‰å¯¼å…¥ä½¿ç”¨å®Œæ•´åç§°ã€‚</p>
<h3 id="ä½¿ç”¨proto2æ¶ˆæ¯ç±»å‹"><a href="#ä½¿ç”¨proto2æ¶ˆæ¯ç±»å‹" class="headerlink" title="ä½¿ç”¨proto2æ¶ˆæ¯ç±»å‹"></a>ä½¿ç”¨proto2æ¶ˆæ¯ç±»å‹</h3><p>å¯ä»¥å¯¼å…¥proto2æ¶ˆæ¯ç±»å‹å¹¶åœ¨proto3æ¶ˆæ¯ä¸­ä½¿ç”¨å®ƒä»¬ï¼Œåä¹‹äº¦ç„¶ã€‚ç„¶è€Œï¼Œproto2æšä¸¾ä¸èƒ½ç›´æ¥ç”¨åœ¨proto3è¯­æ³•ä¸­(å¦‚æœå¯¼å…¥çš„proto2æ¶ˆæ¯ä½¿ç”¨å®ƒä»¬ï¼Œè¿™æ˜¯å¯ä»¥çš„)ã€‚</p>
<h2 id="åµŒå¥—ç±»å‹"><a href="#åµŒå¥—ç±»å‹" class="headerlink" title="åµŒå¥—ç±»å‹"></a>åµŒå¥—ç±»å‹</h2><p>ä½ å¯ä»¥åœ¨å…¶ä»–æ¶ˆæ¯ç±»å‹ä¸­å®šä¹‰å’Œä½¿ç”¨æ¶ˆæ¯ç±»å‹ï¼Œå¦‚ä¸‹ä¾‹æ‰€ç¤ºè¿™é‡Œ<code>ResultResponse</code>æ¶ˆæ¯ä¸­å®šä¹‰äº†<code>Result</code>æ¶ˆæ¯â€”â€”è¿™é‡Œ<code>ResultResponse</code>æ¶ˆæ¯ä¸­å®šä¹‰äº†<code>Result</code>æ¶ˆæ¯ï¼š</p>
<figure class="highlight protobuf"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">message</span> <span class="title">SearchResponse</span> </span>&#123;</span><br><span class="line">  <span class="class"><span class="keyword">message</span> <span class="title">Result</span> </span>&#123;</span><br><span class="line">    <span class="built_in">string</span> url = <span class="number">1</span>;</span><br><span class="line">    <span class="built_in">string</span> title = <span class="number">2</span>;</span><br><span class="line">    <span class="keyword">repeated</span> <span class="built_in">string</span> snippets = <span class="number">3</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">repeated</span> Result results = <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å¦‚æœä½ æƒ³åœ¨å…¶çˆ¶æ¶ˆæ¯ç±»å‹å¤–é‡å¤ä½¿ç”¨æ­¤æ¶ˆæ¯ç±»å‹ï¼Œè¯·å°†å…¶ç§°ä¸º<code>Parent.Type</code>ï¼š</p>
<figure class="highlight protobuf"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">message</span> <span class="title">SomeOtherMessage</span> </span>&#123;</span><br><span class="line">  SearchResponse.Result result = <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä½ å¯ä»¥æ ¹æ®éœ€è¦æ·±åº¦åµŒå¥—æ¶ˆæ¯ï¼š</p>
<figure class="highlight protobuf"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">message</span> <span class="title">Outer</span> </span>&#123;                  <span class="comment">// Level 0</span></span><br><span class="line">  <span class="class"><span class="keyword">message</span> <span class="title">MiddleAA</span> </span>&#123;  <span class="comment">// Level 1</span></span><br><span class="line">    <span class="class"><span class="keyword">message</span> <span class="title">Inner</span> </span>&#123;   <span class="comment">// Level 2</span></span><br><span class="line">      <span class="built_in">int64</span> ival = <span class="number">1</span>;</span><br><span class="line">      <span class="built_in">bool</span>  booly = <span class="number">2</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="class"><span class="keyword">message</span> <span class="title">MiddleBB</span> </span>&#123;  <span class="comment">// Level 1</span></span><br><span class="line">    <span class="class"><span class="keyword">message</span> <span class="title">Inner</span> </span>&#123;   <span class="comment">// Level 2</span></span><br><span class="line">      <span class="built_in">int32</span> ival = <span class="number">1</span>;</span><br><span class="line">      <span class="built_in">bool</span>  booly = <span class="number">2</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="æ›´æ–°æ¶ˆæ¯ç±»å‹"><a href="#æ›´æ–°æ¶ˆæ¯ç±»å‹" class="headerlink" title="æ›´æ–°æ¶ˆæ¯ç±»å‹"></a>æ›´æ–°æ¶ˆæ¯ç±»å‹</h2><p>å¦‚æœç°æœ‰çš„æ¶ˆæ¯ç±»å‹ä¸å†æ»¡è¶³ä½ çš„æ‰€æœ‰éœ€æ±‚â€”â€”ä¾‹å¦‚ï¼Œä½ å¸Œæœ›æ¶ˆæ¯æ ¼å¼å…·æœ‰é¢å¤–çš„å­—æ®µâ€”â€”ä½†ä½ ä»ç„¶å¸Œæœ›ä½¿ç”¨ä½¿ç”¨æ—§æ ¼å¼åˆ›å»ºçš„ä»£ç ï¼Œåˆ«æ‹…å¿ƒï¼åœ¨ä¸ç ´åä»»ä½•ç°æœ‰ä»£ç çš„æƒ…å†µä¸‹æ›´æ–°æ¶ˆæ¯ç±»å‹éå¸¸ç®€å•ã€‚è¯·è®°ä½ä»¥ä¸‹è§„åˆ™ï¼š</p>
<ul>
<li>ä¸è¦æ›´æ”¹ä»»ä½•ç°æœ‰å­—æ®µçš„æ•°å­—æ ‡è®°ã€‚</li>
<li>å¦‚æœä½ æ·»åŠ æ–°å­—æ®µï¼Œåˆ™ä»»ä½•ç”±ä»£ç ä½¿ç”¨â€œæ—§â€æ¶ˆæ¯æ ¼å¼åºåˆ—åŒ–çš„æ¶ˆæ¯ä»ç„¶å¯ä»¥é€šè¿‡æ–°ç”Ÿæˆçš„ä»£ç è§£æã€‚ä½ åº”è¯¥è®°ä½è¿™äº›å…ƒç´ çš„é»˜è®¤å€¼ï¼Œä»¥ä¾¿æ–°ä»£ç å¯ä»¥æ­£ç¡®åœ°ä¸æ—§ä»£ç ç”Ÿæˆçš„æ¶ˆæ¯äº¤äº’ã€‚åŒæ ·çš„ï¼Œç”±æ–°ä»£ç åˆ›å»ºçš„æ¶ˆæ¯å¯ä»¥ç”±æ—§ä»£ç è§£æï¼šæ—§çš„äºŒè¿›åˆ¶æ–‡ä»¶åœ¨è§£ææ—¶ä¼šç®€å•åœ°å¿½ç•¥æ–°å­—æ®µã€‚æœ‰å…³è¯¦æƒ…ï¼Œè¯·å‚é˜…æœªçŸ¥å­—æ®µéƒ¨åˆ†ã€‚</li>
<li>åªæœ‰åœ¨æ›´æ–°çš„æ¶ˆæ¯ç±»å‹ä¸­ä¸å†ä½¿ç”¨æ ‡ç­¾å·ç ï¼Œå­—æ®µå°±å¯ä»¥è¢«åˆ é™¤ã€‚ä½ å¯èƒ½å¸Œæœ›é‡å‘½åè¯¥å­—æ®µï¼Œå¯èƒ½ä¼šæ·»åŠ å‰ç¼€â€œOBSOLETE_â€ï¼Œæˆ–è€…ä¿ç•™æ ‡è®°ï¼Œä»¥ä¾¿å°†æ¥çš„<code>.proto</code>ç”¨æˆ·ä¸ä¼šæ„å¤–é‡ç”¨è¯¥å·ç ã€‚</li>
<li><code>int32</code>,<code>uint32</code>,<code>int64</code>,<code>uint64</code>,å’Œ<code>bool</code>å…¨éƒ½å…¼å®¹â€”â€”è¿™æ„å‘³ç€ä½ å¯ä»¥å°†å­—æ®µä»è¿™äº›ç±»å‹ä¹‹ä¸€æ›´æ”¹ä¸ºå¦ä¸€å­—æ®µè€Œä¸ç ´åå‘å‰æˆ–å‘åå…¼å®¹æ€§ã€‚å¦‚æœä¸€ä¸ªæ•°å­—ä»ä¸é€‚åˆç›¸åº”ç±»å‹çš„çº¿è·¯ä¸­è§£æå‡ºæ¥ï¼Œåˆ™ä¼šå¾—åˆ°ä¸åœ¨C++ä¸­å°†æ•°å­—è½¬æ¢ä¸ºè¯¥ç±»å‹ç›¸åŒçš„æ•ˆæœ(ä¾‹å¦‚ï¼Œå¦‚æœå°†64ä½æ•°å­—è¯»ä¸ºint32ï¼Œå®ƒå°†è¢«æˆªæ–­ä¸º32ä½)ã€‚</li>
<li><code>sint32</code>å’Œ<code>sint64</code>ç›¸äº’å…¼å®¹ï¼Œä½†ä¸å…¶ä»–æ•´æ•°ç±»å‹ä¸å…¼å®¹ã€‚</li>
<li>åªè¦å­—èŠ‚æ˜¯æœ‰æ•ˆçš„UTF-8ï¼Œ<code>string</code>å’Œ<code>bytes</code>æ˜¯å…¼å®¹çš„ã€‚</li>
<li>åµŒå…¥å¼æ¶ˆæ¯ä¸å­—èŠ‚å…¼å®¹ï¼Œå¦‚æœå­—èŠ‚åŒ…å«æ¶ˆæ¯ï¼Œå¦‚æœå­—èŠ‚åŒ…å«æ¶ˆæ¯çš„ç¼–ç ç‰ˆæœ¬ã€‚</li>
<li><code>fixed32</code>ä¸<code>sfixed32</code>å…¼å®¹ï¼Œè€Œ<code>fixed64</code>ä¸<code>sfixed64</code>å…¼å®¹</li>
<li><code>enum</code>ä¸wireæ ¼å¼çš„<code>int32</code>ï¼Œ<code>uint32</code>ï¼Œ<code>int64</code>å’Œ<code>uint64</code>å…¼å®¹(è¯·æ³¨æ„ï¼Œå¦‚æœå®ƒä»¬ä¸é€‚åˆï¼Œå€¼å°†è¢«æˆªæ–­)ã€‚ä½†è¯·æ³¨æ„ï¼Œå½“æ¶ˆæ¯è¢«ååºåˆ—åŒ–æ—¶ï¼Œå®¢æˆ·ç«¯ä»£ç å¯èƒ½ä¼šä»¥ä¸åŒçš„æ–¹å¼å¤„ç†å®ƒä»¬ï¼šä¾‹å¦‚ï¼Œæ— æ³•è¯†åˆ«çš„proto3æšä¸¾ç±»å‹å°†ä¿ç•™åœ¨æ¶ˆæ¯ä¸­ï¼Œä½†æ¶ˆæ¯ååºåˆ—åŒ–æ—¶å¦‚ä½•è¡¨ç¤ºæ˜¯è¯­è¨€ç›¸å…³çš„ã€‚ IntåŸŸå§‹ç»ˆåªä¿ç•™å®ƒä»¬çš„å€¼ã€‚</li>
</ul>
<h2 id="æœªçŸ¥å­—æ®µ"><a href="#æœªçŸ¥å­—æ®µ" class="headerlink" title="æœªçŸ¥å­—æ®µ"></a>æœªçŸ¥å­—æ®µ</h2><p>æœªçŸ¥å­—æ®µæ˜¯æ ¼å¼è‰¯å¥½çš„ protocal buffer åºåˆ—åŒ–æ•°æ®ï¼Œè¡¨ç¤ºè§£æå™¨æ— æ³•è¯†åˆ«çš„å­—æ®µã€‚ä¾‹å¦‚ï¼Œå½“ä¸€ä¸ªæ—§çš„äºŒè¿›åˆ¶æ–‡ä»¶çš„è§£æè¢«åŒ…å«æ–°å­—æ®µçš„æ–°äºŒè¿›åˆ¶æ–‡ä»¶å‘é€æ—¶ï¼Œè¿™äº›æ–°çš„å­—æ®µå°†æˆä¸ºæ—§çš„äºŒè¿›åˆ¶æ–‡ä»¶ä¸­çš„æœªçŸ¥å­—æ®µã€‚<br>Proto3å¯ä»¥æˆåŠŸè§£ææœªçŸ¥å­—æ®µçš„æ¶ˆæ¯ï¼Œä½†æ˜¯ï¼Œæ˜¯å¦èƒ½ä¿ç•™è¿™äº›æœªçŸ¥å­—æ®µå°±ä¸ç¡®å®šäº†ã€‚ä½ ä¸åº”è¯¥ä»¥æ¥ä¿å­˜æˆ–åˆ é™¤æœªçŸ¥å­—æ®µã€‚å¯¹äºå¤§å¤šæ•° Google protocol bufferçš„å®ç°ï¼ŒæœªçŸ¥å­—æ®µåœ¨proto3ä¸­æ— æ³•é€šè¿‡ç›¸åº”çš„ proto runtimes è®¿é—®ï¼Œå¹¶ä¸”åœ¨ååºåˆ—åŒ–æ—¶è¢«ä¸¢å¼ƒæˆ–é—å¿˜ã€‚è¿™æ˜¯ proto2 çš„ä¸åŒè¡Œä¸ºå—ï¼Œå…¶ä¸­æœªçŸ¥å­—æ®µæ€»æ˜¯ä¸æ¶ˆæ¯ä¸€èµ·ä¿å­˜å¹¶åºåˆ—åŒ–ã€‚</p>
<h2 id="Any"><a href="#Any" class="headerlink" title="Any"></a>Any</h2><p><code>Any</code> æ¶ˆæ¯ç±»å‹å…è®¸ä½ å°†æ¶ˆæ¯ç”¨ä½œåµŒå…¥ç±»å‹ï¼Œè€Œä¸å¿…å…·æœ‰<code>.proto</code>å®šä¹‰ã€‚ä¸€ä¸ª<code>Any</code>åŒ…å«ä¸€ä¸ªä»»æ„çš„åºåˆ—åŒ–æ¶ˆæ¯ä½œä¸ºå­—èŠ‚ï¼Œä»¥åŠä¸€ä¸ªå……å½“å…¨å±€å”¯ä¸€æ ‡è¯†ç¬¦å¹¶è§£æä¸ºè¯¥æ¶ˆæ¯ç±»å‹çš„URLã€‚è¦ä½¿ç”¨<code>Any</code>ç±»å‹ï¼Œä½ éœ€è¦å¯¼å…¥<code>google/protobuf/any.proto</code>ã€‚</p>
<figure class="highlight protobuf"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="string">"google/protobuf/any.proto"</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">message</span> <span class="title">ErrorStatus</span> </span>&#123;</span><br><span class="line">  <span class="built_in">string</span> <span class="class"><span class="keyword">message</span> = 1;</span></span><br><span class="line"><span class="class">  <span class="title">repeated</span> google.protobuf.Any details = 2;</span></span><br><span class="line"><span class="class">&#125;</span></span><br></pre></td></tr></table></figure>
<p>ç»™å®šæ¶ˆæ¯ç±»å‹çš„é»˜è®¤çš„URLæ˜¯<code>type.googleapis.com/packagename.messagename</code><br>ä¸åŒè¯­è¨€å®ç°å°†æ”¯æŒruntimeåº“å¸®åŠ©ç¨‹åºä»¥ç±»å‹å®‰å…¨çš„æ–¹å¼æ‰“åŒ…å’Œè§£å‹ç¼©Anyçš„å€¼â€”â€”ä¾‹å¦‚ï¼Œåœ¨Javaä¸­ï¼ŒAnyç±»å‹å°†å…·æœ‰ç‰¹æ®Šçš„<code>pack()</code>å’Œ<code>unpack()</code>è®¿é—®å™¨ï¼Œè€Œåœ¨C++ä¸­åˆ™æœ‰<code>PackForm()</code>å’Œ<code>UnpackTo()</code>æ–¹æ³•ï¼š</p>
<figure class="highlight protobuf"><table><tr><td class="code"><pre><span class="line"><span class="comment">// Storing an arbitrary message type in Any.</span></span><br><span class="line">NetworkErrorDetails details = ...;</span><br><span class="line">ErrorStatus status;</span><br><span class="line">status.add_details()-&gt;PackFrom(details);</span><br><span class="line"></span><br><span class="line">// Reading an arbitrary message from Any.</span><br><span class="line">ErrorStatus status = ...;</span><br><span class="line">for (const Any&amp; detail : status.details()) &#123;</span><br><span class="line">  if (detail.Is&lt;NetworkErrorDetails&gt;()) &#123;</span><br><span class="line">    NetworkErrorDetails network_error;</span><br><span class="line">    detail.UnpackTo(&amp;network_error);</span><br><span class="line">    ... processing network_error ...</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>å½“å‰ç”¨äºå¤„ç†Angç±»å‹çš„çš„runtimeåº“éƒ½åœ¨å¼€å‘ä¸­</strong><br>å¦‚æœä½ å·²ç»ç†Ÿæ‚‰<a href="https://developers.google.com/protocol-buffers/docs/proto" target="_blank" rel="noopener">proto2è¯­æ³•</a>ï¼Œåˆ™Anyç±»å‹ä¼šæ›¿æ¢<a href="https://developers.google.com/protocol-buffers/docs/proto#extensions" target="_blank" rel="noopener">æ‹“å±•å</a>ã€‚</p>
<h2 id="Oneof"><a href="#Oneof" class="headerlink" title="Oneof"></a>Oneof</h2><p>å¦‚æœä½ æœ‰ä¸€ä¸ªåŒ…å«å¤šä¸ªå­—æ®µçš„æ¶ˆæ¯ï¼Œå¹¶ä¸”æœ€å¤šåªèƒ½åŒæ—¶è®¾ç½®ä¸€ä¸ªå­—æ®µï¼Œåˆ™å¯ä»¥ä½¿ç”¨ oneof åŠŸèƒ½å¼ºåˆ¶æ‰§è¡Œæ­¤æ“ä½œå¹¶èŠ‚çœå†…å­˜ã€‚<br>Oneofå­—æ®µä¸å¸¸è§„å­—æ®µå¾ˆç›¸ä¼¼ï¼Œä½†å…±äº«ä¸­çš„æ‰€æœ‰å­—æ®µé™¤å¤–ï¼Œå¹¶ä¸”æœ€å¤šåªèƒ½åŒæ—¶è®¾ç½®ä¸€ä¸ªå­—æ®µã€‚è®¾ç½® oneof ä¸­çš„ä»»ä½•æˆå‘˜ä¼šè‡ªåŠ¨æ¸…é™¤æ‰€æœ‰å…¶ä»–æˆå‘˜ã€‚æ ¹æ®ä½ é€‰æ‹©çš„è¯­è¨€ï¼Œä½ å¯ä»¥ä½¿ç”¨ç‰¹æ®Šçš„ <code>case()</code>æˆ–<code>WhichOneof()</code>æ–¹æ³•æ£€æŸ¥oneofä¸­çš„å“ªä¸ªå€¼(å¦‚æœæœ‰)è¢«è®¾ç½®ã€‚</p>
<h3 id="ä½¿ç”¨-Oneof"><a href="#ä½¿ç”¨-Oneof" class="headerlink" title="ä½¿ç”¨ Oneof"></a>ä½¿ç”¨ Oneof</h3><p>è¦åœ¨<code>.proto</code>ä¸­å®šä¹‰ä¸€ä¸ªoneofå…³é”®å­—ï¼Œè¯·ä½¿ç”¨oneofå…³é”®å­—ï¼Œåè·Ÿä½ çš„oneofåç§°ï¼Œåœ¨æ­¤ä¾‹ä¸­ä¸º<code>test_oneof</code>ï¼š</p>
<figure class="highlight protobuf"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">message</span> <span class="title">SampleMessage</span> </span>&#123;</span><br><span class="line">  <span class="keyword">oneof</span> test_oneof &#123;</span><br><span class="line">    <span class="built_in">string</span> name = <span class="number">4</span>;</span><br><span class="line">    SubMessage sub_message = <span class="number">9</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç„¶åï¼Œå°†ä½ çš„oneofå­—æ®µæ·»åŠ åˆ°oneofå®šä¹‰ä¸­ã€‚ä½ å¯ä»¥æ·»åŠ ä»»æ„ç±»å‹çš„å­—æ®µï¼Œä½†ä¸èƒ½ä½¿ç”¨<code>repeated</code>å­—æ®µã€‚<br>åœ¨ä½ ç”Ÿæˆçš„ä»£ç ä¸­ï¼Œoneofå­—æ®µä¸å¸¸è§„å­—æ®µå…·æœ‰ç›¸åŒçš„<code>getter</code>å’Œ<code>setter</code>ã€‚ä½ è¿˜å¯ä»¥è·å¾—ä¸€ç§ç‰¹æ®Šçš„æ–¹æ³•æ£€æŸ¥oneofä¸­çš„å“ªä¸ªå€¼(å¦‚æœæœ‰)è¢«è®¾ç½®ã€‚ä½ å¯ä»¥åœ¨ç›¸å…³çš„<a href="https://developers.google.com/protocol-buffers/docs/reference/overview" target="_blank" rel="noopener">APIå‚è€ƒ</a>ä¸­æ‰¾åˆ°æ›´å¤šå…³äºä½ æ‰€é€‰è¯­è¨€çš„APIã€‚</p>
<h3 id="Oneof-çš„ç‰¹ç‚¹"><a href="#Oneof-çš„ç‰¹ç‚¹" class="headerlink" title="Oneof çš„ç‰¹ç‚¹"></a>Oneof çš„ç‰¹ç‚¹</h3><ul>
<li>è®¾ç½®ä¸€ä¸ªoneofå­—æ®µå°†è‡ªåŠ¨æ¸…é™¤oneofä¸­çš„å…¶ä»–æˆå‘˜ã€‚æ‰€ä»¥å¦‚æœä½ è®¾ç½®äº†å¤šä¸ªå­—æ®µï¼Œåˆ™åªæœ‰ä½ è®¾ç½®çš„æœ€åä¸€ä¸ªå­—æ®µä¼šæœ‰å€¼ã€‚</li>
</ul>
<figure class="highlight protobuf"><table><tr><td class="code"><pre><span class="line">SampleMessage message;</span><br><span class="line">message.set_name("name");</span><br><span class="line">CHECK(message.has_name());</span><br><span class="line">message.mutable_sub_message();   // Will clear name field.</span><br><span class="line">CHECK(!message.has_name());</span><br></pre></td></tr></table></figure>
<ul>
<li>å¦‚æœè§£æå™¨åœ¨çº¿ä¸Šé‡åˆ°å¤šä¸ªåŒä¸€oneofä¸­æˆå‘˜ï¼Œåˆ™åªæœ‰æœ€åä¸€ä¸ªæˆå‘˜è¢«ç”¨äºè§£æçš„æ¶ˆæ¯ã€‚</li>
<li>ä¸€ä¸ªoneofä¸èƒ½æ˜¯<code>repeated</code>ã€‚</li>
<li>åå°„APIé€‚ç”¨äºoneofå­—æ®µã€‚</li>
<li>å¦‚æœä½ ä½¿ç”¨C++ï¼Œè¯·ç¡®ä¿ä½ çš„ä»£ç ä¸ä¼šå¯¼è‡´å†…å­˜å´©æºƒã€‚ä»¥ä¸‹ç¤ºä¾‹ä»£ç å°†å› ä¸ºè°ƒç”¨<code>set_name()</code>æ–¹æ³•åˆ é™¤äº†<code>sub_message</code>è€Œå´©æºƒã€‚</li>
</ul>
<figure class="highlight protobuf"><table><tr><td class="code"><pre><span class="line">SampleMessage message;</span><br><span class="line">SubMessage* sub_message = <span class="class"><span class="keyword">message</span>.<span class="title">mutable_sub_message</span>();</span></span><br><span class="line"><span class="class">message.set_name("name");      // Will delete sub_message</span></span><br><span class="line"><span class="class">sub_message-&gt;set_...            // Crashes here</span></span><br></pre></td></tr></table></figure>
<ul>
<li>è¿˜æ˜¯C++ï¼Œå¦‚æœä½ <code>Swap()</code>ä¸¤ä¸ªå¸¦æœ‰oneofçš„æ¶ˆæ¯ï¼Œæ¯ä¸ªæ¶ˆæ¯éƒ½ä¼šä»¥å¦ä¸€ä¸ª oneof case ç»“å°¾ï¼šåœ¨ä¸‹é¢çš„ä¾‹å­ä¸­ï¼Œ<code>msg1</code>å°†æœ‰ä¸€ä¸ª<code>sub_message</code>ï¼Œè€Œ<code>msg2</code>å°†æœ‰ä¸€ä¸ª<code>name</code>ã€‚</li>
</ul>
<figure class="highlight protobuf"><table><tr><td class="code"><pre><span class="line">SampleMessage msg1;</span><br><span class="line">msg1.set_name("name");</span><br><span class="line">SampleMessage msg2;</span><br><span class="line">msg2.mutable_sub_message();</span><br><span class="line">msg1.swap(&amp;msg2);</span><br><span class="line">CHECK(msg1.has_sub_message());</span><br><span class="line">CHECK(msg2.has_name());</span><br></pre></td></tr></table></figure>
<h3 id="å‘åå…¼å®¹æ€§é—®é¢˜"><a href="#å‘åå…¼å®¹æ€§é—®é¢˜" class="headerlink" title="å‘åå…¼å®¹æ€§é—®é¢˜"></a>å‘åå…¼å®¹æ€§é—®é¢˜</h3><p>æ·»åŠ æˆ–åˆ é™¤ä¸€ä¸ªå­—æ®µæ—¶è¯·å°å¿ƒã€‚å¦‚æœæ£€æŸ¥ä¸€ä¸ªè¿”å›å€¼çš„å€¼ä¸º<code>None</code>/<code>NOT_SET</code>ï¼Œåˆ™å¯èƒ½æ„å‘³ç€oneofçš„å€¼æ²¡æœ‰è¢«è®¾ç½®ï¼Œæˆ–è€…è¢«è®¾ç½®ä¸ºä¸åŒç‰ˆæœ¬çš„oneofå­—æ®µã€‚æ²¡æœ‰åŠæ³•åˆ†è¾¨è¿™ç§å·®å¼‚ï¼Œå› ä¸ºæ— æ³•çŸ¥é“çº¿è·¯ä¸Šçš„æœªçŸ¥å­—æ®µæ˜¯å¦ä¸ºoneofçš„æˆå‘˜ã€‚</p>
<h3 id="æ ‡è®°é‡ç”¨é—®é¢˜"><a href="#æ ‡è®°é‡ç”¨é—®é¢˜" class="headerlink" title="æ ‡è®°é‡ç”¨é—®é¢˜"></a>æ ‡è®°é‡ç”¨é—®é¢˜</h3><ul>
<li><strong>å°†å­—æ®µç§»å…¥æˆ–ç§»å‡ºoneofå­—æ®µ</strong>ï¼šåœ¨æ¶ˆæ¯åºåˆ—åŒ–å’Œè§£æåï¼Œå¯èƒ½ä¼šä¸¢å¤±ä¸€äº›ä¿¡æ¯(æŸäº›å­—æ®µå°†è¢«æ¸…é™¤)ã€‚</li>
<li><strong>åˆ é™¤ä¸€ä¸ªoneofå­—æ®µå†å°†å…¶æ·»åŠ å›æ¥</strong>ï¼šåœ¨æ¶ˆæ¯åºåˆ—åŒ–å’Œè§£æåï¼Œè¿™å¯èƒ½ä¼šæ¸…é™¤ä½ å½“å‰è®¾ç½®çš„oneofå­—æ®µã€‚</li>
<li><strong>æ‹†åˆ†æˆ–åˆå¹¶oneof</strong>ï¼šè¿™ä¸ç§»åŠ¨å¸¸è§„å­—æ®µå…·æœ‰ç›¸ä¼¼çš„é—®é¢˜ã€‚</li>
</ul>
<h2 id="Maps"><a href="#Maps" class="headerlink" title="Maps"></a>Maps</h2><p>å¦‚æœä½ æƒ³åˆ›å»ºä¸€ä¸ªå…³è”æ˜ å°„(map)ä½œä¸ºæ•°æ®å®šä¹‰çš„ä¸€éƒ¨åˆ†ï¼Œprotocol bufferæä¾›äº†ä¸€ä¸ªæ–¹ä¾¿çš„å¿«æ·è¯­æ³•ã€‚</p>
<figure class="highlight protobuf"><table><tr><td class="code"><pre><span class="line">map&lt;key_type, value_type&gt; map_field = N;</span><br></pre></td></tr></table></figure>
<p>å…¶ä¸­<code>key_type</code>å¯ä»¥æ˜¯ä»»ä½•æ•´æ•°æˆ–å­—ç¬¦ä¸²ç±»å‹(å› æ­¤ï¼Œé™¤äº†æµ®ç‚¹ç±»å‹å’Œå­—èŠ‚å¤–çš„ä»»ä½•æ ‡é‡ç±»å‹)ã€‚è¯·æ³¨æ„ï¼Œæšä¸¾ä¸æ˜¯æœ‰æ•ˆçš„<code>key_type</code>ã€‚<code>value_type</code>å¯ä»¥æ˜¯é™¤å¦ä¸€ä¸ªmapä¹‹å¤–çš„ä»»ä½•ç±»å‹ã€‚</p>
<p>å› æ­¤ï¼Œä¾‹å¦‚ï¼Œå¦‚æœä½ æƒ³åˆ›å»ºä¸€ä¸ªé¡¹ç›®æ˜ å°„ï¼Œå…¶ä¸­æ¯ä¸ª<code>Project</code>æ¶ˆæ¯éƒ½ä¸ä¸€ä¸ªå­—ç¬¦ä¸²ç›¸å…³è”ï¼Œåˆ™å¯ä»¥åƒè¿™æ ·å®šä¹‰å®ƒï¼š</p>
<figure class="highlight protobuf"><table><tr><td class="code"><pre><span class="line">map&lt;<span class="built_in">string</span>, Project&gt; projects = <span class="number">3</span>;</span><br></pre></td></tr></table></figure>
<ul>
<li>Map å­—æ®µä¸èƒ½è¢« <code>repeated</code>ã€‚</li>
<li>çº¿æ ¼å¼æ’åºå’Œæ˜ å°„è¿­ä»£æ’åºæ˜¯ä¸ç¡®å®šçš„ï¼Œæ‰€ä»¥ä½ ä¸èƒ½ä¾é æ˜ å°„é¡¹ç›®çš„ç‰¹å®šé¡ºåºã€‚</li>
<li>ä¸º<code>.proto</code>ç”Ÿæˆæ–‡æœ¬æ ¼å¼æ—¶ï¼Œæ˜ å°„æŒ‰é”®æ’åºã€‚æ•°å­—é”®æŒ‰æ•°å­—æ’åºã€‚</li>
<li>ä»çº¿è·¯è§£ææˆ–åˆå¹¶æ—¶ï¼Œå¦‚æœæœ‰é‡å¤çš„æ˜ å°„é”®ï¼Œåˆ™ä½¿ç”¨æ‰€çœ‹åˆ°çš„æœ€åä¸€ä¸ªé”®ã€‚ä»æ–‡æœ¬æ ¼å¼è§£ææ˜ å°„æ—¶ï¼Œå¦‚æœæœ‰é‡å¤çš„é”®ï¼Œè§£æå¯èƒ½ä¼šå¤±è´¥ã€‚</li>
</ul>
<p>ç”Ÿæˆæ˜ å°„APIç›®å‰å¯ç”¨äºæ‰€æœ‰proto3æ”¯æŒçš„è¯­è¨€ã€‚ä½ å¯ä»¥åœ¨ç›¸å…³çš„<a href="https://developers.google.com/protocol-buffers/docs/reference/overview" target="_blank" rel="noopener">APIå‚è€ƒ</a>ä¸­æ‰¾åˆ°æ›´å¤šå…³äºä½ æ‰€é€‰è¯­è¨€çš„æ˜ å°„APIçš„ä¿¡æ¯ã€‚</p>
<h3 id="å‘åå…¼å®¹æ€§"><a href="#å‘åå…¼å®¹æ€§" class="headerlink" title="å‘åå…¼å®¹æ€§"></a>å‘åå…¼å®¹æ€§</h3><p>æ˜ å°„è¯­æ³•ç­‰åŒäºçº¿è·¯ä¸­çš„ä»¥ä¸‹å†…å®¹ï¼Œå› æ­¤ä¸æ”¯æŒæ˜ å°„çš„ protocol buffer æ¥å£å®ç°ä»ç„¶å¯ä»¥å¤„ç†ä½ çš„æ•°æ®ï¼š</p>
<figure class="highlight protobuf"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">message</span> <span class="title">MapFieldEntry</span> </span>&#123;</span><br><span class="line">  key_type key = <span class="number">1</span>;</span><br><span class="line">  value_type value = <span class="number">2</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">repeated</span> MapFieldEntry map_field = N;</span><br></pre></td></tr></table></figure>
<h2 id="åŒ…"><a href="#åŒ…" class="headerlink" title="åŒ…"></a>åŒ…</h2><p>ä½ å¯ä»¥å°†å¯é€‰<code>package</code>è¯´æ˜ç¬¦æ·»åŠ åˆ°<code>.proto</code>æ–‡ä»¶ï¼Œä»¥é˜²æ­¢åè®®æ¶ˆæ¯ç±»å‹ä¹‹é—´çš„åç§°å†²çªã€‚</p>
<figure class="highlight protobuf"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> foo.bar;</span><br><span class="line"><span class="class"><span class="keyword">message</span> <span class="title">Open</span> </span>&#123; ... &#125;</span><br></pre></td></tr></table></figure>
<p>ä½ å¯ä»¥åœ¨å®šä¹‰æ¶ˆæ¯ç±»å‹çš„å­—æ®µæ—¶ä½¿ç”¨åŒ…è¯´æ˜ç¬¦ï¼š</p>
<figure class="highlight protobuf"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">message</span> <span class="title">Foo</span> </span>&#123;</span><br><span class="line">  ...</span><br><span class="line">  foo.bar.Open open = <span class="number">1</span>;</span><br><span class="line">  ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>åœ¨C++ä¸­ï¼Œç”Ÿæˆçš„ç±»è¢«å°è£…åœ¨C++å‘½åç©ºé—´ä¸­ã€‚ä¾‹å¦‚ï¼Œ<code>Open</code>å°†ä½äºå‘½åç©ºé—´<code>foo::bar</code>ã€‚</li>
<li>åœ¨Javaä¸­ï¼Œé™¤éä½ åœ¨<code>.proto</code>æ–‡ä»¶ä¸­æ˜ç¡®æä¾›äº†<code>option java_package</code>ï¼Œå¦åˆ™è¯¥åŒ…å°†ç”¨ä½œJavaåŒ…ã€‚</li>
<li>åœ¨Pythonä¸­ï¼ŒpackageæŒ‡ä»¤è¢«å¿½ç•¥ï¼Œå› ä¸ºPythonæ¨¡å—æ ¹æ®å®ƒä»¬åœ¨æ–‡ä»¶ç³»ç»Ÿä¸­çš„ä½ç½®è¿›è¡Œç»„ç»‡ã€‚</li>
<li>åœ¨Goä¸­ï¼Œé™¤éä½ åœ¨<code>.proto</code>æ–‡ä»¶ä¸­æ˜ç¡®æä¾›äº†<code>option go_package</code>ï¼Œå¦åˆ™è¯¥è½¯ä»¶åŒ…å°†ç”¨ä½œGoè½¯ä»¶åŒ…åç§°ã€‚</li>
<li>åœ¨Rubyä¸­ï¼Œç”Ÿæˆçš„ç±»å°†è¢«å°è£…åœ¨åµŒå¥—çš„Rubyå‘½åç©ºé—´ä¸­ï¼Œå¹¶è½¬æ¢ä¸ºæ‰€éœ€çš„Rubyå¤§å†™æ ·å¼(é¦–å­—æ¯å¤§å†™;å¦‚æœç¬¬ä¸€ä¸ªå­—ç¬¦ä¸æ˜¯å­—æ¯ï¼Œåˆ™<code>PB_</code>è¢«é¢„ç½®)ã€‚ä¾‹å¦‚ï¼Œ<code>Open</code>å°†ä½äºå‘½åç©ºé—´<code>Foo::Bar</code>ä¸­ã€‚</li>
<li>åœ¨JavaNanoä¸­ï¼Œè¯¥åŒ…ç”¨ä½œJavaåŒ…ï¼Œé™¤éä½ åœ¨<code>.proto</code>æ–‡ä»¶ä¸­æ˜ç¡®æä¾›äº†ä¸€ä¸ª<code>option java_package</code>ã€‚</li>
<li>åœ¨Cï¼ƒä¸­ï¼Œé™¤éä½ åœ¨<code>.proto</code>æ–‡ä»¶ä¸­æ˜ç¡®æä¾›äº†<code>option csharp_namespace</code>ï¼Œå¦åˆ™åœ¨è½¬æ¢ä¸ºPascalCaseä¹‹åï¼Œè¯¥åŒ…å°†ç”¨ä½œåç§°ç©ºé—´ã€‚ä¾‹å¦‚ï¼Œ<code>Open</code>å°†ä½äºåç§°ç©ºé—´<code>Foo.Bar</code>ä¸­ã€‚</li>
</ul>
<h3 id="åŒ…å’Œåç§°è§£å†³æ–¹æ¡ˆ"><a href="#åŒ…å’Œåç§°è§£å†³æ–¹æ¡ˆ" class="headerlink" title="åŒ…å’Œåç§°è§£å†³æ–¹æ¡ˆ"></a>åŒ…å’Œåç§°è§£å†³æ–¹æ¡ˆ</h3><p>Protocol buffer è¯­è¨€ä¸­çš„ç±»å‹åç§°è§£æä¸C++ç±»ä¼¼ï¼šé¦–å…ˆæœç´¢æœ€å†…å±‚çš„èŒƒå›´ï¼Œç„¶åæœç´¢æœ€å†…å±‚çš„å†…å®¹ï¼Œä¾æ­¤ç±»æ¨ï¼Œæ¯ä¸ªåŒ…è¢«è®¤ä¸ºæ˜¯å…¶çˆ¶åŒ…çš„â€œå†…å±‚â€ã€‚å¼€å¤´çš„çš„â€™.â€™ (ä¾‹å¦‚<code>.foo.bar.Baz</code>)æ„å‘³ç€ä»æœ€å¤–å±‚çš„èŒƒå›´å¼€å§‹ã€‚<br>Protocol buffer ç¼–è¯‘å™¨é€šè¿‡è§£æå¯¼å…¥çš„<code>.proto</code>æ–‡ä»¶æ¥è§£ææ‰€æœ‰ç±»å‹åç§°ã€‚æ¯ç§è¯­è¨€çš„ä»£ç ç”Ÿæˆå™¨éƒ½çŸ¥é“å¦‚ä½•å¼•ç”¨è¯¥è¯­è¨€ä¸­çš„æ¯ç§ç±»å‹ï¼Œå³ä½¿å®ƒå…·æœ‰ä¸åŒçš„ä½œç”¨åŸŸè§„åˆ™ã€‚</p>
<h2 id="å®šä¹‰æœåŠ¡"><a href="#å®šä¹‰æœåŠ¡" class="headerlink" title="å®šä¹‰æœåŠ¡"></a>å®šä¹‰æœåŠ¡</h2><p>å¦‚æœä½ æƒ³å°†æ¶ˆæ¯ç±»å‹ç”¨äºRPC(Remote Procedure Call - è¿œç¨‹è¿‡ç¨‹è°ƒç”¨)ç³»ç»Ÿï¼Œåˆ™å¯ä»¥åœ¨.protoæ–‡ä»¶ä¸­å®šä¹‰ä¸€ä¸ªRPCæœåŠ¡æ¥å£ï¼Œå¹¶ä¸” protocol buffer ç¼–è¯‘å™¨å°†ä½¿ç”¨ä½ é€‰æ‹©çš„è¯­è¨€ç”ŸæˆæœåŠ¡æ¥å£ä»£ç å’Œå­˜æ ¹ã€‚æ‰€ä»¥ï¼Œä¾‹å¦‚ï¼Œå¦‚æœä½ æƒ³ç”¨ä¸€ä¸ªå¸¦æœ‰ä½ çš„<code>SearchRequest</code>å¹¶è¿”å›ä¸€ä¸ª<code>SearchResponse</code>çš„æ–¹æ³•æ¥å®šä¹‰ä¸€ä¸ªRPCæœåŠ¡ï¼Œä½ å¯ä»¥åœ¨ä½ çš„<code>.proto</code>æ–‡ä»¶ä¸­å®šä¹‰å®ƒï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<figure class="highlight protobuf"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">service</span> <span class="title">SearchService</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">rpc</span> Search (SearchRequest) <span class="keyword">returns</span> (SearchResponse)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä¸ protocol buffer ä¸€èµ·ä½¿ç”¨çš„æœ€ç›´æ¥çš„RPCç³»ç»Ÿæ˜¯gRPCï¼šç”±è°·æ­Œå¼€å‘çš„è¯­è¨€æ— å…³å’Œå¹³å°æ— å…³çš„å¼€æºRPCç³»ç»Ÿã€‚gRPCç‰¹åˆ«é€‚ç”¨äº protocol buffer ï¼Œå¹¶ä¸”å¯ä»¥ä½¿ç”¨ç‰¹æ®Šçš„ protocol buffer ç¼–è¯‘å™¨æ’ä»¶ç›´æ¥ä».protoæ–‡ä»¶ç”Ÿæˆç›¸å…³çš„RPCä»£ç ã€‚<br>å¦‚æœä½ ä¸æƒ³ä½¿ç”¨gRPCï¼Œä¹Ÿå¯ä»¥åœ¨ä½ è‡ªå·±çš„RPCæ¥å£å®ç°ä¸­ä½¿ç”¨ protocol buffer ã€‚ä½ å¯ä»¥åœ¨<a href="https://developers.google.com/protocol-buffers/docs/proto#services" target="_blank" rel="noopener">Proto2è¯­è¨€æŒ‡å—</a>ä¸­æ‰¾åˆ°æ›´å¤šå…³äºæ­¤çš„ä¿¡æ¯ã€‚<br>è¿˜æœ‰ä¸€äº›æ­£åœ¨è¿›è¡Œçš„ç¬¬ä¸‰æ–¹é¡¹ç›®ä¸º Protocol Buffers å¼€å‘RPCå®ç°ã€‚æœ‰å…³æˆ‘ä»¬äº†è§£çš„é¡¹ç›®çš„é“¾æ¥åˆ—è¡¨ï¼Œè¯·å‚é˜…<a href="https://github.com/google/protobuf/blob/master/docs/third_party.md" target="_blank" rel="noopener">ç¬¬ä¸‰æ–¹é™„åŠ ç»„ä»¶wikié¡µé¢</a>ã€‚</p>
<h2 id="JSONæ˜ å°„"><a href="#JSONæ˜ å°„" class="headerlink" title="JSONæ˜ å°„"></a>JSONæ˜ å°„</h2><p>Proto3æ”¯æŒJSONä¸­çš„è§„èŒƒç¼–ç ï¼Œä½¿ç³»ç»Ÿä¹‹é—´å…±äº«æ•°æ®å˜å¾—æ›´åŠ å®¹æ˜“ã€‚ç¼–ç åœ¨ä¸‹è¡¨ä¸­æŒ‰ç±»å‹é€ä¸ªæè¿°ã€‚<br>å¦‚æœJSONç¼–ç æ•°æ®ä¸­ç¼ºå°‘å€¼æˆ–å…¶å€¼ä¸ºç©ºï¼Œåˆ™åœ¨è§£æä¸º protocol buffer æ—¶ï¼Œå®ƒå°†è¢«è§£é‡Šä¸ºé€‚å½“çš„é»˜è®¤å€¼ã€‚å¦‚æœä¸€ä¸ªå­—æ®µåœ¨ protocol buffer ä¸­å…·æœ‰é»˜è®¤å€¼ï¼Œé»˜è®¤æƒ…å†µä¸‹å®ƒå°†åœ¨JSONç¼–ç æ•°æ®ä¸­çœç•¥ä»¥èŠ‚çœç©ºé—´ã€‚å®ç°å¯èƒ½æä¾›é€‰é¡¹ä»¥åœ¨JSONç¼–ç çš„è¾“å‡ºä¸­å‘é€å…·æœ‰é»˜è®¤å€¼çš„å­—æ®µã€‚</p>
<table>
<thead>
<tr>
<th>proto3</th>
<th>JSON</th>
<th>JSON example</th>
<th>Notes</th>
</tr>
</thead>
<tbody>
<tr>
<td>message</td>
<td>object</td>
<td>{â€œfBarâ€: v, â€œgâ€: null, â€¦}</td>
<td>ç”ŸæˆJSONå¯¹è±¡ã€‚æ¶ˆæ¯å­—æ®µåç§°æ˜ å°„åˆ°lowerCamelCaseå¹¶æˆä¸ºJSONå¯¹è±¡é”®ã€‚æ¥å—nullå¹¶å°†å…¶è§†ä¸ºç›¸åº”å­—æ®µç±»å‹çš„é»˜è®¤å€¼ã€‚</td>
</tr>
<tr>
<td>enum</td>
<td>string</td>
<td>â€œFOO_BARâ€</td>
<td>ä½¿ç”¨protoä¸­æŒ‡å®šçš„æšä¸¾å€¼çš„åç§°ã€‚</td>
</tr>
<tr>
<td>map&lt;K,V&gt;</td>
<td>object</td>
<td>{â€œkâ€: v, â€¦}</td>
<td>æ‰€æœ‰çš„å¯†é’¥éƒ½è½¬æ¢ä¸ºå­—ç¬¦ä¸²ã€‚</td>
</tr>
<tr>
<td>repeated V</td>
<td>array</td>
<td>[v, â€¦]</td>
<td>nullè¢«æ¥å—ä¸ºç©ºlist[]</td>
</tr>
<tr>
<td>bool</td>
<td>true, false</td>
<td>true, false</td>
<td></td>
</tr>
<tr>
<td>string</td>
<td>string</td>
<td>â€œHello World!â€</td>
<td></td>
</tr>
<tr>
<td>bytes</td>
<td>base64 string</td>
<td>â€œYWJjMTIzIT8kKiYoKSctPUB+â€</td>
<td>JSONå€¼å°†æ˜¯ä½¿ç”¨å¸¦å¡«å……çš„æ ‡å‡†base64ç¼–ç ä½œä¸ºå­—ç¬¦ä¸²ç¼–ç çš„æ•°æ®ã€‚æ— è®ºæ˜¯æ ‡å‡†çš„è¿˜æ˜¯URLå®‰å…¨çš„base64ç¼–ç ï¼Œéƒ½å¯ä»¥æ¥å—ã€‚</td>
</tr>
<tr>
<td>int32, fixed32, uint32</td>
<td>number</td>
<td>1, -10, 0</td>
<td>JSONå€¼å°†æ˜¯ä¸€ä¸ªåè¿›åˆ¶æ•°ã€‚æ•°å­—æˆ–å­—ç¬¦ä¸²éƒ½è¢«æ¥å—ã€‚</td>
</tr>
<tr>
<td>int64, fixed64, uint64</td>
<td>string</td>
<td>â€œ1â€, â€œ-10â€</td>
<td>JSONå€¼å°†æ˜¯ä¸€ä¸ªåè¿›åˆ¶å­—ç¬¦ä¸²ã€‚æ•°å­—æˆ–å­—ç¬¦ä¸²éƒ½è¢«æ¥å—ã€‚</td>
</tr>
<tr>
<td>float, double</td>
<td>number</td>
<td>1.1, -10.0, 0, â€œNaNâ€, â€œInfinityâ€</td>
<td>JSONå€¼å°†æ˜¯ä¸€ä¸ªæ•°å­—æˆ–ç‰¹æ®Šå­—ç¬¦ä¸²å€¼â€œNaNâ€ï¼Œâ€œInfinityâ€å’Œâ€œ-Infinityâ€ä¹‹ä¸€ã€‚æ•°å­—æˆ–å­—ç¬¦ä¸²éƒ½è¢«æ¥å—ã€‚æŒ‡æ•°ç¬¦å·ä¹Ÿè¢«æ¥å—ã€‚</td>
</tr>
<tr>
<td>Any</td>
<td>object</td>
<td>{â€œ@typeâ€: â€œurlâ€, â€œfâ€: v, â€¦ }</td>
<td>å¦‚æœAnyåŒ…å«å…·æœ‰ç‰¹æ®ŠJSONæ˜ å°„çš„å€¼ï¼Œåˆ™å®ƒå°†æŒ‰å¦‚ä¸‹æ‰€ç¤ºè¿›è¡Œè½¬æ¢ï¼š {â€œ@typeâ€: xxx, â€œvalueâ€: yyy}ã€‚å¦åˆ™ï¼Œè¯¥å€¼å°†è¢«è½¬æ¢ä¸ºJSONå¯¹è±¡ï¼Œå¹¶ä¸”å°†æ’å…¥â€œ@typeâ€å­—æ®µä»¥æŒ‡ç¤ºå®é™…çš„æ•°æ®ç±»å‹ã€‚</td>
</tr>
<tr>
<td>Timestamp</td>
<td>string</td>
<td>â€œ1972-01-01T10:00:20.021Zâ€</td>
<td>ä½¿ç”¨RFC 3339ï¼Œå…¶ä¸­ç”Ÿæˆçš„è¾“å‡ºå§‹ç»ˆæ˜¯ Z-normalized ï¼Œå¹¶ä½¿ç”¨0,3,6æˆ–9å°æ•°ä½ã€‚</td>
</tr>
<tr>
<td>Duration</td>
<td>string</td>
<td>â€œ1.000340012sâ€, â€œ1sâ€</td>
<td>ç”Ÿæˆçš„è¾“å‡ºæ€»æ˜¯åŒ…å«0,3,6æˆ–9ä¸ªå°æ•°ä½ï¼Œå…·ä½“å–å†³äºæ‰€éœ€çš„ç²¾åº¦ï¼Œåé¢è·Ÿç€åç¼€â€œsâ€ã€‚æ¥å—çš„æ˜¯ä»»ä½•å°æ•°ä½ï¼ˆä¹Ÿæ²¡æœ‰ï¼‰ï¼Œåªè¦å®ƒä»¬ç¬¦åˆçº³ç§’ç²¾åº¦å¹¶ä¸”åç¼€â€œsâ€æ˜¯å¿…éœ€çš„ã€‚</td>
</tr>
<tr>
<td>Struct</td>
<td>object</td>
<td>{ â€¦ }</td>
<td>ä»»ä½•JSONå¯¹è±¡ã€‚è¯·å‚è§<code>struct.proto</code>ã€‚</td>
</tr>
<tr>
<td>Wrapper types</td>
<td>various types</td>
<td>2, â€œ2â€, â€œfooâ€, true, â€œtrueâ€, null, 0, â€¦</td>
<td>åŒ…è£…å™¨åœ¨JSONä¸­ä½¿ç”¨ä¸åŒ…è£…çš„åŸºæœ¬ç±»å‹ç›¸åŒçš„è¡¨ç¤ºå½¢å¼ï¼Œé™¤äº†åœ¨æ•°æ®è½¬æ¢å’Œä¼ è¾“æœŸé—´å…è®¸å’Œä¿ç•™nullã€‚</td>
</tr>
<tr>
<td>FieldMask</td>
<td>string</td>
<td>â€œf.fooBar,hâ€</td>
<td>è§ <code>fieldmask.proto</code>.</td>
</tr>
<tr>
<td>ListValue</td>
<td>array</td>
<td>[foo, bar, â€¦]</td>
<td></td>
</tr>
<tr>
<td>Value</td>
<td>value</td>
<td></td>
<td>ä»»ä½•JSONå€¼</td>
</tr>
<tr>
<td>NullValue</td>
<td>null</td>
<td></td>
<td>JSON null</td>
</tr>
</tbody>
</table>
<h2 id="é€‰é¡¹-option"><a href="#é€‰é¡¹-option" class="headerlink" title="é€‰é¡¹ (option)"></a>é€‰é¡¹ (option)</h2><p><code>.proto</code>æ–‡ä»¶ä¸­çš„å„ä¸ªå£°æ˜å¯ä»¥ç”¨å¤šä¸ª<em>é€‰é¡¹</em>æ‰¹æ³¨ã€‚é€‰é¡¹ä¸ä¼šæ›´æ”¹å£°æ˜çš„æ•´ä½“å«ä¹‰ï¼Œä½†å¯èƒ½ä¼šå½±å“åœ¨ç‰¹å®šä¸Šä¸‹æ–‡ä¸­å¤„ç†å®ƒçš„æ–¹å¼ã€‚å¯ç”¨é€‰é¡¹çš„å®Œæ•´åˆ—è¡¨åœ¨<code>google/protobuf/descriptor.proto</code>ä¸­å®šä¹‰ã€‚<br>æœ‰äº›é€‰é¡¹æ˜¯æ–‡ä»¶çº§é€‰é¡¹ï¼Œè¿™æ„å‘³ç€å®ƒä»¬åº”è¯¥å†™åœ¨é¡¶å±‚ä½œç”¨åŸŸä¸­ï¼Œè€Œä¸æ˜¯ä»»ä½•æ¶ˆæ¯ï¼Œæšä¸¾æˆ–æœåŠ¡å®šä¹‰ä¸­ã€‚æœ‰äº›é€‰é¡¹æ˜¯æ¶ˆæ¯çº§é€‰é¡¹ï¼Œæ„å‘³ç€å®ƒä»¬åº”è¯¥å†™åœ¨æ¶ˆæ¯å®šä¹‰ä¸­ã€‚æœ‰äº›é€‰é¡¹æ˜¯å­—æ®µçº§é€‰é¡¹ï¼Œè¿™æ„å‘³ç€å®ƒä»¬åº”è¯¥å†™åœ¨å­—æ®µå®šä¹‰ä¸­ã€‚é€‰é¡¹ä¹Ÿå¯ä»¥å†™åœ¨æšä¸¾ç±»å‹ï¼Œæšä¸¾å€¼ï¼ŒæœåŠ¡ç±»å‹å’ŒæœåŠ¡æ–¹æ³•ä¸Š;ä½†æ˜¯ï¼Œç›®å‰æ²¡æœ‰ä»»ä½•æœ‰ç”¨çš„é€‰é¡¹ã€‚</p>
<p>ä»¥ä¸‹æ˜¯ä¸€äº›æœ€å¸¸ç”¨çš„é€‰é¡¹ï¼š</p>
<ul>
<li><code>java_package</code>(æ–‡ä»¶é€‰é¡¹)ï¼šä½ è¦ç”¨äºç”Ÿæˆçš„Javaç±»çš„åŒ…ã€‚å¦‚æœåœ¨<code>.proto</code>æ–‡ä»¶ä¸­æ²¡æœ‰ç»™å‡ºæ˜ç¡®çš„<code>java_package</code>é€‰é¡¹ï¼Œé‚£ä¹ˆé»˜è®¤æƒ…å†µä¸‹ä¼šä½¿ç”¨protoåŒ…(åœ¨<code>.proto</code>æ–‡ä»¶ä¸­ä½¿ç”¨â€œpackageâ€å…³é”®å­—æŒ‡å®š)ã€‚ä½†æ˜¯ï¼Œprotoè½¯ä»¶åŒ…é€šå¸¸ä¸ä¼šåˆ¶ä½œå‡ºè‰¯å¥½çš„Javaè½¯ä»¶åŒ…ï¼Œå› ä¸ºprotoè½¯ä»¶åŒ…ä¸å¸Œæœ›ä»¥åå‘åŸŸåå¼€å¤´ã€‚å¦‚æœä¸ç”ŸæˆJavaä»£ç ï¼Œåˆ™æ­¤é€‰é¡¹ä¸èµ·ä½œç”¨ã€‚</li>
</ul>
<figure class="highlight protobuf"><table><tr><td class="code"><pre><span class="line"><span class="keyword">option</span> java_package = <span class="string">"com.example.foo"</span>;</span><br></pre></td></tr></table></figure>
<ul>
<li><code>java_multiple_files</code>(æ–‡ä»¶é€‰é¡¹)ï¼šå¯¼è‡´åœ¨åŒ…çº§åˆ«å®šä¹‰é¡¶çº§æ¶ˆæ¯ï¼Œæšä¸¾å’ŒæœåŠ¡ï¼Œè€Œä¸æ˜¯åœ¨ä»¥<code>.proto</code>æ–‡ä»¶å‘½åçš„å¤–éƒ¨ç±»ä¸­å®šä¹‰ã€‚</li>
</ul>
<figure class="highlight protobuf"><table><tr><td class="code"><pre><span class="line"><span class="keyword">option</span> java_multiple_files = <span class="literal">true</span>;</span><br></pre></td></tr></table></figure>
<ul>
<li><code>java_outer_classname</code>(æ–‡ä»¶é€‰é¡¹)ï¼šè¦ç”Ÿæˆçš„æœ€å¤–å±‚Javaç±»(å› æ­¤æ–‡ä»¶å)çš„ç±»åã€‚å¦‚æœæ²¡æœ‰åœ¨<code>.proto</code>æ–‡ä»¶ä¸­æŒ‡å®šæ˜ç¡®çš„<code>java_outer_classname</code>ï¼Œåˆ™é€šè¿‡å°†<code>.proto</code>æ–‡ä»¶åç§°è½¬æ¢ä¸ºé©¼å³°å‘½å(å› æ­¤<code>foo_bar.proto</code>å˜ä¸º<code>FooBar.java</code>)æ¥æ„é€ ç±»åç§°ã€‚å¦‚æœä¸ç”ŸæˆJavaä»£ç ï¼Œåˆ™æ­¤é€‰é¡¹ä¸èµ·ä½œç”¨ã€‚</li>
</ul>
<figure class="highlight protobuf"><table><tr><td class="code"><pre><span class="line"><span class="keyword">option</span> java_outer_classname = <span class="string">"Ponycopter"</span>;</span><br></pre></td></tr></table></figure>
<ul>
<li><code>optimize_for</code>(æ–‡ä»¶é€‰é¡¹)ï¼šå¯ä»¥è®¾ç½®ä¸º<code>SPEED</code>ï¼Œ<code>CODE_SIZE</code>æˆ–<code>LITE_RUNTIME</code>ã€‚è¿™ä¼šé€šè¿‡ä»¥ä¸‹æ–¹å¼å½±å“C++å’ŒJavaä»£ç ç”Ÿæˆå™¨(ä»¥åŠå¯èƒ½çš„ç¬¬ä¸‰æ–¹ç”Ÿæˆå™¨)ï¼š<ul>
<li><code>SPEED</code>(é»˜è®¤)ï¼š protocol buffer ç¼–è¯‘å™¨å°†ç”Ÿæˆç”¨äºåºåˆ—åŒ–ï¼Œè§£æå’Œæ‰§è¡Œæ¶ˆæ¯ç±»å‹çš„å…¶ä»–å¸¸è§æ“ä½œçš„ä»£ç ã€‚è¿™æ®µä»£ç æ˜¯é«˜åº¦ä¼˜åŒ–çš„ã€‚</li>
<li><code>CODE_SIZE</code>:  protocol buffer ç¼–è¯‘å™¨å°†ç”Ÿæˆæœ€å°‘çš„ç±»ï¼Œå¹¶ä¾é å…±äº«çš„åŸºäºåå°„çš„ä»£ç æ¥å®ç°åºåˆ—åŒ–ï¼Œè§£æå’Œå„ç§å…¶ä»–æ“ä½œã€‚ç”Ÿæˆçš„ä»£ç å› æ­¤æ¯”<code>SPEED</code>è¦å°å¾—å¤šï¼Œä½†æ“ä½œä¼šæ¯”è¾ƒæ…¢ã€‚ç±»ä»å°†å®ç°ä¸<code>SPEED</code>æ¨¡å¼ä¸­å®Œå…¨ç›¸åŒçš„å…¬å…±APIã€‚è¿™ç§æ¨¡å¼åœ¨åŒ…å«å¤§é‡<code>.proto</code>æ–‡ä»¶çš„åº”ç”¨ç¨‹åºä¸­éå¸¸æœ‰ç”¨ï¼Œå¹¶ä¸”ä¸éœ€è¦æ‰€æœ‰è¿™äº›æ–‡ä»¶éƒ½å˜å¾—éå¸¸å¿«é€Ÿã€‚</li>
<li><code>LITE_RUNTIME</code>: protocol buffer ç¼–è¯‘å™¨å°†ç”Ÿæˆä»…å–å†³äºâ€œliteâ€çš„runtimeåº“(<code>libprotobuf-lite</code>è€Œä¸æ˜¯<code>libprotobuf</code>)çš„ç±»ã€‚lite runtimeæ¯”æ•´ä¸ªåº“å°å¾—å¤šï¼ˆå¤§çº¦å°ä¸€ä¸ªæ•°é‡çº§ï¼‰ï¼Œä½†çœç•¥äº†æè¿°ç¬¦å’Œåå°„ç­‰ç‰¹å®šåŠŸèƒ½ã€‚è¿™å¯¹äºåœ¨ç§»åŠ¨ç”µè¯ç­‰å—é™å¹³å°ä¸Šè¿è¡Œçš„åº”ç”¨ç¨‹åºç‰¹åˆ«æœ‰ç”¨ã€‚ç¼–è¯‘å™¨ä»ç„¶ä¼šåƒåœ¨<code>SPEED</code>æ¨¡å¼ä¸‹é‚£æ ·ç”Ÿæˆæ‰€æœ‰æ–¹æ³•çš„å¿«é€Ÿå®ç°ã€‚ç”Ÿæˆçš„ç±»å°†ä»…å®ç°æ¯ç§è¯­è¨€çš„<code>MessageLite</code>æ¥å£ï¼Œè¯¥æ¥å£ä»…æä¾›å®Œæ•´çš„<code>Message</code>æ¥å£çš„ä¸€éƒ¨åˆ†æ–¹æ³•ã€‚</li>
</ul>
</li>
</ul>
<figure class="highlight protobuf"><table><tr><td class="code"><pre><span class="line"><span class="keyword">option</span> optimize_for = CODE_SIZE;</span><br></pre></td></tr></table></figure>
<ul>
<li><code>cc_enable_arenas</code>ï¼ˆæ–‡ä»¶é€‰é¡¹ï¼‰ï¼šä¸ºC ++ç”Ÿæˆçš„ä»£ç å¯ç”¨ç«æŠ€åœºåˆ†é…ã€‚</li>
<li><code>objc_class_prefix</code>ï¼ˆæ–‡ä»¶é€‰é¡¹ï¼‰ï¼šè®¾ç½®æ‰€æœ‰Objective-Cç”Ÿæˆçš„ç±»å’Œæ¥è‡ªæ­¤.protoçš„æšä¸¾çš„Objective-Cç±»å‰ç¼€ã€‚æ²¡æœ‰é»˜è®¤å€¼ã€‚ä½ åº”è¯¥ä½¿ç”¨<a href="https://developer.apple.com/library/ios/documentation/Cocoa/Conceptual/ProgrammingWithObjectiveC/Conventions/Conventions.html#//apple_ref/doc/uid/TP40011210-CH10-SW4" target="_blank" rel="noopener">Appleå»ºè®®</a>çš„3-5ä¸ªå¤§å†™å­—ç¬¦ä¹‹é—´çš„å‰ç¼€ã€‚è¯·æ³¨æ„ï¼Œæ‰€æœ‰2ä¸ªå­—æ¯çš„å‰ç¼€éƒ½ç”±Appleä¿ç•™ã€‚</li>
<li><code>deprecated</code>ï¼ˆå­—æ®µé€‰é¡¹ï¼‰ï¼šå¦‚æœè®¾ç½®ä¸ºtrueï¼Œåˆ™è¡¨ç¤ºè¯¥å­—æ®µå·²è¢«å¼ƒç”¨ä¸”ä¸åº”è¢«æ–°ä»£ç ä½¿ç”¨ã€‚åœ¨å¤§å¤šæ•°è¯­è¨€ä¸­ï¼Œè¿™æ²¡æœ‰å®é™…å½±å“ã€‚åœ¨Javaä¸­ï¼Œè¿™å˜æˆäº†<code>@Deprecated</code>æ³¨é‡Šã€‚å°†æ¥ï¼Œå…¶ä»–è¯­è¨€ç‰¹å®šçš„ä»£ç ç”Ÿæˆå™¨å¯èƒ½ä¼šåœ¨å­—æ®µçš„è®¿é—®å™¨ä¸Šç”Ÿæˆå¼ƒç”¨æ³¨é‡Šï¼Œè¿™ä¼šåœ¨ç¼–è¯‘è¯•å›¾ä½¿ç”¨è¯¥å­—æ®µçš„ä»£ç æ—¶åè¿‡æ¥å¯¼è‡´å‘å‡ºè­¦å‘Šã€‚å¦‚æœè¯¥å­—æ®µä¸è¢«ä»»ä½•äººä½¿ç”¨ï¼Œå¹¶ä¸”ä½ æƒ³é˜»æ­¢æ–°ç”¨æˆ·ä½¿ç”¨è¯¥å­—æ®µï¼Œè¯·è€ƒè™‘ç”¨ä¿ç•™è¯­å¥æ›¿æ¢å­—æ®µå£°æ˜ã€‚</li>
</ul>
<figure class="highlight protobuf"><table><tr><td class="code"><pre><span class="line"><span class="built_in">int32</span> old_field = <span class="number">6</span> [deprecated=<span class="literal">true</span>];</span><br></pre></td></tr></table></figure>
<h3 id="è‡ªå®šä¹‰é€‰é¡¹"><a href="#è‡ªå®šä¹‰é€‰é¡¹" class="headerlink" title="è‡ªå®šä¹‰é€‰é¡¹"></a>è‡ªå®šä¹‰é€‰é¡¹</h3><p>Protocol Buffersè¿˜å…è®¸ä½ å®šä¹‰å’Œä½¿ç”¨ä½ è‡ªå·±çš„é€‰é¡¹ã€‚è¿™æ˜¯å¤§å¤šæ•°äººä¸éœ€è¦çš„<strong>é«˜çº§åŠŸèƒ½</strong>ã€‚å¦‚æœä½ è®¤ä¸ºéœ€è¦åˆ›å»ºè‡ªå·±çš„é€‰é¡¹ï¼Œè¯·å‚é˜…<a href="https://developers.google.com/protocol-buffers/docs/proto.html#customoptions" target="_blank" rel="noopener">Proto2è¯­è¨€æŒ‡å—</a>äº†è§£è¯¦ç»†ä¿¡æ¯ã€‚è¯·æ³¨æ„ï¼Œåˆ›å»ºè‡ªå®šä¹‰é€‰é¡¹ä½¿ç”¨çš„æ‰©å±•åªå…è®¸proto3ä¸­çš„è‡ªå®šä¹‰é€‰é¡¹ã€‚</p>
<h2 id="ç”Ÿæˆä½ çš„ç±»"><a href="#ç”Ÿæˆä½ çš„ç±»" class="headerlink" title="ç”Ÿæˆä½ çš„ç±»"></a>ç”Ÿæˆä½ çš„ç±»</h2><p>è¦ç”Ÿæˆéœ€è¦ä½¿ç”¨.protoæ–‡ä»¶ä¸­å®šä¹‰çš„æ¶ˆæ¯ç±»å‹çš„Javaï¼ŒPythonï¼ŒC ++ï¼ŒGoï¼ŒRubyï¼ŒJavaNanoï¼ŒObjective-Cæˆ–Cï¼ƒä»£ç ï¼Œéœ€è¦åœ¨.protoæ–‡ä»¶ä¸Šè¿è¡Œ Protocol Buffers ç¼–è¯‘å™¨åè®®ã€‚å¦‚æœä½ å°šæœªå®‰è£…ç¼–è¯‘å™¨ï¼Œè¯·<a href="https://developers.google.com/protocol-buffers/docs/downloads.html" target="_blank" rel="noopener">ä¸‹è½½è½¯ä»¶åŒ…</a>å¹¶æŒ‰ç…§READMEä¸­çš„è¯´æ˜è¿›è¡Œæ“ä½œã€‚å¯¹äºGoï¼Œä½ è¿˜éœ€è¦ä¸ºç¼–è¯‘å™¨å®‰è£…ç‰¹æ®Šçš„ä»£ç ç”Ÿæˆå™¨æ’ä»¶ï¼šä½ å¯ä»¥åœ¨GitHubä¸Šçš„<a href="https://github.com/golang/protobuf/" target="_blank" rel="noopener">golang/protobuf</a>å­˜å‚¨åº“ä¸­æ‰¾åˆ°æ­¤å®‰è£…è¯´æ˜ã€‚<br>åè®®ç¼–è¯‘å™¨è°ƒç”¨å¦‚ä¸‹ï¼š</p>
<figure class="highlight protobuf"><table><tr><td class="code"><pre><span class="line">protoc --proto_path=IMPORT_PATH --cpp_out=DST_DIR --java_out=DST_DIR --python_out=DST_DIR --go_out=DST_DIR --ruby_out=DST_DIR --javanano_out=DST_DIR --objc_out=DST_DIR --csharp_out=DST_DIR path/to/file.proto</span><br></pre></td></tr></table></figure>
<ul>
<li><code>IMPORT_PATH</code>æŒ‡å®šè§£æ<code>import</code>æŒ‡ä»¤æ—¶è¦åœ¨å…¶ä¸­æŸ¥æ‰¾<code>.proto</code>æ–‡ä»¶çš„ç›®å½•ã€‚å¦‚æœçœç•¥ï¼Œåˆ™ä½¿ç”¨å½“å‰ç›®å½•ã€‚å¯ä»¥é€šè¿‡å¤šæ¬¡ä¼ é€’<code>--proto_path</code>é€‰é¡¹æ¥æŒ‡å®šå¤šä¸ªå¯¼å…¥ç›®å½•;ä»–ä»¬å°†æŒ‰é¡ºåºæœç´¢ã€‚<code>-I=IMPORT_PATH</code>å¯ä»¥ç”¨ä½œ<code>--proto_path</code>çš„ç®€çŸ­å½¢å¼ã€‚</li>
<li><p>ä½ å¯ä»¥æä¾›ä¸€ä¸ªæˆ–å¤šä¸ªè¾“å‡ºæŒ‡ä»¤ï¼š</p>
<ul>
<li><code>--cpp_out</code>åœ¨<code>DST_DIR</code>ä¸­ç”ŸæˆC++ä»£ç ã€‚æœ‰å…³æ›´å¤šä¿¡æ¯ï¼Œè¯·å‚é˜…<a href="https://developers.google.com/protocol-buffers/docs/reference/cpp-generated" target="_blank" rel="noopener">C++ç”Ÿæˆçš„ä»£ç å‚è€ƒ</a>ã€‚</li>
<li><code>--java_out</code>åœ¨<code>DST_DIR</code>ä¸­ç”ŸæˆJavaä»£ç ã€‚æŸ¥çœ‹<a href="https://developers.google.com/protocol-buffers/docs/reference/java-generated" target="_blank" rel="noopener">Javaç”Ÿæˆçš„ä»£ç å‚è€ƒ</a>ä»¥è·å–æ›´å¤šä¿¡æ¯ã€‚</li>
<li><code>--python_out</code>åœ¨<code>DST_DIR</code>ä¸­ç”ŸæˆPythonä»£ç ã€‚æŸ¥çœ‹<a href="https://developers.google.com/protocol-buffers/docs/reference/python-generated" target="_blank" rel="noopener">Pythonç”Ÿæˆçš„ä»£ç å‚è€ƒ</a>ä»¥è·å–æ›´å¤šä¿¡æ¯ã€‚</li>
<li><code>--go_out</code>åœ¨<code>DST_DIR</code>ä¸­ç”ŸæˆGoä»£ç ã€‚æŸ¥çœ‹<a href="https://developers.google.com/protocol-buffers/docs/reference/go-generated" target="_blank" rel="noopener">Goç”Ÿæˆçš„ä»£ç å‚è€ƒ</a>äº†è§£æ›´å¤šä¿¡æ¯ã€‚</li>
<li><code>--ruby_out</code>åœ¨<code>DST_DIR</code>ä¸­ç”ŸæˆRubyä»£ç ã€‚ Rubyç”Ÿæˆçš„ä»£ç å¼•ç”¨å³å°†æ¨å‡ºï¼</li>
<li><code>--javanano_out</code>åœ¨<code>DST_DIR</code>ä¸­ç”ŸæˆJavaNanoä»£ç ã€‚JavaNanoä»£ç ç”Ÿæˆå™¨æœ‰è®¸å¤šé€‰é¡¹å¯ç”¨äºè‡ªå®šä¹‰ç”Ÿæˆå™¨è¾“å‡ºï¼šä½ å¯ä»¥åœ¨ç”Ÿæˆå™¨<a href="https://github.com/google/protobuf/tree/master/javanano" target="_blank" rel="noopener">README</a>ä¸­æ‰¾åˆ°æ›´å¤šå…³äºè¿™äº›çš„ä¿¡æ¯ã€‚ JavaNanoç”Ÿæˆçš„ä»£ç å‚è€ƒå³å°†æ¨å‡ºï¼</li>
<li><code>--objc_out</code>åœ¨<code>DST_DIR</code>ä¸­ç”ŸæˆObjective-Cä»£ç ã€‚æœ‰å…³æ›´å¤šä¿¡æ¯ï¼Œè¯·å‚é˜…<a href="https://developers.google.com/protocol-buffers/docs/reference/objective-c-generated" target="_blank" rel="noopener">Objective-Cç”Ÿæˆçš„ä»£ç å‚è€ƒ</a>ã€‚</li>
<li><code>--csharp_out</code>åœ¨<code>DST_DIR</code>ä¸­ç”ŸæˆCï¼ƒä»£ç ã€‚æœ‰å…³æ›´å¤šä¿¡æ¯ï¼Œè¯·å‚é˜…<a href="https://developers.google.com/protocol-buffers/docs/reference/csharp-generated" target="_blank" rel="noopener">Cï¼ƒç”Ÿæˆçš„ä»£ç å‚è€ƒ</a>ã€‚</li>
<li><code>--php_out</code>åœ¨<code>DST_DIR</code>ä¸­ç”ŸæˆPHPä»£ç ã€‚æŸ¥çœ‹<a href="https://developers.google.com/protocol-buffers/docs/reference/php-generated" target="_blank" rel="noopener">PHPç”Ÿæˆçš„ä»£ç å‚è€ƒ</a>äº†è§£æ›´å¤šä¿¡æ¯ã€‚</li>
</ul>
<p>ä¸ºäº†æ–¹ä¾¿èµ·è§ï¼Œå¦‚æœ<code>DST_DIR</code>ä»¥<code>.zip</code>æˆ–<code>.jar</code>ç»“å°¾ï¼Œç¼–è¯‘å™¨ä¼šå°†è¾“å‡ºå†™å…¥ä¸€ä¸ªå…·æœ‰ç»™å®šåç§°çš„ZIPæ ¼å¼å­˜æ¡£æ–‡ä»¶ã€‚æ ¹æ®Java JARè§„èŒƒçš„è¦æ±‚ï¼Œ<code>.jar</code>è¾“å‡ºä¹Ÿä¼šè¢«èµ‹äºˆä¸€ä¸ªæ¸…å•æ–‡ä»¶ã€‚è¯·æ³¨æ„ï¼Œå¦‚æœè¾“å‡ºå­˜æ¡£å·²ç»å­˜åœ¨ï¼Œå®ƒå°†è¢«è¦†ç›–;ç¼–è¯‘å™¨ä¸å¤Ÿèªæ˜ï¼Œæ— æ³•å°†æ–‡ä»¶æ·»åŠ åˆ°ç°æœ‰å­˜æ¡£ã€‚</p>
</li>
<li><p>ä½ å¿…é¡»æä¾›ä¸€ä¸ªæˆ–å¤šä¸ª<code>.proto</code>æ–‡ä»¶ä½œä¸ºè¾“å…¥ã€‚å¯ä»¥ä¸€æ¬¡æŒ‡å®šå¤šä¸ª<code>.proto</code>æ–‡ä»¶ã€‚è™½ç„¶è¿™äº›æ–‡ä»¶æ˜¯ç›¸å¯¹äºå½“å‰ç›®å½•å‘½åçš„ï¼Œä½†æ¯ä¸ªæ–‡ä»¶éƒ½å¿…é¡»é©»ç•™åœ¨å…¶ä¸­ä¸€ä¸ª<code>IMPORT_PATH</code>ä¸­ï¼Œä»¥ä¾¿ç¼–è¯‘å™¨å¯ä»¥ç¡®å®šå…¶è§„èŒƒåç§°ã€‚</p>
</li>
</ul>
<h1 id="å…¶ä»–"><a href="#å…¶ä»–" class="headerlink" title="å…¶ä»–"></a>å…¶ä»–</h1><h2 id="RPC-framework"><a href="#RPC-framework" class="headerlink" title="RPC framework"></a>RPC framework</h2><p>RPC (Remote Procedure Call - è¿œç¨‹è¿‡ç¨‹è°ƒç”¨) </p>
<ul>
<li><a href="http://www.grpc.io/docs/" target="_blank" rel="noopener">GRPC - Google</a></li>
<li><a href="https://thrift.apache.org/" target="_blank" rel="noopener">Thrift - Apache</a></li>
</ul>
]]></content>
      <categories>
        <category>Protocol</category>
      </categories>
      <tags>
        <tag>Protocol Buffer</tag>
      </tags>
  </entry>
  <entry>
    <title>Google Protocol Buffer with Golang</title>
    <url>/2018/02/11/Google%20Protocol%20Buffer%20with%20Golang/</url>
    <content><![CDATA[<h2 id="äº†è§£-Google-Protocol-Buffer"><a href="#äº†è§£-Google-Protocol-Buffer" class="headerlink" title="äº†è§£ Google Protocol Buffer"></a>äº†è§£ Google Protocol Buffer</h2><p><a href="https://developers.google.com/protocol-buffers" target="_blank" rel="noopener">å®˜ç½‘</a></p>
<p>Protocol buffers are a language-neutral, platform-neutral extensible mechanism for serializing structured data.</p>
<a id="more"></a>
<h2 id="ä¸‹è½½äºŒè¿›åˆ¶æ–‡ä»¶"><a href="#ä¸‹è½½äºŒè¿›åˆ¶æ–‡ä»¶" class="headerlink" title="ä¸‹è½½äºŒè¿›åˆ¶æ–‡ä»¶"></a>ä¸‹è½½äºŒè¿›åˆ¶æ–‡ä»¶</h2><p><a href="https://github.com/google/protobuf/releases" target="_blank" rel="noopener">https://github.com/google/protobuf/releases</a></p>
<h2 id="é…ç½®ç¯å¢ƒ"><a href="#é…ç½®ç¯å¢ƒ" class="headerlink" title="é…ç½®ç¯å¢ƒ"></a>é…ç½®ç¯å¢ƒ</h2><h3 id="GOPATH"><a href="#GOPATH" class="headerlink" title="GOPATH"></a>GOPATH</h3><p>å‘½ä»¤è¡Œè¾“å…¥:</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">go dev</span><br></pre></td></tr></table></figure>
<p>æˆ–è€…åœ¨ç³»ç»Ÿç¯å¢ƒå˜é‡é‡Œæ·»åŠ ä¸€æ¡GOPATHæŒ‡å‘ä½ çš„è‡ªå®šä¹‰ç›®å½•ã€‚</p>
<p>æœ€åå°†<code>$GOPATH</code>æ·»åŠ åˆ°ç³»ç»Ÿç¯å¢ƒå˜é‡pathä¸­ã€‚</p>
<h3 id="å¯æ‰§è¡Œæ–‡ä»¶åŠ å…¥-GOPATH"><a href="#å¯æ‰§è¡Œæ–‡ä»¶åŠ å…¥-GOPATH" class="headerlink" title="å¯æ‰§è¡Œæ–‡ä»¶åŠ å…¥$GOPATH"></a>å¯æ‰§è¡Œæ–‡ä»¶åŠ å…¥$GOPATH</h3><p>ä»¥Windowsä¸ºä¾‹ï¼Œå°†ä¸‹è½½çš„å‹ç¼©åŒ…çš„binç›®å½•ä¸‹çš„<code>protoc.exe</code>å¤åˆ¶åˆ°ä½ çš„ä»»æ„pathè·¯å¾„ä¸‹ï¼Œæˆ‘æ”¾åˆ°<code>$GOPATH/bin</code>ç›®å½•ä¸‹ã€‚</p>
<h3 id="æ·»åŠ Goè¯­è¨€æ”¯æŒ"><a href="#æ·»åŠ Goè¯­è¨€æ”¯æŒ" class="headerlink" title="æ·»åŠ Goè¯­è¨€æ”¯æŒ"></a>æ·»åŠ Goè¯­è¨€æ”¯æŒ</h3><p>å‘½ä»¤è¡Œæ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">go get -u github.com/golang/protobuf/protoc-gen-go</span><br></pre></td></tr></table></figure>
<h2 id="ä»£ç ç”Ÿæˆ"><a href="#ä»£ç ç”Ÿæˆ" class="headerlink" title="ä»£ç ç”Ÿæˆ"></a>ä»£ç ç”Ÿæˆ</h2><p>å…ˆç¼–å†™ä¸€ä¸ª<code>addressbook.proto</code>æ–‡ä»¶</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">syntax = <span class="string">"proto3"</span>;</span><br><span class="line">package tutorial;</span><br><span class="line">message Person &#123;</span><br><span class="line">  string name = 1;</span><br><span class="line">  int32 id = 2;  // Unique ID number <span class="keyword">for</span> this person.</span><br><span class="line">  string email = 3;</span><br><span class="line"></span><br><span class="line">  enum PhoneType &#123;</span><br><span class="line">    MOBILE = 0;</span><br><span class="line">    HOME = 1;</span><br><span class="line">    WORK = 2;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  message PhoneNumber &#123;</span><br><span class="line">    string number = 1;</span><br><span class="line">    PhoneType <span class="built_in">type</span> = 2;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  repeated PhoneNumber phones = 4;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// Our address book file is just one of these.</span><br><span class="line">message AddressBook &#123;</span><br><span class="line">  repeated Person people = 1;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å‘½ä»¤è¡Œè¾“å…¥ä»¥ä¸‹ç”Ÿæˆå‘½ä»¤ï¼š</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">protoc --go_out=./ ./addressbook.proto</span><br><span class="line"><span class="comment"># å‘½ä»¤æ ¼å¼ protoc -I=$SRC_DIR --go_out=$DST_DIR $SRC_DIR/addressbook.proto</span></span><br></pre></td></tr></table></figure>
<p>åœ¨å½“å‰ç›®å½•ä¸‹ç”Ÿæˆ<code>addressbook.pb.go</code>æ–‡ä»¶</p>
]]></content>
      <categories>
        <category>Golang</category>
      </categories>
      <tags>
        <tag>Golang</tag>
        <tag>Protocol Buffer</tag>
      </tags>
  </entry>
  <entry>
    <title>ä¸€äº›èŠ‚çº¦ç”Ÿå‘½çš„æ“ä½œ (å¢™å†…åŠ é€Ÿ git pip conda npm docker)</title>
    <url>/2017/08/06/%E4%B8%80%E4%BA%9B%E8%8A%82%E7%BA%A6%E7%94%9F%E5%91%BD%E7%9A%84%E6%93%8D%E4%BD%9C/</url>
    <content><![CDATA[<p>ä½ æ˜¯å¦æ„Ÿè§‰  pipï¼Œ npm, gitï¼Œ docker ä¹‹ç±»çš„å·¥å…·ä¸‹è½½å®‰è£…å¥‡æ…¢ï¼Ÿ<br>å› ä¸ºå®ƒä»¬çš„é»˜è®¤æœåŠ¡å™¨éƒ½åœ¨å›½å¤–ï¼Œé‚£ä¹ˆéœ€è¦å¿…è¦çš„è®¾ç½®æ‰èƒ½å‘æŒ¥å’±ç™¾å…†å…‰çº¤çš„ä½œç”¨ã€‚ä¸‹é¢ä»‹ç»æ–¹æ³•:</p>
<a id="more"></a>
<details><br><br><summary>å¦‚æœä½ ç”¨çš„æ˜¯ linuxï¼Œåˆ«æŠ˜è…¾äº†æŒ‚ä»£ç†è§£å†³ä¸€åˆ‡é—®é¢˜</summary><br><br>ç®€å•é…ç½®ä¸‹å…¨å±€ä»£ç†ï¼Œä¹Ÿå¯ä»¥å°†ä¸‹é¢è¿™å¥åŠ å…¥ profile ä¸­<br><br><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># å‡å¦‚ä½ çš„ä»£ç†åœ°å€æ˜¯ http://127.0.0.1:1080</span></span><br><span class="line"><span class="built_in">export</span> proxy=http://127.0.0.1:1080; <span class="built_in">export</span> http_proxy=<span class="variable">$proxy</span> https_proxy=<span class="variable">$proxy</span> no_proxy=<span class="string">"localhost, 127.0.0.0/8, ::1"</span></span><br></pre></td></tr></table></figure><br><br>ç”¨ <code>privoxy</code> ç¨å¾®æŠ˜è…¾ä¸‹è§<a href="http://www.findshank.com/2018/04/15/Linux%E4%B8%8B%E4%BD%BF%E7%94%A8SS%E6%9C%AC%E5%9C%B0%E4%BB%A3%E7%90%86/">è¿™ç¯‡æ–‡ç« </a><br><br></details>

<h2 id="pip-çš„é…ç½®"><a href="#pip-çš„é…ç½®" class="headerlink" title="pip çš„é…ç½®"></a>pip çš„é…ç½®</h2><p>è§£å†³æ–¹å¼ï¼šä½¿ç”¨å›½å†…çš„pypié•œåƒåŠ é€Ÿï¼Œä»¥é˜¿é‡Œæºä¸ºä¾‹ã€‚</p>
<h3 id="æ–¹æ³•1-ä¿®æ”¹é…ç½®"><a href="#æ–¹æ³•1-ä¿®æ”¹é…ç½®" class="headerlink" title="æ–¹æ³•1 ä¿®æ”¹é…ç½®"></a>æ–¹æ³•1 ä¿®æ”¹é…ç½®</h3><ul>
<li>Linux</li>
</ul>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">mkdir ~/.pip &amp;&amp; <span class="built_in">echo</span> <span class="string">"[global]</span></span><br><span class="line"><span class="string">trusted-host =  mirrors.aliyun.com</span></span><br><span class="line"><span class="string">index-url = http://mirrors.aliyun.com/pypi/simple"</span> &gt; ~/.pip/pip.conf</span><br></pre></td></tr></table></figure>
<blockquote>
<p>æ¬²ä½¿ç”¨å…¶ä»–æºï¼Œè‡ªè¡Œæœç´¢æ›¿æ¢ã€‚æ›´å¤šé…ç½®å‚æ•°è§<a href="http://www.pip-installer.org/en/latest/configuration.html" target="_blank" rel="noopener">å®˜æ–¹æ–‡æ¡£</a>ã€‚</p>
</blockquote>
<ul>
<li>Windows</li>
</ul>
<p>æ‰“å¼€powershell(ä¸æ˜¯cmd!)ï¼Œç²˜è´´ä¸‹é¢å‘½ä»¤ã€‚</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">mkdir ~/pip/</span><br><span class="line"><span class="built_in">echo</span> <span class="string">"[global]</span></span><br><span class="line"><span class="string">trusted-host =  mirrors.aliyun.com</span></span><br><span class="line"><span class="string">index-url = http://mirrors.aliyun.com/pypi/simple</span></span><br><span class="line"><span class="string">"</span> | out-file -encoding ascii ~/pip/pip.ini</span><br></pre></td></tr></table></figure>
<p>è§£é‡Šï¼šåœ¨ç”¨æˆ·ç›®å½•(C:\Users\Username)ä¸‹æ–°å»ºåä¸ºpipçš„ç›®å½•ï¼Œç›®å½•ä¸‹æ–°å»ºæ–‡ä»¶pip.iniï¼Œå†™å…¥é˜¿é‡Œçš„é•œåƒæºé…ç½®ã€‚</p>
<blockquote>
<p>P.S å› ä¸ºé»˜è®¤è¾“å‡ºç¼–ç ä¸ºutf16ä¼šå¯¼è‡´pipå‡ºé”™ï¼Œå¿…é¡»æŒ‡å®šç¼–ç ã€‚</p>
</blockquote>
<h3 id="æ–¹æ³•2-ä¸´æ—¶ä½¿ç”¨"><a href="#æ–¹æ³•2-ä¸´æ—¶ä½¿ç”¨" class="headerlink" title="æ–¹æ³•2 ä¸´æ—¶ä½¿ç”¨"></a>æ–¹æ³•2 ä¸´æ—¶ä½¿ç”¨</h3><p>ä»¥å®‰è£…numpyä¸ºä¾‹ã€‚</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">pip install numpy -i http://mirrors.aliyun.com/pypi/simple/</span><br></pre></td></tr></table></figure>
<h2 id="conda-çš„é…ç½®"><a href="#conda-çš„é…ç½®" class="headerlink" title="conda çš„é…ç½®"></a>conda çš„é…ç½®</h2><h3 id="æ–¹æ³•1-é…ç½®ä»£ç†"><a href="#æ–¹æ³•1-é…ç½®ä»£ç†" class="headerlink" title="æ–¹æ³•1 é…ç½®ä»£ç†"></a>æ–¹æ³•1 é…ç½®ä»£ç†</h3><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">conda config --<span class="built_in">set</span> proxy_servers.http http://id:pw@address:port</span><br><span class="line">conda config --<span class="built_in">set</span> proxy_servers.https https://id:pw@address:port</span><br></pre></td></tr></table></figure>
<blockquote>
<p>ref: <a href="https://stackoverflow.com/a/48416007" target="_blank" rel="noopener">Running conda with proxy</a></p>
</blockquote>
<h3 id="æ–¹æ³•2-é…ç½®å›½å†…é•œåƒ"><a href="#æ–¹æ³•2-é…ç½®å›½å†…é•œåƒ" class="headerlink" title="æ–¹æ³•2 é…ç½®å›½å†…é•œåƒ"></a>æ–¹æ³•2 é…ç½®å›½å†…é•œåƒ</h3><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># æ·»åŠ  Anaconda çš„æ¸…åé•œåƒ</span></span><br><span class="line">conda config --add channels https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/free/</span><br><span class="line"><span class="comment"># æœç´¢æ—¶æ˜¾ç¤ºé€šé“åœ°å€</span></span><br><span class="line">conda config --<span class="built_in">set</span> show_channel_urls yes</span><br></pre></td></tr></table></figure>
<blockquote>
<p>ref: <a href="https://docs.conda.io/projects/conda/en/latest/user-guide/tasks/manage-channels.html" target="_blank" rel="noopener">Managing channels</a></p>
</blockquote>
<h2 id="git-çš„é…ç½®"><a href="#git-çš„é…ç½®" class="headerlink" title="git çš„é…ç½®"></a>git çš„é…ç½®</h2><p>è¿™ä¸ªå°±è¦ä»£ç†äº†ã€‚</p>
<h3 id="æ–¹æ³•1-è®¾ç½®gitå…¨å±€å˜é‡"><a href="#æ–¹æ³•1-è®¾ç½®gitå…¨å±€å˜é‡" class="headerlink" title="æ–¹æ³•1 è®¾ç½®gitå…¨å±€å˜é‡"></a>æ–¹æ³•1 è®¾ç½®gitå…¨å±€å˜é‡</h3><p><del>æˆ‘æ›¾ç»ä½¿ç”¨çš„lantern</del>ï¼Œå®ƒæä¾›ä¸¤ç§ä»£ç†ç«¯å£ï¼š Http(s) å’Œ Socks5ã€‚ä½¿ç”¨ä¸‹é¢å‘½ä»¤é…ç½®gitä»£ç†ï¼š</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">git config --global http.proxy http://127.0.0.1:50219</span><br><span class="line">git config --global https.proxy https://127.0.0.1:50219</span><br></pre></td></tr></table></figure>
<p>æˆ–è€…</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">git config --global http.proxy socks5://127.0.0.1:50221</span><br><span class="line">git config --global https.proxy socks5://127.0.0.1:50221</span><br></pre></td></tr></table></figure>
<p>æ ¹æ®ä½ çš„ä»£ç†é…ç½®ï¼Œä¿®æ”¹å¯¹åº”éƒ¨åˆ†å³å¯ã€‚</p>
<h3 id="æ–¹æ³•2-è®¾ç½®ä¸´æ—¶å˜é‡"><a href="#æ–¹æ³•2-è®¾ç½®ä¸´æ—¶å˜é‡" class="headerlink" title="æ–¹æ³•2 è®¾ç½®ä¸´æ—¶å˜é‡"></a>æ–¹æ³•2 è®¾ç½®ä¸´æ—¶å˜é‡</h3><p><code>git clone</code> æ—¶å¯ä»¥è¿™ä¹ˆå†™:</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">ALL_PROXY=http://127.0.0.1:1080 git <span class="built_in">clone</span> https://github.com/some/one.git</span><br></pre></td></tr></table></figure>
<h2 id="docker"><a href="#docker" class="headerlink" title="docker"></a>docker</h2><p>è§£å†³æ–¹æ³•ï¼šä½¿ç”¨å›½å†…çš„åŠ é€Ÿåœ°å€ã€‚è·å–é€”å¾„å¾ˆå¤šã€‚æˆ‘ä½¿ç”¨çš„æ˜¯é˜¿é‡Œäº‘çš„å®¹å™¨é•œåƒæœåŠ¡é‡Œçš„ä¸“å±åŠ é€Ÿåœ°å€ã€‚</p>
<blockquote>
<p><code>PCODE</code> æ˜¯é˜¿é‡Œäº‘å¸æˆ·çš„åŠ é€Ÿå‰ç¼€ï¼Œåæ–‡ä¸­è¯·è‡ªè¡Œæ›¿æ¢ã€‚å¯ä»¥åœ¨<a href="https://cr.console.aliyun.com/#/accelerator" target="_blank" rel="noopener">è¿™é‡Œ</a>è·å–</p>
</blockquote>
<ul>
<li>Linux</li>
</ul>
<p>ä¿®æ”¹<code>/etc/docker/daemon.json</code></p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">sudo mkdir -p /etc/docker</span><br><span class="line">sudo tee /etc/docker/daemon.json &lt;&lt;-<span class="string">'EOF'</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">"registry-mirrors"</span>: [<span class="string">"https://PCODE.mirror.aliyuncs.com"</span>]</span><br><span class="line">&#125;</span><br><span class="line">EOF</span><br><span class="line">sudo systemctl daemon-reload</span><br><span class="line">sudo systemctl restart docker</span><br></pre></td></tr></table></figure>
<blockquote>
<p>P.S Dockerç‰ˆæœ¬éœ€å¤§äº1.10.0</p>
</blockquote>
<ul>
<li>Windows</li>
</ul>
<blockquote>
<p>æˆ‘çš„ç³»ç»Ÿæ˜¯Window10ï¼Œå®˜æ–¹æ¨èä½¿ç”¨ <code>Docker for Windows</code> ï¼Œæ­¤å¤„ä¸ä»‹ç» <code>Docker Toolbox</code></p>
</blockquote>
<p>åœ¨ç³»ç»Ÿå³ä¸‹è§’æ‰˜ç›˜å›¾æ ‡å†…å³é”®èœå•é€‰æ‹© Settingsï¼Œæ‰“å¼€é…ç½®çª—å£åå·¦ä¾§å¯¼èˆªèœå•é€‰æ‹© Docker Daemonã€‚ç¼–è¾‘çª—å£å†…çš„JSONä¸²ï¼Œå¡«å†™åŠ é€Ÿå™¨åœ°å€ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="string">"registry-mirrors"</span>: [<span class="string">"https://PCODE.mirror.aliyuncs.com"</span>]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç¼–è¾‘å®Œæˆï¼Œç‚¹å‡» Apply ä¿å­˜æŒ‰é’®ï¼Œç­‰å¾…Dockeré‡å¯å¹¶åº”ç”¨é…ç½®çš„é•œåƒåŠ é€Ÿå™¨ã€‚</p>
<blockquote>
<p><code>Docker for Windows</code> å’Œ <code>Docker Toolbox</code>æ˜¯ä¸å…¼å®¹çš„ã€‚</p>
</blockquote>
<h2 id="npm-çš„é…ç½®"><a href="#npm-çš„é…ç½®" class="headerlink" title="npm çš„é…ç½®"></a>npm çš„é…ç½®</h2><h3 id="æŒ‚ä»£ç†æ˜¯æœ€å¥½çš„è§£å†³åŠæ³•"><a href="#æŒ‚ä»£ç†æ˜¯æœ€å¥½çš„è§£å†³åŠæ³•" class="headerlink" title="æŒ‚ä»£ç†æ˜¯æœ€å¥½çš„è§£å†³åŠæ³•"></a>æŒ‚ä»£ç†æ˜¯æœ€å¥½çš„è§£å†³åŠæ³•</h3><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">npm config <span class="built_in">set</span> proxy http://proxy.company.com:8080</span><br><span class="line">npm config <span class="built_in">set</span> https-proxy http://proxy.company.com:8080</span><br></pre></td></tr></table></figure>
<details><br><br><summary> update: ä¹‹å‰çš„æ–¹å¼å‡ä¸æ¨èï¼ </summary><br><br><del>è§£å†³æ–¹å¼ï¼šä¹Ÿæ˜¯æ›¿æ¢å›½å†…çš„æºï¼Œä»¥æ·˜å®æºä¸ºä¾‹ã€‚</del><br><br>### <del>æ–¹æ³•1 ä¿®æ”¹é»˜è®¤åº“é…ç½®(ä¸æ¨èï¼ä¼šæœ‰è«åå…¶å¦™çš„é—®é¢˜)</del><br><br><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">npm config <span class="built_in">set</span> registry https://registry.npm.taobao.org</span><br></pre></td></tr></table></figure><br><br>### <del>æ–¹æ³•2 ä½¿ç”¨cnpm</del><br><br>ä½¿ç”¨cnpmå‘½ä»¤æ›¿ä»£npmå‘½ä»¤ã€‚<br><br><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">npm install -g cnpm --registry=https://registry.npm.taobao.org</span><br></pre></td></tr></table></figure><br><br>### <del>æ–¹æ³•3 ä¸´æ—¶æ›¿æ¢ä¸‹è½½æº</del><br><br>ä»¥å®‰è£…Expressä¸ºä¾‹ã€‚<br><br><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">npm --registry=https://registry.npm.taobao.org install express</span><br></pre></td></tr></table></figure><br><br></details>

<h2 id="åè®°"><a href="#åè®°" class="headerlink" title="åè®°"></a>åè®°</h2><p><del>èƒ½çœä¸€ç§’æ˜¯ä¸€ç§’å¯¹å§ï¼Œæ¯•ç«Ÿä¸æ˜¯æ‰€æœ‰äººéƒ½æœ‰+1sçš„èƒ½åŠ›</del></p>
]]></content>
      <categories>
        <category>Tools</category>
      </categories>
      <tags>
        <tag>docker</tag>
        <tag>npm</tag>
        <tag>git</tag>
        <tag>pip</tag>
        <tag>conda</tag>
      </tags>
  </entry>
  <entry>
    <title>MVC éƒ¨åˆ†åˆ·æ–°çš„å°è¯•</title>
    <url>/2017/06/15/MVC%20%E9%83%A8%E5%88%86%E5%88%B7%E6%96%B0%E7%9A%84%E5%B0%9D%E8%AF%95/</url>
    <content><![CDATA[<p><a href="#NewVersion">ç›´æ¥è·³åˆ°2.0ç‰ˆæœ¬</a></p>
<h1 id="ç‰ˆæœ¬0-1-ç®€å•çš„å¼‚æ­¥åˆ·æ–°å°è¯•"><a href="#ç‰ˆæœ¬0-1-ç®€å•çš„å¼‚æ­¥åˆ·æ–°å°è¯•" class="headerlink" title="ç‰ˆæœ¬0.1 - ç®€å•çš„å¼‚æ­¥åˆ·æ–°å°è¯•"></a>ç‰ˆæœ¬0.1 - ç®€å•çš„å¼‚æ­¥åˆ·æ–°å°è¯•</h1><ul>
<li>ProcessControllerä¸­åŠ å…¥</li>
</ul>
<a id="more"></a>
<figure class="highlight csharp"><table><tr><td class="code"><pre><span class="line">[<span class="meta">AllowAnonymous</span>] <span class="comment">// è¿™æ˜¯å…è®¸åŒ¿åè®¿é—®çš„å£°æ˜ï¼Œæ²¡æœ‰ç”¨ASP.NET IDENTITYå¯ä»¥åˆ æ‰</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> ActionResult <span class="title">PartialTest</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">return</span> View();</span><br><span class="line">&#125;</span><br><span class="line">[<span class="meta">AllowAnonymous</span>]</span><br><span class="line"><span class="function"><span class="keyword">public</span> ActionResult <span class="title">Fetch</span>(<span class="params"><span class="keyword">int</span> num</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="comment">// å–å‰numæ¡æ•°æ®</span></span><br><span class="line">  <span class="keyword">var</span> model = db.Movies.Take(num).ToList();</span><br><span class="line">  <span class="comment">// MovieListæ˜¯ä½ çš„Partialé¡µé¢çš„åå­—,modelæ˜¯ä¸è¯¥Partialé¡µå¤´éƒ¨æ¥å—çš„ç±»å‹ä¸€è‡´çš„model</span></span><br><span class="line">  <span class="keyword">return</span> PartialView(<span class="string">"MovieList"</span>, model);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>/View/Process/PartialTest.cshtml</li>
</ul>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">id</span>=<span class="string">"btn"</span> <span class="attr">class</span>=<span class="string">"btn"</span>&gt;</span>åŠ ä¸€æ¡<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"notificationsTable"</span>&gt;</span></span><br><span class="line">    @&#123;Html.RenderAction("Fetch", new &#123; num = 1 &#125;);&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">@* æ·»åŠ JSåˆ°å¸ƒå±€é¡µï¼Œå¦åˆ™æ‰¾ä¸åˆ°jQueryçš„$æ ‡è®° *@</span><br><span class="line">@section scripts&#123;</span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line">    var n = 2;</span><br><span class="line">    $(document).ready(function () &#123;</span><br><span class="line">        $("#btn").click(function () &#123;</span><br><span class="line">            $("#notificationsTable").load('/Process/Fetch?num=' + n);</span><br><span class="line">            n++;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>åœ°å€æ è¿è¡Œ/Process/PartialTest å³å¯</li>
</ul>
<h1 id="æ›´æ–°-1-0-ä½¿ç”¨-Ajax-ActionLink"><a href="#æ›´æ–°-1-0-ä½¿ç”¨-Ajax-ActionLink" class="headerlink" title="æ›´æ–° 1.0 - ä½¿ç”¨@Ajax.ActionLink"></a>æ›´æ–° 1.0 - ä½¿ç”¨@Ajax.ActionLink</h1><p>ä¸å¸Œæœ›åœ¨cshtmlä»£ç é‡Œç”¨JS?  Razor Helper è¿˜æä¾›äº† @Ajax.ActionLink</p>
<p>æ„Ÿè°¢ä¸‹é¢é“¾æ¥é‡Œçš„å¤§ä½¬ </p>
<p><a href="http://www.c-sharpcorner.com/UploadFile/abhikumarvatsa/ajax-actionlink-and-html-actionlink-in-mvc/" target="_blank">ä¼ é€é—¨</a></p>
<ul>
<li>å…ˆåœ¨VSçš„ç¨‹åºåŒ…ç®¡ç†å™¨æ§åˆ¶å°è¾“å…¥ (PS.å¦‚æœæœ‰é—®é¢˜å°±åœ¨NuGetæœç´¢å®‰è£…) </li>
</ul>
<figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line"><span class="built_in">Install-Package</span> Microsoft.jQuery.Unobtrusive.Ajax</span><br></pre></td></tr></table></figure>
<ul>
<li>ä¿®æ”¹/View/Process/PartialTest.cshtmlä¸º</li>
</ul>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line">@Ajax.ActionLink("ä¸€æ¡å˜ä¸¤æ¡", "Fetch",new &#123; num = 2 &#125;,</span><br><span class="line">   new AjaxOptions</span><br><span class="line">   &#123;</span><br><span class="line">       UpdateTargetId = "notificationsTable",</span><br><span class="line">       InsertionMode = InsertionMode.Replace,</span><br><span class="line">       HttpMethod = "GET"</span><br><span class="line">   &#125;,</span><br><span class="line">   new</span><br><span class="line">   &#123;</span><br><span class="line">       @class = "btn btn-default",</span><br><span class="line">       @role = "button"</span><br><span class="line">   &#125;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"notificationsTable"</span>&gt;</span></span><br><span class="line">    @&#123;Html.RenderAction("Fetch", new &#123; num = 1 &#125;);&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">@section scripts&#123;</span><br><span class="line">    @Scripts.Render("~/Scripts/jquery.unobtrusive-ajax.min.js")</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>ç”±äºç”¨@Ajax.ActionLinkç”Ÿæˆçš„æŒ‰é’®æ˜¯å›ºå®šçš„ï¼Œæ‰€ä»¥æ²¡æ³•åƒJSé‚£æ ·åŠ¨æ€ä¿®æ”¹è¯·æ±‚å˜é‡ï¼Œä½†æ˜¯é¡µé¢çš„å¼‚æ­¥åˆ·æ–°æ•ˆæœè¿˜æ˜¯æœ‰çš„</li>
</ul>
<h1 id="æ›´æ–°-1-1-è§£å†³ä¸Šé¢çš„é—®é¢˜"><a href="#æ›´æ–°-1-1-è§£å†³ä¸Šé¢çš„é—®é¢˜" class="headerlink" title="æ›´æ–° 1.1 - è§£å†³ä¸Šé¢çš„é—®é¢˜"></a>æ›´æ–° 1.1 - è§£å†³ä¸Šé¢çš„é—®é¢˜</h1><p>åŠ¨æ€æ›´æ”¹ActionLinkçš„routeValuesï¼ŒStackOverflowçš„å›ç­”åŸºæœ¬æ˜¯ç”¨JQueryï¼Œä¸‹é¢æ˜¯è§£å†³åŠæ³•ï¼š</p>
<ul>
<li>ä¿®æ”¹/View/Process/PartialTest.cshtmlä¸ºï¼š</li>
</ul>
<figure class="highlight csharp"><table><tr><td class="code"><pre><span class="line">@Ajax.ActionLink(<span class="string">"åŠ ä¸€æ¡"</span>, <span class="string">"Fetch"</span>,<span class="keyword">new</span> &#123; num = <span class="string">"xxx"</span> &#125;,</span><br><span class="line">   <span class="keyword">new</span> AjaxOptions</span><br><span class="line">   &#123;</span><br><span class="line">       UpdateTargetId = <span class="string">"notificationsTable"</span>,</span><br><span class="line">       InsertionMode = InsertionMode.Replace,</span><br><span class="line">       HttpMethod = <span class="string">"GET"</span></span><br><span class="line">   &#125;,</span><br><span class="line">   <span class="keyword">new</span></span><br><span class="line">   &#123;</span><br><span class="line">       @id = <span class="string">"btn"</span>,</span><br><span class="line">       @<span class="keyword">class</span> = <span class="string">"btn btn-default"</span>,</span><br><span class="line">       @role = <span class="string">"button"</span></span><br><span class="line">   &#125;</span><br><span class="line">)</span><br><span class="line">@section scripts&#123;</span><br><span class="line">    &lt;script&gt;</span><br><span class="line">        <span class="keyword">var</span> n = <span class="number">2</span>;</span><br><span class="line">        <span class="keyword">var</span> href = $(<span class="string">'#btn'</span>).attr(<span class="string">'href'</span>);</span><br><span class="line">        $(document).ready(function () &#123;</span><br><span class="line">            $(<span class="string">"#btn"</span>).click(function () &#123;</span><br><span class="line">                <span class="keyword">this</span>.href = href.replace(<span class="string">"xxx"</span>, n++);</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;);</span><br><span class="line">    &lt;/script&gt;</span><br><span class="line">    @Scripts.Render(<span class="string">"~/Scripts/jquery.unobtrusive-ajax.min.js"</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>è¿™é‡Œå®ç°äº†0.1ç‰ˆæœ¬ä¸€æ ·çš„åŠŸèƒ½ï¼Œæ˜¯ä¸æ˜¯æœ‰ç§è½¬äº†ä¸€åœˆå›åˆ°åŸç‚¹çš„æ„Ÿè§‰ï¼Ÿå¥½è®½åˆºå•Šâ€¦â€¦</li>
</ul>
<p id="NewVersion"></p>

<h1 id="æ›´æ–°2-0-Formè¡¨å•æäº¤å®ç°æŒ‡å®šDIVçš„å¼‚æ­¥åˆ·æ–°"><a href="#æ›´æ–°2-0-Formè¡¨å•æäº¤å®ç°æŒ‡å®šDIVçš„å¼‚æ­¥åˆ·æ–°" class="headerlink" title="æ›´æ–°2.0 - Formè¡¨å•æäº¤å®ç°æŒ‡å®šDIVçš„å¼‚æ­¥åˆ·æ–°"></a>æ›´æ–°2.0 - Formè¡¨å•æäº¤å®ç°æŒ‡å®šDIVçš„å¼‚æ­¥åˆ·æ–°</h1><p>ä¸Šé¢è®¨è®ºäº†å¦‚ä½•æŒ‰ä¸‹æŒ‰é’®æ—¶å¼‚æ­¥åˆ·æ–°é¡µé¢ï¼Œé‚£ä¹ˆåœ¨è¡¨å•æäº¤æˆ‘ä¸æƒ³è·³è½¬ï¼Œæˆ‘ä¹Ÿè¦å¼‚æ­¥åˆ·æ–°ï¼Œæ€ä¹ˆåŠå‘¢ï¼Ÿä¸‹é¢ä»‹ç»è§£å†³åŠæ³•ã€‚è¿™éƒ¨åˆ†å®ç°ä¸€ä¸ªå±•ç¤ºä¸åŒåˆ†ç±»ä¸‹çš„ç”µå½±åˆ—è¡¨ã€‚ä» Model - View - Controller ä¸€æ­¥æ­¥æ¥å®ç°ï¼š</p>
<ul>
<li>Model - /Models/Movie</li>
</ul>
<figure class="highlight csharp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Movie</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">int</span> Id &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">    [<span class="meta">Display(Name = <span class="meta-string">"ç”µå½±å"</span>)</span>]</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">string</span> Name &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">enum</span> Types</span><br><span class="line">    &#123;</span><br><span class="line">        åŠ¨ä½œ, å–œå‰§, ç§‘å¹», çˆ±æƒ…, çºªå½•, åŠ¨ç”», ææ€–, æ‚¬ç–‘, é’æ˜¥, æ–‡è‰º, åŠ±å¿—, æˆ˜äº‰, çŠ¯ç½ª</span><br><span class="line">    &#125;</span><br><span class="line">    [<span class="meta">Display(Name = <span class="meta-string">"ç±»å‹"</span>)</span>]</span><br><span class="line">    <span class="keyword">public</span> Types? Type &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>View - /View/Process/PartialTest2.cshtml</li>
</ul>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line">@model ZeroMovie.Models.Movie</span><br><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">id</span>=<span class="string">"tForm"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"form-horizontal"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"form-group"</span>&gt;</span></span><br><span class="line">            @Html.LabelFor(model =&gt; model.Type, htmlAttributes: new &#123; @class = "control-label col-md-2" &#125;)</span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-md-10"</span>&gt;</span></span><br><span class="line">                @Html.EnumDropDownListFor(model =&gt; model.Type, htmlAttributes: new &#123; @class = "form-control" &#125;)</span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"form-group"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-md-offset-2 col-md-10"</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"submit"</span> <span class="attr">value</span>=<span class="string">"æäº¤"</span> <span class="attr">id</span>=<span class="string">"btn"</span> <span class="attr">class</span>=<span class="string">"btn btn-default"</span> /&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span>   </span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"PartialRefreshArea"</span>&gt;</span>åˆ·æ–°è¿™é‡Œ<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">@section scripts&#123;</span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line">        $(document).ready(function () &#123;</span><br><span class="line">            $('#tform').on('submit', function (e) &#123;</span><br><span class="line">                e.preventDefault();</span><br><span class="line">                $.ajax(&#123;</span><br><span class="line">                    type: 'post', // Formçš„Method</span><br><span class="line">                    url: '@Url.Action("Fetch","Process")', // Formçš„Action</span><br><span class="line">                    data: $('#tform').serialize(), // åºåˆ—åŒ–æäº¤æ•°æ®</span><br><span class="line">                    success: function (res) &#123;</span><br><span class="line">                        $('#PartialRefreshArea').html(res);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;);</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;);</span><br><span class="line">    <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    @Scripts.Render("~/Scripts/jquery.unobtrusive-ajax.min.js")</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>View - /View/Process/MovieList.cshtml</li>
</ul>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line">@model IEnumerable<span class="tag">&lt;<span class="name">ZeroMovie.Models.Movie</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">table</span> <span class="attr">class</span>=<span class="string">"table"</span> <span class="attr">style</span>=<span class="string">"table-layout:fixed"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">th</span>&gt;</span></span><br><span class="line">            @Html.DisplayNameFor(model =&gt; model.Name)</span><br><span class="line">        <span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">th</span>&gt;</span></span><br><span class="line">            @Html.DisplayNameFor(model =&gt; model.Type)</span><br><span class="line">        <span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">@foreach (var item in Model) &#123;</span><br><span class="line">    <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">td</span>&gt;</span></span><br><span class="line">            @Html.DisplayFor(modelItem =&gt; item.Name)</span><br><span class="line">        <span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">td</span>&gt;</span></span><br><span class="line">            @Html.DisplayFor(modelItem =&gt; item.Type)</span><br><span class="line">        <span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>Controller - /Controller/ProcessController.cs</li>
</ul>
<figure class="highlight csharp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">ProcessController</span> : <span class="title">Controller</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// ä¸Šä¸‹æ–‡ç±»æœ‰ DbSet&lt;Movie&gt;</span></span><br><span class="line">    <span class="keyword">private</span> ApplicationDbContext db = <span class="keyword">new</span> ApplicationDbContext(); </span><br><span class="line">    <span class="function"><span class="keyword">public</span> ActionResult <span class="title">PartialTest2</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="keyword">return</span> View();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> ActionResult <span class="title">Fetch2</span>(<span class="params">[Bind(Include = <span class="string">"Type"</span></span>)] Movie movie)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="keyword">var</span> model = db.Movies.ToList();</span><br><span class="line">        <span class="keyword">if</span>(movie.Type != <span class="literal">null</span>)</span><br><span class="line">            model = db.Movies.Where(p =&gt; p.Type == movie.Type).ToList();</span><br><span class="line">        <span class="keyword">return</span> PartialView(<span class="string">"MovieList"</span>, model); <span class="comment">// modelçš„ç±»å‹è¦ä¸MovieListæ¥å—çš„ç±»å‹ä¸€è‡´</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>è¿è¡Œååœ°å€æ è®¿é—®/Process/PartialTest2å³å¯</li>
</ul>
<h2 id="æ€»ç»“ï¼šJSå¤§æ³•å¥½"><a href="#æ€»ç»“ï¼šJSå¤§æ³•å¥½" class="headerlink" title="æ€»ç»“ï¼šJSå¤§æ³•å¥½"></a>æ€»ç»“ï¼šJSå¤§æ³•å¥½</h2><p>å¼±å¼±é—®ä¸€å¥åƒåœ¾ä»£ç æœ‰äººè¦çœ‹å—ï¼š</p>
<p><a href="https://github.com/sko00o/ZeroMovie" target="_blank">ä¼ é€é—¨</a></p>
]]></content>
      <categories>
        <category>.NET</category>
      </categories>
      <tags>
        <tag>JavaScript</tag>
        <tag>MVC</tag>
        <tag>Razor</tag>
      </tags>
  </entry>
  <entry>
    <title>EFæ¡†æ¶é…ç½®ä½¿ç”¨å„ç§æ•°æ®åº“</title>
    <url>/2017/06/04/EF%E6%A1%86%E6%9E%B6%E9%85%8D%E7%BD%AE%E4%BD%BF%E7%94%A8%E5%90%84%E7%A7%8D%E6%95%B0%E6%8D%AE%E5%BA%93/</url>
    <content><![CDATA[<h3 id="Content"><a href="#Content" class="headerlink" title="Content"></a>Content</h3><ul>
<li><a href="#localdb">LocalDB</a></li>
<li><a href="#sql-server">SQL Server</a></li>
<li><a href="#mysql">MySQL</a></li>
<li><a href="#oracle">Oralce</a></li>
</ul>
<a id="more"></a>
<h3 id="å‡†å¤‡å·¥ä½œ"><a href="#å‡†å¤‡å·¥ä½œ" class="headerlink" title="å‡†å¤‡å·¥ä½œ"></a>å‡†å¤‡å·¥ä½œ</h3><p><em>ç¯å¢ƒï¼š Visual Studio Community 2017ï¼ŒWindows 10.0.15063 pro</em></p>
<ul>
<li>å…ˆæ–°å»ºä¸€ä¸ªASP.NET MVCé¡¹ç›®DbConnectPrac</li>
</ul>
<p><img src="00.png" alt="pic00"></p>
<p><img src="0.png" alt="pic0"></p>
<ul>
<li>ç¨‹åºåŒ…ç®¡ç†å™¨æ§åˆ¶å°å®‰è£…EFæ¡†æ¶</li>
</ul>
<figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line"><span class="built_in">Install-Package</span> EntityFramework</span><br></pre></td></tr></table></figure>
<p>  <em>PS. å¦‚æœè§£å†³æ–¹é‡Œæœ‰å¤šä¸ªé¡¹ç›®ï¼Œé»˜è®¤é¡¹ç›®æ³¨æ„é€‰æ‹©DbConnectPrac</em></p>
<ul>
<li><p>Modelsä¸­æ–°å»ºä¸€ä¸ªç±»</p>
<p><img src="pic1.png" alt="pic1"></p>
<p><em>Program.cs</em></p>
</li>
</ul>
<figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="keyword">using</span> System.ComponentModel.DataAnnotations;</span><br><span class="line"><span class="keyword">namespace</span> <span class="title">DbConnectPrac.Models</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">class</span> <span class="title">User</span></span><br><span class="line">    &#123;</span><br><span class="line">        [<span class="meta">Key</span>]</span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">int</span> Uid &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">        [<span class="meta">Required</span>]</span><br><span class="line">        [<span class="meta">StringLength(16, MinimumLength = 3)</span>]</span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">string</span> NickName &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">        [<span class="meta">Required</span>]</span><br><span class="line">        [<span class="meta">StringLength(16, MinimumLength = 6)</span>]</span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">string</span> Password &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">        [<span class="meta">Required</span>]</span><br><span class="line">        [<span class="meta">RegularExpression(@<span class="meta-string">"^[a-zA-Z0-9_-]+@[a-zA-Z0-9_-]+(\.[a-zA-Z0-9_-]+)+$"</span>)</span>]</span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">string</span> Email &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">int</span> Privilege &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Video</span></span><br><span class="line">    &#123;</span><br><span class="line">        [<span class="meta">Key</span>]</span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">int</span> Vid &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">        [<span class="meta">Required</span>]</span><br><span class="line">        [<span class="meta">StringLength(30)</span>]</span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">string</span> Vname &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">        [<span class="meta">Required</span>]</span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">string</span> Vurl &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">        [<span class="meta">Required</span>]</span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">string</span> Thumbnail &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">int</span> ViewedNum &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">        [<span class="meta">DataType(DataType.Date)</span>]</span><br><span class="line">        [<span class="meta">DisplayFormat(DataFormatString = <span class="meta-string">"&#123;0:yyyy-MM-dd&#125;"</span>, ApplyFormatInEditMode = true)</span>]</span><br><span class="line">        [<span class="meta">Required</span>]</span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">string</span> UploadTime &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">        [<span class="meta">Required</span>]</span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">string</span> Vtype &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">int</span> Uid &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">        [<span class="meta">StringLength(200)</span>]</span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">string</span> Vinfo &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Comment</span></span><br><span class="line">    &#123;</span><br><span class="line">        [<span class="meta">Key</span>]</span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">int</span> Cid &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">        [<span class="meta">Required</span>]</span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">int</span> Uid &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">        [<span class="meta">Required</span>]</span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">int</span> Vid &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">        [<span class="meta">Required</span>]</span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">string</span> Content &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">        [<span class="meta">DataType(DataType.Date)</span>]</span><br><span class="line">        [<span class="meta">DisplayFormat(DataFormatString = <span class="meta-string">"&#123;0:yyyy-MM-dd&#125;"</span>, ApplyFormatInEditMode = true)</span>]</span><br><span class="line">        [<span class="meta">Required</span>]</span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">string</span> CommentTime &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">class</span> <span class="title">History</span></span><br><span class="line">    &#123;</span><br><span class="line">        [<span class="meta">Key</span>]</span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">int</span> Hid &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">        [<span class="meta">Required</span>]</span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">int</span> Uid &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">        [<span class="meta">Required</span>]</span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">int</span> Vid &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">        [<span class="meta">DataType(DataType.Date)</span>]</span><br><span class="line">        [<span class="meta">DisplayFormat(DataFormatString = <span class="meta-string">"&#123;0:yyyy-MM-dd&#125;"</span>, ApplyFormatInEditMode = true)</span>]</span><br><span class="line">        [<span class="meta">Required</span>]</span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">string</span> HistoryTime &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>ç”Ÿæˆè§£å†³æ–¹æ¡ˆ</li>
</ul>
<p>å¿«æ·é”® Ctrl+Shift+b</p>
<ul>
<li>Controllersä¸­æ–°å»ºæ§åˆ¶å™¨</li>
</ul>
<p><img src="pic2.png" alt="pic2"></p>
<p><img src="3.png" alt="pic3"></p>
<p>ç‚¹å‡»æ·»åŠ ï¼Œå°†ç”Ÿæˆä»¥ä¸‹æ–‡ä»¶</p>
<p><img src="5.png" alt="pic5"></p>
<p><em>åˆ†åˆ«æŠŠå¦å¤–å‡ ä¸ªç±»ä¹Ÿåˆ›å»ºå¥½å¸¦è§†å›¾çš„æ§åˆ¶å™¨</em></p>
<h3 id="LocalDB"><a href="#LocalDB" class="headerlink" title="LocalDB"></a>LocalDB</h3><p><em>LocalDBæ˜¯VSè‡ªå¸¦çš„ç®€åŒ–ç‰ˆSQL Server</em></p>
<ul>
<li>æŸ¥çœ‹é¡¹ç›®æ ¹ç›®å½•çš„Web.configï¼Œå‘ç°å·²æ·»åŠ äº†LocalDBçš„ç›¸å…³å†…å®¹</li>
</ul>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">connectionStrings</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">add</span> <span class="attr">name</span>=<span class="string">"DbConnectPracContext"</span> <span class="attr">connectionString</span>=<span class="string">"Data Source=(localdb)\MSSQLLocalDB; Initial Catalog=DbConnectPracContext-20170603111224; Integrated Security=True; MultipleActiveResultSets=True; AttachDbFilename=|DataDirectory|DbConnectPracContext-20170603111224.mdf"</span> <span class="attr">providerName</span>=<span class="string">"System.Data.SqlClient"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">connectionStrings</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">entityFramework</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">defaultConnectionFactory</span> <span class="attr">type</span>=<span class="string">"System.Data.Entity.Infrastructure.LocalDbConnectionFactory, EntityFramework"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">parameters</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">parameter</span> <span class="attr">value</span>=<span class="string">"mssqllocaldb"</span> /&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">parameters</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">defaultConnectionFactory</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">providers</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">provider</span> <span class="attr">invariantName</span>=<span class="string">"System.Data.SqlClient"</span> <span class="attr">type</span>=<span class="string">"System.Data.Entity.SqlServer.SqlProviderServices, EntityFramework.SqlServer"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">providers</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">entityFramework</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>è¿è¡Œé¡¹ç›®è¿›å…¥å¯¹åº”çš„Controllerä½ å¯ä»¥æ–¹ä¾¿çš„å®ç°å¢åˆ æ”¹æŸ¥(CRUD)æ“ä½œã€‚</li>
</ul>
<p><img src="6.png" alt="pic6"></p>
<h3 id="SQL-Server"><a href="#SQL-Server" class="headerlink" title="SQL Server"></a>SQL Server</h3><p><em>ç‰ˆæœ¬ 2016 Developer edition</em></p>
<ul>
<li>åœ¨æ ¹ç›®å½•çš„Web.configä¸­æ·»åŠ SQL Serverçš„è¿æ¥å­—æ®µ</li>
</ul>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">connectionStrings</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- æŒ‰å®é™…æƒ…å†µæ›´æ”¹ Data Source, User ID, Password --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">add</span> <span class="attr">name</span>=<span class="string">"MSSQLConnectContext"</span> </span></span><br><span class="line"><span class="tag">     <span class="attr">connectionString</span>=<span class="string">"Data Source=localhost; Initial Catalog=TESTDB; Persist Security Info=True; User ID=sa; Password=123"</span> </span></span><br><span class="line"><span class="tag">     <span class="attr">providerName</span>=<span class="string">"System.Data.SqlClient"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">connectionStrings</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>æ‰“å¼€Models/DbConnectPracContext.cs</li>
</ul>
<figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">DbConnectPracContext</span> : <span class="title">DbContext</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">// ä¿®æ”¹æŒ‡å®šä½¿ç”¨çš„æ•°æ®åº“è¿æ¥</span></span><br><span class="line">  <span class="comment">//public DbConnectPracContext() : base("name=DbConnectPracContext")&#123;&#125; // LocalDB</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="title">DbConnectPracContext</span>(<span class="params"></span>) : <span class="title">base</span>(<span class="params"><span class="string">"name=MSSQLConnectContext"</span></span>)</span> &#123;&#125; <span class="comment">// SQL Server</span></span><br><span class="line">  <span class="comment">// .....çœç•¥......</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>ç¨‹åºåŒ…ç®¡ç†å™¨æ§åˆ¶å°è¾“å…¥</li>
</ul>
<figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line"><span class="built_in">Enable-Migrations</span> <span class="literal">-EnableAutomaticMigrations</span></span><br></pre></td></tr></table></figure>
<ul>
<li>è¿è¡Œé¡¹ç›®è¿›å…¥å¯¹åº”çš„Controllerä½ å¯ä»¥æ–¹ä¾¿çš„å®ç°å¢åˆ æ”¹æŸ¥(CRUD)æ“ä½œã€‚</li>
</ul>
<h3 id="MySQL"><a href="#MySQL" class="headerlink" title="MySQL"></a>MySQL</h3><p><em>ç‰ˆæœ¬ 5.7.18</em></p>
<ul>
<li>ç¨‹åºåŒ…ç®¡ç†å™¨æ§åˆ¶å°å®‰è£…EFæ¡†æ¶</li>
</ul>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">Install-Package MySql.Data.Entity</span><br></pre></td></tr></table></figure>
<ul>
<li><p>æŸ¥çœ‹é¡¹ç›®æ ¹ç›®å½•çš„Web.config</p>
<p><em>æ›´æ–°äº†ä»¥ä¸‹æœ‰å…³MySQLçš„å†…å®¹</em></p>
</li>
</ul>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">entityFramework</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">providers</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">provider</span> <span class="attr">invariantName</span>=<span class="string">"MySql.Data.MySqlClient"</span> <span class="attr">type</span>=<span class="string">"MySql.Data.MySqlClient.MySqlProviderServices, MySql.Data.Entity.EF6, Version=6.9.9.0, Culture=neutral, PublicKeyToken=c5687fc88969c44d"</span>&gt;</span><span class="tag">&lt;/<span class="name">provider</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">providers</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">entityFramework</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">system.data</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">DbProviderFactories</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">remove</span> <span class="attr">invariant</span>=<span class="string">"MySql.Data.MySqlClient"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">add</span> <span class="attr">name</span>=<span class="string">"MySQL Data Provider"</span> <span class="attr">invariant</span>=<span class="string">"MySql.Data.MySqlClient"</span> <span class="attr">description</span>=<span class="string">".Net Framework Data Provider for MySQL"</span> <span class="attr">type</span>=<span class="string">"MySql.Data.MySqlClient.MySqlClientFactory, MySql.Data, Version=6.9.9.0, Culture=neutral, PublicKeyToken=c5687fc88969c44d"</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">DbProviderFactories</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">system.data</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>connectionStringsä¸­æ·»åŠ MySQLçš„è¿æ¥å­—æ®µ</li>
</ul>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">connectionStrings</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">add</span> <span class="attr">name</span>=<span class="string">"MySQLConnectContext"</span> </span></span><br><span class="line"><span class="tag">         <span class="attr">connectionString</span>=<span class="string">"server=localhost; port=3306; database=TESTDB; uid=root; password=123"</span></span></span><br><span class="line"><span class="tag">         <span class="attr">providerName</span>=<span class="string">"MySql.Data.MySqlClient"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">connectionStrings</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>æ‰“å¼€Models/DbConnectPracContext.cså®Œæˆä¸¤å¤„ä¿®æ”¹</li>
</ul>
<figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="comment">// åœ¨ContextæŒ‡å®šmySqlçš„é…ç½®æ–‡ä»¶</span></span><br><span class="line">[<span class="meta">DbConfigurationType(typeof(MySql.Data.Entity.MySqlEFConfiguration))</span>]</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">DbConnectPracContext</span> : <span class="title">DbContext</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">// ä¿®æ”¹æŒ‡å®šä½¿ç”¨çš„æ•°æ®åº“è¿æ¥</span></span><br><span class="line">  <span class="comment">//public DbConnectPracContext() : base("name=DbConnectPracContext")&#123;&#125; // LocalDB</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="title">DbConnectPracContext</span>(<span class="params"></span>) : <span class="title">base</span>(<span class="params"><span class="string">"name=MySQLConnectContext"</span></span>)</span>&#123;&#125; <span class="comment">// MySQL</span></span><br><span class="line">  <span class="comment">// .....çœç•¥......</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>ç¨‹åºåŒ…ç®¡ç†å™¨æ§åˆ¶å°è¾“å…¥</li>
</ul>
<figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line"><span class="built_in">Enable-Migrations</span> <span class="literal">-EnableAutomaticMigrations</span></span><br></pre></td></tr></table></figure>
<ul>
<li>è¿è¡Œé¡¹ç›®è¿›å…¥å¯¹åº”çš„Controllerä½ å¯ä»¥æ–¹ä¾¿çš„å®ç°å¢åˆ æ”¹æŸ¥(CRUD)æ“ä½œã€‚</li>
</ul>
<p>  <em>è¿æ¥MySQLæŸ¥çœ‹ç”Ÿæˆçš„testdbè¡¨</em></p>
<p><img src="7.png" alt="pic7"></p>
<h3 id="Oracle"><a href="#Oracle" class="headerlink" title="Oracle"></a>Oracle</h3><p><em>ç‰ˆæœ¬ 12.2.0.1.0</em></p>
<ul>
<li>å»ºè®®å…ˆåˆ›å»ºä¸€ä¸ªæ–°ç”¨æˆ·ï¼Œå¦åˆ™ä½¿ç”¨é»˜è®¤ç”¨æˆ·å¯èƒ½æœ‰æ„æƒ³ä¸åˆ°çš„é—®é¢˜</li>
</ul>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">-- ç”¨SQLPLUSç™»å½•åï¼Œè¿æ¥ç®¡ç†å‘˜ (system_password æ˜¯ä½ çš„ç®¡ç†å‘˜å¯†ç )</span></span><br><span class="line">CONNECT system/system_password@ORCL</span><br><span class="line"><span class="comment">-- è¯¥ç‰ˆæœ¬Oracleä¸Šåˆ›å»ºæ–°ç”¨æˆ·åå¿…é¡»C##æˆ–c##å¼€å¤´ï¼Œå¦åˆ™ä¸åˆæ³•</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">USER</span> C<span class="comment">##TESTUSER IDENTIFIED BY 123;</span></span><br><span class="line"><span class="comment">-- åˆ›å»ºæµ‹è¯•ç”¨æˆ·å¹¶æˆæƒï¼Œè¦ç»™DBAæƒé™</span></span><br><span class="line"><span class="keyword">GRANT</span> <span class="keyword">CONNECT</span>, <span class="keyword">RESOURCE</span>, DBA, <span class="keyword">CREATE</span> <span class="keyword">VIEW</span> <span class="keyword">TO</span>  C<span class="comment">##TESTUSER ;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>ç¨‹åºåŒ…ç®¡ç†å™¨æ§åˆ¶å°å®‰è£…EFæ¡†æ¶</li>
</ul>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">Install-Package Oracle.ManagedDataAccess.EntityFramework</span><br></pre></td></tr></table></figure>
<ul>
<li><p>æŸ¥çœ‹æ ¹ç›®å½•çš„Web.config</p>
<p><em>æ›´æ–°äº†ä»¥ä¸‹æœ‰å…³Oracleçš„å†…å®¹</em></p>
</li>
</ul>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">configSections</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">section</span> <span class="attr">name</span>=<span class="string">"oracle.manageddataaccess.client"</span> <span class="attr">type</span>=<span class="string">"OracleInternal.Common.ODPMSectionHandler, Oracle.ManagedDataAccess, Version=4.122.1.0, Culture=neutral, PublicKeyToken=89b483f429c47342"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configSections</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">connectionStrings</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">add</span> <span class="attr">name</span>=<span class="string">"OracleDbContext"</span> <span class="attr">providerName</span>=<span class="string">"Oracle.ManagedDataAccess.Client"</span> <span class="attr">connectionString</span>=<span class="string">"User Id=oracle_user;Password=oracle_user_password;Data Source=oracle"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">connectionStrings</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">entityFramework</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">providers</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">provider</span> <span class="attr">invariantName</span>=<span class="string">"Oracle.ManagedDataAccess.Client"</span> <span class="attr">type</span>=<span class="string">"Oracle.ManagedDataAccess.EntityFramework.EFOracleProviderServices, Oracle.ManagedDataAccess.EntityFramework, Version=6.122.1.0, Culture=neutral, PublicKeyToken=89b483f429c47342"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">providers</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">entityFramework</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">system.data</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">DbProviderFactories</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">remove</span> <span class="attr">invariant</span>=<span class="string">"Oracle.ManagedDataAccess.Client"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">add</span> <span class="attr">name</span>=<span class="string">"ODP.NET, Managed Driver"</span> <span class="attr">invariant</span>=<span class="string">"Oracle.ManagedDataAccess.Client"</span> <span class="attr">description</span>=<span class="string">"Oracle Data Provider for .NET, Managed Driver"</span> <span class="attr">type</span>=<span class="string">"Oracle.ManagedDataAccess.Client.OracleClientFactory, Oracle.ManagedDataAccess, Version=4.122.1.0, Culture=neutral, PublicKeyToken=89b483f429c47342"</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">DbProviderFactories</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">system.data</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">oracle.manageddataaccess.client</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span> <span class="attr">number</span>=<span class="string">"*"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dataSources</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">dataSource</span> <span class="attr">alias</span>=<span class="string">"SampleDataSource"</span> <span class="attr">descriptor</span>=<span class="string">"(DESCRIPTION=(ADDRESS=(PROTOCOL=tcp)(HOST=localhost)(PORT=1521))(CONNECT_DATA=(SERVICE_NAME=ORCL))) "</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dataSources</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">oracle.manageddataaccess.client</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>connectionStringsä¸­ä¿®æ”¹Oracleçš„è¿æ¥å­—æ®µçš„å‚æ•°</li>
</ul>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">connectionStrings</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- å› ä¸ºç”Ÿæˆçš„&lt;dataSources&gt;ä¸­æœåŠ¡åæ˜¯ORCLï¼Œä¸æˆ‘çš„è®¾ç½®ç›¸åŒï¼Œæ‰€ä»¥è¿™é‡Œç›´æ¥ç”¨åˆ«åSampleDataSource--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">add</span> <span class="attr">name</span>=<span class="string">"OracleDbContext"</span> </span></span><br><span class="line"><span class="tag">         <span class="attr">providerName</span>=<span class="string">"Oracle.ManagedDataAccess.Client"</span> </span></span><br><span class="line"><span class="tag">         <span class="attr">connectionString</span>=<span class="string">"User Id=C##TESTUSER;Password=123;Data Source=SampleDataSource"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">connectionStrings</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>ä¿®æ”¹Models/DbConnectPracContext.cs</li>
</ul>
<figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="keyword">namespace</span> <span class="title">DbConnectPrac.Models</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">class</span> <span class="title">DbConnectPracContext</span> : <span class="title">DbContext</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// ä¿®æ”¹æŒ‡å®šä½¿ç”¨çš„æ•°æ®åº“è¿æ¥</span></span><br><span class="line">        <span class="comment">//public DbConnectPracContext() : base("name=DbConnectPracContext") &#123; &#125; // LocalDB</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">DbConnectPracContext</span>(<span class="params"></span>) : <span class="title">base</span>(<span class="params"><span class="string">"name=OracleDbContext"</span></span>)</span> &#123; &#125; <span class="comment">// Oracle</span></span><br><span class="line">        <span class="comment">// é»˜è®¤çš„æ¨¡å¼åæ˜¯dboï¼Œä½†Oracleä¸­ä¸å­˜åœ¨æ¨¡å¼åä¸ºdboï¼Œéœ€è¦æŒ‡å®šé»˜è®¤æ¨¡å¼å</span></span><br><span class="line">      	<span class="function"><span class="keyword">protected</span> <span class="keyword">override</span> <span class="keyword">void</span> <span class="title">OnModelCreating</span>(<span class="params">DbModelBuilder modelBuilder</span>)</span></span><br><span class="line"><span class="function"></span>        &#123;</span><br><span class="line">            modelBuilder.HasDefaultSchema(<span class="string">"C##TESTUSER"</span>); <span class="comment">// é»˜è®¤æ¨¡å¼åå°±æ˜¯æŠŠä½ ç”¨æˆ·åå¤§å†™</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// .....çœç•¥......</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Oracleä¸­ä¸å­˜åœ¨æ¨¡å¼åä¸ºdboï¼Œdboæ˜¯SQL Serveræ•°æ®åº“çš„ï¼Œå¦‚å›¾ä¾‹ã€‚</p>
<p><img src="9.png" alt="pic9"></p>
<ul>
<li>ç¨‹åºåŒ…ç®¡ç†å™¨æ§åˆ¶å°è¾“å…¥</li>
</ul>
<figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line"><span class="built_in">Enable-Migrations</span> <span class="literal">-EnableAutomaticMigrations</span></span><br></pre></td></tr></table></figure>
<ul>
<li>è¿è¡Œé¡¹ç›®è¿›å…¥å¯¹åº”çš„Controllerä½ å¯ä»¥æ–¹ä¾¿çš„å®ç°å¢åˆ æ”¹æŸ¥(CRUD)æ“ä½œã€‚</li>
</ul>
<p><em>è¿æ¥OracleæŸ¥çœ‹ç”Ÿæˆçš„è¡¨</em></p>
<p><img src="10.png" alt="pic10"></p>
<p><strong>æœ€åä¸€æ¬¡æµ‹è¯•æ—¶ï¼Œå‘ç°ä¸€ä¸ªBUGï¼Œå¦‚æœæŠŠåˆšç”Ÿæˆçš„è¡¨å…¨åˆ é™¤ï¼Œè¯•å›¾é€šè¿‡é‡æ–°è¿è¡Œé¡¹ç›®é‡æ–°å»ºè¡¨ï¼Œä¼šå¤±è´¥ã€‚è¿™ä¸ªæƒ…å†µåªåœ¨Oracleä¸Šå‘ç”Ÿï¼Œå¤§æ¦‚å®˜æ–¹è¿˜æ²¡æ³¨æ„åˆ°è¿™ä¸ªBUGã€‚â€œä¸€æ¬¡æ€§â€ç”¨æˆ·çœŸæ˜¯å°´å°¬â€¦â€¦</strong></p>
]]></content>
      <categories>
        <category>.NET</category>
      </categories>
      <tags>
        <tag>MySQL</tag>
        <tag>Database</tag>
        <tag>EntityFramework</tag>
        <tag>Oracle</tag>
        <tag>SQL Server</tag>
        <tag>Visual Studio</tag>
      </tags>
  </entry>
  <entry>
    <title>OSMCçš„ä½¿ç”¨</title>
    <url>/2017/01/18/OSMC%E4%BD%BF%E7%94%A8/</url>
    <content><![CDATA[<p>å»å¹´æŸå®ä¸Šä¹°äº† Raspberry Pi 2Bï¼ŒæœŸé—´ç©è¿‡ä¸€æ®µæ—¶é—´çš„Raspbianï¼Œæ²¡æœ‰ä¹°å…¶ä»–é…ä»¶ï¼Œå…¨å½“ç»ƒä¹ ä½¿ç”¨linuxäº†ã€‚æœ€è¿‘ç›¯ä¸Šäº† OSMCï¼Œæ‰€ä»¥ï¼Œè¦æäº‹æƒ…ï¼</p>
<a id="more"></a>
<h2 id="è®¾å¤‡"><a href="#è®¾å¤‡" class="headerlink" title="è®¾å¤‡"></a>è®¾å¤‡</h2><ul>
<li><p>Raspberry Pi 2B  </p>
<p>â€‹<em>å®˜æ–¹è¯´æ”¯æŒå…¨ç³»åˆ—çš„Piæ¿å­</em></p>
</li>
<li><p>32G SAMSUNG micro SDHC  </p>
<p><em>æ”¯æŒçš„SDå¡å¯ä»¥å»å®˜æ–¹çœ‹æ”¯æŒåˆ—è¡¨ï¼Œå®¹é‡ä¸ä½äº8G</em></p>
</li>
<li><p>HDMI to HDMI çº¿</p>
<p>â€‹<em>çœ‹éœ€æ±‚å§ï¼Œèƒ½æŠŠPiè¿ä¸Šç”µè§†å°±è¡Œ</em></p>
</li>
<li><p>EDUP EP-N8508GS USBç½‘å¡</p>
<p>â€‹<em>å³æ’å³ç”¨ï¼Œæ”¯æŒ802.11Nã€‚å¦‚æœä½ çš„ç½‘çº¿å¤Ÿé•¿å¯ä»¥ä¸ç”¨</em></p>
</li>
</ul>
<h2 id="åˆ·ç³»ç»Ÿ"><a href="#åˆ·ç³»ç»Ÿ" class="headerlink" title="åˆ·ç³»ç»Ÿ"></a>åˆ·ç³»ç»Ÿ</h2><p>ä¼ é€é—¨ <a href="https://osmc.tv/download/" target="_blank" rel="noopener">OSMC</a></p>
<p>ä½ å¯ä»¥ä½¿ç”¨å®˜æ–¹çš„å®‰è£…å™¨(æ”¯æŒWindows/Linux/OSX)ï¼Œä¹Ÿå¯ä»¥ä¸‹è½½é•œåƒè‡ªå·±åˆ·ã€‚</p>
<p>æˆ‘é€‰æ‹©ä¸‹è½½é•œåƒåœ¨winä¸‹åˆ·å…¥ï¼š</p>
<ul>
<li>å‡†å¤‡<ul>
<li>SDå¡ æ’å…¥ç”µè„‘</li>
<li>å®‰è£… <a href="https://www.sdcard.org/downloads/formatter_4/" target="_blank" rel="noopener">SD Card Formatter</a></li>
<li>å®‰è£… <a href="https://sourceforge.net/projects/win32diskimager/" target="_blank" rel="noopener">Win32 Disk Imager</a></li>
<li>è§£å‹ä¸‹è½½çš„ç³»ç»ŸzipåŒ…</li>
</ul>
</li>
<li>æ“ä½œ<ul>
<li>ä½¿ç”¨ SDFormatter V4.0 æ ¼å¼åŒ–SDå¡<ul>
<li>Drive é€‰ä¸­ä½ çš„SDå¡ç›˜ç¬¦</li>
<li>é€‰é¡¹è®¾ç½® -&gt; é€»è¾‘å¤§å°è°ƒæ•´ -&gt; å¼€å¯ï¼ˆONï¼‰-&gt; OK -&gt; æ ¼å¼åŒ–</li>
</ul>
</li>
<li>ä½¿ç”¨ Win32 Disk Imager V0.9.5 åˆ·å…¥ç³»ç»Ÿ<ul>
<li>Device é€‰ä¸­ä½ çš„SDå¡ç›˜ç¬¦</li>
<li>Image File é€‰ä¸­OSMCçš„imgæ–‡ä»¶</li>
<li>é€‰æ‹© Write</li>
</ul>
</li>
<li>åˆ·å¥½SDå¡æ’å…¥Pi<ul>
<li>Pi ç”¨è§†é¢‘çº¿æ¥ç”µè§†ï¼Œå¼€ç”µè§†ï¼Œåˆ‡æ¢ä¿¡å·æºåˆ° HDMI</li>
<li>Pi ç”¨microUSBæ¥ç”µæºé€‚é…å™¨</li>
<li>Pi ä¸Šæ¥é”®ç›˜</li>
</ul>
</li>
<li>å¼€æœºé…ç½®ç³»ç»Ÿâ€¦â€¦è¯­è¨€æš‚æ—¶ç”¨English(US)ï¼Œè”ç½‘</li>
</ul>
</li>
</ul>
<h2 id="è½¯ä»¶é…ç½®"><a href="#è½¯ä»¶é…ç½®" class="headerlink" title="è½¯ä»¶é…ç½®"></a>è½¯ä»¶é…ç½®</h2><ul>
<li><p>è¯­è¨€è®¾ç½®</p>
<p>Settings -&gt; Apperance -&gt; Skin -&gt; Fonts -&gt; Arial</p>
<p>Settings -&gt; Apperance -&gt; International -&gt; Language -&gt; Chinese(Simple)</p>
<p>ç°åœ¨å°±æ˜¯æ˜¾ç¤ºä¸­æ–‡äº†ï¼Œä¸‹é¢è¿˜æœ‰äº›é¸¡è‚‹çš„è®¾ç½®</p>
<p>è®¾ç½® -&gt; ç”¨æˆ·ç•Œé¢ -&gt; å­—ç¬¦é›† -&gt; Chinese Simplified (GBK)</p>
<p>è®¾ç½® -&gt; ç”¨æˆ·ç•Œé¢ -&gt; é”®ç›˜å¸ƒå±€ -&gt; æ·»åŠ  Chinese BaiduPY</p>
</li>
<li><p>å®‰è£…æ’ä»¶åº“</p>
<p><a href="http://dkmc.tv/2013/04/07/xbmc%E6%8F%92%E4%BB%B6%E5%BA%93%E6%B1%87%E6%80%BB/" target="_blank" rel="noopener">ä¼ é€é—¨</a></p>
<p>ä½¿ç”¨zipåŒ…çš„å®‰è£…æ–¹å¼ï¼Œå…ˆåœ¨åŒå±€åŸŸç½‘çš„ç”µè„‘ä¸Šä¸‹è½½</p>
<p> <a href="https://github.com/taxigps/xbmc-addons-chinese/raw/master/repo/repository.xbmc-addons-chinese/repository.xbmc-addons-chinese-1.2.0.zip" target="_blank" rel="noopener">chinese addon</a> ã€<a href="http://xbmc.hdpfans.com/repository.hdpfans.xbmc-addons.zip" target="_blank" rel="noopener">hdpfans</a></p>
<p>é€‰æ‹©æ’ä»¶ï¼Œé€‰æ‹©å®‰è£…ï¼ŒæŒ‰Backspaceåˆ°æœ€å¤–å±‚ï¼Œé€‰æ‹©zipåŒ…å®‰è£…æ’ä»¶ï¼Œé€‰æ‹©å®‰è£…åˆšä¸‹çš„ä¸¤ä¸ªæ’ä»¶ã€‚</p>
</li>
<li><p>å¯»æ‰¾ä½ éœ€è¦çš„æ’ä»¶ï¼Œå®‰è£…å³å¯ã€‚</p>
</li>
</ul>
<h2 id="ä½¿ç”¨-app-æ§åˆ¶"><a href="#ä½¿ç”¨-app-æ§åˆ¶" class="headerlink" title="ä½¿ç”¨ app æ§åˆ¶"></a>ä½¿ç”¨ app æ§åˆ¶</h2><p><a href="http://kodi.wiki/view/Remote_controls" target="_blank" rel="noopener">Remote Control</a></p>
<ul>
<li>Android<ul>
<li><a href="http://mirrors.kodi.tv/tools/kore/releases/" target="_blank" rel="noopener">Kore</a> <em>å®˜æ–¹è½¯ä»¶</em></li>
<li><a href="http://yatse.tv/redmine/projects/yatse/wiki/XbmcStarter#Download-and-install-2" target="_blank" rel="noopener">Yatse</a> <em>åŠŸèƒ½ä¸€æ ·ï¼Œ<a href="https://play.google.com/store/apps/details?id=tv.yatse.android.remotestarter" target="_blank" rel="noopener">Google Play</a>ä¸Šå”®ä»·0.99$</em></li>
</ul>
</li>
<li>iOS<ul>
<li><a href="https://itunes.apple.com/cn/app/official-kodi-remote/id520480364?mt=8" target="_blank" rel="noopener">Official Kodi Remote</a> <em>å®˜æ–¹è½¯ä»¶</em></li>
</ul>
</li>
<li>WP  <em>ä¸‹é¢æ‘˜æŠ„è‡ªkodi.wiki</em><ul>
<li><a href="https://www.microsoft.com/store/apps/9nblggh4qvkx" target="_blank" rel="noopener">mrRemote for Kodi</a> by Domenico Rescigno (free)</li>
<li><a href="http://www.windowsphone.com/s?appid=3897b459-b11b-41eb-9cea-dd9e53c55b78" target="_blank" rel="noopener">Kodi Assist</a> by akshay2000 (free)</li>
<li><a href="http://www.windowsphone.com/s?appid=3a35a8c6-bf35-49a1-b67b-f8104be2b05c" target="_blank" rel="noopener">xbmc remote free</a> by CRW Solutions (free)</li>
<li><a href="http://kodi.wiki/view/XBMC_Maestro" target="_blank" rel="noopener">XBMC Maestro</a> by 3Webers ($0.99 USD)</li>
<li><a href="http://www.windowsphone.com/s?appid=7cdb0b87-1e00-4328-b839-43a6bf9c8556" target="_blank" rel="noopener">Kodi Remote</a> by Fabien Lavocat (free)</li>
</ul>
</li>
</ul>
]]></content>
      <categories>
        <category>é—²æ‰¯</category>
      </categories>
      <tags>
        <tag>OSMC</tag>
      </tags>
  </entry>
  <entry>
    <title>é‡è£…Ubuntuçš„é…ç½®åŠæŠ˜è…¾rEFInd</title>
    <url>/2017/01/17/%E9%87%8D%E8%A3%85Ubuntu%E7%9A%84%E9%85%8D%E7%BD%AE%E5%8F%8A%E6%8A%98%E8%85%BErEFInd/</url>
    <content><![CDATA[<p>ä¸ºä»€ä¹ˆçªç„¶ä¼šæŠ˜è…¾è¿™ä¸ªï¼Ÿå› ä¸ºæˆ‘æ ¼ç›˜é‡è£…äº†ç³»ç»Ÿï¼Œå› ä¸ºå¼ºè¿«ç—‡å‘ä½œï¼Œä»¥å‰è£…å¾—win10ç«Ÿç„¶ä¸æ˜¯EFI+GPTâ€¦â€¦è™½ç„¶è£…å›ºæ€ä¸Šï¼Œå¯åŠ¨é€Ÿåº¦æ²¡æœ‰åŒºåˆ«ï¼Œä½†æˆ‘å°±æ˜¯è¦æŠ˜è…¾â€¦â€¦æ—¢ç„¶æŠ˜è…¾å®Œäº†ï¼Œå…¨éƒ¨è¿‡ç¨‹è®°å½•ä¸‹ï¼Œä¸æ„¿çœ‹è¿™ä¹ˆå¤šï¼Œä¹Ÿå¯ä»¥ç›´æ¥è·³åˆ°<a href="#refind">rEFIndçš„é…ç½®</a>ã€‚</p>
<a id="more"></a>
<h2 id="å…ˆå®‰è£…win10"><a href="#å…ˆå®‰è£…win10" class="headerlink" title="å…ˆå®‰è£…win10"></a>å…ˆå®‰è£…win10</h2><p>ç”¨<a href="https://www.microsoft.com/zh-cn/software-download/windows10" target="_blank" rel="noopener">å®˜æ–¹å·¥å…·</a>åšä¸€ä¸ªå®‰è£…ç›˜ï¼Œbiosé€‰æ‹©ä¸­å¯åŠ¨æ–¹å¼<strong>EFI Only</strong>ï¼Œå¹¶å¼€å¯<strong>Secure Boot</strong> ã€‚ï¼ˆ<em>å¯¹ï¼Œç½‘ä¸Šé‚£äº›è¾£é¸¡æ•™ç¨‹éƒ½TMæ•™ä½ å…³æ‰ï¼Œä½†æ˜¯ä¸å‘Šè¯‰ä½ åŸå› ï¼Œå¬æˆ‘çš„ï¼Œä¸ç”¨å…³ï¼Œè£…ubuntuä¹Ÿä¸ç”¨å…³ï¼Œå› ä¸ºubuntuç”³è¯·äº†EFIå®‰å…¨è¯ä¹¦çš„ï¼</em>ï¼‰</p>
<p>æ¥ç€å¼€æœºæ’å…¥Uç›˜ï¼ŒæŒ‰æç¤ºå®‰è£…å°±å¥½ï¼Œè®°å¾—æŠŠåˆ†åŒºæ–¹å¼æ”¹æˆ<strong>GPT</strong>ã€‚ï¼ˆ<em>è‹¥ä½ ä¹‹å‰æ˜¯MBRï¼Œè¦ä¹ˆæŠŠåŸæ¥åˆ†åŒºå…¨åˆ æ‰ï¼Œè¦ä¹ˆæŒ‰ç½‘ä¸Šæ•™ç¨‹åšä¸ªEFI+MBRï¼Œåæ­£æˆ‘æ˜¯å¼ºè¿«ç—‡ï¼Œæˆ‘å°±è¦æ ¼ç›˜ï¼</em>ï¼‰</p>
<p>å¦‚ä½•è¾¨åˆ«æ˜¯ä¸æ˜¯EFIå¯åŠ¨å‘¢ï¼Ÿ</p>
<p>win + R ï¼Œè¾“å…¥ msinfo32 ï¼Œå›è½¦ï¼Œå¼•å¯¼æ–¹å¼é‚£è¡Œæ˜¯ EFI å°±å¯¹äº†ã€‚</p>
<h2 id="å†å®‰è£…ubuntu16-04"><a href="#å†å®‰è£…ubuntu16-04" class="headerlink" title="å†å®‰è£…ubuntu16.04"></a>å†å®‰è£…ubuntu16.04</h2><p>è¿™ä¸ªæ›´ç®€å•ï¼ŒæŠŠå®˜æ–¹isoé•œåƒæ–‡ä»¶ï¼Œç›´æ¥è§£å‹åˆ°<strong>FAT32</strong>æ ¼å¼Uç›˜çš„æ ¹ç›®å½•ï¼Œå¼€æœºï¼Œè¿›Uç›˜ï¼Œå®‰è£…ã€‚åˆ°é‚£ä¸ªç„¶è¦ç°åœ¨winä¸‹åˆ‡å¥½æœªåˆ†é…ç©ºé—´ï¼Œè¿™æ¬¡æˆ‘åˆ‡äº†40Gã€‚å°æœ¬å­æœ‰8Gå†…å­˜ï¼Œswapåˆ†åŒºå®Œå…¨ä¸ç”¨åˆ†çš„ã€‚åœ¨ä¹‹å‰æˆ‘è¯•è¿‡æ‰€æœ‰æœªåˆ†é…ç©ºé—´éƒ½æŒ‚åˆ°æ ¹ç›®å½•ï¼Œä¸€æ ·ç”¨ç€å¥½å¥½çš„ï¼Œåªæœ‰ä¸€ç‚¹é—®é¢˜ï¼Œåªèƒ½æŒ‚èµ·ï¼Œä¸èƒ½ä¼‘çœ ã€‚</p>
<p>é‚£ä¹ˆè¿™æ¬¡çš„åˆ†åŒºæ–¹æ¡ˆæ˜¯8Gçš„swapï¼Œå‰©ä¸‹å…¨æŒ‚ / æ ¹ç›®å½•ã€‚ å¯åŠ¨å™¨æŒ‚åœ¨ubuntuæ‰€åœ¨ç¡¬ç›˜ï¼Œæˆ‘æ˜¯åœ¨ç¬¬äºŒå¿«ç¡¬ç›˜ /dev/sdb ä¸Šã€‚</p>
<h2 id="ubuntué…ç½®è®°å½•"><a href="#ubuntué…ç½®è®°å½•" class="headerlink" title="ubuntué…ç½®è®°å½•"></a>ubuntué…ç½®è®°å½•</h2><p><strong>å…ˆè¦æ„Ÿè°¢<a href="https://plumz.me/" target="_blank" rel="noopener">plumçš„åšå®¢</a>ï¼Œçœ‹ä»–çš„åšå®¢è®©æˆ‘è§£å†³çš„ä¸å°‘é—®é¢˜</strong></p>
<p>æ—¢ç„¶ç”¨äº†ä¸€æ®µæ—¶é—´çš„ubuntuï¼Œè§£å†³äº†ä¸å°‘é—®é¢˜ï¼Œè¿™é‡Œçš„é…ç½®ä¸ä¸Šä¸€ç¯‡æœ‰ç‚¹ä¸åŒï¼Œé‡æ–°è®°å½•å¦‚ä¸‹ï¼š</p>
<ul>
<li>ä¿®æ”¹æœ¬åœ°æ–‡ä»¶å¤¹åç§°ä¸ºè‹±æ–‡</li>
</ul>
<blockquote>
<p>å¦‚æœä½ å®‰è£…ç³»ç»Ÿæ—¶é€‰æ‹©äº†ä¸­æ–‡ï¼Œé‚£ä¹ˆç”¨æˆ·ç›®å½•å°±é»˜è®¤æ˜¯ä¸­æ–‡ï¼Œå¸¦ä½ cdç›®å½•çš„æ—¶å€™å°±çŸ¥é“å¤šè›‹ç–¼ï¼</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">export LANG=en_US</span><br><span class="line">xdg-user-dirs-gtk-update</span><br><span class="line">export LANG=zh_CN</span><br><span class="line">reboot</span><br></pre></td></tr></table></figure>
<ul>
<li>å…³é—­é¼ æ ‡åŠ é€Ÿ</li>
</ul>
<blockquote>
<p>Ubuntu16.04é»˜è®¤å¼€å¯äº†é¼ æ ‡åŠ é€Ÿï¼Œç”¨è§¦æ§æ¿åˆ°æ„Ÿè§‰ä¸åˆ°ï¼Œç”¨é¼ æ ‡è¿™ä¹ˆé£˜å°±ä¸èƒ½å¿äº†ï¼</p>
</blockquote>
<figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">åœ¨Dashboardé‡Œæœç´¢:</span><br><span class="line">gnome-session-properties</span><br><span class="line">ç‚¹å‡»æ·»åŠ ï¼š</span><br><span class="line">åç§°ï¼šsetmouse</span><br><span class="line">å‘½ä»¤ï¼šxset m 0 æˆ–è€… xset m default</span><br><span class="line">é‡å¯ã€‚</span><br></pre></td></tr></table></figure>
<ul>
<li>å®‰è£… lantern </li>
</ul>
<p><em>æ¥ä¸‹æ¥è¦å®‰è£…è½¯ä»¶äº†ï¼Œæˆ‘å¸Œæœ›ç½‘ç»œè¦æ²¡æœ‰é˜»ç¢ï¼Œæ¢¯å­æ˜¯å¿…é¡»å…ˆè£…çš„ï¼</em></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">cd ~/Downloads/</span><br><span class="line">wget https://raw.githubusercontent.com/getlantern/lantern-binaries/master/lantern-installer-beta-64-bit.deb</span><br><span class="line">sudo dpkg -i lantern-installer-beta-64-bit.deb</span><br></pre></td></tr></table></figure>
<p>æ‰“å¼€lanternï¼Œè¿›å…¥è®¾ç½®ï¼ŒæŸ¥çœ‹ä¸¤ä¸ªç«¯å£å·ï¼Œæˆ‘çš„æ˜¯ï¼š</p>
<figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">HTTP(S) proxy: 127.0.0.1:44045</span><br><span class="line">SOCKS proxy: 127.0.0.1:43355</span><br></pre></td></tr></table></figure>
<p>ç„¶åç»ˆç«¯è¾“å…¥ä¸‹é¢ä¸¤å¥æ¥å…¨å±€ä»£ç†</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">export all_proxy=socks://127.0.0.1:43355</span><br><span class="line">export ALL_PROXY=socks://127.0.0.1:43355</span><br></pre></td></tr></table></figure>
<p>å¦‚æœæƒ³å–æ¶ˆæ‰çš„è¯ï¼š</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">unset all_proxy</span><br><span class="line">unset ALL_PROXY</span><br></pre></td></tr></table></figure>
<p>æ¥ç€é…ç½® lantern çš„å¼€æœºæ— ç•Œé¢å¯åŠ¨</p>
<figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">åœ¨Dashboardé‡Œæœç´¢:</span><br><span class="line">gnome-session-properties</span><br><span class="line">ç‚¹å‡»æ·»åŠ ï¼š</span><br><span class="line">åç§°ï¼šlantern</span><br><span class="line">å‘½ä»¤ï¼š/usr/bin/lantern -headless</span><br></pre></td></tr></table></figure>
<ul>
<li>å®‰è£… git</li>
</ul>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sudo apt install git -y</span><br><span class="line"><span class="meta">#</span><span class="bash"> è®¾ç½® git ä»£ç†ï¼ˆhttp &amp; https ä»£ç†ï¼‰</span></span><br><span class="line">git config --global http.proxy socks5://127.0.0.1:43355</span><br><span class="line">git config --global https.proxy socks5://127.0.0.1:43355</span><br></pre></td></tr></table></figure>
<ul>
<li>å®‰è£…åŠŸè€—æ§åˆ¶ TLP</li>
</ul>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sudo apt-get install tlp tlp-rdw -y</span><br><span class="line">sudo apt-get install tp-smapi-dkms acpi-call-dkms -y</span><br><span class="line">sudo apt-get install thermald -y</span><br><span class="line">sudo apt-get install powertop -y</span><br><span class="line"><span class="meta">#</span><span class="bash"> é…ç½® TLP</span></span><br><span class="line">sudo vim /etc/default/tlp</span><br><span class="line"><span class="meta">#</span><span class="bash"> å¯åŠ¨ TLP</span></span><br><span class="line">sudo tlp start</span><br></pre></td></tr></table></figure>
<ul>
<li>æ¶ˆé™¤ Ubuntu LightDM ç™»é™†ç•Œé¢èƒŒæ™¯ç™½ç‚¹</li>
</ul>
<blockquote>
<p>ä¸èƒ½å¿ï¼Œå½±å“æˆ‘çœ‹é”å±å£çº¸ï¼</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">gsettings set com.canonical.unity-greeter draw-grid false</span><br><span class="line">sudo xhost +SI:localuser:lightdm</span><br><span class="line">sudo su lightdm -s /bin/bash</span><br><span class="line">gsettings set com.canonical.unity-greeter draw-grid false</span><br><span class="line">exit</span><br></pre></td></tr></table></figure>
<ul>
<li>å®‰è£… arc-flatabulous ä¸»é¢˜</li>
</ul>
<p><em><a href="https://github.com/andreisergiu98/arc-flatabulous-theme" target="_blank" rel="noopener">Arc-Flatabulous Theme</a></em></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> å®‰è£…ä¾èµ–</span></span><br><span class="line">sudo apt install autoconf automake libgtk-3-dev -y</span><br><span class="line"><span class="meta">#</span><span class="bash"> å®‰è£… unity-tweek-tool</span></span><br><span class="line">sudo apt install unity-tweak-tool -y</span><br><span class="line"><span class="meta">#</span><span class="bash"> å®˜æ–¹å®‰è£…æ–¹å¼</span></span><br><span class="line">sudo rm -rf /usr/share/themes/&#123;Arc-Flatabulous,Arc-Flatabulous-Darker,Arc-Flatabulous-Dark&#125;</span><br><span class="line">rm -rf ~/.local/share/themes/&#123;Arc-Flatabulous,Arc-Flatabulous-Darker,Arc-Flatabulous-Dark&#125;</span><br><span class="line">rm -rf ~/.themes/&#123;Arc-Flatabulous,Arc-Flatabulous-Darker,Arc-Flatabulous-Dark&#125;</span><br><span class="line">git clone https://github.com/andreisergiu98/arc-flatabulous-theme &amp;&amp; cd arc-flatabulous-theme</span><br><span class="line"><span class="meta">#</span><span class="bash"> ç¼–è¯‘å®‰è£…ï¼Œä¸æƒ³è§é€æ˜æ•ˆæœï¼Œç¼–è¯‘æ—¶åŠ å‚æ•° --<span class="built_in">disable</span>-transparency</span></span><br><span class="line">./autogen.sh --prefix=/usr &amp;&amp; sudo make install</span><br></pre></td></tr></table></figure>
<ul>
<li>å®‰è£… papirus å›¾æ ‡ä¸»é¢˜</li>
</ul>
<p><em><a href="https://github.com/PapirusDevelopmentTeam/papirus-icon-theme" target="_blank" rel="noopener">papirus-icon-theme</a></em></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sudo apt install wget git libqt4-svg -y </span><br><span class="line">wget -qO- https://raw.githubusercontent.com/PapirusDevelopmentTeam/papirus-icon-theme/master/install-papirus-root.sh | sh</span><br></pre></td></tr></table></figure>
<ul>
<li>å®‰è£… Hardcode-Tray å›¾æ ‡ä¿®å¤</li>
</ul>
<blockquote>
<p>å¯¹å³ä¸Šè§’é‚£äº›å›¾æ ‡é£æ ¼ä¸ç»Ÿä¸€ï¼Œå¯ä»¥è¯•è¯•ï¼Œä½†æ˜¯åªæ”¯æŒéƒ¨åˆ†å›¾æ ‡ä¿®å¤ï¼Œè¿™ä¸ªè½¯ä»¶è›®é¸¡è‚‹çš„â€¦â€¦</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sudo add-apt-repository ppa:andreas-angerer89/sni-qt-patched</span><br><span class="line">sudo apt update</span><br><span class="line">sudo apt install sni-qt sni-qt:i386 hardcode-tray -y</span><br><span class="line"><span class="meta">#</span><span class="bash"> ä½¿ç”¨ Hardcode-Tray</span></span><br><span class="line">hardcode-tray --apply</span><br><span class="line"><span class="meta">#</span><span class="bash"> å¦‚æœå‡ºç° FileNotFoundError: [Errno 2] ï¼Œå»ºä¸€ä¸ªè½¯é“¾æ¥</span></span><br><span class="line">ln -s  /usr/share/icons/ ~/.local/share/icons</span><br><span class="line">hardcode-tray --apply</span><br></pre></td></tr></table></figure>
<ul>
<li>æ›´æ”¹é¼ æ ‡æŒ‡é’ˆæ ·å¼</li>
</ul>
<figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">ä¸‹è½½ Breeze-Hacked å¹¶è§£å‹</span><br><span class="line">cp -a Breeze-Hacked/ /usr/share/icons/</span><br><span class="line">åœ¨ unity-tweek-tool é‡Œæ›´æ¢</span><br></pre></td></tr></table></figure>
<ul>
<li>ä½¿ç”¨terminatoråŠZSH</li>
</ul>
<p>æ™®é€šç”¨æˆ·</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sudo apt-get install terminator zsh -y</span><br><span class="line">chsh -s /bin/zsh</span><br><span class="line">wget https://github.com/robbyrussell/oh-my-zsh/raw/master/tools/install.sh -O - | sh</span><br><span class="line">vim ~/.zshrc # æ·»åŠ ä»¥ä¸‹å†…å®¹</span><br><span class="line"><span class="meta">#</span><span class="bash"> ZSH_THEME=<span class="string">"agnoster"</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> DEFAULT_USER=<span class="string">"shank"</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> COMPLETION_WAITING_DOTS=<span class="string">"true"</span></span></span><br></pre></td></tr></table></figure>
<p>rootç”¨æˆ·</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sudo su</span><br><span class="line">wget https://github.com/robbyrussell/oh-my-zsh/raw/master/tools/install.sh -O - | sh</span><br><span class="line">vim ~/.zshrc # æ·»åŠ ä»¥ä¸‹å†…å®¹</span><br><span class="line"><span class="meta">#</span><span class="bash"> ZSH_THEME=<span class="string">"agnoster"</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> DEFAULT_USER=<span class="string">"root"</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> COMPLETION_WAITING_DOTS=<span class="string">"true"</span></span></span><br><span class="line">exit</span><br></pre></td></tr></table></figure>
<p>å®‰è£…PowerLineå­—ä½“</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">cd ~/Downloads</span><br><span class="line">git clone https://github.com/powerline/fonts</span><br><span class="line">cd fonts</span><br><span class="line">./install.sh</span><br></pre></td></tr></table></figure>
<ul>
<li>å¸¸è§„æ›´æ–°</li>
</ul>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sudo apt update</span><br><span class="line">sudo apt upgrade</span><br></pre></td></tr></table></figure>
<ul>
<li>å®‰è£… Deluge</li>
</ul>
<p>ä¸‹è½½å·¥å…·ï¼Œå¸¦æœ‰BTå’Œç£é“¾ä¸‹è½½</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sudo apt install deluge -y</span><br></pre></td></tr></table></figure>
<ul>
<li>å®‰è£… caffeine</li>
</ul>
<p>ç”¨äºæš‚æ—¶å–æ¶ˆå±ä¿å’Œç¡çœ æ¨¡å¼ï¼Œç”¨linuxçœ‹è§†é¢‘æ—¶è®°å¾—æŠŠå®ƒè®¾ä¸ºActive</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sudo apt install caffeine -y</span><br><span class="line"><span class="meta">#</span><span class="bash"> åœ¨ gnome-session-properties å¼€æœºå¯åŠ¨ä¸­æ·»åŠ æˆ–ä¿®æ”¹Caffeineçš„å‘½ä»¤ä¸ºä¸‹é¢è¿™å¥</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> /usr/bin/caffeine-indicator</span></span><br></pre></td></tr></table></figure>
<ul>
<li>å®‰è£… mpv</li>
</ul>
<blockquote>
<p>ç®€ä»‹è€Œå¼ºå¤§çš„æ’­æ”¾å™¨ï¼Œä¸ç”¨VLCå› ä¸ºå®ƒå¯¹å­—å¹•æ”¯æŒä¸å¥½ï¼</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sudo apt-get install mpv -y</span><br></pre></td></tr></table></figure>
<ul>
<li>å®‰è£… flash æ”¯æŒ</li>
</ul>
<blockquote>
<p>Bç«™çš„Html5æ’­æ”¾å™¨æ€»æ˜¯æ²¡é€Ÿåº¦ï¼Œæ‰€ä»¥flashè¿˜æ˜¯å¿…éœ€çš„ï¼</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">å…ˆåœ¨è®¾ç½®ä¸­å…è®¸ Canonical Partners æ‰“åŒ…çš„åº”ç”¨</span></span><br><span class="line">sudo apt install adobe-flashplugin -y</span><br></pre></td></tr></table></figure>
<ul>
<li>è§£å†³å¾…æœºåé‡å¯ä¼šè‡ªåŠ¨æ–­çº¿çš„ Bug</li>
</ul>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sudo systemctl enable NetworkManager.service</span><br></pre></td></tr></table></figure>
<ul>
<li>ä½¿ç”¨ Canonical Livepatch Service</li>
</ul>
<p><em><a href="https://www.ubuntu.com/server/livepatch" target="_blank" rel="noopener">Canonical Livepatch Service</a> å…é‡æ–°å¼€æœºåšæ ¸å¿ƒ</em></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sudo snap install canonical-livepatch</span><br><span class="line">sudo canonical-livepatch enable XXX #XXXä»å®˜æ–¹è·å–</span><br></pre></td></tr></table></figure>
<ul>
<li>å®‰è£…æŒ‡çº¹è¯†åˆ«æ”¯æŒ</li>
</ul>
<blockquote>
<p>è¿™ä¸ªå¯ä»¥ç”¨ï¼Œä½†æ˜¯ä¼šè§‰å¾—çš„æœ‰ç‚¹çƒ¦ï¼Œå› ä¸ºè¿™ä¸ªè½¯ä»¶æœ‰ä¸ªbugï¼Œåˆ·æŒ‡çº¹ä¸€å®šè¦åˆ·ä¸¤ä¸‹ï¼ŒéªŒè¯æˆåŠŸï¼Œè¿˜è¦å†åˆ·ä¸€ä¸‹æŒ‡çº¹ç¯æ‰ä¼šç­ï¼Œæ‰€ä»¥æˆ‘å·²ç»ä¸ç”¨äº†â€¦â€¦</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sudo add-apt-repository ppa:fingerprint/fprint -y &amp;&amp; sudo apt-get update</span><br><span class="line">sudo apt-get install libfprint0 fprint-demo libpam-fprintd gksu -y</span><br></pre></td></tr></table></figure>
<ul>
<li>Fcitx è¾“å…¥æ³•æ¢å›åŸç”Ÿ indicatorï¼Œä¸ç”¨é‚£ä¸ª qim</li>
</ul>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sudo apt remove fcitx-ui-qimpanel -y</span><br></pre></td></tr></table></figure>
<ul>
<li>å®‰è£… android studio</li>
</ul>
<p><em><a href="https://developer.android.com/studio/index.html" target="_blank" rel="noopener">å®˜æ–¹é“¾æ¥</a>ä¸‹è½½zipå®‰è£…åŒ…</em></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> å®‰è£… jdk</span></span><br><span class="line">sudo apt install openjdk-8-jdk -y</span><br><span class="line"><span class="meta">#</span><span class="bash"> å®‰è£…ä¾èµ–</span></span><br><span class="line">sudo apt-get install lib32z1 lib32ncurses5 lib32stdc++6 -y</span><br><span class="line"><span class="meta">#</span><span class="bash"> è§£å†³æ—  pixmap é—®é¢˜</span></span><br><span class="line">sudo apt-get install gtk2-engines-pixbuf -y</span><br><span class="line"><span class="meta">#</span><span class="bash"> è§£å†³æ—  adwaita é—®é¢˜</span></span><br><span class="line">sudo apt-get install gnome-themes-standard gnome-themes-standard-data -y</span><br><span class="line"><span class="meta">#</span><span class="bash"> å®‰è£…a.s.ï¼Œæˆ‘ä¹ æƒ¯æŠŠa.s.è£…åˆ° /opt ç›®å½•</span></span><br><span class="line">sudo unzip -q ~/Downloads/android-studioâ€¦â€¦â€¦ -d /opt # çœç•¥å·éƒ¨åˆ†è‡ªå·±æŒ‰TABæ›¿æ¢</span><br><span class="line">cd /opt/android-studio/bin/</span><br><span class="line">./studio.sh</span><br></pre></td></tr></table></figure>
<ul>
<li>Firefox å­—ä½“é—®é¢˜ ï¼ˆä¸ç”¨æ”¹äº†ï¼Œæ–°ç‰ˆæœ¬å¥½åƒè§£å†³äº†è¿™ä¸ªé—®é¢˜ï¼‰</li>
</ul>
<figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">åœ°å€æ è¾“å…¥ about:config</span><br><span class="line">æ‰¾åˆ° gfx.font_rendering.fontconfig.fontlist.enabled</span><br><span class="line">è®¾ç½®ä¸º false</span><br></pre></td></tr></table></figure>
<ul>
<li>å®‰è£… typola ,æœ¬äººæœ€å–œæ¬¢çš„ markdown ç¼–è¾‘å™¨</li>
</ul>
<p><em><a href="https://typora.io/" target="_blank" rel="noopener">typolaå®˜æ–¹é“¾æ¥</a></em></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> optional, but recommended</span></span><br><span class="line">sudo apt-key adv --keyserver keyserver.ubuntu.com --recv-keys BA300B7755AFCFAE</span><br><span class="line"><span class="meta">#</span><span class="bash"> add Typora<span class="string">'s repository</span></span></span><br><span class="line">sudo add-apt-repository 'deb https://typora.io ./linux/' -y</span><br><span class="line">sudo apt-get update</span><br><span class="line"><span class="meta">#</span><span class="bash"> install typora</span></span><br><span class="line">sudo apt-get install typora -y</span><br></pre></td></tr></table></figure>
<h2 id="rEFInd"><a href="#rEFInd" class="headerlink" title="rEFInd"></a>rEFInd</h2><p><em><a href="http://www.rodsbooks.com/refind/configfile.html" target="_blank" rel="noopener">rEFIndå®˜æ–¹é“¾æ¥</a></em></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sudo apt-add-repository ppa:rodsmith/refind -y </span><br><span class="line">sudo apt-get update</span><br><span class="line">sudo apt-get install refind -y</span><br><span class="line">sudo cd /boot/eft/EFI/refind</span><br><span class="line">sudo su</span><br><span class="line">mkdir themes</span><br><span class="line">cd themes</span><br><span class="line"><span class="meta">#</span><span class="bash"> ä¸‹è½½æ–°ä¸»é¢˜</span></span><br><span class="line">git clone https://github.com/EvanPurkhiser/rEFInd-minimal.git</span><br><span class="line">cd ..</span><br><span class="line">cp refind.conf refind.conf.bak</span><br><span class="line">gedit refind.conf</span><br></pre></td></tr></table></figure>
<p>æ·»åŠ è®¾ç½®åˆ°æ–‡ä»¶ç»“å°¾ï¼Œå…·ä½“çœ‹é…ç½®æ–‡ä»¶æˆ–è€…Google</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">resolution 1920 1080</span><br><span class="line">scan_all_linux_kernels false</span><br><span class="line">default_selection Microsoft</span><br><span class="line"><span class="meta">#</span><span class="bash"> å¯¼å…¥ä¸»é¢˜é…ç½®ï¼š</span></span><br><span class="line">include themes/rEFInd-minimal/theme.conf</span><br></pre></td></tr></table></figure>
<p>è¿™ä¸ªæ—¶å€™é‡å¯æ˜¯ä½¿ç”¨ä¸äº†rEFIndçš„ï¼Œå› ä¸ºå¼€äº†Secure Bootçš„ç¼˜æ•…ã€‚é‚£ä¹ˆè¦è§£å†³å…è®¸Secure Bootçš„é—®é¢˜ï¼Œå°±è¦ç»™ä»–æˆæƒã€‚å®˜æ–¹æä¾›çš„æ–¹æ¡ˆæœ‰ Shim å’Œ PreLoaderï¼Œå¤–æ–‡åšå®¢åŸºæœ¬ä»‹ç»çš„ä¹Ÿæ˜¯Shimã€‚éƒ½æ¯”è¾ƒéº»çƒ¦ï¼Œä¸æ„¿çœ‹ä¹Ÿä¸æ„¿åšï¼ˆâ€”ã€‚â€”ï¼‰ï¼Œå¶ç„¶å‘ç°äº† boot-repair ã€‚è¿™ä¸ªè½¯ä»¶æ˜¯å‚»ç“œåŒ–ä¿®å¤å¯åŠ¨å¼•å¯¼ç”¨çš„ï¼Œå®ƒè§£å†³å®‰å…¨å¼•å¯¼çš„åŒæ—¶ä¹Ÿä¼šè£… Shimï¼Œæ­£å¥½çœå¾—æˆ‘åŠ¨æ‰‹ã€‚<br>å…ˆè£… boot-repair</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sudo add-apt-repository ppa:yannubuntu/boot-repair</span><br><span class="line">sudo apt-get update</span><br><span class="line">sudo apt-get install -y boot-repair &amp;&amp; boot-repair</span><br></pre></td></tr></table></figure>
<p>é€‰æ‹©æ¨èæ–¹æ¡ˆ(Recommended repair)ï¼Œæ¥ç€éƒ½æ˜¯â€œyesâ€<br>å¼•å¯¼ä¿®å¤åï¼Œå¯ä»¥apté‡è£…ä¸‹refindï¼Œåº”è¯¥åŒæ—¶ä¼šç”³è¯· *.cer æ–‡ä»¶<br>ç„¶åé‡å¯ï¼Œå’Œå®˜æ–¹ Slimæˆæƒçš„æ–¹å¼ä¸€æ ·ï¼ŒSelect keyé€‰ç¬¬ä¸€ä¸ªï¼Œ<br>ç»™EFI/refind/keyç›®å½•ä¸‹çš„<strong>refind.cer</strong>å’Œ<strong>refind_local.cer</strong>æ–‡ä»¶æˆæƒï¼Œç„¶åé€‰æ‹©é‡å¯ã€‚</p>
<p>æˆæƒåçš„ä¸€äº›è°ƒæ•´</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sudo su</span><br><span class="line"><span class="meta">#</span><span class="bash"> åˆ é™¤ä¸€ä¸ªå¤šä½™å¯åŠ¨æ–‡ä»¶</span></span><br><span class="line">rm -f /boot/efi/EFI/Boot/bkpbootx64.efi</span><br><span class="line"><span class="meta">#</span><span class="bash"> æƒ³è¦refindé€‰æ‹©ubuntuå°±ç›´æ¥è¿›ç³»ç»Ÿï¼Œä¸ç”¨å†æ˜¾ç¤ºgrub2èœå•</span></span><br><span class="line">vim /etc/default/grub # ä¿®æ”¹ GRUB_TIMEOUT=0</span><br><span class="line">rm -f /etc/grub.d/30_os-prober # grubä¸è®°å½•win10å¼•å¯¼</span><br><span class="line"><span class="meta">#</span><span class="bash"> æ›´æ–°gurb</span></span><br><span class="line">update-grub</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>Linux</category>
      </categories>
      <tags>
        <tag>Linux</tag>
        <tag>Ubuntu</tag>
        <tag>EFI</tag>
        <tag>rEFInd</tag>
      </tags>
  </entry>
  <entry>
    <title>ä»æ”¾å¼ƒWindowsåˆ°ä½¿ç”¨IRC</title>
    <url>/2017/01/08/%E4%BB%8E%E6%94%BE%E5%BC%83Windows%E5%88%B0%E4%BD%BF%E7%94%A8IRC/</url>
    <content><![CDATA[<p>Windows å·²ç»åˆ äº†ï¼Œæœ€è¿‘éƒ½åœ¨ Ubuntu ä¸Šï¼Œä¸å°å¿ƒæ¥è§¦äº†IRCè¿™ä¸ªå¤è€çš„ä¸œè¥¿ï¼Œç ”ç©¶äº†ä¸€æ™šä¸Šï¼Œç»™ç ´ç«™åŠ ç‚¹æ–°ç©æ„ã€‚</p>
<a id="more"></a>
<p> åšå®¢è¿ç§»åï¼ŒèŠå¤©å®¤å·²ä¸å­˜åœ¨ã€‚</p>
<blockquote>
<p>IRCï¼ˆInternet Relay Chatçš„ç¼©å†™ï¼Œâ€œå› ç‰¹ç½‘ä¸­ç»§èŠå¤©â€ï¼‰æ˜¯ä¸€ç§é€šè¿‡ç½‘ç»œçš„å³æ—¶èŠå¤©æ–¹å¼ã€‚</p>
</blockquote>
<p><a href="https://zh.wikipedia.org/wiki/IRC" target="_blank" rel="noopener">è§Wiki</a></p>
<h2 id="è®²æ•…äº‹"><a href="#è®²æ•…äº‹" class="headerlink" title="è®²æ•…äº‹"></a>è®²æ•…äº‹</h2><ul>
<li><p>èƒŒæ™¯</p>
<p>å‡†å¤‡å¥½å¥½é€‚åº”ä½¿ç”¨linuxæ¥ç¼–ç¨‹ï¼Œè¶ç€å‡æœŸï¼Œæ‰“ç®—å®Œå…¨ä¸å»ç¢°windowsï¼Œé‡æ–°å®‰è£…äº†åŒç³»ç»Ÿï¼Œè¿™æ¬¡ä»—ç€å†…å­˜8Gå¤Ÿç”¨ï¼Œswapåˆ†åŒºå°±ä¸è¦äº†ï¼Œå…¨éƒ¨40Géƒ½æŒ‚åˆ° / ç›®å½•ä¸Šã€‚</p>
</li>
<li><p>é—®é¢˜</p>
<p>è§‰å¾—è·Ÿå¤–ç•Œè”ç³»è¿˜æ˜¯æŒºé‡è¦çš„ï¼Œè™½ç„¶QQå¯ä»¥æŒ‚åœ¨æ‰‹æœºä¸Šï¼Œä½†æ˜¯ç”¨ç€linuxè¦åˆ†äº«ä¸ªé“¾æ¥ä»€ä¹ˆçš„éº»çƒ¦çš„è¦æ­»ï¼Œæ²¡æ³•å¥½å¥½èŠå¤©å•Šã€‚</p>
</li>
<li><p>Telegram</p>
<p>çœ‹åˆ«äººç”¨ç€Telegramå¥½å¥½çš„ï¼Œå¯æ˜¯åˆ°æˆ‘æƒ³ç”¨æ—¶ï¼ŒGFWå°±è®©å®ƒå¤±è”äº†ã€‚è€Œä¸”ä¸ºäº†æ‰¾äººèŠå¤©è®©åˆ«äººåœ¨è£…ä¸ªè½¯ä»¶ä¹Ÿéº»çƒ¦ã€‚</p>
</li>
<li><p>IRC</p>
<p>ç¬¬ä¸€æ¬¡è§IRCè¿˜æ˜¯ä¸Šæ¬¡æ•´è¶Šç‹±çš„è€iTouchæ—¶ï¼Œæœèµ„æ–™å¶ç„¶å‘ç°äº†Kiwi IRCã€‚æ­£å¥½æ˜¯å¼€æºçš„ï¼Œè¿™æ¬¡æ‹¿æ¥ç»ƒæ‰‹ã€‚</p>
</li>
</ul>
<h2 id="è¯´æ­£äº‹"><a href="#è¯´æ­£äº‹" class="headerlink" title="è¯´æ­£äº‹"></a>è¯´æ­£äº‹</h2><p>å…¶å®å®‰è£…è¿‡ç¨‹å®˜æ–¹ç»™çš„å¤ªè¯¦ç»†äº†ï¼Œæ²¡ä»€ä¹ˆå¥½è¯´çš„ (-_-|||</p>
<p>Kiwiçš„å®‰è£…è¿‡ç¨‹å‚è€ƒå®˜æ–¹æ•™ç¨‹ï¼š</p>
<p><a href="https://kiwiirc.com/docs/installing" target="_blank" rel="noopener">ä¼ é€é—¨</a></p>
<p>åŠ¡å¿…å…ˆè£…å¥½ openssl å’Œ openssl-dev | openssl-devel</p>
<p>å‚è€ƒå¦ä¸€æ¬¾è€ç‰ŒIRC ï¼ˆUnrealIRCdï¼‰çš„å®‰è£…ï¼Œå°±å¯ä»¥ç†è§£é…ç½®æ–‡ä»¶çš„è®¾ç½®ï¼Œä¸‹é¢æ¨èä¸¤ä¸ªåšå®¢</p>
<p><a href="https://www.dadclab.com/archives/6007.jiecao" target="_blank" rel="noopener">åšå®¢1</a> <a href="http://soft.dog/2016/03/25/unrealircd-basic/" target="_blank" rel="noopener">åšå®¢2</a></p>
<h2 id="è®²åºŸè¯"><a href="#è®²åºŸè¯" class="headerlink" title="è®²åºŸè¯"></a>è®²åºŸè¯</h2><p>ä¸ºä»€ä¹ˆæˆ‘ä¸ç”¨ UnrealIRCd å‘¢ï¼Ÿå› ä¸ºåªæœ‰ä¸€ä¸ªæœåŠ¡ç«¯ï¼Œå®¢æˆ·ç«¯è¿˜è¦è‡ªå·±å¦å¤–æ‰¾ã€‚</p>
<p>Kiwi IRC çš„æ˜“ç”¨åœ¨äºï¼Œå®ƒæŠŠæœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯æ•´åˆäº†ï¼Œåœ¨äº‘ä¸»æœºä¸Šè£…å¥½åï¼Œç›´æ¥ä»ç«¯å£è¿›å…¥å®¢æˆ·ç«¯ï¼Œç›´æ¥è¿æ¥å¦ä¸€ç«¯å£çš„æœåŠ¡ç«¯ã€‚</p>
<p><del>å»çœ‹çœ‹æœ¬ç«™çš„èŠå¤©å®¤å§ï¼š <a href="#missing">Chatting Room</a></del></p>
<blockquote>
<p>æ¥è‡ª2018/10/29ï¼šâ€œ æ”¾å¼ƒ Windowsâ€¦ Steam on linuxâ€¦ çœŸé¦™~ â€</p>
</blockquote>
]]></content>
      <categories>
        <category>Linux</category>
      </categories>
      <tags>
        <tag>Linux</tag>
        <tag>IRC</tag>
      </tags>
  </entry>
  <entry>
    <title>ä¸€ç‚¹æ•°æ®åº“ç¬”è®°</title>
    <url>/2017/01/03/%E4%B8%80%E7%82%B9%E6%95%B0%E6%8D%AE%E5%BA%93%E7%AC%94%E8%AE%B0/</url>
    <content><![CDATA[<blockquote>
<p>Markdown æ˜¯ä¸ªå¥½ä¸œè¥¿ï¼Œç”¨äº†ä¸€æ®µæ—¶é—´ï¼Œè¿™æ¬¡æŠŠè‡ªå·±ä¸€ç‚¹æ•°æ®åº“è¯¾çš„ç¬”è®°æ”¾ä¸Šæ¥ï¼Œç»ƒä¹ ä¸‹ Markdown ã€‚</p>
</blockquote>
<a id="more"></a>
<h1 id="å‡½æ•°ä»‹ç»"><a href="#å‡½æ•°ä»‹ç»" class="headerlink" title="å‡½æ•°ä»‹ç»"></a>å‡½æ•°ä»‹ç»</h1><h2 id="æ•°æ®è¯­å¥"><a href="#æ•°æ®è¯­å¥" class="headerlink" title="æ•°æ®è¯­å¥"></a>æ•°æ®è¯­å¥</h2><ul>
<li>DECLARE <em>å£°æ˜è‹¥å¹²å±€éƒ¨å˜é‡</em></li>
<li>SET <em>ä¸€ä¸ªå˜é‡èµ‹å€¼</em></li>
<li>SELECT <em>å¤šä¸ªå˜é‡èµ‹å€¼</em></li>
<li>PRINT <em>è¿”å›ç”¨æˆ·è‡ªå®šä¹‰ä¿¡æ¯</em></li>
</ul>
<h2 id="å¾ªç¯æ§åˆ¶è¯­å¥"><a href="#å¾ªç¯æ§åˆ¶è¯­å¥" class="headerlink" title="å¾ªç¯æ§åˆ¶è¯­å¥"></a>å¾ªç¯æ§åˆ¶è¯­å¥</h2><ul>
<li><p>BEGIN END <em>è¯­å¥å—</em></p>
</li>
<li><p>GOTO <em>è·³è½¬åˆ°æ ‡ç­¾</em></p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line"><span class="keyword">GOTO</span> <span class="keyword">skip</span></span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> student</span><br><span class="line"><span class="keyword">skip</span>:</span><br><span class="line">PRINT <span class="string">'hello'</span></span><br><span class="line"><span class="keyword">END</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>IF ELSE <em>æ¡ä»¶åˆ¤æ–­</em></p>
</li>
<li><p>CASE <em>å¤šåˆ†æ”¯é€‰æ‹©</em></p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> score,</span><br><span class="line">(<span class="keyword">case</span></span><br><span class="line"><span class="keyword">when</span> score &gt; <span class="number">90</span> <span class="keyword">then</span> <span class="string">'excellent'</span></span><br><span class="line"><span class="keyword">when</span> score &gt; <span class="number">80</span> <span class="keyword">then</span> <span class="string">'good'</span></span><br><span class="line"><span class="keyword">when</span> score &gt; <span class="number">60</span> <span class="keyword">then</span> <span class="string">'ok'</span></span><br><span class="line"><span class="keyword">else</span> <span class="string">'not well'</span></span><br><span class="line"><span class="keyword">end</span>) <span class="keyword">as</span> rate</span><br><span class="line"><span class="keyword">from</span> student</span><br></pre></td></tr></table></figure>
</li>
<li><p>WHILE _å¾ªç¯_</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">while</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line"><span class="comment">--code here</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>WAITFOR _æš‚åœ_</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">WAITFOR DELAY '11:00'</span><br><span class="line">WAITFOR TIME '01:00'</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="èšåˆå‡½æ•°"><a href="#èšåˆå‡½æ•°" class="headerlink" title="èšåˆå‡½æ•°"></a>èšåˆå‡½æ•°</h2><ul>
<li>AVG</li>
<li>COUNT</li>
<li>MAX</li>
<li>MIN</li>
<li>SUM</li>
<li>DISTINCT</li>
</ul>
<h2 id="æ•°å­¦å‡½æ•°"><a href="#æ•°å­¦å‡½æ•°" class="headerlink" title="æ•°å­¦å‡½æ•°"></a>æ•°å­¦å‡½æ•°</h2><ul>
<li>ABS <em>ç»å¯¹å€¼</em></li>
<li>ceiling <em>å¤§äºæˆ–ç­‰äº</em></li>
<li>floor <em>å°äºæˆ–ç­‰äº</em></li>
<li>rand <em>è¿”å›0-1çš„éšæœºæ•°</em></li>
<li>round <em>å››èˆäº”å…¥åˆ°æŒ‡å®šç²¾åº¦</em></li>
</ul>
<h2 id="å­—ç¬¦ä¸²å‡½æ•°"><a href="#å­—ç¬¦ä¸²å‡½æ•°" class="headerlink" title="å­—ç¬¦ä¸²å‡½æ•°"></a>å­—ç¬¦ä¸²å‡½æ•°</h2><ul>
<li>ascii <em>ç¬¬ä¸€å­—ç¬¦çš„asciiå€¼</em></li>
<li>char <em>è¿”å›asciiå¯¹åº”å­—ç¬¦</em></li>
<li>charindex <em>è¿”å›åŒ¹é…ä½ç½®</em></li>
<li>itrim <em>å»é™¤å·¦ç©ºæ ¼</em></li>
<li>rtrim <em>å»é™¤å³ç©ºæ ¼</em></li>
<li>left <em>æˆªæ–­å·¦ä¾§æŒ‡å®šé•¿åº¦å­—ç¬¦</em></li>
<li>right <em>æˆªæ–­å³ä¾§æŒ‡å®šé•¿åº¦å­—ç¬¦</em></li>
<li>len <em>è¿”å›é•¿åº¦</em></li>
<li>lower _å°å†™_</li>
<li>upper _å¤§å†™_</li>
<li>reverse _è½¬ç½®_</li>
<li>replace <em>æŒ‡å®šå­—ç¬¦æ›¿æ¢</em></li>
<li>space <em>æŒ‡å®šç©ºæ ¼æ•°</em></li>
<li>stuff <em>æ›¿æ¢å­—ç¬¦ä¸²çš„æŒ‡å®šèŒƒå›´</em></li>
<li>substring <em>è¿”å›æŒ‡å®šèŒƒå›´å­—ç¬¦ä¸²</em></li>
</ul>
<h2 id="æ—¥æœŸå’Œæ—¶é—´å‡½æ•°"><a href="#æ—¥æœŸå’Œæ—¶é—´å‡½æ•°" class="headerlink" title="æ—¥æœŸå’Œæ—¶é—´å‡½æ•°"></a>æ—¥æœŸå’Œæ—¶é—´å‡½æ•°</h2><ul>
<li>dateadd <em>ç»™æŒ‡å®šæ—¥æœŸæ·»åŠ ä¸€æ®µæ—¶é—´</em></li>
<li>datediff <em>ä¸¤æ—¥æœŸç›¸å‡</em></li>
<li>datename <em>è¿”å›æŒ‡å®šæ—¥æœŸçš„éƒ¨åˆ†</em></li>
<li>day <em>æŒ‡å®šæ—¥æœŸçš„å¤©æ•°</em></li>
<li>dayofyear <em>å¹´å†…å¤©æ•°</em></li>
<li>month <em>è¿”å›æ—¥æœŸçš„æœˆä»½</em></li>
<li>year <em>è¿”å›æ—¥æœŸçš„å¹´ä»½</em></li>
<li>getdate <em>è¿”å›ç³»ç»Ÿæ—¶é—´</em></li>
<li>datepart <em>è¿”å›æŒ‡å®šéƒ¨åˆ†æ•´æ•°</em></li>
<li>isDate <em>æ£€æµ‹æ—¥æœŸæœ‰æ•ˆæ€§</em></li>
</ul>
<h1 id="è¯­å¥æå‡"><a href="#è¯­å¥æå‡" class="headerlink" title="è¯­å¥æå‡"></a>è¯­å¥æå‡</h1><h2 id="çº¦æŸä¸è§„åˆ™"><a href="#çº¦æŸä¸è§„åˆ™" class="headerlink" title="çº¦æŸä¸è§„åˆ™"></a>çº¦æŸä¸è§„åˆ™</h2><h3 id="è§„åˆ™"><a href="#è§„åˆ™" class="headerlink" title="è§„åˆ™"></a>è§„åˆ™</h3><ol>
<li>è§„åˆ™åªå…è®¸åœ¨å½“å‰æ•°æ®åº“åˆ›å»º</li>
<li>è§„åˆ™ä¸èƒ½ç»‘å®šåˆ°æ•°æ®ç±»å‹ charã€ intã€ imageã€ text ä¸­</li>
</ol>
<ul>
<li>åˆ›å»ºè§„åˆ™</li>
</ul>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">create</span> rule è§„åˆ™å</span><br><span class="line"><span class="keyword">as</span> è§„åˆ™</span><br><span class="line"><span class="comment">/* è§„åˆ™å¯ä»¥æ˜¯whereè¯­å¥ä»»ä½•æœ‰æ•ˆçš„è¡¨è¾¾å¼ */</span></span><br></pre></td></tr></table></figure>
<ul>
<li>ç»‘å®šè§„åˆ™</li>
</ul>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">use</span> æ•°æ®åº“å</span><br><span class="line">exec sp_bindrule <span class="string">'è§„åˆ™å'</span>,<span class="string">'æ•°æ®åº“è¡¨å­—æ®µ'</span></span><br></pre></td></tr></table></figure>
<ul>
<li>è§£ç»‘è§„åˆ™</li>
</ul>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">use</span> æ•°æ®åº“å</span><br><span class="line">exec sp_unbindrule <span class="string">'æ•°æ®åº“è¡¨å­—æ®µ'</span></span><br></pre></td></tr></table></figure>
<ul>
<li>åˆ é™¤è§„åˆ™</li>
</ul>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">drop</span> rule <span class="string">'è§„åˆ™å'</span></span><br></pre></td></tr></table></figure>
<h3 id="çº¦æŸ"><a href="#çº¦æŸ" class="headerlink" title="çº¦æŸ"></a>çº¦æŸ</h3><ul>
<li>æ·»åŠ checkçº¦æŸ</li>
</ul>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> è¡¨å</span><br><span class="line"><span class="keyword">add</span> [<span class="keyword">constraint</span> çº¦æŸå] <span class="keyword">check</span>(çº¦æŸ)</span><br></pre></td></tr></table></figure>
<ul>
<li>åˆ é™¤checkçº¦æŸ</li>
</ul>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> è¡¨å</span><br><span class="line"><span class="keyword">drop</span> <span class="keyword">constraint</span> çº¦æŸå</span><br></pre></td></tr></table></figure>
<h3 id="åŒºåˆ«"><a href="#åŒºåˆ«" class="headerlink" title="åŒºåˆ«"></a>åŒºåˆ«</h3><ol>
<li>çº¦æŸå’Œè¡¨çš„å®šä¹‰è”ç³»ï¼Œåˆ é™¤è¡¨çš„åŒæ—¶çº¦æŸä¹Ÿåˆ é™¤ã€‚è§„åˆ™æ˜¯å•ç‹¬å­˜å‚¨çš„æ•°æ®åº“å¯¹è±¡ï¼Œç‹¬ç«‹äºè¡¨å¤–ï¼Œåˆ é™¤è¡¨æ—¶å¹¶ä¸èƒ½åˆ é™¤è§„åˆ™ã€‚</li>
<li>ä¸€ä¸ªå­—æ®µå¯æœ‰å¤šä¸ªçº¦æŸï¼Œä½†åªèƒ½æœ‰ä¸€ä¸ªè§„åˆ™ã€‚</li>
</ol>
<h2 id="SELECTé«˜çº§æŸ¥è¯¢"><a href="#SELECTé«˜çº§æŸ¥è¯¢" class="headerlink" title="SELECTé«˜çº§æŸ¥è¯¢"></a>SELECTé«˜çº§æŸ¥è¯¢</h2><h3 id="IN-NULL"><a href="#IN-NULL" class="headerlink" title="IN, NULL"></a>IN, NULL</h3><ul>
<li>IN <em>æŸ¥è¯¢ç¬¦åˆåˆ—è¡¨ä¸­ä»»ä½•ä¸€ä¸ªå€¼çš„è®°å½•</em></li>
</ul>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> table1 <span class="keyword">where</span> score <span class="keyword">in</span> (<span class="number">70</span>,<span class="number">80</span>,<span class="number">90</span>);</span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> table2 <span class="keyword">where</span> score <span class="keyword">in</span> (<span class="keyword">select</span> score <span class="keyword">from</span> table1);</span><br></pre></td></tr></table></figure>
<ul>
<li>NULL | NOT NULL <em>å­—æ®µæ˜¯å¦ä¸ºç©º</em></li>
</ul>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> table1 <span class="keyword">where</span> items <span class="keyword">in</span> <span class="literal">null</span>;</span><br></pre></td></tr></table></figure>
<h3 id="SELECT"><a href="#SELECT" class="headerlink" title="SELECT"></a>SELECT</h3><blockquote>
<p>ç”¨äºå°†æŸ¥è¯¢ç»“æœå­˜å‚¨åˆ°å¦ä¸€ä¸ªè¡¨</p>
</blockquote>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> top <span class="number">5</span> *</span><br><span class="line"><span class="keyword">into</span> table3</span><br><span class="line"><span class="keyword">from</span> table2;</span><br></pre></td></tr></table></figure>
<h3 id="GROUP-BY"><a href="#GROUP-BY" class="headerlink" title="GROUP BY"></a>GROUP BY</h3><blockquote>
<p>ç”¨äºæ•°æ®æ±‡æ€»</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">select name,avg(age) as avg_age</span><br><span class="line">from student</span><br><span class="line">group by name;</span><br></pre></td></tr></table></figure>
<h2 id="åµŒå¥—æŸ¥è¯¢"><a href="#åµŒå¥—æŸ¥è¯¢" class="headerlink" title="åµŒå¥—æŸ¥è¯¢"></a>åµŒå¥—æŸ¥è¯¢</h2><ul>
<li>å­æŸ¥è¯¢ä½œä¸ºæ–°å¢åˆ— <em>ä½œä¸ºå¤–å±‚selectè¯­å¥çš„åˆ—å€¼</em></li>
</ul>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> avg_score = (</span><br><span class="line"><span class="keyword">select</span> <span class="keyword">avg</span>(score)</span><br><span class="line">  <span class="keyword">from</span> score</span><br><span class="line">)<span class="keyword">from</span> score</span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> score.id;</span><br></pre></td></tr></table></figure>
<ul>
<li>ä½¿ç”¨INå…³é”®å­— <em>ä¸»è¦ç”¨äºwhereå­å¥åé¢çš„å­æŸ¥è¯¢ã€‚</em></li>
</ul>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> a.name</span><br><span class="line"><span class="keyword">from</span> student <span class="keyword">as</span> a</span><br><span class="line"><span class="keyword">where</span> a.id <span class="keyword">in</span>(</span><br><span class="line"><span class="keyword">select</span> b.id</span><br><span class="line">  <span class="keyword">from</span> score <span class="keyword">as</span> b</span><br><span class="line"><span class="keyword">where</span> b.score = <span class="number">80</span></span><br><span class="line">)<span class="keyword">order</span> <span class="keyword">by</span> a.id;</span><br></pre></td></tr></table></figure>
<ul>
<li>æ¯”è¾ƒè¿ç®—ç¬¦</li>
</ul>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> a.name</span><br><span class="line"><span class="keyword">from</span> student <span class="keyword">as</span> a</span><br><span class="line"><span class="keyword">where</span> a.id <span class="keyword">in</span>(</span><br><span class="line"><span class="keyword">select</span> b.id</span><br><span class="line"><span class="keyword">from</span> score <span class="keyword">as</span> b</span><br><span class="line"><span class="keyword">where</span> b.score &lt;= <span class="number">80</span></span><br><span class="line">) <span class="keyword">order</span> <span class="keyword">by</span> a.id;</span><br></pre></td></tr></table></figure>
<ul>
<li>BETWEEN</li>
</ul>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> a.name</span><br><span class="line"><span class="keyword">from</span> student <span class="keyword">as</span> a</span><br><span class="line"><span class="keyword">where</span> a.id <span class="keyword">in</span>(</span><br><span class="line"><span class="keyword">select</span> b.id </span><br><span class="line"><span class="keyword">from</span> score <span class="keyword">as</span> b</span><br><span class="line"><span class="keyword">where</span> b.score</span><br><span class="line"><span class="keyword">between</span> <span class="number">80</span> <span class="keyword">and</span> <span class="number">90</span></span><br><span class="line">) <span class="keyword">order</span> <span class="keyword">by</span> a.id;</span><br></pre></td></tr></table></figure>
<ul>
<li>EXISTS</li>
</ul>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> *</span><br><span class="line"><span class="keyword">from</span> table1</span><br><span class="line"><span class="keyword">where</span> <span class="keyword">exists</span>(</span><br><span class="line"><span class="keyword">select</span> score</span><br><span class="line"><span class="keyword">from</span> table1</span><br><span class="line"><span class="keyword">where</span> score = <span class="number">80</span>)</span><br><span class="line"><span class="comment">/* INå’ŒEXISTSéƒ½ä»£è¡¨çš„æ˜¯å­æŸ¥è¯¢å­˜åœ¨æŸä¸ªå€¼ï¼Œä½†æ˜¯INç”¨çš„æ—¶å€™ï¼Œå­æŸ¥è¯¢åªèƒ½æ˜¯ä¸€ä¸ªå­—æ®µï¼Œä½†æ˜¯EXISTSå¯ä»¥ç”¨å¤šä¸ªå­—æ®µã€‚ */</span></span><br></pre></td></tr></table></figure>
<h2 id="å¤šè¡¨è¿æ¥"><a href="#å¤šè¡¨è¿æ¥" class="headerlink" title="å¤šè¡¨è¿æ¥"></a>å¤šè¡¨è¿æ¥</h2><h3 id="JOINâ€¦ON"><a href="#JOINâ€¦ON" class="headerlink" title="JOINâ€¦ON"></a>JOINâ€¦ON</h3><h4 id="ä¸¾ä¾‹"><a href="#ä¸¾ä¾‹" class="headerlink" title="ä¸¾ä¾‹"></a>ä¸¾ä¾‹</h4><ul>
<li>è¡¨A</li>
</ul>
<table>
<thead>
<tr>
<th style="text-align:center">snum</th>
<th style="text-align:center">name</th>
<th style="text-align:center">age</th>
<th style="text-align:center">sex</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">1</td>
<td style="text-align:center">AA</td>
<td style="text-align:center">12</td>
<td style="text-align:center">M</td>
</tr>
<tr>
<td style="text-align:center">2</td>
<td style="text-align:center">BB</td>
<td style="text-align:center">13</td>
<td style="text-align:center">F</td>
</tr>
<tr>
<td style="text-align:center">3</td>
<td style="text-align:center">CC</td>
<td style="text-align:center">24</td>
<td style="text-align:center">M</td>
</tr>
<tr>
<td style="text-align:center">4</td>
<td style="text-align:center">DD</td>
<td style="text-align:center">21</td>
<td style="text-align:center">F</td>
</tr>
</tbody>
</table>
<ul>
<li>è¡¨B</li>
</ul>
<table>
<thead>
<tr>
<th style="text-align:center">snum</th>
<th style="text-align:center">score</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">1</td>
<td style="text-align:center">10</td>
</tr>
<tr>
<td style="text-align:center">2</td>
<td style="text-align:center">20</td>
</tr>
<tr>
<td style="text-align:center">5</td>
<td style="text-align:center">40</td>
</tr>
</tbody>
</table>
<h4 id="inner-join"><a href="#inner-join" class="headerlink" title="inner join"></a>inner join</h4><table>
<thead>
<tr>
<th style="text-align:center">snum</th>
<th style="text-align:center">name</th>
<th style="text-align:center">age</th>
<th style="text-align:center">sex</th>
<th style="text-align:center">snum</th>
<th style="text-align:center">score</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">1</td>
<td style="text-align:center">AA</td>
<td style="text-align:center">12</td>
<td style="text-align:center">M</td>
<td style="text-align:center">1</td>
<td style="text-align:center">10</td>
</tr>
<tr>
<td style="text-align:center">2</td>
<td style="text-align:center">BB</td>
<td style="text-align:center">13</td>
<td style="text-align:center">F</td>
<td style="text-align:center">2</td>
<td style="text-align:center">20</td>
</tr>
</tbody>
</table>
<h4 id="left-join"><a href="#left-join" class="headerlink" title="left join"></a>left join</h4><table>
<thead>
<tr>
<th style="text-align:center">snum</th>
<th style="text-align:center">name</th>
<th style="text-align:center">age</th>
<th style="text-align:center">sex</th>
<th style="text-align:center">snum</th>
<th style="text-align:center">score</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">1</td>
<td style="text-align:center">AA</td>
<td style="text-align:center">12</td>
<td style="text-align:center">M</td>
<td style="text-align:center">1</td>
<td style="text-align:center">10</td>
</tr>
<tr>
<td style="text-align:center">2</td>
<td style="text-align:center">BB</td>
<td style="text-align:center">13</td>
<td style="text-align:center">F</td>
<td style="text-align:center">2</td>
<td style="text-align:center">20</td>
</tr>
<tr>
<td style="text-align:center">3</td>
<td style="text-align:center">CC</td>
<td style="text-align:center">24</td>
<td style="text-align:center">M</td>
<td style="text-align:center">null</td>
<td style="text-align:center">null</td>
</tr>
<tr>
<td style="text-align:center">4</td>
<td style="text-align:center">DD</td>
<td style="text-align:center">21</td>
<td style="text-align:center">F</td>
<td style="text-align:center">null</td>
<td style="text-align:center">null</td>
</tr>
</tbody>
</table>
<h4 id="right-join"><a href="#right-join" class="headerlink" title="right join"></a>right join</h4><table>
<thead>
<tr>
<th style="text-align:center">snum</th>
<th style="text-align:center">score</th>
<th style="text-align:center">snum</th>
<th style="text-align:center">name</th>
<th style="text-align:center">age</th>
<th style="text-align:center">sex</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">1</td>
<td style="text-align:center">10</td>
<td style="text-align:center">1</td>
<td style="text-align:center">AA</td>
<td style="text-align:center">12</td>
<td style="text-align:center">M</td>
</tr>
<tr>
<td style="text-align:center">2</td>
<td style="text-align:center">20</td>
<td style="text-align:center">2</td>
<td style="text-align:center">BB</td>
<td style="text-align:center">13</td>
<td style="text-align:center">F</td>
</tr>
<tr>
<td style="text-align:center">5</td>
<td style="text-align:center">40</td>
<td style="text-align:center">null</td>
<td style="text-align:center">null</td>
<td style="text-align:center">null</td>
<td style="text-align:center">null</td>
</tr>
</tbody>
</table>
<h4 id="full-join"><a href="#full-join" class="headerlink" title="full join"></a>full join</h4><table>
<thead>
<tr>
<th style="text-align:center">snum</th>
<th style="text-align:center">name</th>
<th style="text-align:center">age</th>
<th style="text-align:center">sex</th>
<th style="text-align:center">snum</th>
<th style="text-align:center">score</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">1</td>
<td style="text-align:center">AA</td>
<td style="text-align:center">12</td>
<td style="text-align:center">M</td>
<td style="text-align:center">1</td>
<td style="text-align:center">10</td>
</tr>
<tr>
<td style="text-align:center">2</td>
<td style="text-align:center">BB</td>
<td style="text-align:center">13</td>
<td style="text-align:center">F</td>
<td style="text-align:center">2</td>
<td style="text-align:center">20</td>
</tr>
<tr>
<td style="text-align:center">3</td>
<td style="text-align:center">CC</td>
<td style="text-align:center">24</td>
<td style="text-align:center">M</td>
<td style="text-align:center">null</td>
<td style="text-align:center">null</td>
</tr>
<tr>
<td style="text-align:center">4</td>
<td style="text-align:center">DD</td>
<td style="text-align:center">21</td>
<td style="text-align:center">F</td>
<td style="text-align:center">null</td>
<td style="text-align:center">null</td>
</tr>
<tr>
<td style="text-align:center">null</td>
<td style="text-align:center">null</td>
<td style="text-align:center">null</td>
<td style="text-align:center">null</td>
<td style="text-align:center">5</td>
<td style="text-align:center">40</td>
</tr>
</tbody>
</table>
<h3 id="UNION"><a href="#UNION" class="headerlink" title="UNION"></a>UNION</h3><blockquote>
<p>æ‹¼æ¥å­—æ®µç›¸åŒçš„è¡¨</p>
</blockquote>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> student <span class="keyword">as</span> a</span><br><span class="line"><span class="keyword">union</span></span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> student <span class="keyword">as</span> b</span><br></pre></td></tr></table></figure>
<h3 id="æ•°æ®æ“çºµè¿›é˜¶"><a href="#æ•°æ®æ“çºµè¿›é˜¶" class="headerlink" title="æ•°æ®æ“çºµè¿›é˜¶"></a>æ•°æ®æ“çºµè¿›é˜¶</h3><h2 id="insert"><a href="#insert" class="headerlink" title="insert"></a>insert</h2><h3 id="æ’å…¥å¤šè¡Œ"><a href="#æ’å…¥å¤šè¡Œ" class="headerlink" title="æ’å…¥å¤šè¡Œ"></a>æ’å…¥å¤šè¡Œ</h3><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> table2</span><br><span class="line"><span class="keyword">select</span> <span class="keyword">name</span>,sex,phone,email</span><br><span class="line"><span class="keyword">from</span> table2</span><br></pre></td></tr></table></figure>
<h3 id="select-â€¦-into"><a href="#select-â€¦-into" class="headerlink" title="select â€¦ into"></a>select â€¦ into</h3><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">into</span> table1 <span class="keyword">from</span> table2</span><br></pre></td></tr></table></figure>
<h2 id="update"><a href="#update" class="headerlink" title="update"></a>update</h2><h3 id="åŸºäºçº§è”"><a href="#åŸºäºçº§è”" class="headerlink" title="åŸºäºçº§è”"></a>åŸºäºçº§è”</h3><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">update</span> table1 <span class="keyword">set</span> table1.c = table2.c</span><br><span class="line"><span class="keyword">from</span> table1 <span class="keyword">inner</span> <span class="keyword">join</span> table2</span><br><span class="line"><span class="keyword">on</span> table1.a = table2.a</span><br><span class="line"><span class="keyword">where</span> table1.c <span class="keyword">is</span> <span class="literal">null</span></span><br></pre></td></tr></table></figure>
<h3 id="å¸¦æœ‰output"><a href="#å¸¦æœ‰output" class="headerlink" title="å¸¦æœ‰output"></a>å¸¦æœ‰output</h3><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">-- æŸ¥è¯¢æ–°è¡Œçš„å±æ€§</span></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> table1(a) <span class="keyword">output</span> inserted.a <span class="keyword">values</span>(<span class="string">'123'</span>)</span><br><span class="line"><span class="comment">-- æŸ¥è¯¢æ—§è¡Œçš„å±æ€§</span></span><br><span class="line"><span class="keyword">delete</span> <span class="keyword">into</span> table1 <span class="keyword">output</span> deleted.a <span class="keyword">where</span> a = <span class="string">'123'</span></span><br><span class="line"><span class="comment">-- è¿”å›ä¿®æ”¹åçš„å€¼</span></span><br><span class="line"><span class="keyword">update</span> table1 <span class="keyword">set</span> a = <span class="string">'b'</span> <span class="keyword">output</span> inserted.a <span class="keyword">where</span> a = <span class="string">'123'</span></span><br><span class="line"><span class="comment">-- è¿”å›ä¿®æ”¹å‰çš„å€¼</span></span><br><span class="line"><span class="keyword">update</span> table1 <span class="keyword">set</span> a = <span class="string">'b'</span> <span class="keyword">output</span> deleted.a wherer a = <span class="string">'123'</span></span><br></pre></td></tr></table></figure>
<h1 id="è§†å›¾ã€ç´¢å¼•ã€è§¦å‘å™¨"><a href="#è§†å›¾ã€ç´¢å¼•ã€è§¦å‘å™¨" class="headerlink" title="è§†å›¾ã€ç´¢å¼•ã€è§¦å‘å™¨"></a>è§†å›¾ã€ç´¢å¼•ã€è§¦å‘å™¨</h1><h2 id="è§†å›¾"><a href="#è§†å›¾" class="headerlink" title="è§†å›¾"></a>è§†å›¾</h2><ul>
<li>åˆ›å»ºè§†å›¾</li>
</ul>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">view</span> è§†å›¾å</span><br><span class="line"><span class="keyword">as</span></span><br><span class="line"><span class="keyword">select</span>è¯­å¥</span><br></pre></td></tr></table></figure>
<ul>
<li>è§†å›¾ç»“æœé›†æ’åº</li>
</ul>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">view</span> stu1</span><br><span class="line"><span class="keyword">as</span></span><br><span class="line"><span class="keyword">select</span> top <span class="number">3</span> * <span class="keyword">from</span> table2</span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> <span class="keyword">id</span></span><br></pre></td></tr></table></figure>
<ul>
<li>å¤šå¼ è¡¨è¿›è¡Œè§†å›¾æŸ¥è¯¢</li>
</ul>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">view</span> stu2</span><br><span class="line"><span class="keyword">as</span></span><br><span class="line"><span class="keyword">select</span> b.score,b.name,a.name,sex,age</span><br><span class="line"><span class="keyword">from</span> student <span class="keyword">as</span> a</span><br><span class="line"><span class="keyword">inner</span> <span class="keyword">join</span></span><br><span class="line">score <span class="keyword">as</span> b</span><br><span class="line"><span class="keyword">on</span> a.id = b.id</span><br></pre></td></tr></table></figure>
<ul>
<li>ä¿®æ”¹è§†å›¾</li>
</ul>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">alter</span> <span class="keyword">view</span> è§†å›¾å</span><br><span class="line"><span class="keyword">as</span></span><br><span class="line"><span class="keyword">select</span>è¯­å¥</span><br></pre></td></tr></table></figure>
<ul>
<li>åˆ é™¤è§†å›¾</li>
</ul>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">drop</span> <span class="keyword">view</span> è§†å›¾å</span><br></pre></td></tr></table></figure>
<h3 id="å¢åˆ æ”¹"><a href="#å¢åˆ æ”¹" class="headerlink" title="å¢åˆ æ”¹"></a>å¢åˆ æ”¹</h3><ol>
<li>è§†å›¾å¯ä»¥å¯¹åŸºæœ¬è¡¨çš„æ•°æ®è¿›è¡ŒæŸ¥è¯¢ï¼Œè¿˜å¯ä»¥å‘åŸºæœ¬è¡¨å¢åˆ æ”¹</li>
<li>select å­å¥ä¸å¯ç”¨èšåˆå‡½æ•°</li>
<li>ä¸èƒ½åŒ…å«ç®—å¼è¡¨è¾¾å¼ç»“æœçš„åˆ—</li>
<li>è§†å›¾å¼•ç”¨å¤šè¡¨ï¼Œæ— æ³•ä½¿ç”¨delete</li>
</ol>
<h2 id="ç´¢å¼•"><a href="#ç´¢å¼•" class="headerlink" title="ç´¢å¼•"></a>ç´¢å¼•</h2><h3 id="ä¼˜ç‚¹"><a href="#ä¼˜ç‚¹" class="headerlink" title="ä¼˜ç‚¹"></a>ä¼˜ç‚¹</h3><ol>
<li>é€šè¿‡åˆ›å»ºå”¯ä¸€ç´¢å¼•ï¼Œå¯ä»¥ä¿è¯æ•°æ®è®°å½•çš„å”¯ä¸€æ€§ã€‚</li>
<li>å¯ä»¥å¤§å¤§åŠ å¿«æ•°æ®æ£€ç´¢é€Ÿåº¦ã€‚</li>
<li>å¯ä»¥åŠ é€Ÿè¡¨ä¸è¡¨ä¹‹é—´çš„è¿æ¥ï¼Œè¿™ä¸€ç‚¹åœ¨å®ç°æ•°æ®çš„å‚ç…§å®Œæ•´æ€§æ–¹é¢æœ‰ç‰¹åˆ«çš„æ„ä¹‰ã€‚</li>
<li>åœ¨ä½¿ç”¨order byå’Œgroup byå­å¥ä¸­è¿›è¡Œæ£€ç´¢æ•°æ®æ—¶ï¼Œå¯ä»¥æ˜¾è‘—å‡å°‘æŸ¥è¯¢ä¸­åˆ†ç»„å’Œæ’åºçš„æ—¶é—´ã€‚</li>
<li>ä½¿ç”¨ç´¢å¼•å¯ä»¥åœ¨æ£€ç´¢æ•°æ®çš„è¿‡ç¨‹ä¸­ä½¿ç”¨ä¼˜åŒ–éšè—ï¼Œæé«˜ç³»ç»Ÿæ€§èƒ½ã€‚</li>
</ol>
<h3 id="ç¼ºç‚¹"><a href="#ç¼ºç‚¹" class="headerlink" title="ç¼ºç‚¹"></a>ç¼ºç‚¹</h3><ol>
<li>åˆ›å»ºç´¢å¼•è¦èŠ±è´¹æ—¶é—´å’Œå ç”¨å­˜å‚¨ç©ºé—´ã€‚</li>
<li>å»ºç«‹ç´¢å¼•åŠ å¿«äº†æ•°æ®æ£€ç´¢é€Ÿåº¦ï¼Œä½†æ˜¯å‡æ…¢äº†æ•°æ®ä¿®æ”¹é€Ÿåº¦ã€‚</li>
</ol>
<h3 id="ä¸åº”åˆ›å»ºç´¢å¼•åˆ—çš„æƒ…å†µ"><a href="#ä¸åº”åˆ›å»ºç´¢å¼•åˆ—çš„æƒ…å†µ" class="headerlink" title="ä¸åº”åˆ›å»ºç´¢å¼•åˆ—çš„æƒ…å†µ"></a>ä¸åº”åˆ›å»ºç´¢å¼•åˆ—çš„æƒ…å†µ</h3><ol>
<li>å¾ˆå°‘æˆ–ä»æ¥ä¸åœ¨æŸ¥è¯¢ä¸­å¼•ç”¨çš„åˆ—ï¼Œå› ä¸ºç³»ç»Ÿå¾ˆå°‘æˆ–ä»æ¥ä¸æ ¹æ®è¿™ä¸ªåˆ—çš„å€¼å»æŸ¥æ‰¾æ•°æ®è¡Œã€‚</li>
<li>åªæœ‰ä¸¤ä¸ªæˆ–å¾ˆå°‘å‡ ä¸ªå€¼çš„åˆ—ï¼Œä¾‹å¦‚æ€§åˆ«ã€‚</li>
<li>ä»¥bitã€textã€imageæ•°æ®ç±»å‹å®šä¹‰çš„åˆ—ã€‚</li>
<li>æ•°æ®è¡Œè¾“å¾ˆå°‘çš„è¡¨ä¸€èˆ¬ä¹Ÿæ²¡æœ‰å¿…è¦åˆ›å»ºç´¢å¼•ã€‚</li>
</ol>
<h2 id="è§¦å‘å™¨"><a href="#è§¦å‘å™¨" class="headerlink" title="è§¦å‘å™¨"></a>è§¦å‘å™¨</h2><h3 id="DMLè§¦å‘å™¨"><a href="#DMLè§¦å‘å™¨" class="headerlink" title="DMLè§¦å‘å™¨"></a>DMLè§¦å‘å™¨</h3><ul>
<li>afterè§¦å‘å™¨ <em>è®°å½•æ”¹å˜åæ‰æ¿€æ´»è§¦å‘å™¨</em></li>
</ul>
<blockquote>
<p>afterè§¦å‘å™¨åŒ…æ‹¬ insertã€deleteã€updateè§¦å‘å™¨</p>
</blockquote>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">after <span class="keyword">insert</span></span><br><span class="line"><span class="keyword">as</span></span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line"><span class="keyword">SET</span> NOCOUNT <span class="keyword">ON</span>;</span><br><span class="line"><span class="comment">/* process */</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="keyword">go</span></span><br></pre></td></tr></table></figure>
<ul>
<li>instead of è§¦å‘å™¨ <em>ç›´æ¥æ‰§è¡Œè§¦å‘å™¨ï¼Œä¸æ‰§è¡Œsqlè¯­å¥</em></li>
</ul>
<blockquote>
<p>instead of è§¦å‘å™¨åŒ…æ‹¬insertã€deleteã€updateè§¦å‘å™¨</p>
</blockquote>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">instead of <span class="keyword">insert</span></span><br><span class="line"><span class="keyword">as</span></span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line"><span class="keyword">SET</span> NOCOUNT <span class="keyword">ON</span>;</span><br><span class="line"><span class="comment">/* process */</span></span><br><span class="line">if @age &gt; 25</span><br><span class="line">print 'Too old!'</span><br><span class="line">else</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> score(<span class="keyword">name</span>,age) <span class="keyword">values</span>(@<span class="keyword">name</span>,@age)</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="keyword">go</span></span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>Database</category>
      </categories>
      <tags>
        <tag>Database</tag>
        <tag>SQL</tag>
      </tags>
  </entry>
  <entry>
    <title>iPod touch ä¸Šæ­å»ºå¼€å‘ç¯å¢ƒ</title>
    <url>/2017/01/01/iPod%20touch%20%E4%B8%8A%E6%90%AD%E5%BB%BA%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83/</url>
    <content><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>è€touchåœ¨æŠ½å±‰é‡Œèººäº†å¥½å‡ å¹´ï¼Œå¶ç„¶æŠŠå®ƒç¿»å‡ºæ¥ï¼Œè¿™ä¹ˆä¸€ä¸ªPDAï¼Œç°åœ¨é¡¶å¤šç”¨æ¥å¬æ­Œï¼Œæ€ªå¯æƒœçš„ï¼Œå¥½åƒç”¨å®ƒæäº‹æƒ…å•Šã€‚</p>
<a id="more"></a>
<h1 id="æ­£é¢˜"><a href="#æ­£é¢˜" class="headerlink" title="æ­£é¢˜"></a>æ­£é¢˜</h1><p>é—²æ¥æ— äº‹googleäº†ä¸€ä¸‹â€iTouch c++â€ï¼Œå‘ç°ä¸€ä¸ªå¤§ç¥çš„åšå®¢</p>
<p><a href="http://blog.csdn.net/jackjones86/article/details/41802515" target="_blank">åšå®¢ä¼ é€é—¨</a></p>
<p>è¿™ä¹ˆè¯¦ç»†çš„æ•™ç¨‹ï¼Œå¦¥å¦¥çš„è¦åŠ¨æ‰‹è¯•ä¸€è¯•å•Šã€‚</p>
<h1 id="è¿‡ç¨‹"><a href="#è¿‡ç¨‹" class="headerlink" title="è¿‡ç¨‹"></a>è¿‡ç¨‹</h1><p>æŠ„åˆ«äººçš„æ²¡æ„æ€ï¼Œè‡ªå·±åˆä¸æ„¿å†™ï¼Œæ¯•ç«Ÿå¤§ç¥å†™å¾—å¤ªå®Œæ•´äº†ï¼</p>
<p>è™½ç„¶æœ‰äº›å°é—®é¢˜ï¼Œæˆ‘å°±è¯´è¯´æˆ‘ç¢°åˆ°çš„é—®é¢˜:</p>
<ul>
<li><p>æµ‹è¯• nic æ—¶ï¼Œè¾“å…¥nicæç¤ºæ²¡æœ‰æ‰¾åˆ°perl</p>
<p><em>è§£å†³ï¼šä¼°è®¡æ˜¯ç‰ˆæœ¬å‡çº§åå®‰è£…ä½ç½®æ”¹äº†ï¼Œä¸ºäº†ä¸å½±å“è€çš„é…ç½®æ–‡ä»¶ï¼Œç›´æ¥å»ºä¸ªè½¯é“¾æ¥è§£å†³é—®é¢˜</em></p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">ln -s /usr/<span class="built_in">local</span>/bin/perl /usr/bin/</span><br></pre></td></tr></table></figure>
</li>
<li><p>æµ‹è¯•mysqlæ—¶ï¼Œæˆ‘åœ¨è®¾ç½®é‡Œæ‰¾åŠå¤©æ²¡çœ‹åˆ°mysql</p>
<p><em>è§£å†³ï¼šåŸæ¥åšå®¢æœªæåˆ°è¦è£…mysqlï¼Œç›´æ¥åœ¨cydiaé‡Œæœç´¢å®‰è£…å°±å¥½</em></p>
</li>
</ul>
<h1 id="ç»“æœ"><a href="#ç»“æœ" class="headerlink" title="ç»“æœ"></a>ç»“æœ</h1><p><img src="IMG_0001.png" alt="IMG_0001"></p>
<p><img src="IMG_0002.png" alt="IMG_0002"></p>
<p><img src="IMG_0003.png" alt="IMG_0003"></p>
<h1 id="åè®°"><a href="#åè®°" class="headerlink" title="åè®°"></a>åè®°</h1><ul>
<li>è½»é‡çº§webserver</li>
</ul>
<p>è¯è¯´åœ¨cydiaé‡Œæœç´¢â€mysqlâ€æ—¶ï¼Œçœ‹åˆ°è¿˜æœ‰ä¸ªæœç´¢ç»“æœ â€œtouch-lighttpd-php-mysqlâ€ï¼Œè¿™ä¸ªç©æ„æœ‰è¶£äº†ï¼Œè½»é‡çº§çš„webserveræ•´åˆï¼Œæœ‰äº†å®ƒï¼Œå¯ä»¥åœ¨touché‡Œæ­ä¸ªwordpressäº†ï¼Œå“ˆå“ˆã€‚<br>å®‰è£…å¥½æ’ä»¶ï¼Œæµè§ˆå™¨è®¿é—®touchçš„ipï¼Œç²¾ç®€çš„â€is worksâ€é¡µé¢â€¦â€¦<br><img src="20170101133551.jpg" alt="20170101133551"></p>
<p>ç„¶åè£…wordpressæˆ‘å°±ä¸åœ¨è¿™è°ˆäº†ï¼Œç›´æ¥ä¸Šç»“æœ<br><img src="20170101133908.jpg" alt="20170101133908"></p>
<p>ä½†æ˜¯è£…å¥½çš„wordpressé‡åˆ°ç‚¹å°é—®é¢˜ï¼Œè¿›å…¥â€ä»ªè¡¨ç›˜â€ä¼šå‡ºç° æœåŠ¡å™¨500 é”™è¯¯ï¼Œè¿™ä¸ªè²Œä¼¼æ˜¯å†…å­˜ä¸è¶³ï¼Œå”‰~touchçš„ç¡¬ä¼¤ï¼Œå†™æ–‡ç« æ˜¯æ²¡æœ‰é—®é¢˜çš„ï¼Œæ‰€ä»¥ä¸ç®¡äº†ã€‚</p>
<ul>
<li>apt å·¥å…·</li>
</ul>
<p>æŒ‰ç…§åšå®¢è£…äº† apt çš„æ’ä»¶åï¼Œè£…å…¶ä»–æ’ä»¶å®Œå…¨å¯ä»¥å‘ç”¨ linux ä¸€æ ·çˆ½å•Š<br>ä½†æ˜¯åŒæ ·é‡åˆ°ä¸€ä¸ªå°é—®é¢˜ï¼Œæˆ‘ä½¿ç”¨ â€œsudo apt-get install XXXâ€ å®‰è£…è½¯ä»¶æ—¶ï¼Œå‡ºç°äº† â€œsegmentation fault 11â€¦â€<br>googleäº†ä¸€ç•ªï¼Œè§£å†³æ–¹æ¡ˆæ˜¯ï¼š</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">sudo rm -rf /var/cache/apt/*.bin</span><br></pre></td></tr></table></figure>
<p>å†æ¨èå¤§å®¶è£…äº›å¸¸ç”¨æ’ä»¶ï¼Œå†…å®¹è§å¦ä¸€ç¯‡çš„åšå®¢</p>
<p><a href="http://m.blog.csdn.net/article/details?id=50855627" target="_blank">åšå®¢ä¼ é€é—¨</a></p>
<h1 id="æœ€åæ„Ÿè°¢-iOS-Jailbreak"><a href="#æœ€åæ„Ÿè°¢-iOS-Jailbreak" class="headerlink" title="æœ€åæ„Ÿè°¢ iOS Jailbreak"></a>æœ€åæ„Ÿè°¢ iOS Jailbreak</h1><p><a href="https://www.reddit.com/r/jailbreak/" target="_blank">iOS Jailbreak</a></p>
]]></content>
      <categories>
        <category>é—²æ‰¯</category>
      </categories>
      <tags>
        <tag>iOS</tag>
      </tags>
  </entry>
  <entry>
    <title>å°†UWPåº”ç”¨éƒ¨ç½²åˆ°å…¶ä»–win10è®¾å¤‡</title>
    <url>/2016/12/20/%E5%B0%86UWP%E5%BA%94%E7%94%A8%E9%83%A8%E7%BD%B2%E5%88%B0%E5%85%B6%E4%BB%96win10%E8%AE%BE%E5%A4%87/</url>
    <content><![CDATA[<h2 id="What"><a href="#What" class="headerlink" title="What"></a>What</h2><p>è€å¤«æœ‰å°VenuePro8ï¼Œç³»ç»Ÿæ˜¯win10ï¼Œæ‰€ä»¥æƒ³æŠŠå®ƒä½œä¸ºUWPæµ‹è¯•æœºï¼Œä¸€ç›´ä¸çŸ¥é“æ€ä¹ˆæŠŠåº”ç”¨éƒ¨ç½²åˆ°å¹³æ¿ä¸Šã€‚</p>
<a id="more"></a>
<p>æœ€è¿‘æ‰å‘ç°ï¼ŒåŸæ¥vs2015æ—©å°±æœ‰è¿™ä¸ªåŠŸèƒ½äº†ï¼Œä¸‹é¢æ¥è®²ä¸€è®²å…·ä½“çš„æ“ä½œã€‚</p>
<h2 id="How"><a href="#How" class="headerlink" title="How"></a>How</h2><ul>
<li>é¦–å…ˆåœ¨å¼€å‘æœºä¸Šæ‰“å¼€vs2015ï¼Œæ‰“å¼€é¡¹ç›®</li>
<li>è§†çº¿å…ˆåˆ‡æ¢åˆ°win10å¹³æ¿ï¼Œcmd -&gt; ipconfig é»˜é»˜è®°ä¸‹å®ƒçš„ipï¼Œæ‰“å¼€è®¾ç½® -&gt; æ›´æ–°å’Œå®‰å…¨ -&gt; é’ˆå¯¹å¼€å‘è€… -&gt; æ‰“å¼€â€œè®¾å¤‡å‘ç°â€<br><img src="4.png" alt="4"></li>
<li>æ¥ç€å‡ºç°ä¸€ä¸ªé…å¯¹æŒ‰é’®ï¼Œç‚¹å‡»ã€‚é»˜é»˜è®°ä¸‹PINç ã€‚<br><img src="5.png" alt="5"></li>
<li>è§†çº¿åˆ‡å›å¼€å‘æœºï¼Œå³é”®vsèœå•æ åº•éƒ¨ï¼Œå‹¾ä¸Šâ€œæ ‡å‡†â€ï¼ˆé»˜è®¤é‚£ä¸ªæ˜¯å‹¾ä¸Šçš„â€¦â€¦ï¼‰<br><img src="20161220121241.jpg" alt="20161220121241"></li>
<li>é€‰æ‹©ä½ éœ€è¦çš„è§£å†³æ–¹æ¡ˆå¹³å°ï¼Œç„¶åéƒ¨ç½²è®¾å¤‡åˆ‡æ¢åˆ°è¿œç¨‹è®¡ç®—æœº<br><img src="snipaste20161220_115218.png" alt="snipaste20161220_115218"></li>
<li>è¾“å…¥å¹³æ¿çš„ipï¼Œå†ç‚¹å‡»â€œé€‰æ‹©â€ã€‚<br><img src="snipaste20161220_115923.png" alt="snipaste20161220_115923"></li>
<li>Ctrl+F5ï¼Œå¼€å§‹æ‰§è¡Œé¡¹ç›®ã€‚</li>
<li>ç¼–è¯‘è¿‡ç¨‹ä¸­ä¼šå¼¹å‡ºå¯¹è¯æ¡†ï¼Œè¦æ±‚è¾“å…¥å¦ä¸€å°ä¸»æœºçš„PINï¼Œè¾“å…¥ä¸Šé¢çš„æ‰¾åˆ°çš„PINå³å¯ã€‚<br> <img src="snipaste20161220_120059.png" alt="snipaste20161220_120059"></li>
<li>ç„¶åä½ çš„UWPé¡¹ç›®å°±ä¼šåœ¨ä½ çš„å¹³æ¿ä¸Šå®‰è£…äº†ã€‚(-_-||) è¯·æ— è§†æˆ‘çš„lowé€¼è¯¾ç¨‹è¡¨UWPâ€¦â€¦<br> <img src="snipaste20161220_123214.png" alt="snipaste20161220_123214"></li>
</ul>
]]></content>
      <categories>
        <category>UWP</category>
      </categories>
      <tags>
        <tag>UWP</tag>
      </tags>
  </entry>
  <entry>
    <title>ä½¿ç”¨ Terminator &amp; ZSHçš„é…ç½®</title>
    <url>/2016/10/01/%E4%BD%BF%E7%94%A8%20Terminator%20%20&amp;%20ZSH%E7%9A%84%E9%85%8D%E7%BD%AE/</url>
    <content><![CDATA[<p> åœ¨åˆ«äººåšå®¢é‡Œçœ‹åˆ° Terminator æŒºå¥½ç”¨çš„ï¼Œç‰¹åˆ«æ˜¯å’Œzshæ­é…çœŸæ˜¯æ¼‚äº®ï¼Œè¿™é‡Œæ€»ç»“ä¸‹æ€ä¹ˆå¼„å§ã€‚</p>
<a id="more"></a>
<h2 id="å®‰è£…-Terminator"><a href="#å®‰è£…-Terminator" class="headerlink" title="å®‰è£… Terminator"></a>å®‰è£… Terminator</h2><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">sudo apt-get install terminator</span><br></pre></td></tr></table></figure>
<ul>
<li><em>åˆ©ç”¨ Debian çš„é‡æ–°é…ç½®å‘½ä»¤é€‰æ‹©é»˜è®¤ç»ˆç«¯ï¼š</em></li>
</ul>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">sudo update-alternatives --config x-terminal-emulator</span><br></pre></td></tr></table></figure>
<ul>
<li><em>éubuntuç³»ç»Ÿè®¾ç½®terminatorå¿«æ·é”®</em></li>
</ul>
<p>Setting -&gt; Keyboard -&gt; Shortcuts -&gt; Custom Shortcuts -&gt; add(+)<br>Name : Terminal<br>Command : /usr/bin/terminator<br>Apply<br>Click â€œDisableâ€<br>press Ctrl + Alt + T</p>
<h2 id="æ›´æ¢ä¸»é¢˜"><a href="#æ›´æ¢ä¸»é¢˜" class="headerlink" title="æ›´æ¢ä¸»é¢˜"></a>æ›´æ¢ä¸»é¢˜</h2><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">/* æ‰“å¼€Terminator ï¼Œè¿›è¡Œå¦‚ä¸‹æ“ä½œ */</span><br><span class="line">Preferenvces -&gt; General</span><br><span class="line">Disable â€˜Show titlebarâ€™</span><br><span class="line">Preferenvces -&gt; Profiles -&gt; Colors -&gt; Foreground and Background -&gt; Build-in schemes</span><br><span class="line">Choose â€˜Solarized darkâ€™</span><br></pre></td></tr></table></figure>
<h2 id="å®‰è£…zsh"><a href="#å®‰è£…zsh" class="headerlink" title="å®‰è£…zsh"></a>å®‰è£…zsh</h2><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">sudo apt-get install zsh</span><br></pre></td></tr></table></figure>
<ul>
<li><em>è®¾ç½®å½“å‰ç”¨æˆ·ä½¿ç”¨zsh</em></li>
</ul>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">chsh -s /bin/zsh</span><br></pre></td></tr></table></figure>
<h2 id="å®‰è£…-on-my-zsh"><a href="#å®‰è£…-on-my-zsh" class="headerlink" title="å®‰è£… on my zsh"></a>å®‰è£… on my zsh</h2><ul>
<li><em>è‡ªåŠ¨å®‰è£…ï¼š(æ¨è)</em></li>
</ul>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">wget https://github.com/robbyrussell/oh-my-zsh/raw/master/tools/install.sh -O - | sh</span><br></pre></td></tr></table></figure>
<ul>
<li><em>æ‰‹åŠ¨å®‰è£…ï¼š</em></li>
</ul>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">git <span class="built_in">clone</span> git://github.com/robbyrussell/oh-my-zsh.git ~/.oh-my-zsh</span><br><span class="line">cp ~/.oh-my-zsh/templates/zshrc.zsh-template ~/.zshrc</span><br></pre></td></tr></table></figure>
<h2 id="å®‰è£…powerlineå­—ä½“"><a href="#å®‰è£…powerlineå­—ä½“" class="headerlink" title="å®‰è£…powerlineå­—ä½“"></a>å®‰è£…powerlineå­—ä½“</h2><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">git <span class="built_in">clone</span> https://github.com/powerline/fonts</span><br><span class="line"><span class="built_in">cd</span> fonts</span><br><span class="line">./install.sh</span><br></pre></td></tr></table></figure>
<p>ç„¶ååœ¨ç»ˆç«¯ä¸­ä½¿ç”¨powerlineå­—ä½“</p>
<h2 id="ç¼–è¾‘ï¼š-zshrc"><a href="#ç¼–è¾‘ï¼š-zshrc" class="headerlink" title="ç¼–è¾‘ï¼š ~/.zshrc"></a>ç¼–è¾‘ï¼š ~/.zshrc</h2><ul>
<li><em>å¢åŠ è‡ªå·±çš„ç”¨æˆ·åï¼š</em></li>
</ul>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">DEFAULT_USER=<span class="string">"Shank"</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>PSï¼šä¸Šé¢ Shank æ›¿æ¢æˆä½ å½“å‰çš„ç”¨æˆ·åï¼Œç”¨whoamiæŸ¥çœ‹ä½ çš„ç”¨æˆ·å</p>
</blockquote>
<ul>
<li><em>ä¿®æ”¹ä¸»é¢˜ï¼š</em></li>
</ul>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">ZSH_THEME=<span class="string">"agnoster"</span></span><br></pre></td></tr></table></figure>
<ul>
<li><em>å¯ç”¨å‡ ä¸ªåŠŸèƒ½ï¼š</em></li>
</ul>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">COMPLETION_WAITING_DOTS=<span class="string">"true"</span></span><br></pre></td></tr></table></figure>
<h3 id="æˆ–è€…ç”¨ä»¥ä¸‹ç®€å•ç²—æš´çš„æ–¹å¼å±è”½zshä¸­çš„ç”¨æˆ·å"><a href="#æˆ–è€…ç”¨ä»¥ä¸‹ç®€å•ç²—æš´çš„æ–¹å¼å±è”½zshä¸­çš„ç”¨æˆ·å" class="headerlink" title="æˆ–è€…ç”¨ä»¥ä¸‹ç®€å•ç²—æš´çš„æ–¹å¼å±è”½zshä¸­çš„ç”¨æˆ·å"></a>æˆ–è€…ç”¨ä»¥ä¸‹ç®€å•ç²—æš´çš„æ–¹å¼å±è”½zshä¸­çš„ç”¨æˆ·å</h3><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="built_in">cd</span> ~/.oh-my-zsh/themes</span><br><span class="line">sudo vim å½“å‰ä¸»é¢˜åç§°</span><br></pre></td></tr></table></figure>
<p>æ‰¾åˆ°æœ€ä¸‹é¢å¯¹<code>build_prompt</code>çš„å®šä¹‰ï¼ŒæŠŠ<code>prompt_context</code>ç”¨<code>#</code>æ³¨é‡Šæ‰å³å¯</p>
<blockquote>
<p>æ¥è‡ª2018/10/29ï¼šâ€œä»¥å‰çš„è‡ªå·± Markdown å†™å¾—è¿™ä¹ˆçƒ‚è¿˜æ•¢è´´å‡ºæ¥ã€‚â€</p>
</blockquote>
]]></content>
      <categories>
        <category>Linux</category>
      </categories>
      <tags>
        <tag>Linux</tag>
        <tag>Terminator</tag>
        <tag>ZSH</tag>
      </tags>
  </entry>
  <entry>
    <title>Thinkpad X250 å®‰è£…ubuntu16.04.1LTS çš„è®°å½•</title>
    <url>/2016/10/01/Thinkpad%20X250%20%E5%AE%89%E8%A3%85ubuntu16.04.1LTS%20%E7%9A%84%E8%AE%B0%E5%BD%95/</url>
    <content><![CDATA[<p>X250 ä¸Šæœ‰ä¸¤å—ç¡¬ç›˜ï¼Œsdaæœ‰win10ï¼Œsdbä¸€ç›´åä¸ºæ•°æ®ç›˜ï¼Œæ‰“ç®—å®‰è£…ä¸€ä¸ªubuntu16.04.01LTSã€‚<br>å› ä¸ºè½»åº¦ä½¿ç”¨æ‰€ä»¥sdbä¸Šåˆ‡20Gçš„åˆ†åŒºç»™ubuntuï¼Œå‹ç¼©å·åä¸éœ€è¦æ–°å»ºåˆ†åŒºã€‚<br>Uç›˜åˆ¶ä½œubuntuå®‰è£…ç›˜ï¼Œå¼€æœºå¯åŠ¨åˆ°Uç›˜ã€‚</p>
<a id="more"></a>
<p>å®‰è£…æ—¶ï¼Œå¯¹ç©ºé—²20Gæ‰‹åŠ¨åˆ†åŒº ï¼š</p>
<table>
<thead>
<tr>
<th style="text-align:left">åˆ†åŒºç±»å‹</th>
<th style="text-align:left">æŒ‚è½½ç‚¹</th>
<th style="text-align:left">å¤§å°</th>
<th style="text-align:left">ä½ç½®</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">ä¸»åˆ†åŒº</td>
<td style="text-align:left">/boot</td>
<td style="text-align:left">400M</td>
<td style="text-align:left">èµ·å§‹</td>
</tr>
<tr>
<td style="text-align:left">é€»è¾‘åŒº</td>
<td style="text-align:left">/</td>
<td style="text-align:left">15000M</td>
<td style="text-align:left">èµ·å§‹</td>
</tr>
<tr>
<td style="text-align:left">é€»è¾‘åŒº</td>
<td style="text-align:left">swap</td>
<td style="text-align:left">512M</td>
<td style="text-align:left">æœ«å°¾</td>
</tr>
<tr>
<td style="text-align:left">é€»è¾‘åŒº</td>
<td style="text-align:left">/home</td>
<td style="text-align:left">å‰©ä½™æ‰€æœ‰</td>
<td style="text-align:left">èµ·å§‹</td>
</tr>
</tbody>
</table>
<p>å› ä¸ºæˆ‘ä¸å¸Œæœ›ubuntuè¦†ç›–æˆ‘çš„windowså¼•å¯¼ï¼Œæ‰€ä»¥å¯åŠ¨é€‰æ‹©å™¨ sdb<br>ï¼ˆå› ä¸ºå†…å­˜æœ‰8Gï¼Œäº¤æ¢ç©ºé—´å°±ä¸åˆ†é‚£ä¹ˆå¤šäº†ã€‚å¯åŠ¨é€‰æ‹©åœ¨ç¬¬äºŒå¿«ç›˜ï¼Œå°±ä¸ä¼šè¦†ç›–winçš„å¼•å¯¼ï¼Œå€’æ—¶å¼€æœºbiosæ”¹ä¸‹ç¡¬ç›˜å¯åŠ¨é¡ºåºå°±è¡Œäº†ã€‚<br>æˆ‘å¯èƒ½éšæ—¶ä¼šæŠŠubuntuçš„åˆ†åŒºæ ¼æ‰ï¼Œæ¯•ç«Ÿssdç©ºé—´æœ‰é™ï¼Œåˆ°æ—¶å€™ä¸è‡³äºç”¨easybcdæˆ–è€…PEé‡åšå¼•å¯¼ï¼‰<br>å®‰è£…å®Œæˆåï¼Œé‡å¯ã€‚</p>
<p><strong>å®‰è£…burgï¼Œç¾åŒ–å¼€æœºé€‰æ‹©ç•Œé¢ï¼š</strong></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sudo add-apt-repository ppa:n-muench/burg &amp;&amp; sudo apt-get update</span><br><span class="line">sudo apt-get install burg burg-themes burg-emu</span><br></pre></td></tr></table></figure>
<p>å®‰è£…è¿‡ç¨‹å¯ä»¥ä¸€è·¯å›è½¦ï¼Œæ³¨æ„åœ¨Configuring burg-pcæ—¶é€‰æ‹©sdbã€‚<br>æ›´æ¢burg themes ï¼Œä¸‹è½½Lightness BURG Theme by SWOriginal<br>è§£å‹åcpåˆ°/boot/burg/themesé‡Œã€‚</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sudo update-burg</span><br><span class="line">gedit /boot/burg/burg.cfg</span><br></pre></td></tr></table></figure>
<p>åˆ é™¤ä¸€ä¸ªrecoverymodeå¼•å¯¼ï¼Œæå‰winå¼•å¯¼é¡¹<br>sudo burg-emu -&gt; F2 -&gt; é€‰æ‹©Lightness<br>(æ¯æ¬¡grubæ›´æ–°åéƒ½è¦é‡ç½®burg sudo burg-install /dev/sdx )</p>
<p><strong>å®‰è£…æŒ‡çº¹è¯†åˆ«fingerprintï¼š</strong></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sudo add-apt-repository ppa:fingerprint/fprint &amp;&amp; sudo apt-get update</span><br><span class="line">sudo apt-get install libfprint0 fprint-demo libpam-fprintd gksu</span><br></pre></td></tr></table></figure>
<p>åœ¨ â€œç³»ç»Ÿè®¾ç½®â€ -&gt; â€œç”¨æˆ·è´¦æˆ·â€ é‡Œä¼šå¤šä¸€ä¸ª â€œæŒ‡çº¹ç™»å½•â€ï¼Œç…§ç€æç¤ºè¿›è¡Œè®¾ç½®å°±å¯ä»¥äº†ã€‚</p>
<p><strong>å…³é—­é¼ æ ‡åŠ é€Ÿï¼š</strong><br>åœ¨Dashboardé‡Œæœç´¢:<br>gnome-session-properties<br>ç‚¹å‡»æ·»åŠ ï¼š<br>åç§°ï¼šsetmouse<br>å‘½ä»¤ï¼šxset m 0 æˆ–è€… xset m default<br>é‡å¯ã€‚</p>
<p><strong>å®‰è£…TLPç”µæºç®¡ç†ï¼š</strong></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sudo apt-get install tlp tlp-rdw</span><br><span class="line">sudo apt-get install tp-smapi-dkms acpi-call-dkms</span><br><span class="line">sudo apt-get install thermald</span><br><span class="line">sudo apt-get install powertop</span><br></pre></td></tr></table></figure>
<p>é…ç½® TLP</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sudo vim /etc/default/tlp</span><br><span class="line">sudo tlp start</span><br></pre></td></tr></table></figure>
<p><strong>ä½¿ç”¨ terminator <a href="/2016/10/01/ä½¿ç”¨%20Terminator%20%20&amp;%20ZSHçš„é…ç½®/">æ›¿æ¢é»˜è®¤ç»ˆç«¯ä»¥åŠä½¿ç”¨zsh</a></strong> (å¦å¤–å†™ä¸€ç¯‡ä»‹ç»è¿™ä¸ª)</p>
<p><strong>å®‰è£…Arc GTKä¸»é¢˜ï¼š</strong></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sudo sh -c "echo 'deb http://download.opensuse.org/repositories/home:/Horst3180/xUbuntu_16.04/ /' &gt;&gt; /etc/apt/sources.list.d/arc-theme.list"</span><br><span class="line">wget http://download.opensuse.org/repositories/home:Horst3180/xUbuntu_16.04/Release.key</span><br><span class="line">sudo apt-key add - &lt; Release.key</span><br><span class="line">sudo apt update</span><br><span class="line">sudo apt install arc-theme</span><br></pre></td></tr></table></figure>
<p>å®‰è£…Unity Tweak Toolç®¡ç†ä¸»é¢˜ï¼š</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sudo apt install unity-tweak-tool</span><br></pre></td></tr></table></figure>
<p>ä¸ªäººè§‰å¾—Arc-darker å¥½çœ‹ï¼Œæ›´æ¢ä¹‹ã€‚</p>
<p><strong>å®‰è£…Deadbeefï¼Œæ’­æ”¾æ›´å¤šéŸ³é¢‘ï¼š</strong></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sudo add-apt-repository ppa:starws-box/deadbeef-player</span><br><span class="line">sudo apt-get update</span><br><span class="line">sudo apt-get install deadbeef</span><br></pre></td></tr></table></figure>
<p><strong>å®‰è£…MPVæ’­æ”¾å™¨ï¼š</strong></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sudo apt-get install mpv</span><br></pre></td></tr></table></figure>
<p><strong>å®‰è£…cherrytreeç¬”è®°æœ¬ï¼š</strong></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sudo apt-get install cherrytree</span><br></pre></td></tr></table></figure>
<p><strong>å®‰è£…lanternç¿»å¢™ï¼š</strong><br><a href="https://github.com/getlantern/forum/issues/833" target="_blank" rel="noopener">ä¼ é€é—¨</a></p>
]]></content>
      <categories>
        <category>Linux</category>
      </categories>
      <tags>
        <tag>Linux</tag>
        <tag>Terminator</tag>
        <tag>ZSH</tag>
      </tags>
  </entry>
</search>
